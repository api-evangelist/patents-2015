---

title: Proactively providing corrective measures for storage arrays
abstract: Proactively providing corrective measures for storage arrays includes: receiving data from a storage array, the data including one or more events; detecting, in dependence upon a problem signature, one or more events from the data indicative of a particular problem, where the problem signature comprises a specification of a pattern of events indicative of the particular problem experienced by at least one other storage array; determining whether the particular problem violates an operational policy of the storage array, the operational policy specifying at least one requirement for an operational metric of the storage array; and if the particular problem violates the operational policy of the storage array, deploying automatically without user intervention one or more corrective measures to prevent the storage array from experiencing the particular problem.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09384082&OS=09384082&RS=09384082
owner: Pure Storage, Inc.
number: 09384082
owner_city: Mountain View
owner_country: US
publication_date: 20151023
---
The field of technology is data processing or more specifically methods apparatus and products for proactively providing corrective measures for storage arrays.

Data centers may include many computing components including servers network devices and storage arrays. As the need for storage of large amounts of data and efficient access to that data increases storage array technology is advancing. Such storage arrays may provide persistent storage for any number of computing devices in a data center. As the number of storage arrays in a data center increases and the types of such storage arrays begins to vary different storage arrays may be susceptible to different types of problems. Preventing such disparate types of problems across a large set of storage arrays may be difficult. Further each corrective measure deployed to prevent such a problem may adversely affect the performance of the storage array s performance during the deployment of the corrective measure.

Methods apparatus and products for proactively providing corrective measures for storage arrays are disclosed in this specification. Proactively providing such corrective measures for storage arrays includes receiving data from a storage array the data including one or more events detecting in dependence upon a problem signature one or more events from the data indicative of a particular problem where the problem signature comprises a specification of a pattern of events indicative of the particular problem experienced by at least one other storage array determining whether the particular problem violates an operational policy of the storage array the operational policy specifying at least one requirement for an operational metric of the storage array and if the particular problem violates the operational policy of the storage array deploying automatically without user intervention one or more corrective measures to prevent the storage array from experiencing the particular problem.

The foregoing and other objects features and advantages of the invention will be apparent from the following more particular descriptions of exemplary embodiments of the invention as illustrated in the accompanying drawings wherein like reference numbers generally represent like parts of exemplary embodiments of the invention.

Exemplary methods apparatus and products for proactively providing corrective measures for storage arrays in accordance with the present invention are described with reference to the accompanying drawings beginning with .

The computing devices in the example of are coupled for data communications to a number of storage arrays through a storage area network SAN as well as a local area network LAN . The SAN may be implemented with a variety of data communications fabrics devices and protocols. Example fabrics for such a SAN may include Fibre Channel Ethernet Infiniband SAS Serial Attached Small Computer System Interface and the like. Example data communications protocols for use in such a SAN may include ATA Advanced Technology Attachment Fibre Channel Protocol SCSI iSCSI HyperSCSI and others. Readers of skill in the art will recognize that a SAN is just one among many possible data communications couplings which may be implemented between a computing device and a storage array. Any other such data communications coupling is well within the scope of embodiments of the present invention.

The local area network of may also be implemented with a variety of fabrics and protocols. Examples of such fabrics include Ethernet . wireless . and the like. Examples of such data communications protocols include TCP Transmission Control Protocol UDP User Datagram Protocol IP Internet Protocol HTTP HyperText Transfer Protocol WAP Wireless Access Protocol HDTP Handheld Device Transport Protocol SIP Session Initiation Protocol RTP Real Time Protocol and others as will occur to those of skill in the art.

The example storage arrays of provide persistent data storage for the computing devices. Each storage array includes a storage controller . The storage controller is a module of automated computing machinery comprising computer hardware computer software or a combination of computer hardware and software. The storage controller may be configured to carry out various storage related tasks. Such tasks may include writing data received from a computing device to storage erasing data from storage retrieving data from storage to provide to a computing device monitoring and reporting of disk utilization and performance performing RAID Redundant Array of Independent Drives or RAID like data redundancy operations compressing data encrypting data and so on.

Each storage controller may be implemented in a variety of ways including as an FPGA Field Programmable Gate Array a PLC Programmable Logic Chip an ASIC Application Specific Integrated Circuit or computing device that includes discrete components such as a central processing unit computer memory and various adapters. Each storage controller may for example include a data communications adapter configured to support communications via the SAN and the LAN . Only one of the storage controllers in the example of is depicted as coupled to the LAN for data communications for clarity. Readers should understand that both storage controllers are independently coupled to the LAN . Each storage controller may also for example include an I O controller or the like that couples the storage controller for data communications through a midplane to a number of storage devices and a number of write buffer devices devices.

Each write buffer device may be configured to receive from the storage controller data to be stored in the storage devices . Such data may originate from any one of the computing devices . In the example of writing data to the write buffer device may be carried out more quickly than writing data to the storage device. The storage controller may be configured to effectively utilize the write buffer devices as a quickly accessible redundant buffer for data destined to be written to storage. In this way if the storage device to which the data is to be written fails or if the write does not complete the write buffer device may maintain the data to be written during a retry of the write or during failover of the storage device to another location. That is the write buffer device may provide redundancy for the storage devices.

A storage device as the term is used in this specification refers to any device configured to record data persistently. The term persistently as used here refers to a device s ability to maintain recorded data after loss of a power source. Examples of storage devices may include mechanical spinning hard disk drives Solid state drives Flash drives and the like.

In addition to being coupled to the computing devices through the SAN the storage arrays may also be coupled to the computing devices through the LAN and to one or more cloud service providers through the Internet . The term cloud as used in this specification refers to systems and computing environments that provide services to user devices through the sharing of computing resources through a network. Generally the user device is unaware of the exact computing resources utilized by the cloud system to provide the services. Although in many cases such cloud environments or systems are accessible via the Internet readers of skill in the art will recognize that any system that abstracts the use of shared resources to provide services to a user through any network may be considered a cloud based system.

One example cloud service in is a storage array services provider . The storage array service provider may be configured to provide various storage array services such as reporting of storage array performance characteristics configuration control of the storage arrays and the like. The storage array services provider may rely on modules executing on the storage array itself to gather or process such data.

The system of may be configured according to embodiments of the present invention to proactively provide corrective measures for storage arrays. The storage array services provider in the example of may receive data from a storage array where the data includes one or more events. Data received from a storage array may take various forms including for example log data from components of the storage array. Such log data may include a description of events that occur at the components of the storage array. Such events may include exceptions errors performance metrics and other types of occurrences.

The storage array services provider may also detect in dependence upon a problem signature one or more events from the data that are indicative of a particular problem. A problem signature as the term is used in this specification refers to a specification of a pattern of events indicative of a particular problem experienced by at least one storage array in a multiple array storage environment. In this way a problem signature may be used to project the occurrence of a problem in one or more storage arrays in the storage environment before that problem is exhibited. The generation of such a problem signature may be based on events from one or more storage arrays that experienced the particular problem. When multiple storage arrays for example suffer the same problem the events leading up to the occurrence of the problem may be cross correlated amongst the arrays to identify a similar pattern of events. Such a pattern of events may be utilized to generate the problem signature for the particular problem. Then when a storage array experiences the same pattern of events even before experiencing the particular problem the storage array services provider may through the use of the problem signature detect the events as indicative of the particular problem.

In another embodiment a particular issue may occur on one or more arrays set A but that same particular issue may not yet have occurred or have been observed on another one or more arrays set B. To generate a problem signature in such an environment the one or more storage arrays of set A may be inspected for common characteristics such as software version controller type performance settings and the like. The particular issue may arise on only set A rather than set B for various reasons and as an effect of such common characteristics. In some instances for example the particular issue may arise on set A due to set A running a newer software version then set B. In such an instance when set B is upgraded to the newer software version set B would match the problem signature for the particular issue and a candidate for the proactive upgrades.

In some embodiments the cloud storage array services provider may assign a severity level to each particular problem or each problem signature. The cloud storage array services provider may classify an application level of the corrective measures in dependence upon the severity of the problem and the potential impact of deploying corrective measures. For example a problem signature may be classified as follows in descending order of likelihood for application 

In this way highly severe problems that are common across many storage arrays regardless of each of the storage arrays operational policies may be identified and corrective measures may be applied in accordance with the severity.

The storage array services provider in the example of may then determine whether the particular problem violates an operational policy of the storage array. A storage array may be subject to any number of operational policies. An operational policy as the term is used in this specification refers to a policy that specifies at least one requirement for an operational metric of the storage array. Operational metrics may be any type of metric that describes operation of the storage array including for example throughput data reduction high availability and the like. One particular example of an operational policy may be a service level agreement for a required quality of service. Another example may be related to ensuring performance objectives of the storage array during recovery such as meeting the recovery point objective RPO or recovery time objective RTO . A user of the storage array may require that some services provided by the storage array meet particular criteria. Examples of such operational policies may include a requirement for high availability a requirement for failover a requirement for a minimum data reduction ratio including garbage collection performance deduplication performance or both a requirement for a minimum input output latency a requirement for a minimum replication throughput or a requirement for data retention. Another type of operational policy may be an expected or healthy operational policy. Such a policy may specify a maximum number of errors of particular types that are allowed as well as other minimum operational metrics.

If the particular problem violates the operational policy of the storage array the storage array services provider may automatically and without user intervention deploy one or more corrective measures to prevent the storage array from experiencing the particular problem. Examples of corrective measures may include a software upgrade a firmware upgrade setting of performance parameters and the like. In this way a storage array may be prevented from experiencing a problem that has occurred on other storage arrays and prevented from operating in a manner that violates the operational policy of the storage array. Corrective measures may also include measures other than setting performance parameters. For example modifying behavior of an algorithm executing on the storage array to prevent a crash or prevent experiencing a known issue or bug.

The term prevent as used here may refer to preempt and correct as context requires. That is in some instances corrective measures are deployed in order to preempt a problem from occurring in a storage array that has not yet exhibited the problem identified in the problem signature. In such an instance that problem may have been previously identified in one or more storage arrays in a multiple array storage environment. The one or more storage arrays exhibiting the problem may have similar or common characteristics to the storage array that has not yet exhibited the problem. In this way through the deployment of corrective measures a storage array may be preempted from exhibiting the problem that one or more other storage arrays previously exhibited.

In other examples a problem may have been experienced by a storage array and through the identification of the problem through the use of the problem signature as described above corrective measures may correct the problem being experienced. In either case the effect of the problem is reduced greatly. That is because the problem or potential for a problem is identified at an early stage the effect of the problem is greatly reduced. In some embodiments the problem is avoided entirely and in others the problem is corrected at a very early stage.

Deploying corrective actions may be carried out in various ways. In some embodiments the storage array services provider may deploy one or more corrective measures automatically without a user s approval or with a user s inferred approval such as through the user opting in to automatic deployments of corrective measures . In other embodiments the storage array services provider may be configured to deploy corrective measures only upon a user s explicit approval. Examples of such deployment upon a user s explicit approval may include staging an update of software of the storage array and updating the software only responsive to receiving an approval from the user. Another example of such deployment of corrective actions upon a user s explicit approval may include the storage array services provider recommending to a user a modification of one or more tuning parameters for the storage array. In such embodiments the storage array services provider may push such modification to the storage array after the user s approves the recommendation.

Additionally multiple tiers of criticality may be implemented in which problems that are less critical need not be pushed without a user s approval while problems for which corrective measures are highly critical may be automatically pushed without a user s permission. In some instances such automatic corrective measures may be provided without a user s permission at the time of the deployment of such corrective measures but with a user s permission to all such deployments. That is a user may opt in to automatic corrective measures in some embodiments.

In some embodiments a particular problem may be identified but the problem may not violate an operational policy of the storage array. In such embodiments the storage array services provider may be configured to flag the particular problem. The storage array services provider may also be configured to take any number of actions in addition to flagging the particular problem such as informing the user of the flagged problem or recommending one or more corrective actions to be carried out.

The arrangement of computing devices storage arrays cloud based service providers networks and other devices making up the exemplary system illustrated in are for explanation not for limitation. Systems useful according to various embodiments of the present invention may include different configurations of servers routers switches computing devices and network architectures not shown in as will occur to those of skill in the art.

Proactively providing corrective measures for storage arrays in accordance with embodiments of the present invention is generally implemented with computers. In the system of for example all the computing devices storage controllers and storage array services provider may be implemented to some extent at least as computers. For further explanation therefore sets forth a block diagram of several example computers useful for proactively providing corrective measures for storage arrays according to embodiments of the present invention. The example computers in include a storage array services provider .

The storage array services provider of includes at least one computer processor or CPU as well as random access memory RAM which is connected through a high speed memory bus and bus adapter to processor and to other components of the storage array services provider . Stored in RAM is a cloud based services module a module of computer program instructions that when executed causes the storage array services provider to proactively provide corrective measures to a storage array. The cloud based services module may receive data from a storage array where the data includes one or more events detect in dependence upon a problem signature one or more events from the data indicative of a particular problem where the problem signature comprises a specification of a pattern of events indicative of the particular problem experienced by at least one other storage array determine whether the particular problem violates an operational policy of the storage array where the operational policy specifies at least one requirement for an operational metric of the storage array and if the particular problem violates the operational policy of the storage array deploy automatically without user intervention one or more corrective measures to prevent the storage array from experiencing the particular problem.

As mentioned above the problem signature may be generated based on an analysis of data from one or more storage arrays that have experienced the particular problem. In the example of three sets of storage arrays are coupled to the storage array services provider for data communications. Each set may be located at a distinct physical location from the other sets. That is each set may be located in a different data center at different location in the world. Further each set may be owned by a different entity. All the storage arrays however provide data including events that occur within the storage array to the storage array services provider. To that end the events provided by the storage arrays experiencing the same problem may be analyzed for commonalities so that a pattern of events indicative of the problem may be identified. Once identified a problem signature for the problem may be generated and utilized as described above to prevent the same problem from occurring in other storage arrays.

Although proactively providing corrective measures for storage arrays in a multiple array storage environment is described here as being carried out generally by the storage array services provider readers will understand that such steps may be carried out by other entities and modules. For example the storage controller may execute a module of computer program instructions that proactively provides corrective measures for storage arrays a management module not shown in in communication with the storage arrays within the local area network of the storage array environment may be configured to proactively provide corrective measures for storage arrays and so on as will occur to readers of skill in the art.

Also stored in RAM of the example storage array services provider is an operating system . Examples of operating systems useful in computers configured for proactively providing corrective measures for storage arrays according to embodiments of the present invention include UNIX Linux Microsoft Windows and others as will occur to those of skill in the art. The operating system and the cloud based storage array services module in the example of are shown in RAM but many components of such software typically are stored in non volatile memory also such as for example on a disk drive . Likewise the modules depicted in RAM of the storage array and client side user computer may be stored in non volatile memory.

The storage array services provider of also includes disk drive adapter coupled through an expansion bus and bus adapter to the processor and other components of the storage array services provider . Disk drive adapter connects non volatile data storage to the storage array services provider in the form of disk drive . Disk drive adapters may be implemented in a variety of ways including as SATA Serial Advanced Technology Attachment adapters PATA Parallel ATA adapters Integrated Drive Electronics IDE adapters Small Computer System Interface SCSI adapters and others as will occur to those of skill in the art. Non volatile computer memory also may be implemented as an optical disk drive electrically erasable programmable read only memory so called EEPROM or Flash memory RAM drives and so on as will occur to those of skill in the art.

The example storage array services provider of includes one or more input output I O adapters . I O adapters implement user oriented input output through for example software drivers and computer hardware for controlling output to display devices such as computer display screens as well as user input from user input devices such as keyboards and mice. The example storage array services provider of also includes a video adapter which is an example of an I O adapter specially designed for graphic output to a display device such as a display screen or computer monitor. Video adapter is connected to the processor through a high speed video bus.

The exemplary storage array services provider of includes a communications adapter for data communications with the storage arrays through the network . Such data communications may be carried out through data communications networks such as IP data communications networks and in other ways as will occur to those of skill in the art. Communications adapters implement the hardware level of data communications through which one computer sends data communications to another computer directly or through a data communications network. Examples of such communications adapters useful include modems for wired dial up communications Ethernet IEEE 802.3 adapters for wired data communications and 802.11 adapters for wireless data communications.

Readers of skill in the art will recognize that the components of the storage array services provider as depicted in are example computing components only. Such a storage array services provider may be configured in various ways including for example as a server. Such a server may not include the I O adapters the driver adapters display devices video adapters and the like.

As mentioned above a storage array may also be implemented at least to some extent as a computer. For further explanation therefore sets forth a block diagram of an example storage controller of a storage array . The example storage controller includes a computer processor . The computer processor is coupled to RAM through a DDR4 Double Data Rate 4 bus. Stored in RAM is an operating system and log data . Such log data may include events that occur within the storage array that are reported to the storage controller from firmware of the components of the storage array or events detected by the operating system of the storage controller.

The processor is also coupled for data communications through PCIe Peripheral Component Interface express links to several Fibre Channel host bus adapters an Ethernet adapter and a PCIe switch . The Fibre Channel host bus adapters may couple the storage controller to a storage area network such the SAN depicted in the example of . The Ethernet adapter may couple the storage controller to a local area network such as the LAN depicted in the example of . The PCIe switch may provide data communications across other PCI links through the midplane to PCI endpoints such as storage devices or write buffer devices. Likewise the processor is also coupled through a SAS Serial Attached SCSI host bus adapter to a SAS expander . The SAS expander may provide SAS connections between the computer processor and other devices through the midplane.

Readers of skill in the art will recognize that these components protocols adapters and architectures are for illustration only not limitation. Such a storage controller may be implemented in a variety of different ways. Each such way is well within the scope of the present invention.

For further explanation sets forth a flow chart illustrating an exemplary method for proactively providing corrective measures for storage arrays according to embodiments of the present invention. The method of may be carried out by a cloud based storage array services provider in the example of .

The method of includes receiving data from a storage array. The data received from the storage array comprising one or more events. The events as mentioned above may include any occurrence of a component within the storage array any occurrence of software performance metrics and so on as will occur to readers of skill in the art. Receiving such data may be carried out in a variety of ways. In some embodiments for example the storage array services provider may receive such data periodically through a data communications network and one or more Application Programming Interfaces APIs exposed to software executing on a storage controller of the storage array.

The method of also includes detecting in dependence upon a problem signature one or more events from the data indicative of a particular problem. As mentioned above the problem signature may be implemented as a specification of a pattern of events indicative of the particular problem experienced by at least one other storage array. Detecting one or more events indicative of the particular from the data received from the storage may be carried out in a variety of ways. For example the storage array services provider may periodically compare events received from a storage array to the patterns of events of a plurality of problem signatures. In some embodiments one or more events of one or more problem signatures may be flagged. The storage array services provider may be configured to begin a comparison of events received from a storage array to one or more problem signatures that include a flagged event upon receipt of that flagged event.

The method of also includes determining whether the particular problem violates an operational policy of the storage array. As mentioned above the operational policy specifies at least one requirement for an operational metric of the storage array. Determining whether the particular problem violates the operational policy of the storage array may be carried out by determining whether the effect of the problem if experienced by the storage array may cause one or more operational metrics to fail to meet at least one requirement of the operational policy.

If the particular problem violates the operational policy of the storage array the method of continues by deploying automatically without user intervention one or more corrective measures to prevent the storage array from experiencing the particular problem. Deploying one or more corrective measures to prevent the storage array from experiencing the particular problem may be carried out by pushing from the storage array services provider to the storage array via a data communications network and one or more APIs an update to software a change to one or more performance tuning metrics an update to firmware a change in configuration and so on as will occur to readers of skill in the art. In some embodiments the storage array services provider may instruct the storage array to update software or firmware in a background process.

If the particular problem does not violate the operational policy of the storage array the method of continues by generating an action recommendation to provide to a user. Generating an action recommendation may include generating a notification of a type of corrective action recommended to prevent the occurrence of the particular problem. Additionally the action recommendation may include a severity or criticality level of the recommended corrective action. In some embodiments such an action recommendation may include a proposed schedule for applying the recommended corrective action.

In some embodiments such an action recommendation may include notifying a user of the storage array of physical corrective measures to be carried out by the user. That is a corrective measure that cannot be carried within the storage array through a software update or configuration change for example may be identified as a means to prevent a particular problem. In such an embodiment a user of the storage array may be notified to take such measures. A physical change for example such as utilizing a greater number or fewer number ports may alleviate a problem identified in a problem signature. Such a corrective measure however cannot be applied by a storage array services provider.

Exemplary embodiments of the present invention are described largely in the context of a fully functional computer system. Readers of skill in the art will recognize however that the present invention also may be embodied in a computer program product disposed upon computer readable media for use with any suitable data processing system. Such computer readable storage media may be any transitory or non transitory media. Examples of such media include storage media for machine readable information including magnetic media optical media or other suitable media. Examples of such media also include magnetic disks in hard drives or diskettes compact disks for optical drives magnetic tape and others as will occur to those of skill in the art. Persons skilled in the art will immediately recognize that any computer system having suitable programming means will be capable of executing the steps of the method of the invention as embodied in a computer program product. Persons skilled in the art will recognize also that although some of the exemplary embodiments described in this specification are oriented to software installed and executing on computer hardware nevertheless alternative embodiments implemented as firmware as hardware or as an aggregation of hardware and software are well within the scope of embodiments of the present invention.

It will be understood from the foregoing description that modifications and changes may be made in various embodiments of the present invention without departing from its true spirit. The descriptions in this specification are for purposes of illustration only and are not to be construed in a limiting sense. The scope of the present invention is limited only by the language of the following claims.

