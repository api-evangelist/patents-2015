---

title: Systems and methods for authenticated system partition access
abstract: In accordance with embodiments of the present disclosure, an information handling system may include a processor, a storage resource communicatively coupled to the processor, and a basic input/output system (BIOS) comprising a program of instructions executable by the processor and configured to cause the processor to initialize one or more information handling resources of the information handling system. The BIOS may be further configured to, during runtime of an operating system, receive an input/output request from the operating system to access a system partition instantiated on the storage resource, authenticate the input/output request, and responsive to authenticating the input/output request, provide a runtime service of the BIOS to complete the input/output request to the system partition.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09495535&OS=09495535&RS=09495535
owner: Dell Products L.P.
number: 09495535
owner_city: Round Rock
owner_country: US
publication_date: 20150417
---
The present disclosure relates in general to information handling systems and more particularly to systems and methods for providing secure system partition access to an operating system.

As the value and use of information continues to increase individuals and businesses seek additional ways to process and store information. One option available to users is information handling systems. An information handling system generally processes compiles stores and or communicates information or data for business personal or other purposes thereby allowing users to take advantage of the value of the information. Because technology and information handling needs and requirements vary between different users or applications information handling systems may also vary regarding what information is handled how the information is handled how much information is processed stored or communicated and how quickly and efficiently the information may be processed stored or communicated. The variations in information handling systems allow for information handling systems to be general or configured for a specific user or specific use such as financial transaction processing airline reservations enterprise data storage or global communications. In addition information handling systems may include a variety of hardware and software components that may be configured to process store and communicate information and may include one or more computer systems data storage systems and networking systems.

In many information handling systems a basic input output system BIOS for example a Unified Extensible Firmware Interface UEFI is capable of operating in a pre boot mode in which the BIOS executes certain instructions prior to loading and execution of an operating system. In an information handling system employing UEFI a storage resource of the information handling system may include an EFI System Partition ESP . When an information handling system is powered up and booted UEFI firmware may load files stored on the ESP to start installed operating systems and various utilities.

Presently across the industry there are numerous different mechanisms to access an ESP which may vary based on operating system file system type or other parameters and no industry standard to address the access mechanism to an ESP. For example in Linux systems gummiboot operates on the ESP only meaning configuration file fragments kernels and other EFI images need to reside on the ESP. Linux kernels must accordingly be built with an appropriate stub to be able to be directly executed as an EFI image. gummiboot may read simple and entirely generic boot loader boot loader configuration files with one file per boot loader entry to select from and with all files residing in the ESP. On the other hand on Apple Intel architecture Macintosh systems the ESP may initially be blank and may not be used for booting. However the ESP may be used as a staging area for firmware updates. As another example Microsoft recommends that when partitioning a storage resource the ESP be the first partition on the storage resource even though this is not a requirement of the UEFI specification itself. On later versions of Microsoft operating systems access to ESP may be obtained by running a command to mount volumes.

In addition multiple vulnerabilities may exist in allowing operating systems to access an ESP directly. If an operating system is vulnerable system recovery embedded in operating system loaders or in a recovery partition may not be accessible once the ESP is corrupted as the ESP is the main partition to access system boot and system dependent files. In spite of systems enabled with SecureBoot or similar features SecureBoot is not guaranteed to run in operating system space across all operating systems and once handover from UEFI to operating system loaded is complete UEFI SecureBoot functionality is complete. Thus if the operating system is vulnerable malicious code may take over an entire system by injecting malware into the ESP as the ESP is a direct access mechanism from the operating system.

In accordance with the teachings of the present disclosure the disadvantages and problems associated with securing access to a system partition of a storage resource by an operating system may be substantially reduced or eliminated.

In accordance with embodiments of the present disclosure an information handling system may include a processor a storage resource communicatively coupled to the processor and a basic input output system BIOS comprising a program of instructions executable by the processor and configured to cause the processor to initialize one or more information handling resources of the information handling system. The BIOS may be further configured to during runtime of an operating system receive an input output request from the operating system to access a system partition instantiated on the storage resource authenticate the input output request and responsive to authenticating the input output request provide a runtime service of the BIOS to complete the input output request to the system partition.

In accordance with these and other embodiments of the present disclosure a method may include during runtime of an operating system executing on an information handling system receiving by a basic input output system BIOS comprising a program of instructions executable by the processor and configured to cause the processor to initialize one or more information handling resources of the information handling system an input output request from the operating system to access a system partition instantiated on a storage resource of the information handling system. The method may also include authenticating by the BIOS the input output request. The method may further include responsive to authenticating the input output request providing a runtime service of the BIOS to complete the input output request to the system partition.

In accordance with these and other embodiments of the present disclosure an article of manufacture may include a non transitory computer readable medium and computer executable instructions carried on the computer readable medium. The instructions may be readable by a processor the instructions when read and executed for causing the processor to during runtime of an operating system executing on an information handling system i receive by a basic input output system BIOS comprising a program of instructions executable by the processor and configured to cause the processor to initialize one or more information handling resources of the information handling system an input output request from the operating system to access a system partition instantiated on a storage resource of the information handling system ii authenticate by the BIOS the input output request and iii responsive to authenticating the input output request provide a runtime service of the BIOS to complete the input output request to the system partition.

Technical advantages of the present disclosure may be readily apparent to one skilled in the art from the figures description and claims included herein. The objects and advantages of the embodiments will be realized and achieved at least by the elements features and combinations particularly pointed out in the claims.

It is to be understood that both the foregoing general description and the following detailed description are examples and explanatory and are not restrictive of the claims set forth in this disclosure.

Preferred embodiments and their advantages are best understood by reference to wherein like numbers are used to indicate like and corresponding parts.

For the purposes of this disclosure an information handling system may include any instrumentality or aggregate of instrumentalities operable to compute classify process transmit receive retrieve originate switch store display manifest detect record reproduce handle or utilize any form of information intelligence or data for business scientific control entertainment or other purposes. For example an information handling system may be a personal computer a PDA a consumer electronic device a network storage device or any other suitable device and may vary in size shape performance functionality and price. The information handling system may include memory one or more processing resources such as a central processing unit CPU or hardware or software control logic. Additional components of the information handling system may include one or more storage devices one or more communications ports for communicating with external devices as well as various input and output I O devices such as a keyboard a mouse and a video display. The information handling system may also include one or more buses operable to transmit communication between the various hardware components.

For the purposes of this disclosure computer readable media may include any instrumentality or aggregation of instrumentalities that may retain data and or instructions for a period of time. Computer readable media may include without limitation storage media such as a direct access storage device e.g. a hard disk drive or floppy disk a sequential access storage device e.g. a tape disk drive compact disk CD ROM DVD random access memory RAM read only memory ROM electrically erasable programmable read only memory EEPROM and or flash memory as well as communications media such as wires optical fibers microwaves radio waves and other electromagnetic and or optical carriers and or any combination of the foregoing.

For the purposes of this disclosure information handling resources may broadly refer to any component system device or apparatus of an information handling system including without limitation processors buses memories I O devices and or interfaces storage resources network interfaces motherboards integrated circuit packages electro mechanical devices e.g. air movers displays and power supplies.

Processor may comprise any system device or apparatus operable to interpret and or execute program instructions and or process data and may include without limitation a microprocessor microcontroller digital signal processor DSP application specific integrated circuit ASIC or any other digital or analog circuitry configured to interpret and or execute program instructions and or process data. In some embodiments processor may interpret and or execute program instructions and or process data stored in memory storage resource and or another component of information handling system . Memory may be communicatively coupled to processor and may comprise any system device or apparatus operable to retain program instructions or data for a period of time. Memory may comprise random access memory RAM electrically erasable programmable read only memory EEPROM a PCMCIA card flash memory magnetic storage opto magnetic storage or any suitable selection and or array of volatile or non volatile memory that retains data after power to information handling system is turned off.

A BIOS may include any system device or apparatus configured to identify test and or initialize information handling resources of information handling system and or initialize interoperation of information handling system with other information handling systems. BIOS may broadly refer to any system device or apparatus configured to perform such functionality including without limitation a Unified Extensible Firmware Interface UEFI . In some embodiments BIOS may be implemented as a program of instructions that may be read by and executed on processor to carry out the functionality of BIOS . In these and other embodiments BIOS may comprise boot firmware configured to be the first code executed by processor when information handling system is booted and or powered on. As part of its initialization functionality code for BIOS may be configured to set components of information handling system into a known state so that one or more applications e.g. an operating system or other application programs stored on compatible media e.g. disk drives may be executed by processor and given control of information handling system . BIOS may also be configured with functionality for receiving information from network and storing such information in storage resource .

As shown in BIOS may include runtime services . A BIOS and in particular a UEFI enabled BIOS may include two types of services boot services and runtime services. Boot services are only available while the BIOS firmware owns an information handling system and before a BIOS passes execution to an operating system. Boot services include text and graphical consoles on various devices and bus block and file services. On the other hand runtime services are services of BIOS that may remain accessible while an operating system is executing and may include services such as date time non volatile RAM access and other services. Thus runtime services may comprise a subset of instructions of BIOS . As shown in runtime services may include a protected access module and system partition access services . As described in greater detail elsewhere in this disclosure protected access module and system partition access services may enable an operating system during runtime to access a system partition of storage resource through authenticated services thus providing security to the system partition even if the operating system has become vulnerable to malicious code.

Storage resource may be communicatively coupled to processor and may include any system device or apparatus operable to store information processed by processor . Storage resource may include for example one or more direct access storage devices e.g. hard disk drives . Although storage resource is shown as internal to information handling system in in some embodiments storage resource may be external to information handling system . Also although only one storage resource is depicted in information handling system may comprise or may be coupled to a plurality of storage resources . As shown in storage resource may comprise globally unique identifier GUID partition table GPT a system partition a bootable primary partition a primary partition and a backup GPT .

GPT may comprise a table or other data structure setting forth the various partitions of storage resource and the locations e.g. logical block addresses thereof. To provide redundancy in case of failure the contents of GPT may be backed up to backup GPT .

System partition may comprise a partition of storage resource that includes boot loader programs for installed operating systems of information handling system device driver files for devices present in information handling system that are used by the firmware at boot time system utility programs that are intended to be run before an operating system is booted and data files such as error logs. In addition system partition may also be accessible during runtime of an operating system such that an operating system may use system partition to store certain utilities tools and or data files of the operating system. In embodiments in which information handling system adheres to UEFI system partition may comprise an ESP.

Bootable primary partition may comprise a primary partition of storage resource that includes a boot loader for booting an operating system. Although depicts storage resource having a single bootable primary partition in some embodiments particularly in those in which information handling system has installed thereon multiple operating systems storage resource may comprise multiple bootable primary partitions .

Primary partition may comprise a partition other than a system partition and a bootable primary partition that includes a single file system as is known in the art. Although depicts storage resource having a single primary partition in some embodiments storage resource may comprise multiple primary partitions .

Network interface may comprise any suitable system apparatus or device operable to serve as an interface between information handling system and another information handling system and or a network. Network interface may enable information handling system to communicate using any suitable transmission protocol and or standard. In some embodiments network interface may be configured to communicate with other information handling systems via one or more protocols or standards discussed below with respect to network . In these and other embodiments network interface may comprise a network interface card or NIC. 

As shown in network interface may be communicatively coupled to a network . Network may be a network and or fabric configured to couple information handling system to one or more other information handling systems. In these and other embodiments network may include a communication infrastructure which provides physical connections and a management layer which organizes the physical connections and information handling systems communicatively coupled to network . Network may be implemented as or may be a part of a storage area network SAN personal area network PAN local area network LAN a metropolitan area network MAN a wide area network WAN a wireless local area network WLAN a virtual private network VPN an intranet the Internet or any other appropriate architecture or system that facilitates the communication of signals data and or messages generally referred to as data . Network may transmit data via wireless transmissions and or wire line transmissions using any storage and or communication protocol including without limitation Fibre Channel Frame Relay Asynchronous Transfer Mode ATM Internet protocol IP other packet based protocol small computer system interface SCSI Internet SCSI iSCSI Serial Attached SCSI SAS or any other transport that operates with the SCSI protocol advanced technology attachment ATA serial ATA SATA advanced technology attachment packet interface ATAPI serial storage architecture SSA integrated drive electronics IDE and or any combination thereof. Network and its various components may be implemented using hardware software or any combination thereof.

In addition to processor memory BIOS storage resource and network interface information handling system may include one or more other information handling resources.

On the other hand in accordance with the present disclosure during a boot device selection phase of a boot BIOS may add a new entry in a configuration table of runtime services. The new entry may comprise authenticated system partition access services which may include an application programming interface API of various I O services for system partition that may interface with block drivers to access system partition . During the boot device selection phase operating system loaders in the system partition are then able to access the system partition to create partition access to the operating system. After initialization of information handling system is handed from BIOS to the operating system I O requests to system partition may instead be passed to runtime services where protected access module may control access to authenticated services of system partition access services such that for each I O access to system partition during operating system runtime BIOS authenticates that the operating system is authorized to perform such I O command. For example protected access module may use an authenticated variable concept in which a public private key mechanism is used to access individual system partition access services . The private key may be owned by firmware of BIOS with the corresponding public key passed as a variable in an I O command thus ensuring protection from any malware in the operating system or self executing code of the operating system that may gain access to sensitive portions of system partition .

On the other hand in accordance with the present disclosure authenticated system partition access services may be created in a manner identical or similar to that of such that system partition access services include an application programming interface API of various I O services for system partition that may interface with block drivers to access system partition . Thus during pre boot deployment I O requests to system partition may instead be passed to runtime services where protected access module may control access to authenticated services of system partition access services such that for each I O access to system partition during the pre boot mode BIOS authenticates that the deployment tools are authorized to perform such I O command.

As used herein when two or more elements are referred to as coupled to one another such term indicates that such two or more elements are in electronic communication or mechanical communication as applicable whether connected indirectly or directly with or without intervening elements.

This disclosure encompasses all changes substitutions variations alterations and modifications to the example embodiments herein that a person having ordinary skill in the art would comprehend. Similarly where appropriate the appended claims encompass all changes substitutions variations alterations and modifications to the example embodiments herein that a person having ordinary skill in the art would comprehend. Moreover reference in the appended claims to an apparatus or system or a component of an apparatus or system being adapted to arranged to capable of configured to enabled to operable to or operative to perform a particular function encompasses that apparatus system or component whether or not it or that particular function is activated turned on or unlocked as long as that apparatus system or component is so adapted arranged capable configured enabled operable or operative.

All examples and conditional language recited herein are intended for pedagogical objects to aid the reader in understanding the disclosure and the concepts contributed by the inventor to furthering the art and are construed as being without limitation to such specifically recited examples and conditions. Although embodiments of the present disclosure have been described in detail it should be understood that various changes substitutions and alterations could be made hereto without departing from the spirit and scope of the disclosure.

