---

title: Low-power mode signal bridge for optical media
abstract: System, methods and apparatus are described that facilitate transmission of data between two devices. A data transfer method includes receiving first data from a first interface, the first data being received in signaling transmitted by a first device according to a first protocol, determining a mode of operation for a communication link to be used for transmitting the first data to a second device, transmitting the first data to the second device over an optical path of the communication link in a first mode of operation, transmitting the first data in accordance with the first protocol to the second device over an electrical path of the communication link in a second mode of operation, and in a third mode of operation, translating the first data to obtain second data, and transmitting the second data in accordance with a second protocol to the second device over the electrical path.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09584227&OS=09584227&RS=09584227
owner: QUALCOMM Incorporated
number: 09584227
owner_city: San Diego
owner_country: US
publication_date: 20150717
---
At least one aspect generally relates to high speed data communications interfaces and more particularly extending the range of standards defined interfaces used for communicating between integrated circuit devices.

Manufacturers of mobile devices such as cellular phones may obtain components of the mobile devices from various sources including different manufacturers. For example the application processor in a cellular phone may be obtained from a first manufacturer while the display for the cellular phone may be obtained from a second manufacturer. Moreover multiple standards are defined for interconnecting certain components of the mobile devices. For example there are multiple types of interface defined for communications between an application processor and display and camera components of a mobile device. Some components employ an interface that conforms to one or more standards specified by the Mobile Industry Processor Interface MIPI Alliance. For example the MIPI Alliance defines protocols for a camera serial interface CSI and a display serial interface DSI .

MIPI CSI 2 and MIPI DSI or DSI 2 standards define a wired interface between a camera and application processor or an application processor and display. The low level physical layer PHY interface in each of these applications can be MIPI C PHY or MIPI D PHY. Optical media can be used to extend the range of the MIPI C PHY or D PHY physical layers. However some interfaces require that bidirectional and or low power modes of operation be implemented neither of which requirements can be met by a conventional optical interface which is unidirectional by nature.

Embodiments disclosed herein provide systems methods and apparatus that enable an application processor to communicate with a display using any of a plurality of interface standards bidirectionally and in a low power mode. According to certain aspects described herein two or more Integrated Circuit IC devices may be collocated in an electronic apparatus and communicatively coupled through one or more data links that can be configured with one of a plurality of interface standards.

In an aspect of the disclosure a data transfer method operational on one of two devices in an apparatus includes receiving first data from a first interface the first data being received in signaling transmitted by a first device in accordance with a first protocol determining a mode of operation for a communication link to be used for transmitting the first data to a second device where the communication link includes an optical path and an electrical path transmitting the first data to the second device over the optical path in a first mode of operation transmitting the first data in accordance with the first protocol to the second device over the electrical path in a second mode of operation and in a third mode of operation translating the first data to obtain second data and transmitting the second data in accordance with a second protocol to the second device over the electrical path.

In an aspect of the disclosure an apparatus has an optical medium used for communicating information carried on optical signals a first integrated circuit IC device coupled to the optical medium and adapted to transmit the optical signals a second IC device coupled to the optical medium and adapted to receive the optical signals and an electrical path that includes a plurality of electrical connectors coupling the first IC device and the second IC device. The first IC device and the second IC device include a bridge circuit configured to receive first data from a first interface the first data being received in signaling transmitted by the first IC device in accordance with a first protocol determine a mode of operation for communicating between the first IC device and the second IC device transmit the first data to the second IC device over the optical medium in a first mode of operation transmit the first data in accordance with the first protocol to the second IC device using two or more of the plurality of electrical connectors in a second mode of operation and in a third mode of operation translate the first data to obtain second data and transmit the second data in accordance with a second protocol to the second IC device using the plurality of electrical connectors.

In an aspect of the disclosure a bridge circuit includes means for communicating first information in optical signals through an optical medium including a first interface circuit coupled to the optical medium means for communicating second information in electrical signals through a plurality of electrical connectors including a second interface circuit coupled to the plurality of electrical connectors means for selectively coupling one or more sources of input data with the first interface circuit and the second interface circuit including a processing circuit. The processing circuit may be configured to receive first data encoded in accordance with a first protocol determine a mode of operation for communicating the first data transmit the first data over the optical medium in a first mode of operation transmit the first data in accordance with the first protocol using two or more of the plurality of electrical connectors in a second mode of operation and in a third mode of operation translate the first data to obtain second data and transmit the second data in accordance with a second protocol using the plurality of electrical connectors.

In an aspect of the disclosure a processor readable storage medium may have code stored thereon. The code may include instructions for receiving first data from a first interface the first data being received in signaling transmitted by a first device in accordance with a first protocol determining a mode of operation for a communication link to be used for transmitting the first data to a second device where the communication link includes an optical path and an electrical path transmitting the first data to the second device over the optical path in a first mode of operation transmitting the first data in accordance with the first protocol to the second device over the electrical path in a second mode of operation and in a third mode of operation translating the first data to obtain second data and transmitting the second data in accordance with a second protocol to the second device over the electrical path.

The detailed description set forth below in connection with the appended drawings is intended as a description of various configurations and is not intended to represent the only configurations in which the concepts described herein may be practiced. The detailed description includes specific details for the purpose of providing a thorough understanding of various concepts. However it will be apparent to those skilled in the art that these concepts may be practiced without these specific details. In some instances well known structures and components are shown in block diagram form in order to avoid obscuring such concepts.

Several aspects of data communication systems will now be presented with reference to various apparatus and methods. These apparatus and methods will be described in the following detailed description and illustrated in the accompanying drawings by various blocks modules components circuits steps processes algorithms etc. collectively referred to as elements . These elements may be implemented using electronic hardware computer software or any combination thereof. Whether such elements are implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system.

By way of example an element or any portion of an element or any combination of elements may be implemented with a processing system that includes one or more processors. Examples of processors include microprocessors microcontrollers digital signal processors DSPs field programmable gate arrays FPGAs programmable logic devices PLDs state machines gated logic discrete hardware circuits and other suitable hardware configured to perform the various functionality described throughout this disclosure. One or more processors in the processing system may execute software. Software shall be construed broadly to mean instructions instruction sets code code segments program code programs subprograms software modules applications software applications software packages routines subroutines objects executables threads of execution procedures functions etc. whether referred to as software firmware middleware microcode hardware description language or otherwise.

Accordingly in one or more exemplary embodiments the functions described may be implemented in hardware software firmware or any combination thereof. If implemented in software the functions may be stored on or encoded as one or more instructions or code on a computer readable medium. Computer readable media includes computer storage media. Storage media may be any available media that can be accessed by a computer. By way of example and not limitation such computer readable media can include read only memory ROM or random access memory RAM electrically erasable programmable ROM EEPROM including ROM implemented using a compact disc CD or other optical disk storage magnetic disk storage or other magnetic storage devices or any other medium that can be used to carry or store desired program code in the form of instructions or data structures and that can be accessed by a computer. Disk and disc as used herein includes CD laser disc optical disc digital versatile disc DVD and floppy disk where disks usually reproduce data magnetically while discs reproduce data optically with lasers. Combinations of the above should also be included within the scope of computer readable media.

The communication link may provide multiple channels and . One or more channels may be bidirectional and may operate in half duplex and or full duplex modes. One or more channels and may be unidirectional. The communication link may be asymmetrical providing higher bandwidth in one direction. In one example described herein a first communications channel may be referred to as a forward channel while a second communications channel may be referred to as a reverse channel . The first IC device may be designated as a host system or transmitter while the second IC device may be designated as a client system or receiver even if both IC devices and are configured to transmit and receive on the communications channel . In one example the forward channel may operate at a higher data rate when communicating data from a first IC device to a second IC device while the reverse channel may operate at a lower data rate when communicating data from the second IC device to the first IC device .

The IC devices and may each have a processor or other processing and or computing circuit or device . In one example the first IC device may perform core functions of the apparatus including maintaining wireless communications through a wireless transceiver and an antenna while the second IC device may support a user interface that manages or operates a display controller . In the example the second IC device may be adapted to control operations of a camera or video input device using a camera controller . Other features supported by one or more of the IC devices and may include a keyboard a voice recognition component and other input or output devices. The display controller may include circuits and software drivers that support displays such as a liquid crystal display LCD panel touch screen display indicators and so on. The storage media and may include transitory and or non transitory storage devices adapted to maintain instructions and data used by respective processors and and or other components of the IC devices and . Communication between each processor and its corresponding storage media and and other modules and circuits may be facilitated by one or more bus and respectively.

The reverse channel may be operated in the same manner as the forward channel and the forward link and reverse channel may be capable of transmitting at comparable speeds or at different speeds where speed may be expressed as data transfer rate and or clocking rates. The forward and reverse data rates may be substantially the same or differ by orders of magnitude depending on the application. In some applications a single bidirectional channel may support communications between the first IC device and the second IC device . The forward channel and or reverse channel may be configurable to operate in a bidirectional mode when for example the forward and reverse channels and share the same physical connections and operate in a half duplex manner. In one example the communication link may be operated to communicate control command and other information between the first IC device and the second IC device in accordance with an industry or other standard.

In some instances the forward and reverse channels and may be configured or adapted to support a wide video graphics array WVGA 80 frames per second LCD driver IC without a frame buffer delivering pixel data at 810 Mbps for display refresh. In another example the forward and reverse channels and may be configured or adapted to enable communications between with dynamic random access memory DRAM such as double data rate synchronous dynamic random access memory SDRAM . The drivers may include encoding devices that can be configured to encode multiple bits per clock transition and multiple sets of wires can be used to transmit and receive data from the SDRAM control signals address signals and other signals.

The forward and reverse channels and may comply with or be compatible with application specific industry standards. In one example the MIPI standard defines physical layer interfaces between an application processor IC device and an IC device that supports the camera or display in a mobile device. The MIPI standard includes specifications that govern the operational characteristics of products that comply with MIPI specifications for mobile devices. In some instances the MIPI standard may define interfaces that employ complimentary metal oxide semiconductor CMOS parallel busses.

The MIPI Alliance defines standards and specifications that may address communications affecting all aspects of operations in a mobile device including the antenna peripherals the modem and application processors. For example the MIPI Alliance defines protocols for a camera serial interface CSI and a display serial interface DSI . The MIPI CSI 2 defines a wired interface between a camera and Application Processor and the MIPI DSI or DSI 2 defines a wired interface between an Application Processor and a display. The low level physical layer PHY interface in each of these applications can be MIPI C PHY or MIPI D PHY.

According to certain aspects disclosed herein systems and apparatus may employ multi phase data encoding and decoding interface methods for communicating between IC devices and . A multi phase encoder may drive a plurality of conductors i.e. M conductors . The M conductors typically include three or more conductors and each conductor may be referred to as a wire although the M conductors may include conductive traces on a circuit board or within a conductive layer of a semiconductor IC device. In one example the MIPI Alliance defined C PHY physical layer interface technology may be used to connect camera and display devices to an application processor device . The C PHY interface employs three phase symbol encoding to transmit data symbols on 3 wire lanes or trios where each trio includes an embedded clock.

The M conductors may be divided into a plurality of transmission groups each group encoding a portion of a block of data to be transmitted. An N phase encoding scheme is defined in which bits of data are encoded in phase transitions and polarity changes on the M conductors. Decoding does not rely on independent conductors or pairs of conductors and timing information can be derived directly from phase and or polarity transitions in the M conductors. N Phase polarity data transfer can be applied to any physical signaling interface including electrical optical and radio frequency RF interfaces.

In the C PHY example a three phase encoding scheme for a three wire system may define three phase states and two polarities providing 6 states and 5 possible transitions from each state. Deterministic voltage and or current changes may be detected and decoded to extract data from the three wires.

In the depicted C PHY example an M wire N phase polarity encoding transmitter is configured for M 3 and N 3. The example of three wire three phase encoding is selected solely for the purpose of simplifying descriptions of certain aspects of this disclosure. The principles and techniques disclosed for three wire three phase encoders can be applied in other configurations of M wire N phase polarity encoders and may comply or be compatible with other interface standards.

When three phase polarity encoding is used connectors such as signal wires and on a 3 wire bus may be undriven driven positive or driven negative. An undriven signal wire or may be in a high impedance state. An undriven signal wire or may be driven or pulled to a voltage level that lies substantially halfway between the positive and negative voltage levels provided on driven signal wires. An undriven signal wire or may have no current flowing through it. In the example each signal wire and may be in one of three states denoted as 1 1 or 0 using drivers . In one example drivers may include unit level current mode drivers. In another example drivers may drive opposite polarity voltages on two signals transmitted on the signal wires and while the third signal wire is at high impedance and or pulled to ground. For each transmitted symbol interval at least one signal is in the undriven 0 state while the number of signals driven positive 1 state is equal to the number of signals driven negative 1 state such that the sum of current flowing to the receiver is always zero. For each symbol the state of at least one signal wire or is changed from the symbol transmitted in the preceding transmission interval.

In the example a mapper may receive 16 bit data and the mapper may map the input data to 7 symbols for transmitting sequentially over the signal wires and . An M wire N phase encoder configured for three wire three phase encoding receives the 7 symbols produced by the mapper one symbol at a time and computes the state of each signal wire and for each symbol interval based on the immediately preceding state of the signal wires and . The 7 symbols may be serialized using parallel to serial converters for example. The encoder selects the states of the signal wires and based on the input symbol and the previous states of signal wires and

The use of M wire N phase encoding permits a number of bits to be encoded in a plurality of symbols where the bits per symbol is not an integer. In the simple example of a three wire three phase system there are 3 available combinations of 2 wires which may be driven simultaneously and 2 possible combinations of polarity on any pair of wires that is driven simultaneously yielding 6 possible states. Since each transition occurs from a current state 5 of the 6 states are available at every transition. The state of at least one wire is typically required to change at each transition. With 5 states log 5 2.32 bits may be encoded per symbol. Accordingly a mapper may accept a 16 bit word and convert it to 7 symbols because 7 symbols carrying 2.32 bits per symbol can encode 16.24 bits. In other words a combination of seven symbols that encodes five states has 5 78 125 permutations. Accordingly the 7 symbols may be used to encode the 2 65 536 permutations of 16 bits.

At any phase state in the illustrated three wire example exactly two of the signal wires carry a signal which is effectively a differential signal for that phase state while the third signal wire or is undriven. The phase state for each signal wire may be determined by voltage difference between the signal wire or and at least one other signal wire and or or by the direction of current flow or lack of current flow in the signal wire or . As shown in the state transition diagram three phase states S Sand S are defined. A signal may flow clockwise from phase state Sto phase state S phase state Sto phase state S and or phase state Sto phase state Sand the signal may flow counter clockwise from phase state Sto phase state S phase state Sto phase state S and or phase state Sto phase state S. For other values of N transitions between the N states may optionally be defined according to a corresponding state diagram to obtain circular rotation between state transitions.

In the example of a three wire three phase communications link clockwise rotations Sto S Sto S and or Sto S at a state transition may be used to encode a logic 1 while counter clockwise rotations Sto S Sto S and or Sto S at the state transition may be used to encode a logic 0. Accordingly a bit may be encoded at each transition by controlling whether the signal is rotating clockwise or counter clockwise. For example a logic 1 may be encoded when the three signal wires transition from phase state Sto phase state Sand a logic 0 may be encoded when the three signal wires transition from phase state Sto phase state S. In the simple three wire example depicted direction of rotation may be easily determined based on which of the three signal wires is undriven before and after the transition.

Information may also be encoded in the polarity and or changes of polarity of state of the driven conductors or in the direction of current flow or changes in the direction of current flow between two signal wires . Signals and illustrate voltage levels applied to signal wires respectively at each phase state in a three wire three phase link. At any time a first signal wire is coupled to a more positive voltage V for example a second signal wire is coupled to a more negative voltage V for example while the third signal wire may be open circuited. As such one polarity encoding state may be determined by the current flow between the first and second signal wires or the voltage polarities of the first and second signal wires . In some embodiments two bits of data may be encoded in each state transition . A decoder may determine the direction of signal phase rotation to obtain the first bit. The second bit may be determined based on the polarity difference between two of the signals and . In some instances the second bit may be determined based on a change or lack of change in polarity of the differential signal transmitted on a pair of the signal wires . The decoder having determined direction of rotation can determine the phase state and the polarity of the voltage applied between the two active signal wires and or or the direction of current flow through the two active signal wires and or

In the example of the three wire three phase link described herein one bit of data may be encoded in the rotation or phase change in the three wire three phase link and an additional bit may be encoded in the polarity or changes in polarity of two driven wires. Certain embodiments encode more than two bits in each transition of a three wire three phase encoding system by allowing transition to any of the possible states from a current state. Given three rotational phases and two polarities for each phase 6 states are defined such that 5 states are available from any current state. Accordingly there may be log 5 2.32 bits per symbol transition and the mapper may accept a 16 bit word and convert it to 7 symbols.

In one example an encoder may transmit symbols using 6 wires with two pairs of wires driven for each state. The 6 wires may be labeled A through F such that in one state wires A and F are driven positive wires B and E negative and C and D are undriven or carry no current . For six wires there may be 

Of the 4 wires driven the possible combinations of two wires driven positive and the other two must be negative . The combinations of polarity may include 

Accordingly the total number of different states may be calculated as 15 6 90. To guarantee a transition between symbols 89 states are available from any current state and the number of bits that may be encoded in each symbol may be calculated as log 89 6.47 bits per symbol. In this example a 32 bit word can be encoded by the mapper into 5 symbols given that 5 6.47 32.35 bits.

The general equation for the number of combinations of wires that can be driven for a bus of any size as a function of the number of wires in the bus and number of wires simultaneously driven 

According to certain aspects disclosed herein a plurality of three state amplifiers can be controlled to produce a set of output states defined by a differential encoder an N phase polarity encoder or another encoder that encodes information in wires or connectors that can assume one of the three states described.

With reference again to the communication link may include a high speed digital interface that can be configured to support both differential encoding scheme and N phase polarity encoding. Physical layer drivers and may include N phase polarity encoders and decoders which can encode multiple bits per transition on the interface and line drivers to drive signal wires and . The line drivers may be constructed with amplifiers that produce an active output that can have a positive or negative voltage or a high impedance output whereby a signal wires or is in an undefined state or a state that is defined by external electrical components. Accordingly the output drivers may receive by a pair of signals that includes data and output control high impedance mode control . In this regard the three state amplifiers used for N phase polarity encoding and differential encoding can produce the same or similar three output states.

According to certain aspects disclosed herein systems and apparatus may employ some combination of differential and single ended encoding for communicating between IC devices and . In one example the MIPI Alliance defined D PHY physical layer interface technology may be used to connect camera and display devices to an application processor device . The D PHY interface can switch between a differential High Speed mode and a single ended Low Power mode in real time as needed to facilitate the transfer of large amounts of data or to conserve power and prolong battery life. The D PHY interface is capable of operating in simplex or duplex configuration with single data lane or multiple data lanes with a unidirectional Master to Slave clock lane.

On the reverse channel one or more pairs of wires may be driven by a client side differential driver . The differential driver receives an input data stream and generates positive and negative versions of the input which are provided to the pair of wires . The differential receiver on the host generates an output data stream by performing a comparison of the signals carried on the pair of wires

In a bidirectional channel the host and client may be configured for half duplex mode and may transmit and receive data on the same wire pair . A bidirectional bus may alternatively or additionally be operated in full duplex mode using combinations of the forward and reverse link drivers to drive multiple wire pairs . In the half duplex bidirectional implementation depicted for the bidirectional channel the differential drivers and may be prevented from driving the wire pair simultaneously using for example an output enable OE control respectively to force the differential drivers and into a high impedance state. The differential receiver may be prevented from driving the input output while the differential driver is active typically using an OE control to force the differential receiver into a high impedance state. The differential receiver may be prevented from driving the input output while the differential driver is active typically using an OE control to force the differential receiver into a high impedance state. In some instances the outputs of the differential drivers and and the differential receivers and may be in a high impedance state when the interface is not active. Accordingly the OE controls and of the differential drivers and the differential receivers and may be operated independently of one another.

Each of the differential drivers and may include a pair of amplifiers one receiving at one input the inverse of the input of the other amplifier. The differential drivers and may each receive a single input and may have an internal inverter that generates an inverse input for use with a pair of amplifiers. The differential drivers and may also be constructed using two separately controlled amplifiers such that their respective outputs can be placed in high impedance mode independently of one another.

When a D PHY implementation of the communication link see is operated in Low Power mode signals may be transmitted on single wire data and or clock lanes. In one example the differential drivers and or may be reconfigured or controlled such that only one of the wires in a pair of wires or of an active lane is driven. In other examples the differential drivers and or may be turned off or placed in a high impedance output mode and separate single ended line driver and receiver may be used for communications over a single wire single ended link . In some instances the input and output of the single ended link may be bidirectional and both transmitting and receiving devices may employ a transceiver that includes both a line driver and a receiver that is controlled in accordance with one or more protocols.

The CSI and DSI interfaces currently limit the length of interconnects based on limitations imposed by various electrical signaling characteristics and effects. In some instances optical media is used to extend the range of the MIPI C PHY or D PHY physical layers. The use of optical media introduces certain additional complexities and issues when used with interfaces defined by the MIPI Alliance particularly when multiple protocols are employed in a device connected using the MIPI defined interfaces.

The display subsystem may include a unidirectional data link which may be configured and operated according to D PHY or C PHY protocols. In the application processor a clock source such as the PLL may be used to generate a clock signal for controlling transmissions on the data link . At the display driver a D PHY or C PHY receiver may extract embedded clock information from sequences of symbols transmitted on the data link or from a clock lane provided in the data link .

Devices adapted according to certain aspects disclosed herein may resolve issues arising from the complexities and hindrances associated with the use of optical media to extend the length of communication links that compliant or compatible with MIPI standards. Certain aspects disclosed herein relate to systems apparatus and methods that support a broad range of interface protocols and that can operate using different physical media. As shown in for example the camera subsystem and or display subsystem may communicate high data rate information using D PHY or C PHY protocols and in some configurations may communicate using a reverse channel e.g. the CCI link for configuration of an image sensor or other device. In some instances a low power mode of operation may be defined for links that use either D PHY or C PHY protocols. Optical interfaces may be unsuited for low power modes of operation and the use of optical media to extend transmission distances can increase power consumption of a communications link. Optical interfaces are typically unidirectional. Although multiple channels may be multiplexed for transmission over the optical media in unidirectional transmissions two optical links may be required to support bidirectional communication links.

Display applications may be suited for communication link extension using an optical media subsystem in some implementations where data needs to flow in only one direction over the C PHY or D PHY interface signals. That is the application processor may transmit display data and control information to the display driver IC while the display driver IC need not transmit any information to the application processor . The optical media subsystem is less suited for applications employ more than one data link between devices and or bidirectional data links. In many instances however the application processor may need to read registers in the display driver IC and bidirectional communication links are employed in such instances.

A CCI link provides a bidirectional channel for communicating lower speed control and configuration information. The application processor may include a CCI master device while the image sensor includes a CCI slave device . The application processor transmits a clock signal over a first wire SCL of the CCI link and controls the direction of data flow over a second wire SDA of the CCI link . The optical media subsystem is typically unidirectional and carries high speed data from the image sensor to the application processor . Accordingly the optical media subsystem may not be configured to relay the signals carried on the SCL or the SDA since both signals operate to carry data from the application processor to the image sensor .

The example illustrated in may be representative of many applications in which bidirectional communication links are used to exchange data between devices. Substantially greater bandwidths and or bit rates may be provided for transmissions in one direction over the bidirectional communication link than in the reverse direction and or more than one type of physical link may be supported in one or both directions. In the example of the higher bandwidth data link may be employed to transfer video streams frames pixel or other image data from an image sensor to an application processor while the lower bandwidth data link may be employed for initialization configuration control and or reading of registers in the image sensor. As illustrated the lower bandwidth data link may be implemented as a low speed auxiliary interface according to CCI protocols although other protocols including an I2C protocol may be used. When optical media is used to extend the reach of a bidirectional communication link the optical media is typically deployed in the high speed direction while the bidirectional link may be maintained as a low speed CCI I2C or other low speed link. The maximum extension for the bidirectional link may be dictated by the signaling characteristics of the low speed direction i.e. the non optical path . The use of two optical paths may burden the designer with unacceptable power consumption real estate and or financial costs.

Certain aspects disclosed herein may enable the use of optical data links in a wide range of applications that employ multiple bidirectional power sensitive interfaces between devices within an apparatus. Certain C PHY and D PHY interfaces are defined to operate in two modes sending data at high speed using low voltage signaling or sending data at a low speed with very low power consumption in a Low Power LP Mode. DSI provides a LP mode in which the PHY operates at reduced power and low power signals are transmitted in both directions over the C PHY or D PHY interface. For example high speed data may flow in only one direction from an application processor to a display driver while low speed control information may flow in both directions. In LP mode high speed drivers and receivers may be disabled and standard digital CMOS logic levels are used for communication. The high speed mode is unidirectional from the application processor to the display driver while the LP mode is bi directional so that the processor can read and write registers within the display driver. Since the optical link is unidirectional by its nature bidirectional LP communication links may not be redirected over a single optical link.

The optical link may be selectively used to communicate data received in a format defined in accordance with a MIPI CSI 2 protocol. The image sensor may include a C PHY D PHY encoder and CCI slave that provides a low speed bidirectional communications path. The C PHY D PHY encoder and the CCI slave are coupled to a first bridge that includes a serializer that in a high speed mode of operation may be configured to provide a serial data signal to the Laser driver . The Laser driver may format the serial data signal for driving a Laser diode . Light signals produced by the Laser diode are carried through the optical link to a detector such as a photodiode . A TIA may be used to amplify and otherwise condition the signal produced by the photodiode . A deserializer in a second bridge converts the amplified output if the TIA to parallel C PHY or D PHY formatted signals from which a C PHY or D PHY receiver decoder in the application processor may decode and or extract data.

The first bridge and the second bridge may operate to select a path for both high speed unidirectional data and low speed low power and or bidirectional signals. In one example the first bridge and the second bridge may disable optical circuits in a low power mode of operation and may redirect the high speed data over a non optical communication link auxiliary bus which may include electrically conductive wires or traces. In another example the first bridge and the second bridge may pass through CCI I2C or other low data rate signals to two or more wires of the auxiliary bus suitable for handling the low data rate traffic. In another example the first bridge and the second bridge may convert CCI I2C or other low data rate signals for transmission using a protocol and a number of wires of the auxiliary bus that can handle the CCI I2C data rate data over an extended distance.

The bridging function provided by the first bridge and the second bridge may be controlled by processors configured to recognize when the PHY is sending data in LP mode. The first bridge and the second bridge may exchange messages over any available link to configure a mode of operation. The bridging function may be configured to separate LP mode data from high speed data i.e. the primary data stream . The separated LP mode data may be transmitted over the auxiliary bus which may operate as an out of band communication link. That is the auxiliary bus may employ a different proprietary or standards defined protocol that the protocols used to encode data provided to the first bridge and or the second bridge . The first bridge and the second bridge may also communicate data in accordance with C PHY or D PHY protocols. For example in a low power mode of operation the first bridge may be configured to implement the LP mode protocol of C PHY or D PHY such that LP communications can be bridged to connectors of the auxiliary bus . In the latter example the second bridge may be configured to merge data received from the auxiliary bus back onto the C PHY or D PHY interface.

According to certain aspects the first bridge and the second bridge may be configured to support LP mode data in one or both directions. For example MIPI CSI 2 and MIPI DSI or DSI 2 specifications define a wired interface between a camera and application processor or between the application processor and a display. The low level PHY interface in each of these applications can be MIPI C PHY or MIPI D PHY. The C PHY and D PHY interfaces are defined to operate in two modes to send data at high speed using low voltage signaling or to send data at a low speed and consume a very small amount of power using LP Mode. In LP mode the high speed drivers and receivers are disabled and standard digital CMOS logic levels may be used for communication. The high speed mode is unidirectional from the Application Processor to the Display but the LP mode is bi directional so that the processor can read and write registers within the display. An LP mode protocol function in the first bridge and the second bridge may include support for bus turn around BTA .

The transmitting bridge circuit may include or cooperate with a controller which may be implemented in a processing circuit that configures monitors operates and otherwise controls various aspects of the transmitting bridge circuit and its subcomponents. The subcomponents of the transmitting bridge circuit may include switching logic multiplexers de multiplexers drivers receivers clock recovery circuits and so on. Certain subcomponents of the transmitting bridge circuit may be implemented in some combination of hardware and software elements.

The transmitting bridge circuit may include interface circuits that configured to receive relay and or process signals provided in accordance with one or more protocols and or interface signaling specifications. For example the transmitting bridge circuit may include a C PHY interface and or a D PHY interface that extract a clock signal and process C PHY D PHY signals in accordance with the clock signal. The transmitting bridge circuit may also include a C PHY D PHY low power interface that can handle signaling transmitted by a MIPI compliant device here an image sensor in low power mode. The transmitting bridge circuit may also include a CCI interface an I2C interface or other interface configured to transmit and receive signals through an out of band channel . In one example the CCI interface may include line drivers and receivers that operate to receive and condition signals transmitted in accordance with CCI protocols.

The controller of the transmitting bridge circuit may be configured to determine a mode of operation associated with the C PHY D PHY signals and or the signals carried by the out of band channel . In one example the interface circuits may identify the protocol associated with the C PHY D PHY signals and may further indicate other information such as clock rates number of lanes used and directionality of lanes and or signal lines. A next level of logic may be configured to determine a mode of operation for one or more communication links controlled by the transmitting bridge circuit and may be further configured to select a mode of processing for the C PHY D PHY signals and or the signals carried by the out of band channel . In a first mode of operation the one or more communication links may be operated in a high data rate mode and the PHY D PHY signals may be provided to an appropriately configured serializer to provide a serialized data signal for transmission over an optical link . In the first mode the signals carried by the out of band channel may be coupled to electrically conductive wires traces conductors or connectors of an auxiliary bus . The signals carried by the out of band channel may be translated to a different protocol and or signaling standard to obtain a greater transmission distance for the signals carried by the out of band channel . For example signaling associated with a CCI interface may be transmitted using a lower clock rate or using differential transmitters and receivers to obtain better signaling characteristics. In one example the CCI signals may be split and transmitted over two lanes each of the two lanes operating at a lower clock rate than the clock provided in the original CCI signaling.

In a second mode of operation the one or more communication links may be operated in a forced low power mode in which the optical link is disabled and high data rate C PHY D PHY signals may be provided to a protocol translator for conversion to a signaling format suitable for communications over the auxiliary bus . The second mode may be initiated independently of the C PHY or D PHY channel. In the second mode the transmitting bridge circuit or a processing circuit associated with the transmitting bridge circuit may determine a configuration for the auxiliary bus based on the data rate of the C PHY D PHY signals the number of connectors available in the auxiliary bus the distance traversed by the connectors and other signaling characteristics associated with the auxiliary bus . The protocol translator and the transceivers may then be configured to transmit data consistent with the selected configuration. In one example data may be spread over multiple lower rate D PHY or C PHY interfaces. In another example data may be transmitted over multiple lanes encoded using a multi level pulse amplitude modulation scheme. In the second mode the signals carried by the out of band channel may be translated to a different protocol and or signaling standard to obtain a greater transmission distance for the signals carried by the out of band channel . For example signaling associated with a CCI interface may be transmitted using a lower clock rate or using differential transmitters and receivers to obtain better signaling characteristics. In one example the CCI signals may be split and transmitted over two lanes each of the two lanes operating at a lower clock rate than the clock provided in the original CCI signaling.

In a third mode of operation the C PHY D PHY signals may be encoded in a MIPI defined low power mode. The C PHY D PHY signals may be passed through the transmitting bridge circuit with the auxiliary bus configured for low power mode signaling in accordance with the corresponding standard. In some instances a reconfiguration of the auxiliary bus may be indicated. For example the length of one or more connectors in the auxiliary bus may exceed a maximum distance for reliable communications and the auxiliary bus may be reconfigured to spread data to be transferred across multiple lanes or interfaces operated at lower data rates where the combined data rate is sufficient to support the throughput specified by the appropriate standards or specifications. In the third mode the signals provided to the out of band channel may be translated to a different protocol and or signaling standard to obtain a greater transmission distance for the signals provided to the out of band channel . For example signaling associated with a CCI interface may be transmitted using a lower clock rate or using differential transmitters and receivers to obtain better signaling characteristics. In one example the CCI signals may be split and transmitted over two lanes each of the two lanes operating at a lower clock rate than the clock provided in the original CCI signaling.

In some instances protocol translation includes modifying an encoding scheme and or modifying a signaling scheme. The protocol translation may include splitting or combining data using multiplexers and or demultiplexers transcoding data for transmission.

The receiving bridge circuit may include or cooperate with a controller that may be implemented in a processing circuit that configures monitors operates and otherwise controls various aspects of the receiving bridge circuit and its subcomponents. The subcomponents of the receiving bridge circuit may include switching logic multiplexers de multiplexers drivers receivers clock recovery circuits and so on. Certain subcomponents of the receiving bridge circuit may be implemented in some combination of hardware and software elements.

The receiving bridge circuit may include interface circuits that provide to drive high speed data signals and other data unidirectional and bidirectional data signals to PHY of a receiving device. These signals are provided in accordance with one or more protocols and or interface signaling specifications. For example the receiving bridge circuit may include a C PHY interface and or a D PHY interface provide C PHY D PHY signals in accordance with the clock signal. The receiving bridge circuit may also include a C PHY D PHY low power interface that can handle signaling transmitted by a MIPI compliant device in low power mode. The receiving bridge circuit may also include a CCI interface an I2C interface or other interface configured to transmit and receive signals from an out of band channel . In one example the CCI interface may include line drivers and receivers that operate to receive and condition signals transmitted in accordance with CCI protocols.

The receiving bridge circuit may be configured to determine a mode of operation associated with the C PHY D PHY signals and or the signals received from the out of band channel . The mode of operation may be determined by configuration and or through communication with a transmitting bridge circuit at the transmitting end of an optical link .

At block the bridge circuit may determine whether an optical path is available for communicating between devices. The determination of whether an optical path is available may include detecting presence of optical circuitry identifying whether optical circuitry can be used or configured for transmission of the data in a desired direction and determining whether the optical circuitry is being used by another application in a manner that precludes its use for transmitting the data. In one example an optical link used to carry high speed data provided by an image sensor to an application processor may be incapable of carrying CCI control data in the opposite direction i.e. to the image sensor .

In some examples the presence of optical circuitry may be detected and its capabilities and configurability identified from configuration parameters maintained by the bridge circuit the application processor and or another processing circuit or device. Information identifying a current mode of operation of the optical link may also be maintained by the bridge circuit or accessed through the application processor . If optical circuitry is determined to be unavailable then the bridge circuit may determine at block that the data should be communicated using an out of band channel and the process then continues at block .

When the bridge circuit determines at block that the data can be communicated using an optical link based on capabilities of the optical link then the bridge circuit may determine at block whether the optical link has been enabled. In some instances the optical link may be unconditionally disabled to conserve power when a device management function determines that battery life requires a reduction in power consumption. In other instances the optical link may be disabled for certain traffic but available for other traffic. For example certain data types may be subject to quality of service requirements that necessitate transmission at high data rates while other types of data may be characterized by a low data rate or may be low priority high data rate traffic that is tolerant of delay and can be redirected to an out of band channel . In some instances the optical link may be usable under power restricted modes of operation when a volume of data to be transmitted exceeds certain thresholds. In other instances data packets may be dropped during power restricted modes of operation. When the bridge circuit determines at block that the optical link is disabled for the type of data to be transmitted then the process continues at block . Otherwise the bridge circuit may process the data for optical communication and transmit the process data on the optical link in block .

At block the data is to be transmitted over an out of band channel and the bridge circuit may determine whether the data should be re coded in a different protocol. The determination may include identifying whether the data is high speed data or low speed data. For example the data may be designated as high speed data when it is provided from a high speed interface. In another example the data may be designated as high speed data when it arrives at a rate that potentially exceeds the capacity of the out of band channel . Other characteristics of the data its rate of arrival and the capacity of the out of band channel may be taken into consideration in order to determine whether data should be re coded. In some instances certain types of low speed data may be transmitted at block without significant alteration of format or protocol. For example CCI data may be transmitted without modification when two or more wires of the out of band channel are configured as a CCI bus.

If at block the bridge circuit may have determined that the data is to be re coded the bridge circuit may cause the data to be translated into a different format and or protocol at block before transmission on the out of band channel at block . Certain types of low speed data including CCI and I2C data may be re coded when the initial protocol associated with such low speed data cannot be accommodated as presented by the out of band channel or is incompatible with signaling used on the out of band channel . Certain types of high speed data may be re coded at block . In one example the bridge circuit may transmit full rate C PHY data as quarter rate C PHY data where both full rate and quarter rate C PHY transmission modes are defined by MIPI standards. In some instances the bridge circuit may provide configuration information to sources of high speed data that causes the sources to reduce the data rate of the high speed data. In the C PHY data example the data source may provide quarter rate C PHY data when the bridge circuit identifies the optical link as unavailable. In another example the bridge circuit may convert certain types of data for transmission over one or more pairs of wires of the out of band channel that are configured for CCI operation. In another example the bridge circuit may convert certain high speed data to a format that may be transmitted over an increased number of wires of the out of band channel .

In some instances the bridge circuit may segment packetize or otherwise divide and buffer high speed data at block in order to match data rates of the high speed data with transmission capacity of the out of band channel . In some instances the bridge circuit may cooperate with and or provide signaling to data sources in order to manage and control rates of flow of data over the out of band channel . The bridge circuit may communicate with device management functions that control activation of the optical link in order to identify chokepoints and or reliability issues that may arise from the unavailability of the optical link .

In this configuration forward LP mode data is sent over the optical link and the reverse LP mode data is sent over the out of band auxiliary bus. The C PHY receivers may include high speed receivers for C PHY data as well as LP mode receivers and LP mode drivers. In this configuration the LP mode receivers may transmit high speed data and LP data through the optical media using the optical framer multiplexer and driver to multiplex the LP mode data onto the optical fiber link. The LP reverse link is received from out of band signals and combined in the C PHY Receivers when the C PHY link is operating in a mode where LP mode data is transferred in the reverse direction.

In this configuration combined high speed data and forward link LP mode signaling is received from the optical link and is de framed and de multiplexed at the CDR deframer demultiplexer and driver . LP mode data in the forward direction is sent from the de multiplexing circuit to the C PHY transmitter. Reverse LP mode data is received by circuitry inside the C PHY transmitter and is sent to LP Mode Multiplexing and Transmitter circuits of the LP interface where the LP mode data is combined in a suitable manner to be sent over the out of band LP signals.

In this configuration both forward and reverse LP mode data are sent over the out of band auxiliary bus while high speed data is transmitted over the optical link. Since the C PHY and D PHY LP data is half duplex both forward and reverse LP data can share the same out of band communication signal wires. As illustrated in the configuration two or more conductors may be allocated for out of band LP communication and an LP mode de multiplexer and an LP mode multiplexer can be configured to concentrate the LP signals onto any number of out of band signal wires depending upon the maximum signal length and speed capability of the out of band interface.

In this configuration high speed data is received from the optical link and is de framed and de multiplexed at the CDR deframer demultiplexer and driver . LP mode data in the forward direction is sent from de multiplexing circuits in the low power interface to the C PHY transmitters . Reverse LP mode data is received by circuitry inside the C PHY transmitters and is processed by multiplexing circuits in the low power interface where the LP mode data is combined in a suitable manner to be communicated over the out of band LP auxiliary bus. The C PHY deserializer receives only high speed data over the optical link and is configured to send and receive all LP mode data over the out of band LP auxiliary bus.

This configuration operates in a manner similar to that of the configuration in with configured or reconfigured receiving logic as the D PHY receivers . A D PHY serializer has a separate D PHY receiver dedicated for coupling to a clock lane and this D PHY receiver provides a clock signal to the optical framer multiplexer and driver circuit .

This configuration operates in a manner similar to that of the configuration in with configured or reconfigured receiving logic as the D PHY receivers . A D PHY serializer has a separate D PHY receiver dedicated for coupling to a clock lane and this D PHY receiver provides a clock signal to the optical framer multiplexer and driver circuit .

In the illustrated example the processing circuit may be implemented with a bus architecture represented generally by the bus . The bus may include any number of interconnecting buses and bridges depending on the specific application of the processing circuit and the overall design constraints. The bus links together various circuits including the one or more processors and storage . Storage may include memory devices and mass storage devices and may be referred to herein as computer readable media and or processor readable media. The bus may also link various other circuits such as timing sources timers peripherals voltage regulators and power management circuits. A bus interface may provide an interface between the bus and one or more line interface circuits . A line interface circuit may be provided for each networking technology supported by the processing circuit. In some instances multiple networking technologies may share some or all of the circuitry or processing modules found in a line interface circuit . Each line interface circuit provides a means for communicating with various other apparatus over a transmission medium. Depending upon the nature of the apparatus a user interface e.g. keypad display speaker microphone joystick may also be provided and may be communicatively coupled to the bus directly or through the bus interface .

A processor may be responsible for managing the bus and for general processing that may include the execution of software stored in a computer readable medium that may include the storage . In this respect the processing circuit including the processor may be used to implement any of the methods functions and techniques disclosed herein. The storage may be used for storing data that is manipulated by the processor when executing software and the software may be configured to implement any one of the methods disclosed herein.

One or more processors in the processing circuit may execute software. Software shall be construed broadly to mean instructions instruction sets code code segments program code programs subprograms software modules applications software applications software packages routines subroutines objects executables threads of execution procedures functions algorithms etc. whether referred to as software firmware middleware microcode hardware description language or otherwise. The software may reside in computer readable form in the storage or in an external computer readable medium. The external computer readable medium and or storage may include a non transitory computer readable medium. A non transitory computer readable medium includes by way of example a magnetic storage device e.g. hard disk floppy disk magnetic strip an optical disk e.g. a compact disc CD or a digital versatile disc DVD a smart card a flash memory device e.g. a flash drive a card a stick or a key drive a random access memory RAM a read only memory ROM a programmable ROM PROM an erasable PROM EPROM an electrically erasable PROM EEPROM a register a removable disk and any other suitable medium for storing software and or instructions that may be accessed and read by a computer. The computer readable medium and or storage may also include by way of example a carrier wave a transmission line and any other suitable medium for transmitting software and or instructions that may be accessed and read by a computer. Computer readable medium and or the storage may reside in the processing circuit in the processor external to the processing circuit or be distributed across multiple entities including the processing circuit . The computer readable medium and or storage may be embodied in a computer program product. By way of example a computer program product may include a computer readable medium in packaging materials. Those skilled in the art will recognize how best to implement the described functionality presented throughout this disclosure depending on the particular application and the overall design constraints imposed on the overall system.

The storage may maintain software maintained and or organized in loadable code segments modules applications programs etc. which may be referred to herein as software modules . Each of the software modules may include instructions and data that when installed or loaded on the processing circuit and executed by the one or more processors contribute to a run time image that controls the operation of the one or more processors . When executed certain instructions may cause the processing circuit to perform functions in accordance with certain methods algorithms and processes described herein.

Some of the software modules may be loaded during initialization of the processing circuit and these software modules may configure the processing circuit to enable performance of the various functions disclosed herein. For example some software modules may configure internal devices and or logic circuits of the processor and may manage access to external devices such as the line interface circuit the bus interface the user interface timers mathematical coprocessors and so on. The software modules may include a control program and or an operating system that interacts with interrupt handlers and device drivers and that controls access to various resources provided by the processing circuit . The resources may include memory processing time access to the line interface circuit the user interface and so on.

One or more processors of the processing circuit may be multifunctional whereby some of the software modules are loaded and configured to perform different functions or different instances of the same function. The one or more processors may additionally be adapted to manage background tasks initiated in response to inputs from the user interface the line interface circuit and device drivers for example. To support the performance of multiple functions the one or more processors may be configured to provide a multitasking environment whereby each of a plurality of functions is implemented as a set of tasks serviced by the one or more processors as needed or desired. In one example the multitasking environment may be implemented using a timesharing program that passes control of a processor between different tasks whereby each task returns control of the one or more processors to the timesharing program upon completion of any outstanding operations and or in response to an input such as an interrupt. When a task has control of the one or more processors the processing circuit is effectively specialized for the purposes addressed by the function associated with the controlling task. The timesharing program may include an operating system a main loop that transfers control on a round robin basis a function that allocates control of the one or more processors in accordance with a prioritization of the functions and or an interrupt driven main loop that responds to external events by providing control of the one or more processors to a handling function.

At block first data is received from a first interface. The first data may be received in signaling transmitted by a first device in accordance with a first protocol.

At block a mode of operation may be determined for a communication link to be used for transmitting the first data to a second device. The communication link may include an optical path and an electrical path.

At block the mode determines how data transmissions are to be handled. At block the first data is transmitted to the second device over the optical path in a first mode of operation. At block the first data is transmitted in accordance with the first protocol to the second device over the electrical path in a second mode of operation.

At block data transmissions are handled in accordance with a third mode of operation. In the third mode the first data is translated to obtain second data. The second data may then be transmitted to the second device over the electrical path in accordance with the second protocol.

In some examples one or more characteristics of a plurality of connectors of the electrical path are determined. The one or more characteristics may include a length of the plurality of connectors. The second protocol may be selected based on the one or more characteristics. In a first signaling mode third data communicated between a second interface and the second device may be relayed without translation. In a second signaling mode the third data received from a second interface in accordance with a third protocol may be translated to obtain fourth data. The fourth data may be transmitted to the second device in accordance with the fourth protocol and over the electrical path.

In some examples a data rate associated with the first data may be determined. The second protocol may be selected based on the data rate. In the third mode of operation a mode of signaling used for communicating the second data may be selected based on the data rate associated with the first data and one or more characteristics of a plurality of connectors of the electrical path. The one or more characteristics may include a length of one or more connectors in the plurality of connectors proximity of two or more connectors in the plurality of connectors common mode rejection characteristics of two or more connectors in the plurality of connectors and or characteristics associated with physical routing of one or more connectors in the plurality of connectors.

In some examples the second data may be transmitted over the electrical path at a lower data rate than a data rate at which the first data is received from the first interface. In some instances the second protocol may be a CCI protocol an I2C protocol or a proprietary protocol.

In some examples third data received from a second interface may be relayed to the second device over a first plurality of connectors in the electrical path. In the third mode of operation the second data are transmitted on a second plurality of connectors in the electrical path the second plurality of connectors being different from the first plurality of connectors. In the second mode of operation the first data may be transmitted on a first group of connectors of the electrical path and the third data may be transmitted on a second group of connectors of the electrical path. The first group of connectors and the second group of connectors may include one or more different connectors. The first group of connectors may include no connectors found in the second group of connectors.

The processor is responsible for general processing including the execution of software stored on the computer readable storage medium . The software when executed by the processor causes the processing circuit to perform the various functions described supra for any particular apparatus. The computer readable storage medium may also be used for storing data that is manipulated by the processor when executing software including data decoded from symbols transmitted over the connectors or wires which may be configured as data lanes and clock lanes. The processing circuit further includes at least one of the modules and . The modules and may be software modules running in the processor resident stored in the computer readable storage medium one or more hardware modules coupled to the processor or some combination thereof. The and or may include microcontroller instructions state machine configuration parameters or some combination thereof.

In one configuration the apparatus for data communication includes modules and or circuits configured to receive first data from a first interface the first data being received in signaling transmitted by the first IC device in accordance with a first protocol modules and or circuits configured to determine a mode of operation for communicating between a first IC device and a second IC device modules and or circuits configured to transmit the first data to the second device over an optical medium in a first mode of operation transmit the first data in accordance with the first protocol to the second IC device using two or more of the plurality of electrical connectors in a second mode of operation and in a third mode of operation translate the first data to obtain second data and transmit the second data in accordance with the second protocol to the second device using the plurality of electrical connectors.

It is understood that the specific order or hierarchy of steps in the processes disclosed is an illustration of exemplary approaches. Based upon design preferences it is understood that the specific order or hierarchy of steps in the processes may be rearranged. The accompanying method claims present elements of the various steps in a sample order and are not meant to be limited to the specific order or hierarchy presented.

The previous description is provided to enable any person skilled in the art to practice the various aspects described herein. Various modifications to these aspects will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other aspects. Thus the claims are not intended to be limited to the aspects shown herein but is to be accorded the full scope consistent with the language claims wherein reference to an element in the singular is not intended to mean one and only one unless specifically so stated but rather one or more. Unless specifically stated otherwise the term some refers to one or more. All structural and functional equivalents to the elements of the various aspects described throughout this disclosure that are known or later come to be known to those of ordinary skill in the art are expressly incorporated herein by reference and are intended to be encompassed by the claims. Moreover nothing disclosed herein is intended to be dedicated to the public regardless of whether such disclosure is explicitly recited in the claims. No claim element is to be construed as a means plus function unless the element is expressly recited using the phrase means for. 

