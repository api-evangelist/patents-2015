---

title: Secure short message service (SMS) communications
abstract: Embodiments provide secure messaging communications. In an embodiment, a method comprises receiving, by a service provider processor, an encrypted message and a key from a sender associated with a first client device that is remote from the service provider, wherein the first client device internally encrypts the message. The message also comprises verifying the received key based on at least a comparison with a pre-determined key. Once the received key is verified, the method also comprises processing one or more unique factors associated with the sender or the first client device, wherein the one or more unique factors are known by the service provider. The method further comprises decrypting the message and re-encrypting the message using a key of a receiver associated with a second client device; and sending the re-encrypted message to the receiver associated with the second client device, wherein the second client device decrypts the message.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09537839&OS=09537839&RS=09537839
owner: PayPal, Inc.
number: 09537839
owner_city: San Jose
owner_country: US
publication_date: 20150512
---
This disclosure is a continuation of U.S. application Ser. No. 14 034 279 filed on Sep. 23 2013 issued on Jun. 16 2015 as U.S. Pat. No. 9 060 271 which is a continuation of U.S. application Ser. No. 12 341 987 filed on Dec. 22 2008 issued on Sep. 24 2013 as U.S. Pat. No. 8 543 091 which claims priority to U.S. Provisional Application Ser. No. 61 059 395 filed on Jun. 6 2008 and to U.S. Provisional Application Ser. No. 61 059 907 filed on Jun. 9 2008 the contents of which are hereby incorporated by reference in their entirety.

Embodiments of the present disclosure generally relate to electronic communications and more particularly to methods and systems for sending and or receiving Short Message Service SMS communications in a secure manner.

Short Message Service SMS is a communications protocol that allows the interchange of short text messages between mobile devices. SMS text messaging has become the most widely used tool of communications in many business and personal situations having billions of active users sending and receiving text messages on their mobile devices.

The ubiquitous worldwide use of mobile devices and SMS text communications has posed risks for users of having their SMS text communications intercepted read or pried upon by in some cases unwelcome third parties. In particular this is a problem when users want to send or receive passwords account numbers personal details confidential messages or other sensitive information.

Some companies still use insecure SMS text messaging in relation to for example payment systems or financial transactions. To get around such insecure text messaging such companies may use an Interactive Voice Response IVR call back system to obtain for example a Personal Identification Number PIN . This may create bad user experience because for example IVR is often criticized as being unhelpful and difficult to use due to poor design and lack of appreciation of the user s needs. IVR is an insecure channel itself and provides no guarantee of a strong second factor of authentication.

Also in view of the risks posed in potentially having sensitive information detected by third parties services have been offered for use against SMS prying. Such services may encrypt every text message during transfer which remains encrypted on the user s mobile phone thus preventing unwelcome third parties from deciphering private text messages. Text messages may appear scrambled until a correct password is entered. However the services offered in connection with these services are inconvenient in that they must be downloaded similarly to for example a ringtone. Also such services have no hardware support as their key management is in software.

Furthermore in some typical SMS communications for example in online payment systems a Wireless Application Protocol WAP or other typical protocols may be employed for mobile payments or financial transactions. This requires Internet access from the mobile device which means that users must sign up for a data plan. Because exchanging data over protocol channels such as WAP is expensive to use for SMS type data users tend not to use such protocol services.

As will be further described herein in relation to one or more embodiments methods and systems are provided for a secure Short Message Service SMS so that secure communications may be exchanged over regular SMS interfaces without the need of expensive protocol channels while meeting the user s need for convenient friendly and confidential SMS communication exchanges within a trusted environment.

In accordance with an embodiment of the disclosure a method of providing secure Short Message Service SMS communications comprises requesting that SMS data to be sent from a client device to a remote location be encrypted. The method also comprises encrypting the SMS data by processing the SMS data with a Message Authentication Code MAC and a timestamp and or counter along with second factor authentication information. The method further comprises sending the encrypted SMS data to the remote location by a secure SMS application via a regular SMS channel of the client device.

In accordance with another embodiment of the disclosure a client device comprises one or more processors and one or more memories adapted to store a plurality of machine readable instructions which when executed by the one or more processors are adapted to cause the client device to request that SMS data to be sent from the client device be encrypted encrypt the SMS data by processing the SMS data with a Message Authentication Code MAC and a timestamp and or counter along with second factor authentication information and send the encrypted SMS data to a remote location by a secure SMS application via a regular SMS channel of the client device.

In accordance with another embodiment of the disclosure a secure SMS system comprises a client in communication with a remote location via a network. The secure SMS system also comprises one or more processors and one or more memories adapted to store a plurality of machine readable instructions. When executed by the one or more processors the machine readable instructions are adapted to cause the client device to encrypt SMS data to be sent from the client device by generating a Hash Message Authentication Code HMAC using an encryption algorithm and applying the HMAC to a combination of a timestamp and or counter with second factor authentication information in a component of the client device and send encrypted SMS data via a secure SMS application using a regular SMS channel of the client device to the remote location.

These and other features and advantages of the embodiments of the present disclosure will be more readily apparent from the detailed description of the embodiments set forth below taken in conjunction with the accompanying drawings.

In accordance with one or more embodiments described herein methods and systems are provided for secure Short Message Service SMS communications wherein components such as a secure SMS application are built into a client device which may encrypt decrypt SMS messages or data to ensure a secure and private communications exchange. The exchange of such secure SMS communications involves encryption and or decryption of SMS messages or data with a strong second factor authentication without the need of for example Interactive Voice Response IVR callbacks to address security or confidentiality concerns. Secure SMS may enable users to send sensitive information over text messages as well as for example perform financial transactions such as sending money using a mobile Personal Identification Number PIN . In one or more embodiments described herein secure SMS communications may be performed without inconvenient downloads Internet access from the client device or exchange of data over expensive protocols.

Referring now to the drawings wherein the showings are for purposes of illustrating embodiments of the present disclosure only and not for purposes of limiting the same is a block diagram illustrating components inside a client device for use in a secure Short Message Service SMS flow according to an embodiment of the present disclosure.

A client device includes an Application component or block Application block where applications may be loaded. One application that may be loaded in Application block is a secure SMS application . It should be noted however that secure SMS application may alternatively be located outside Application block separately or as part of another block or component of client device . Secure SMS application is in communication with a Crypto component or block Crypto block and with an Over the Air OTA regular SMS communications chip . It should be appreciated that components of client device including Application block and Crypto block may comprise a Secure Element SE a Universal Integrated Circuit Card UICC with a Subscriber Identity Module SIM application smart cards or other suitable devices.

Application block may also include other pre loaded applications for example a payment service provider application to facilitate financial transactions. In addition client device may include various applications as may be desired in particular embodiments to provide desired features to client device . For example in various embodiments applications may include security applications for implementing client side security features programmatic client applications for interfacing with appropriate application programming interfaces APIs over a network or other types of applications.

Crypto block may include credentials payment instruments certificates and or keys that may be preloaded therein. For example to personalize client device an X509 key pair EMV Europay MasterCard VISA Elliptic Curve Cryptography ECC and or RSA algorithms for public encryption may be preloaded in Crypto block .

Client device may further include identification information such as for example a Secure Element number or identification ID the client device s unique identifier number such as an International Mobile Equipment Identity IMEI number or a unique number associated with a user of a client device such as an International Mobile Subscriber Identity IMSI number which may be stored inside the client device for example in a component such as an SE a UICC SIM card a smart card or any other suitable card of the client device. One or more user identifiers may be implemented for example as operating system registry entries cookies associated with a browser application identifiers associated with hardware of client device or other appropriate identifiers. In one embodiment a user identifier may be used by a payment service provider to associate client device or correspondingly the user with a particular account maintained by the payment service provider.

For logical end to end security both Application block and Crypto block may have an authenticated and encrypted channel. For physical security both Application block and Crypto block follow at least FIPS 140 2 Level 3 tamper proof and copy protection and Common Criteria ISO 15408 EAL 4 . Also the components or blocks are global and may work with GSM UMTS and or CDMA enabled client devices.

Client device may be implemented using any appropriate combination of hardware and or software configured for wired and or wireless communication over a network. For example in one embodiment client device may be implemented as a personal computer of a user in communication with the Internet or another network. In other embodiments client device may be implemented as a wireless telephone a personal digital assistant PDA a key fob a smart card a notebook computer and or other types of computing devices.

Referring now to a flowchart for a secure SMS flow inside the client device of is provided according to an embodiment of the present disclosure. In block when an SMS message or data is to be sent out from client device in an encrypted manner for instance when a financial transaction with client device is made or sensitive information is to be sent out using SMS text messaging secure SMS application requests Crypto block to encrypt the message or data.

In block Crypto block encrypts the SMS message or data by processing it through for example a keyed Hash Message Authentication Code HMAC using an RSA algorithm or Elliptic Curve Cryptography ECC and applying it to a combination of a timestamp and or counter along with second factor authentication information.

In general a three factor authentication for secure SMS text messaging may be used. The first factor involves what a user knows for example a password or a PIN. The second factor involves what a user has for example a token or the client device itself. Finally the third factor involves what the user is for example biometrics may be used for identification purposes such as a fingerprint or retinal pattern.

According to one or more embodiments of the present disclosure a strong second factor authentication may be provided to verify the authenticity of the client device or user. The encryption and processing of the SMS message or data may include applying an HMAC to a timestamp or counter along with pre registered identification information for a particular user or a particular client device also referred to as an identifier . That is an identifier such as an IMEI number or an IMSI number which may be stored in for example a SIM card of the client device is combined with a timestamp or counter and then HMAC is applied to the combination. This encryption and processing prevents a particular identifier from being sent out as is or by itself.

Identification information for a particular user or client device may be set during pre registration. Identification information may be used with a timestamp and or counter and HMAC and is not needed subsequent to pre registration. This allows for just the HMAC to be used the next time. Registration may be done one time via SMS or online over a network. Using an HMAC and a timestamp counter which is a private key with for example the IMSI number which is uniquely pre registered provides strong authentication compared to just sending an IMSI number by itself.

As it is well known in the art HMAC is a type of message authentication code MAC calculated by a specific algorithm involving a cryptographic hash function in combination with a secret key. As with any MAC it may be used to simultaneously verify both the data integrity and the authenticity of a message. Any iterative cryptographic hash function such as MD5 SHA 1 or a function in the SHA 2 family may be used in the calculation of an HMAC. A message or data may be encrypted using an encryption algorithm such as AES 256. According to one or more embodiments the size of an SMS message may be adjusted so that the total size of the message is 160 characters to be sent in a single SMS message. That is to fit the message in one single SMS there may be two algorithm options including i an RSA algorithm with PKCS 1 padding or ii Elliptic Curve Cryptography ECC wherein an output is 24 bytes in Base 48 encoding and 32 bytes in Base 64 encoding. The data may then be less than 128 160 32 bytes. Thus an ECC or RSA algorithm may be used for encryption of the SMS message or data with HMAC. The counter and or timestamp may be used for replay protection and HMAC may be attached. The message or data is thus encrypted internally in client device .

In block secure SMS application may then send the encrypted SMS message or data OTA using a regular SMS interface channel without the need of a special protocol channel such as a WAP channel.

Referring now to a secure SMS flow system is illustrated according to an embodiment of the present disclosure. Client device is in communication with a remote location for example a secure SMS service provider or key manager via a Mobile Network Operator MNO over network . In turn the remote location for example secure SMS service provider is in communication with another client device via MNO over network .

Client devices and and the remote location for example secure SMS service provider may each include one or more processors memories and other appropriate components for executing instructions such as program code and or data stored on one or more computer readable mediums to implement the various applications data and methods described herein. For example such instructions may be stored in one or more computer readable mediums such as memories or data storage devices internal and or external to various components of the system and or accessible over network which may be implemented as a single network or a combination of multiple networks. For example in various embodiments a network may include the Internet or one or more intranets landline networks wireless networks and or other appropriate types of networks.

Referring now to a flowchart for the secure SMS flow system of is illustrated according to an embodiment of the present disclosure.

In block client device sends an encrypted HMAC with timestamp counter SMS message or data through a regular SMS channel via MNO over network to a remote location for example to secure SMS service provider or key manager . In one embodiment the remote location may comprise a payment service provider such as PayPal Inc. As discussed above the SMS message or data may be encrypted and processed with HMAC and a timestamp counter along with an identification number for example an IMEI number an IMSI number or an SE number for a second factor authentication.

In block the remote location for example secure SMS service provider receives the encrypted SMS message or data from client device and finds out who the message is sent to. Secure SMS service provider has keys registered for the sender as well as for an intended receiver such as client device . Secure SMS service provider decrypts and re encrypts the message or data received from client device using the receiver client device s keys with for example hardware key generation or Hardware Security Modules HSMs . Timestamps counters may be used to prevent replays. Secure SMS service provider may have a public key inside Crypto block of client device . As discussed above Crypto block may generate a MAC key and encrypt a message or data with such MAC key. The keys may be encrypted using secure SMS service provider s public key that may then be used to create a digital envelope. The counter and or timestamp may be used for replay protection and MAC may be attached. Algorithms such as i an RSA algorithm with PKCS 1 padding or ii Elliptic Curve Cryptography may be used with HMAC for encryption of the data.

When a user sends an SMS text message the public key is sent along. An intended recipient is asked to verify possession of a public key by a standard method such as generating a hash a random number or a time stamp. The recipient is then asked to sign and verify. Once this is done public key encryption data is used as in standard methods by using the digital envelope created. In an example the process includes receiving the HMAC timestamp and or counter from the sender and comparing such HMAC timestamp and or counter with a pre determined timestamp and or counter that makes appropriate sense to determine veracity. Once the received HMAC timestamp and or counter is verified the receiver then may run a known identifier for example the known IMSI number the IMEI number or the Secure Element number or ID of the sender to verify authenticity. The position of the identifier is proven by the timestamp and or counter and HMAC.

In block Secure SMS service provider may then send the re encrypted SMS message or data to receiver client device over network via MNO .

In block client device receives the re encrypted SMS message or data and is able to decrypt and read the message by using its built in secure SMS application.

According to one or more embodiments it is assumed that a user has previously registered with the remote location for example secure SMS service provider to open a user account. In this regard it will be appreciated that the user may have previously provided account information to secure SMS service provider over network through for example a secure connection between client device or client device and secure SMS service provider . Alternatively client device or client device may be personalized during customization by operators customizers and or device manufacturers.

As a result of such previous registration client device or client device stores a specific user identifier that may be used to identify the particular user as having a user account maintained by secure SMS service provider . The user identifier may be implemented for example as one or more cookies operating system registry entries hardware identifiers or other types of identifiers.

Secure SMS service provider may work with an MNO to put a certificate issued by the secure SMS service provider in Crypto block of client device and client device . As discussed above Crypto block may follow security guidelines such as FIPS 140 2 Level 2 3. Secure SMS service provider issued certificates already installed in client devices and may be done for personalization purposes. When customers or users activate their secure SMS service provider application such as for example a payment service provider application which may already be built into client devices and the users are asked to select a PIN which may be optional or mandatory. The PIN protects the private key of the certificate.

When a transaction for instance a financial transaction using SMS text messaging with client device is made via secure SMS service provider for example a payment service provider secure SMS service provider gets signature information of for example a X509 certificate. This X509 signature information is typically maintained for each user. The signature information may be a digital signature and may include a time stamp dollar amount transaction type item and location which may be determined from a GPS enabled client device . Signature information may also be preloaded in client device or client device as EMV Europay MasterCard Visa or ECC in addition to X509.

It should be noted that in a secure SMS flow using for example a secure SMS service provider applications may be upgraded. All application upgrades would be signed by the secure SMS service provider. The applications would check periodically for any available updates. If an update is available and the user agrees the application may be downloaded and the signature is verified. Once the signature is verified the new application may be activated.

Although one or more embodiments have been described with respect to a remote location such as a secure SMS service provider embodiments of the present disclosure may also be used by customers to send secure messages directly to each other.

In view of the present disclosure it will be appreciated that various methods and systems have been described for secure SMS communications that may be used in conjunction with client device manufacturers wherein the client device for example a mobile telephone device includes for example a SIM card and or SE along with an ECC or RSA algorithm for public key encryption. The keys used therein are dynamic and may be managed by hardware.

Where applicable various embodiments provided by the present disclosure may be implemented using hardware software or combinations of hardware and software. Also where applicable the various hardware components and or software components set forth herein may be combined into composite components comprising software hardware and or both without departing from the spirit of the present disclosure. Where applicable the various hardware components and or software components set forth herein may be separated into sub components comprising software hardware or both without departing from the spirit of the present disclosure. In addition where applicable it is contemplated that software components may be implemented as hardware components and vice versa.

Software in accordance with the present disclosure such as program code and or data may be stored on one or more computer readable mediums. It is also contemplated that software identified herein may be implemented using one or more general purpose or specific purpose computers and or computer systems networked and or otherwise. Where applicable the ordering of various steps described herein may be changed combined into composite steps and or separated into sub steps to provide features described herein.

The foregoing disclosure is not intended to limit the present disclosure to the precise forms or particular fields of use disclosed. It is contemplated that various alternate embodiments and or modifications to the present disclosure whether explicitly described or implied herein are possible in light of the disclosure.

Having thus described embodiments of the disclosure persons of ordinary skill in the art will recognize that changes may be made in form and detail without departing from the scope of the disclosure. Thus the disclosure is limited only by the claims.

