---

title: Techniques for determining a handoff profile between telecommunications networks
abstract: Techniques are disclosed for evaluating an ongoing VoIP call over a combination of IP data communication network connections for purposes of determining when to hand it off to a circuit-switched cellular network connection. Multiple IP stream call quality values X1(i), X2(i), and Xb(i) are sampled over a time period (N) of (j) samples for an ongoing telephone call and stored. Instantaneous annoyance values a1(j), a2(j), and ab(j) for each of the stored call quality values for each of the IP streams within sampled time period (N) are calculated. Current accumulated annoyance values A1(i), A2(i), and Ab(i) are obtained by summing the instantaneous annoyance values a(j) for each IP network. The combined IP stream accumulated annoyance values Ab(i) is compared to a handoff threshold values Hb(i). A handoff of the telephone call a circuit-switched cellular communication link is initiated when the accumulated annoyance value Ab(i) is greater than the handoff threshold value Hb(i).
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09288731&OS=09288731&RS=09288731
owner: Bandwidth.com, Inc.
number: 09288731
owner_city: Raleigh
owner_country: US
publication_date: 20151103
---
Examples described herein are generally related to techniques for determining a handoff profile for a dual network communication device operable on multiple telecommunications networks.

Mobile telephony devices utilizing wireless communication protocols are ubiquitous. Many of these devices utilize one of the competing cellular networks e.g. GSM or CDMA to place and receive telephone calls to other telephony endpoint devices. A telephony endpoint device may include another mobile telephony device on the same or another cellular network a Voice over IP VoIP telephony device and or a plain old telephone service POTS telephony device. Each of these telephony endpoint devices may use a different access network but all are interfaced at some point to allow for communication among the different networks.

Recently there has been introduced another type of mobile telephony device one that is capable of utilizing multiple different networks depending on the current location or network conditions pertaining to the mobile telephony device. Such a mobile telephony device may be characterized as a hybrid mobile device due to its capability of making and receiving telephone calls on at least two distinct networks. Some hybrid mobile devices include the ability to start or establish a telephone call on one network e.g. an IP based VoIP network over a wireless fidelity WiFi connection or a cellular data connection like Long Term Evolution LTE and handoff the call to a second network e.g. a circuit switched cellular network when conditions on the original network degrade. Rather than dropping the call the hybrid mobile device in conjunction with a network based server may switch to a circuit switched cellular connection prior to severing the VoIP connection thereby ensuring that the hybrid mobile device stays connected to the other telephony endpoint and the call is not dropped.

Determining when to initiate the handoff to avoid dropping a call can vary based on a number of factors including but not limited to network conditions signal strength location and the like and is typically set based on manufacturer or carrier default settings. The aforementioned factors conspire to affect the user experience. However network conditions may be fleeting and or somewhat tolerable even if not perfect. Thus users may be able to tolerate a certain degree of annoyance before wanting a call to handoff to another network. Incorporating annoyance tolerance into the handoff determination may improve the user experience. As such described herein are methods systems and techniques for determining a handoff threshold based on various communication link parameters using annoyance tolerance as a triggering criteria.

The embodiments described herein disclose systems and methods for intelligently incorporating data based on various communication link parameters to establish a handoff profile to enhance communication sessions between or among communication devices. The systems and methods of the invention may be embodied in and performed by communication devices call servers and other devices and software instructions executed by some or all of such devices as will be explained in detail below. The different types of networks contemplated herein include for example cellular mobile networks both circuit switched and IP based and data networks such as the Internet or other IP based networks including wide area networks local area networks and combinations thereof.

As used herein the term communication session is meant to generally indicate any one way or two way exchange of information between two or more communication devices. Communication sessions may include voice data video and multimedia communication sessions or any other type of data communication sessions or messaging exchanges. As used herein the term communication link is intended to mean a physical or logical channel that connects two or more devices. A communication link may be a signaling link or a media link. In this context a communication session may be established via one or more communication links. One or more media streams may be transmitted over one or more communication links. A call server may be situated between communication devices thereby making the call server an endpoint in a communication link. The call server may be hosted within an IP network such as for instance the Internet or a LAN WAN accessible to the Internet.

The convergence of and inter operation among different types of network technologies e.g. heterogeneous network inter operability blurs the line between various distinct networks. This disclosure discusses access networks that may be characterized as the portion of a communication network that connects subscriber communication devices to a service provider s core network. An access network may also be referred to as the interface between the communication device and the network. Another type of interface may be the interface between networks. That is the interface necessary to facilitate seamless communication from one network to another.

Therefore references herein to a communication device capable of connecting to or communicating via a mobile carrier network refer to a communication device equipped with a cellular transceiver for wireless communication with base stations and other mobile carrier network access points for both circuit switched communication protocols e.g. GSM CDMA and IP based protocols e.g. LTE . Similarly references herein to a communication device capable of connecting to or communicating via a data network refer to a communication device equipped with a transceiver or other network interface for wireless communication e.g. 802.11 with a router or other data network access point. One particular communication device may be characterized herein as a wireless handset mobile device or hybrid mobile device. A wireless handset may include multiple RF transceivers one of which may be operable to connect to an access network for a mobile carrier network e.g. cellular network and another of which may be operable to connect to an access network for an IP data network e.g. 802.11 or combinations thereof.

The PSTN can be characterized as a circuit switched point to point communication network in which a physical connection between the endpoints is maintained for the duration of the connection. The PSTN may also be referred to as the legacy telephone network as it is the backbone infrastructure for connecting endpoints comprised of Plain Old Telephone Service POTS phones .

Mobile carrier networks sometimes referred to as cellular networks may come in different varieties based on a particular circuit switched radio transmission scheme between a communication device known as a wireless handset e.g. mobile or cellular phone or hybrid mobile device and the mobile carrier network base station that is in communication with the hybrid mobile device . Two such circuit switched radio transmission schemes are the Global System for Mobile Communication GSM and Code Division Multiple Access CDMA . These circuit switched radio transmission schemes are incompatible with one another necessitating an intervening interface to allow communication between endpoints on either network. In addition each network may operate over a specific frequency ranges. Often there may even be an intervening network such as the PSTN between two distinct mobile carrier networks . Each mobile carrier network includes an interface to the PSTN such that calls crossing that interface can be handled by the receiving network whether it is a mobile carrier network or the PSTN .

Various mobile carrier network operators base their network on one of the circuit switched radio transmission schemes and provide service to hybrid mobile devices using that circuit switched radio transmission scheme over a defined frequency band. For example a hybrid mobile device wirelessly communicates with a base station that serves as an access network to the mobile carrier network . The base station authenticates and authorizes the hybrid mobile device to the mobile carrier network and in conjunction with other equipment within the mobile carrier network manages calls to and from the hybrid mobile device . The mobile carrier network provides connectivity for any hybrid mobile devices capable of cellular transmission that are physically located within range of the mobile carrier network . The range of a mobile carrier network depends in part on an amplification power and or energy associated with the antennas comprising cellular base station hybrid mobile devices and the like. As the hybrid mobile device moves toward the outer range of the mobile carrier network the strength of the cellular signals degrade.

Similarly an IP based data network like the Internet may provide wireless connectivity to hybrid mobile devices within range of an IP access point . For instance an IP access point may provide wireless connectivity using any of the 802.11 WiFi standards and or any other type of IP based connectivity standard. As will be appreciated by those of skill in the art a hybrid mobile device may experience a stronger connection signal when located closer to an IP access point than when located further away from the IP access point . Thus the strength of the wireless data connection may fade as the hybrid mobile device moves away from an IP access point .

There may also be one or more alternative networks and alternative access points that may provide access to the Internet for a hybrid mobile device or other wireless handset devices . One such alternative network may be characterized as a WiMAX network operable over the 802.16 wireless protocol standard. Another such alternative network may be characterized as a whitespace network. A whitespace network may utilize RF spectrum that is shared with television broadcasters. The television broadcasters do not necessarily utilize all the spectrum allocated to them to broadcast their video signals. The unused spectrum may be tapped into to provide an alternative RF access point to an alternative network that can interface with the Internet .

The collection of IP based data networks and any IP cellular data based networks illustrated in such as LAN WANs the IP data portion of mobile carrier network and the Internet all run on a packet based data transfer protocol characterized as packet switching. Packet switching essentially chops up a data stream e.g. text voice data into segments and transfers them across an IP network to a destination where the packets are re assembled into the original data stream for output. Voice over IP VoIP is a specialized subset of IP packet based communication directed to IP telephony. Certain VoIP end user devices utilize an IP access point to access the larger IP network. The IP access point may be wired wireless e.g. WiFi or a combination wired wireless access point such as those illustrated in . A VoIP communication device may communicate with an IP access point to gain access to the larger IP network and other communication devices. The VoIP communication device has been illustrated as a wireline type device but may just as easily be a wireless device communicable with the IP access point over for instance one or more of the 802.11 protocols.

In certain embodiments mobile carrier network s include cellular networks or portions of cellular networks based on GSM LTE CDMA and or any other cellular network standards. IP based data networks include for example the Internet one or more intranets wide area networks WANs local area networks LANs and the like portions or all of which may be wireless and or wired. For instance an IP based data network may be a wireless network or a portion of a wireless network implemented using an IEEE 802.11 standard WiMAX and or any other wireless data communication standard. As is known in the art the resources the various networks PSTN Mobile Carrier IP Based may interface with the call server through gateway devices routers and or other appropriate devices not shown . Similarly the hybrid mobile devices may interface with the various networks PSTN Mobile Carrier IP based and alternative networks through appropriate access points some not shown .

Communication sessions get more complicated when the communication devices are associated with different networks. For instance a POTS phone placing a call to a wireless handset or a VoIP phone calling a POTS phone. In these scenarios and others there is an interface between the networks that serves to resolve any differences so that a communication session may be connected and maintained. As described above there may be an intervening network between two endpoint networks. For instance each mobile carrier network includes an interface to the PSTN such that calls crossing that interface can be handled by the receiving network whether it is a mobile carrier network or the PSTN . Similarly each VoIP service provider on an IP packet based network includes an interface to the PSTN such that calls crossing that interface can be handled by the receiving network whether it is an IP packet based network or the PSTN . Thus the PSTN often serves as a common routing network for endpoint communication devices that are associated with other networks. It is possible to create a VoIP interface such that IP packet based networks can interface directly with mobile carrier networks .

Each network service provider may provide equipment communication devices and service plans to its subscribers. These service plans can vary greatly in cost depending on the expected use of network resources. In addition some service plans may bundle data and voice services in the cost of the service plan. This is often the case for mobile carrier network subscribers since the ability to access data networks such as the Internet on a mobile device is a desired service. This is especially the case when a WiFi data connection is out of range. As a result bundled voice and data services can place a significant burden on the mobile carrier network resources that can lead to use restrictions for bundled voice data plans.

One approach that addresses the mobile network congestion problem is a communication device that may be characterized as a hybrid mobile device . The hybrid mobile device may be associated with network infrastructure that defaults telephony services to a WiFi connection using for instance VoIP over an 802.11 protocol via an IP access point . The hybrid mobile device may default to WiFi mode when available and may only switch to a mobile carrier network connection via a radio transmission scheme to a base station cellular mode when the WiFi connection is lost is unavailable or degrades in quality to the point that the connection can no longer support telephony services. For telephony services however such a soft handoff between heterogeneous networks is a more daunting and complex process.

One implementation of a soft handoff of a voice call between heterogeneous networks involves associating two telephone numbers to a hybrid mobile device . A first telephone number may be characterized as a data telephone number that is based on a VoIP telephony scheme. The second number may be characterized as a mobile telephone number that is used in conjunction with a radio transmission scheme associated with a mobile carrier network . The subscriber may only be aware of the data number and not have actual knowledge of the mobile number. For all intents and purposes the subscriber places and receives calls using the data telephone number. To reach the subscriber a second communication device would dial the subscriber s data telephone number.

When the hybrid mobile device is connected with an IP access point telephony services and functions are handled using VoIP. To dial out the subscriber dials the telephone number of the intended recipient s communication device. The intelligence within the hybrid mobile device recognizes that the subscriber is attempting to place a call and notes the telephone number entered. The call from the hybrid mobile device is routed to a call server hosted in an IP based network such as the Internet and establishes a first communication link. The call server then determines the intended telephone number that was dialed by the subscriber and places a call to the communication device associated with that telephone number called communication device . Upon connecting the second communication link between the call server and the called communication device the call server joins the first communication link with the second communication link to create a full duplex communication session between the hybrid mobile device and the called communication device.

The communication session will generally stay active until one of the respective communication devices terminates the call. Sometimes however the hybrid mobile device may experience a loss of service with or degradation to the WiFi connection. This commonly occurs if the hybrid mobile device moves out of range of the IP access point or the quality of the connection with the IP access point or intermediate LAN WAN network otherwise degrades. In such a scenario it is necessary to handoff or hand over the call over to the mobile carrier network to avoid terminating the communication session. This may be accomplished by creating a third communication link between the call server and the hybrid mobile device . The third communication link however may be routed through the mobile carrier network to the hybrid mobile device . When the first communication link is lost or is significantly degraded it may be seamlessly replaced by the third communication link such that the call server bridges or connects the third communication link with the second communication link to maintain the communication session.

Determining when to handoff the call to the mobile carrier network may be based on any number of suitable factors. In a typical implementation a manufacturer carrier or network provider may determine a default set of connection characteristics below which a connection is handed off from the IP network to the mobile carrier network . This default approach however may not take into account the differences between user expectations or tolerances regarding connection quality differences in networks configurations and performance capabilities and differences between devices used to establish the connection on behalf of a user e.g. different mobile devices . Based on these and other factors as described in more detail below it may be advantageous to incorporate user feedback and or user tolerance data into the algorithm used to determine when the handoff from the IP network to the mobile carrier network or an alternative network via an alternative network access point or a different WiFi IP access point for which network conditions may be more favorable is required.

On inbound calls to the hybrid mobile device a calling communication device dials the data number of the hybrid mobile device . This initiates a connection to the call server as the data number is automatically routed to the call server . The call server then establishes a first communication link with the calling communication device. The call server then establishes a second communication link with the hybrid mobile device . The call server defaults to WiFi mode in attempting to establish the communication link with the hybrid mobile device . If the hybrid mobile device is not currently connected to an IP access point and is therefore inaccessible via VoIP over WiFi the call server will switch to cellular mode. In cellular mode the call server will establish the second communication link over the mobile carrier network . This cannot be done however using the hybrid mobile device s data number since that number is unknown to the mobile carrier network . To establish the second communication link between the call server and the hybrid mobile device the call server accesses a translation table within a database that includes data mobile number pairs in which each pair may be associated with a hybrid mobile device . In this case the call server will lookup the data number and have a mobile number returned. The call server may then establish the second communication link by dialing the mobile number and establishing a connection to the hybrid mobile device . The call server may then join the first and second communication links to create the full duplex communication session between the calling device and the hybrid mobile device .

The communication session will stay active until one of the respective communication devices terminates the call. While the communication session is in progress the hybrid mobile device may re establish a WiFi connection. In such a scenario it may be desirable to hand the call over to the VoIP network to reduce the burden on the mobile carrier network . This may be accomplished by creating a third communication link between the call server and the hybrid mobile device . This time the third communication link may be routed over the VoIP network via an IP access point to the hybrid mobile device . When the third communication link is sufficiently established it may seamlessly replace the first communication link such that the call server bridges or connects the third communication link with the second communication link to maintain the communication session.

In another outbound calling scenario the hybrid mobile device may not have an initial connection via WiFi to a packet based VoIP network or the WiFi connection may not be sufficiently good. An outbound call to a destination telephone number is established over the mobile carrier network using the mobile number associated with the hybrid mobile device . For caller ID purposes however the calling number is the data number associated with the hybrid mobile device . The call is again routed to and through the call server . The first communication link is between the hybrid mobile device and the call server. This is accomplished by having the hybrid mobile device automatically place a call to the call server using one of the pool of telephone numbers associated with the call server. Just prior to the call the hybrid mobile device may utilize the mobile carrier network s data services to send a message to the call server . The message to the call server may contain the mobile and data numbers of the hybrid mobile device and the destination telephone number such that when the call server receives the call from the hybrid mobile device using the mobile number it can place a call to the destination telephone number and substitute the data telephone number in the caller ID field. Upon establishing the second communication link the call server may then join the first and second communication links to create the full duplex communication session between the hybrid mobile device and the destination device.

Alternatively a plurality of call servers may be employed and may be arranged for example in one or more server banks or computer banks or other arrangements. For example a plurality of call servers together may comprise a cloud computing resource a grid computing resource and or any other aggregated or distributed computing arrangement. Such call servers may be located in a single installation or may be distributed among different geographical locations. For purposes of convenience the call server is illustrated in and referred to herein in the singular. Even though the call server is referred to in the singular it is understood that a plurality of call servers may be employed in various arrangements as described above.

The communication interface s may include a voice over IP VoIP interface adapted to exchange IP based telephony signaling e.g. SIP and or media data with other IP network devices using a VoIP protocol. Another communication interface may be a PSTN interface adapted to convert incoming PSTN audio data to VoIP audio data and convert outgoing VoIP audio data to PSTN audio data. Still another communication interface may be an IP data interface adapted to exchange IP data with other IP network devices. This may include IP data exchanged with a mobile hybrid mobile device over an intermediate mobile carrier network . Yet another communication network interface may be directed toward an alternative network adapted to exchange data with a hybrid mobile device or a hybrid mobile device . Examples of alternative network s may include but are not limited to WiMAX and whitespace. A whitespace network may be characterized as one that utilizes frequency spectrum that is overlapping with that of broadcast television frequency spectrum.

The call server may further include several inter operable software modules collectively referred to as the communication link handoff logic that is operable with application programming interfaces APIs and communication interfaces and configured to intelligently manage the communication session.

The communication link handoff logic may be configured to physically or logically connect communication links. The communication link handoff logic may also be configured to monitor network conditions and receive communication session data from the hybrid mobile device regarding its connection with the IP access point so as to intelligently determine the need for a soft handoff to the mobile carrier network . Communication session data may refer to any data relating to a communication session or its constituent communication link s such as but not limited to detected signal strengths available networks protocol and buffer statistics and analysis e.g. jitter latency dropped packets signal strength link speed etc. environmental and or geographical factors the performance of access points and other network components past interactions between or among communication devices access points and other network components context of conversations during voice calls and other data points described herein. The communication link handoff logic may be further configured to initiate a handoff from one communication link to another communication link.

More specifically the communication link handoff logic may cooperate with the APIs and network interfaces to physically or logically connect communication links to initially establish a communication session between communication devices and or to perform a handoff of at least one communication link of a communication session from one network to another network. A communication session may be for instance between a hybrid mobile device and a second telephony endpoint e.g. . The handoff may be caused by an instruction or command received from or sent to the communication link handoff logic . The communication link handoff logic may be configured to physically or logically establish communication links join communication links and sever communication links to a common or shared communication session based on commands or instructions received from or sent to the call server .

The communication link handoff logic may also cooperate with the APIs and network interfaces to monitor and gather receive data pertaining to network conditions and communication device connections with various networks. The data may then be intelligently processed to predict or determine the need for a handoff of at least one communication link of a communication session. The data sent or received by the communication link handoff logic may also include out of band and or out of network signaling to or from a communication device to indicate that a handoff is needed. In such a case the communication link handoff logic may instruct the call server to establish a new communication link and then initiate a handoff process once the new communication link has been established.

The communication link handoff logic may cooperate with the APIs and network interfaces to effect a handoff of a first communication link between the call server and the hybrid mobile device to a second communication link between the call server and the hybrid mobile device . The communication link handoff logic may receive data and instructions that indicate a handoff may be needed imminently based on the degrading network conditions associated with the first communication link. The need may be determined based on a handoff profile established by a statistical modeling technique that was applied to a set of multiple VoIP network parameter data acquired via some form of user feedback or annoyance model data. The communication link handoff logic may then execute certain instructions to establish a second communication link between the call server and the hybrid mobile device . Once the second communication link has been established the communication link handoff logic may join the second communication link to the communication session with the other telephony device prior to severing the first communication link between the call server and the hybrid mobile device .

The communication link handoff logic may be designed to fit a statistical and or annoyance model pertaining to call quality parameters of a media stream between a communication device and the call server . The communication link handoff logic may include for example logic to establish a handoff profile based at least in part on a statistical model fitted to multiple VoIP communication link parameters indicative of communication link quality or an annoyance model based on changing call quality over time.

The call server may execute various applications and or other functionality for among other things setting up managing and tearing down communication sessions between communication devices and . Also various data may be stored in a data storage via memory of the call server . Data storage illustrated in may be representative of a plurality of data stores as can be appreciated. The data stored in the data storage for example may be associated with the operation of the various applications and or functional entities of the call server .

The WiFi transceiver may be operable to communicate with an IP network access point using one or more of the 802.11 wireless transmission protocols. Upon connection with an IP network access point the hybrid mobile device may exchange IP data with servers or other computers that are connected with or communicable with the Internet via LAN WAN . This may include the call server shown in .

The cellular transceiver may be operable to communicate with a mobile carrier network for both circuit switched voice and IP data communication. On the circuit switched voice side the mobile carrier network may be based on GSM CDMA or other communication protocols while on the IP data side the mobile carrier network may be based on for example GPRS EDGE EV DO HSPA D HSPA U LTE UMTS WCDMA UMTS TDD eHRPD etc.

In one embodiment the alternate transceiver may be a WiMAX transceiver that is operable to communicate with an IP network access point using one or more of the 802.16 wireless transmission protocols. Upon connection with a WiMAX network access point the hybrid mobile device may exchange IP data with servers or other computers that are connected with or communicable with the Internet via WiMAX network . This may include call server shown in . In another embodiment the alternate transceiver may be a whitespace transceiver that is operable to communicate with a whitespace network access point. The whitespace network in turn may be communicable with the Internet to allow IP data communication between the hybrid mobile device and servers or other computers that are connected with or communicable with the Internet . This may include call server shown in .

The hybrid mobile device may further include data storage software applications various user interface s and its own communication link handoff logic . The data storage may include for example one or more types of memory devices including but not limited to flash memory usable for ROM RAM PROM EEPROM and cache. The software applications may include for example one or more software applications executable on or by the processor s including but not limited to web browsers email applications application specific data and or audio video applications call handoff applications etc. The user interface s may include for example a display a touchscreen for soft key input speaker s microphone s a keyboard for hard key input and one or more buttons. The communication link handoff logic may include for example logic to establish and execute a handoff profile based at least in part on statistically modeled user feedback regarding communication link quality and or an annoyance model.

Sometimes however the hybrid mobile device may experience a loss of service with or degradation to the original network connection used to establish the call. The original network may be a mobile carrier network or an IP network . In such a scenario it is necessary to hand the call over e.g. handoff to an alternate network to avoid terminating the communication session. The alternate network may be the opposite of the original network . For example if the original network was an IP network the alternate network may be a mobile carrier network and vice versa. The embodiments are not limited to these examples. There may be other alternate network s that are neither mobile carrier network s or IP network s .

The handoff may be accomplished by creating an alternate communication link between the call server and the hybrid mobile device . The alternate communication link however will be routed through the alternate network to the hybrid mobile device . When the original communication link is lost or is significantly degraded it may be seamlessly replaced by the alternate communication link such that the call server bridges or connects the alternate communication link with the communication link to the other communication device to maintain the communication session.

To establish the alternate communication link the hybrid mobile device may initially send or receive an out of band or even an out of network signal to or from the call server . A call between the hybrid mobile device and another communication device by way of call server may be initially setup using the Session Initiation Protocol SIP . IP addresses and ports are exchanged and an audio and or video codec is negotiated for the exchange of media. Audio and or video from both ends flows using the Real time Transport Protocol RTP and the selected codec s . Any further change in the call is accomplished using SIP e.g. one party hangs up . The hybrid mobile device may also maintain an open data channel with the call server using for example a protocol called Message Queue Telemetry Transport MQTT . MQTT is an open message protocol for machine to machine communication that enables the transfer of telemetry style data in the form of messages from pervasive devices along high latency or constrained networks to a server or small message broker. Pervasive devices may range from for example sensors and actuators to mobile phones embedded systems on vehicles or laptops and full scale computers.

The MQTT channel is not involved in the initial call setup. As long as the communication device has some sort of network connection the MQTT channel is available. The impending handoff signal may be sent from the communication device to the server using this data channel. The MQTT channel is out of band in the sense that it is not involved with the initiation or destruction of a communication session e.g. phone call . Nor is it in the path of the exchange of media between the hybrid mobile device and the call server . Additionally or alternatively the impending handoff signal could be out of band in the sense that it uses an alternative such as for example a text message white space or LTE that may be referred to herein as out of network signals.

The out of band or out of network signal may instruct the call server to initiate the process of establishing an alternate communication link between the hybrid mobile device and the call server . The out of band or out of network signal may be the result of the hybrid mobile device detecting poor or degrading original network connectivity or may be based on one or more other sensor inputs indicative of the impending need for a handoff. Once the out of band or out of network signal requesting establishment of an alternate communication link is received the call server may initiate the alternate communication link by first determining on what network the original communication link is established. The call server may then dial the hybrid mobile device using the telephone number associated with the alternate network connection to the hybrid mobile device . The hybrid mobile device may then automatically answer the call without user notification or intervention. The call server may then join the alternate communication link with communication link to the other communication device to maintain the communication session before severing the original communication link between hybrid mobile device and the call server . Alternatively the hybrid mobile device may sever the original communication link once the alternate communication link is established.

For example if the original network connection for the original communication link is a VoIP based WiFi connection the alternate communication link may be established over a mobile carrier network via a cellular system. The hybrid mobile device will have both a data telephone number associated with in this example the original network and a mobile telephone number associated with the alternate network . The alternate communication link may be routed over the alternate network by having the call server send call establishment signaling to the hybrid mobile device . Since the hybrid mobile device is currently connected to the call server on the original communication link the incoming new call signaling may be acted upon without notifying the user. For instance the hybrid mobile device may not ring vibrate or display a call waiting message pertaining to the incoming call from the call server . Rather the hybrid mobile device may automatically answer the new incoming call over the alternate network based on a particular piece of information in the signaling data that identifies the new call as being a handoff for the current call. For example the out of band or out of network signal sent by the hybrid mobile device to the call server may include a flag or data bits uniquely signifying a request to create an alternate communication link between the hybrid mobile device and the call server and switch from the original communication link to the alternate communication link. In another embodiment the call server may use a particular telephone number as the source number when signaling the hybrid mobile device . The particular number may be dedicated to handoff calls only.

The technique s described may work whether the original network is an IP based VoIP network and the alternate network is a cellular based mobile carrier network or vice versa. In addition there may be other types of non cellular based network s that can function as the original network or alternate network . The embodiments are not limited to these examples.

The foregoing description relates generally to the process of handing a call off from an IP based VoIP network to a cellular based carrier network or an alternate network and vice versa . While the handoff process itself is useful in improving the user experience and decreasing network load by utilizing an IP based VoIP network when possible the determination regarding when to initiate the handoff and what parameters to analyze when determining that the handoff should be performed is an area that can be improved. Currently a device manufacturer network carrier or other similar party in the communications chain assigns default handoff metrics. This process however does not account for personal user preferences user tolerance for communication link quality degradation variations between different networks and devices and the like. Therefore in various embodiments it may be advantageous to incorporate such data into the algorithm used to determine when a handoff should occur for that user. The embodiments are not limited in this respect.

The capability to handoff a call from an Internet Protocol IP network to a circuit switched cellular network exists. But determining when that handoff should be made for a given communication session e.g. telephone call greatly affects the user experience. A call on an IP network may utilize an 802.11 WiFi communication link alone or multiple communication links comprising an 802.11 WiFi communication link multi streamed or bonded with cellular IP data communication link.

Converting the subjective mean opinion score canonical model into an objective modeling framework capable of informing a handoff decision provides a mechanism to improve user perception of call quality.

A hybrid mobile device on a call can measure in real time Voice over Internet Protocol VoIP variables or parameters that serve as a proxy for call quality. Similarly a network based call server mediating the call may also be able to receive and process the real time VoIP parameters. When VoIP network call quality degrades to a certain level the device may handoff from an IP based network to a circuit switched cellular based network.

Although call quality can be regarded as subjective it is likely that a wide majority of users are able to differentiate good calls from bad calls and mediocre calls. With that as the case a model to inform handoff can be crafted that i does not require large scale user input ii can be easily or naturally adapted to groups of users or individual users and iii can incorporate multiple call quality metrics.

The objective portion of the model is the concept of annoyance and annoyance tolerance. Poor VoIP call quality will annoy users and they will tend to favor circuit switched calls in that moment that are presumably better quality. Annoyance is proportional to the product of call degradation and duration very bad quality for short periods of time and mediocre call quality over long periods of time are equally annoying. Annoyance is cumulative and builds as the user experiences more or longer instances of poor to bad quality. There is a bound to annoyance that is defined by a user s memory as the call continues a user will forget about poor quality early in the call. Mathematically this manifests as a moving window of time that cumulative annoyance is computed over.

A handoff may be triggered when the annoyance exceeds the tolerance for annoyance over time. An annoyance tolerance function may be derived from empirical data. Call quality can be simulated in a controlled environment. For instance users may be queried as to how long they would tolerate calls at varying levels of call quality. This maximum tolerance may range from indefinitely the call is not bad enough to hang up to less than a second of tolerability. Some simulated call qualities potentially any call that is not perfect may have been annoying and could contribute to annoyance but not annoying enough to drive a user to terminate the call. The maximum time a user would stay on a call at a given quality may be used as an input to define a user s annoyance tolerance.

Although many different scenarios may generate the same level of annoyance over time those annoyances may or may not be equally tolerable. Generally very bad quality for a short period of time is less tolerable than mediocre quality for a longer period. In other words we have chosen annoyance to be the consistent measure across all listeners and allow tolerance to vary between individual listeners. As illustrated later in this principle is incorporated via the shape of a maximum tolerance function.

A user s preference for handoff sensitivity may be stored as a set of constants and functions that can be studied empirically. Users tend to agree with a high degree of precision on maximum tolerances and annoyance cutoff thresholds. These maximum tolerances may then be used as a default setting for everyone. Still it is important to retain some flexibility to adjust the model either broadly or down to individual user preference tuning to balance call quality and cost incurred. The annoyance model may also be generalized to multiple measures of call quality that may be translated into a call degradation measurement.

Call degradation may be measured as a combination of conditions present over a system of devices that may contain an 802.11 network e.g. LAN and the Internet e.g. WAN . Because the full state of the system is not available to each individual entity these conditions are often unpredictable when analyzed by a single device. Current handoff models analyze call degradation or some proxy of it to find trends over time. These trends are then used either implicitly or explicitly to forecast future conditions of the network. However since call degradation is often unpredictable a forecast may often be unreliable. Whereas a trend model employs a mathematical derivative for analysis the accumulated annoyance is related to the anti derivative of call degradation. It measures the cumulative effect of call degradation based on what measurably occurred in the recent past instead of attempting for forecast into an uncertain future.

Predictions based on the derivative may easily be misleading because WiFi quality is extremely variable. Linear trend lines and a measure of their variability are often employed for predictions but such predictions are useless outside of a very local window especially when the underlying data are volatile. displays a scenario of predicting WiFi call degradation with a linear trend. The measured call degradation is displayed as a solid black line . Linear predictions of future poor quality may be made continuously throughout the call one such example is shown as the dashed line . The shaded region between dashed line and dashed line depicts a pointwise 95 prediction interval. Despite this wide prediction band the true call degradation can easily fall outside of the prediction region after only a few more measured samples as shown by the continued clashed line . Using linear predictions may result in many false positives where a handoff may occur too soon even when IP network quality is sufficient for the call.

The techniques described herein eschew a derivative based predictive model of WiFi call degradation in favor of an derivative i.e. integral based objective model.

For instance IP stream  is missing of 75 packets 25 packet loss while IP stream  is missing of 75 packets 32 packet loss . However the bonded IP stream is only missing of 75 packets 7 packet loss .

Included herein is a set of flow charts and message diagrams representative of exemplary methodologies for performing novel aspects of the disclosed architecture. While for purposes of simplicity of explanation the one or more methodologies shown herein for example in the form of a flow chart or flow diagram are shown and described as a series of acts it is to be understood and appreciated that the methodologies are not limited by the order of acts as some acts may in accordance therewith occur in a different order and or concurrently with other acts from that shown and described herein. For example those skilled in the art will understand and appreciate that a methodology could alternatively be represented as a series of interrelated states or events such as in a state diagram. Moreover not all acts illustrated in a methodology may be required for a novel implementation.

Block is indicative of a call being connected and a communication session established between a first user on a hybrid mobile device capable of voice communications on multiple networks and a second user. A call server mediates the communication session between the two users. The variable X may be used to represent the call quality values in the aggregate and generally. Without loss of generality X is taken to be a measure of call degradation so a larger X implies worsening call quality. For example increased jitter more dropped packets additional latency sub optimal signal strength and or reduced link speed would drive t to value of X higher for a given time. As the call is ongoing certain call quality values X1 for IP stream  and X2 for IP stream  are obtained at block and stored at block . In block the same call quality values Xb are determined based on the combination of IP stream  and IP stream  illustrated in for the bonded IP stream and similarly stored in block .

This may occur on either the call server side or on the hybrid mobile device side. The call quality values X may be stored over time t and sequentially labeled indexed. The variable i may be used as generic indices for call quality values X at time samples t. Thus a sample set of call quality values such as X i X i 1 . . . X i 10 may be stored at block . The sample rate may be adjustable but for purposes of illustration the sample rate may be set to 500 ms meaning a call quality measurement X i is stored every half second. The call quality values X i may include but are not limited to Voice over IP VoIP characteristics such as jitter latency dropped packets signal strength link speed etc.

In addition a time window of length N may be set that defines a relevant period within which to save sampled call quality values X i . For example if N 30 seconds then a full set of call quality values X i for that time window would comprise sixty 60 samples X 1 X 2 . . . X 60 based on a sampling rate of 500 ms and assuming that the samples are captured in exact periodicity which may not be the case. Just as for the sampling rate the length N of the time window may also be adjustable.

The following process decides the ideal time for handing over a VoIP call from a bonded IP stream using IP stream  and IP stream  to a circuit switched cellular network. Two critical decision points exist in the process 1 an evaluation of the degradation existing on the bonded IP connection and 2 a safety valve for protecting the user experience in a scenario when one of the two IP connections cannot sustain the call on its own. To reach these decision points we continue describing the process in full. In block an accumulated annoyance value A1 i A2 i and Ab i is calculated for each of IP stream  IP stream  and the bonded IP stream using the call quality values X1 i X2 i and Xb i . Additional details for calculating the accumulated annoyance are described with reference to . At block a handoff threshold also referred to as the annoyance tolerance threshold is acquired and labeled H1 i H2 i and Hb i for the respective IP streams. Additional details for determining the handoff threshold are described with reference to . At decision block the process evaluates the degradation of the bonded VoIP call. If the accumulated annoyance Ab i for the bonded IP stream is greater than the handoff threshold Hb i for the bonded IP stream a network handoff from the IP network s to a circuit switched cellular network is initiated at block . This causes the communication link between the first user on the hybrid mobile device and the call server to switch networks. If accumulated annoyance Ab i is less than or equal to annoyance tolerance Hb i then control moves to block . Blocks and compose the safety valve to prevent a poor call experience that could occur due to a sudden loss of the connection bonding.

The decision block compares the accumulated annoyance A2 i to the annoyance tolerance H2 i from an isolated IP stream  . The values A2 i and H2 i generally do not correspond directly with the call degradation because they are measurements taken prior to the IP connection bonding detailed in . Rather the values A2 i and H2 i represent a hypothetical VoIP call in the case of a complete failure of IP stream  . If A2 i is less than or equal to H2 i then IP stream  is capable of serving but not required to serve the VoIP call by itself without bonding control is returned to block effectively re cycling the entire procedure for the next iteration of call quality values X1 i 1 X2 i 1 and Xb i 1 . If however A2 i has exceeded H2 i conditions of the 802.11 WiFi network are evaluated at block to determine if a change to the network topology is predicted or impending. The most likely topological change is a disconnect of hybrid mobile device from the 802.11 WiFi network access point. The hybrid mobile device has access to measurements of the 802.11 connection s current capabilities which are a proxy for the surrounding environment for example changes in connection signal strength can approximate changes in distance between the hybrid mobile device and the 802.11 WiFi network access point. Block analyzes environmental trends to predict a disconnect at the 802.11 protocol level. If such a prediction is made control is sent to block where a handoff to a circuit switched cellular communication link is initiated. If the 802.11 WiFi conditions do not predict an impending disconnect at block control is returned to block effectively re cycling the entire procedure for the next iteration of call quality values X1 i 1 X2 i 1 and Xb i 1 .

Block is indicative of an annoyance subroutine being invoked from block of . The CLH logic may then fetch sample call quality measurements X1 i X2 i and Xb i at time t i at block . At block all of the sample indices for call quality values X1 X2 and Xb that are still in memory are collected. Still in memory may be characterized as those indices j that fall within time window N. Both j and i are indices for call quality values X1 X2 and Xb. Index j is a subset of index i. Specifically index j includes all indices from the current time t i inclusive back to t i N exclusive . Thus j is any index representing a sample that is newer than N seconds old. This index set may be mathematically denoted as S j t j t i N. At block an individual sampled annoyance value a j is computed for each X1 j X2 j and Xb j wherein a1 j X1 j t j t j 1 X1 j C a2 j X2 j t j t j 1 X2 j C and ab j Xb j t j t j 1 Xb j C where C represents a first annoyance threshold level and is defined below. If X1 j C is less than or equal to zero 0 then the entire individual sampled annoyance value a1 j is set to zero 0 indicating no annoyance for index j. If X2 j C is less than or equal to zero 0 then the entire individual sampled annoyance value a2 j is set to zero 0 indicating no annoyance for index j. If Xt j C is less than or equal to zero 0 then the entire individual sampled annoyance value ab j is set to zero 0 indicating no annoyance for index j. The a1 j a2 j and ab j annoyance value calculations are repeated for all j indices in S comprising time window N.

At block the accumulated annoyance A i is calculated for the entirety of the time window that captures the past N seconds of data. Mathematically accumulated annoyance for window N may be expressed as A1 i a1 j j in S A2 i a2 j j in S and Ab i ab j j in S . The accumulated annoyance values A1 i A2 i and Ab i are then returned to the main comparison in block of to be used in determining whether to initiate a handoff.

Before getting to the process of some background and context is helpful. A tolerance T function defines a user s tolerance or maximum duration in seconds for had call quality as measured by call quality values X. As stated before call quality values may include but are not limited to jitter dropped packets latency strength link speed etc. As described above X may be used as shorthand notation for the call quality values of multiple IP data streams X1 X2 and Xb.

There is some range of call quality that a user can tolerate indefinitely this may be anywhere from perfect call quality to slightly degraded quality that is not bad enough to drive the user to become frustrated with the call experience and terminate or seek to handoff the call. Note that a perfect portion of a call which is trivially infinitely tolerable is defined as when X C. When CC the call is annoying enough to drop the user s tolerance duration T of the call to a finite level. As X continues to increase above Cand call quality becomes even worse the tolerance duration T continues to decrease down to a very short duration possibly at or under 1 second . Both Cand Chave been previously determined likely through empirical data gathering over a sample of users.

Tolerance as a function of X defines a T X curve. T X is infinite when X C. When X C T X is a monotonically decreasing function. It is possible to measure T X with user feedback. Controlled and known amounts of degradation can be injected into a VoIP call and users can be polled for how long they would remain on the call. This can be repeated for multiple different X values across multiple different users to define a default T X profile including values for Cand Cthat is acceptable for most people. It is also possible to tune the T X function on a per user basis for more fine grained control of a handoff trigger.

A generalized annoyance tolerance function e.g. handoff threshold H i is the tolerance for a user s cumulative annoyance on a call. To ensure that the units on annoyance and annoyance tolerance are comparable define H i T X X so that both annoyance A i and annoyance tolerance H i are based in time and can be termed call degradation seconds. It is required that H X also be monotonically decreasing which could lead to simple restrictions on T X .

Both the accumulated annoyance A i and the annoyance tolerance H i are computed in regular intervals e.g. a sampling rate during the call. Because the call quality values X may be very spiky over a call a smoothed measurement of X called Xs is fed into the tolerance function T. The use of Xs mitigates false positive handoffs that may occur when brief but extreme spikes in bad network quality appear. However because this spikiness does contribute to a user s annoyance level the unsmoothed call quality values X are used to compute accumulated annoyance A i .

Block is indicative of a handoff subroutine being invoked from block of . The CLH logic may smooth the call quality measurement data for each of the IP streams X1 i into X1s i X2 i into X1s i and Xb i into Xbs i at block . This may be achieved by multiplying a weighting factor that reduces the abruptness of call quality changes from sample index to sample index. This process is further described and illustrated in some of the graphs in .

At block the currently sampled and smoothed call quality measurement for IP stream  X1s i is compared against the second annoyance threshold C. Recall that Crefers to an annoyance threshold above which the call quality measurement X1s i corresponds potentially to a level of annoyance for which a user may terminate a call. A call quality measurement X1s i above Cmay cause the determination of the handoff cutoff value H1 i denoted as T X1s i X1s i at block . A call quality measurement X1s i below Ccorrelates to an infinite handoff cutoff value H1 i at block meaning the user would not terminate a call for this relatively satisfactory call quality measurement X1s i . The value of H1 i may then be returned to the main comparison in block of to be used in determining whether to initiate a handoff.

At block the currently sampled and smoothed call quality measurement for IP stream  X2s i is compared against the second annoyance threshold C. Recall that Crefers to an annoyance threshold above which the call quality measurement X2s i corresponds potentially to a level of annoyance for which a user may terminate a call. A call quality measurement X2s i above Cmay cause the determination of the handoff cutoff value H2 i denoted as T X2s i X2s i at block . A call quality measurement X2s i below Ccorrelates to an infinite handoff cutoff value H2 i at block meaning the user would not terminate a call for this relatively satisfactory call quality measurement X2s i . The value of H2 i may then be returned to the main comparison in block of to be used in determining whether to initiate a handoff.

At block the currently sampled and smoothed call quality measurement for the bonded IP stream Xbs i is compared against the second annoyance threshold C. Recall that Crefers to an annoyance threshold above which the call quality measurement Xbs i corresponds potentially to a level of annoyance for which a user may terminate a call. A call quality measurement Xbs i above Cmay cause the determination of the handoff cutoff value Hb i denoted as T Xbs i Xbs i at block . A call quality measurement Xbs i below Ccorrelates to an infinite handoff cutoff value Hb i at block meaning the user would not terminate a call for this relatively satisfactory call quality measurement Xbs i . The value of Hb i may then be returned to the main comparison in block of to be used in determining whether to initiate a handoff.

The thin jagged line graph represents the instantaneous aggregated call quality values X i from whereas the dashed line graph represents a smoothed version Xs i of the instantaneous aggregated call quality values X i graph . The smoothed version Xs i graph may be calculated using exponential smoothing that reduces the abruptness of call quality changes in X i from sample index to sample index at block in . Higher values on the upper y axis indicate more significant call degradation as determined by a plurality of measurable network conditions.

Graph may be termed annoyance tolerance referenced as H X above which is the tolerance for a user s cumulative annoyance on a call. The annoyance tolerance graph works in conjunction with the accumulated annoyance graph to determine a handoff point at which a user desires the call to handoff from an IP based network to a circuit switched cellular based network. So long as the smoothed version Xs i graph remains below the threshold level C graph the call will be considered of sufficient quality and the annoyance tolerance graph will not dip below its arbitrary setting meaning no handoff will be warranted. Remember the Cgraph represents an annoyance tolerance threshold above which users indicate they are annoyed enough to terminate the call whereas C graph represents an annoyance tolerance threshold above which users indicate they are annoyed but not yet annoyed enough to terminate the call.

The lower solid line graph may be termed the accumulated annoyance graph . The accumulated annoyance A i graph is calculated by summing the instantaneous annoyance s for all sample indices j within the relevant time window duration N at block of . Mathematically accumulated annoyance for window duration N may be expressed as A i a j j in S where the set S contains the samples newer than N seconds old. As indicates rises in accumulated annoyance as measured by graph coincide with call degradation values smoothed Xs graph above the initial annoyance threshold C. Drops in the annoyance tolerance graph coincide with call degradation values smoothed Xs graph above the higher annoyance threshold Cabove which users indicate they are annoyed enough to terminate or handoff the call at some point. These boundaries are marked in by the vertical lines and . Vertical line indicates a point in time at which the instantaneous smoothed call quality Xs graph breaches the Cannoyance threshold upward causing the annoyance threshold graph to move lower while vertical line indicates a point in time at which the instantaneous smoothed call quality Xs graph breaches the Cannoyance threshold downward causing the annoyance threshold graph to return to the no handoff needed state. A handoff may be initiated when the accumulated annoyance exceeds the annoyance threshold at a handoff cutoff point . Mathematically one could view the accumulated annoyance graph as the integral of the instantaneous aggregated call quality values X i graph .

Some examples may be described using the expression in one example or an example along with their derivatives. These terms mean that a particular feature structure or characteristic described in connection with the example is included in at least one example. The appearances of the phrase in one example in various places in the specification are not necessarily all referring to the same example.

Some examples may be described using the expression coupled connected or capable of being coupled along with their derivatives. These terms are not necessarily intended as synonyms for each other. For example descriptions using the terms connected and or coupled may indicate that two or more elements are in direct physical or electrical contact with each other. The term coupled however may also mean that two or more elements are not in direct contact with each other but yet still co operate or interact with each other.

It is emphasized that the Abstract of the Disclosure is provided to comply with 37 C.F.R. Section 1.72 b requiring an abstract that will allow the reader to quickly ascertain the nature of the technical disclosure. It is submitted with the understanding that it will not be used to interpret or limit the scope or meaning of the claims. In addition in the foregoing Detailed Description it can be seen that various features are grouped together in a single example for the purpose of streamlining the disclosure. This method of disclosure is not to be interpreted as reflecting an intention that the claimed examples require more features than are expressly recited in each claim. Rather as the following claims reflect inventive subject matter lies in less than all features of a single disclosed example. Thus the following claims are hereby incorporated into the Detailed Description with each claim standing on its own as a separate example. In the appended claims the terms including and in which are used as the plain English equivalents of the respective terms comprising and wherein respectively. Moreover the terms first second third and so forth are used merely as labels and are not intended to impose numerical requirements on their objects.

