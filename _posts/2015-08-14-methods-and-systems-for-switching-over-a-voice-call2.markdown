---

title: Methods and systems for switching over a voice call
abstract: Systems and methods for switching a voice call from an Instant Messaging (IM) based voice network to a second voice network. A telephone adapted to switch a voice call from an Instant Messaging (IM) based voice network to a second voice network.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09578570&OS=09578570&RS=09578570
owner: TP Lab Inc.
number: 09578570
owner_city: Palo Alto
owner_country: US
publication_date: 20150814
---
This application is a continuation of U.S. patent application Ser. No. 14 457 643 filed Aug. 12 2014 which is a continuation of U.S. patent application Ser. No. 13 598 133 filed Aug. 29 2012 issued as U.S. Pat. No. 8 838 083 which is a continuation of U.S. patent application Ser. No. 12 835 402 filed Jul. 13 2010 issued as U.S. Pat. No. 8 295 821 which is a continuation of U.S. patent application Ser. No. 11 615 636 filed Dec. 22 2006 issued as U.S. Pat. No. 7 778 630 the entireties of which are incorporated herein by reference.

This invention relates generally to telecommunication particularly to a system and method for switching a voice call from an Instant Messaging IM based voice network to a cellular voice network.

In only twenty years mobile phones also referred to as cellular phones have gone from obscure and expensive gadgets to phenomenally common and low cost personal commodities.

At the same time a new mobile lifestyle enabled by mobile phones has emerged. People use mobile phones to keep in touch with family and friends while on the go. Popular features such as Short Message Service SMS camera and music further solidify cellular phones as must have items for consumers.

With the addition of Internet access availability of WiFi hotspots and popularity of Instant Messaging a new breed of dual mode mobile phones has arrived. Besides cellular telephone service these new dual mode mobile phones can receive Instant Messaging IM based telephone services such as Yahoo Messenger with Voice network Google Talk American Online AOL Instant Messenger Phoneline Service and Skype by connecting to a private WiFi access point at home or by connecting to a public WiFi access point at a hotspot. These IM based telephone services oftentimes provide alternative voice service and advanced features that complement the cellular counterpart.

As these IM based telephone services are commonly adopted by dual mode mobile phone users a new problem surfaces IM based voice calls are dropped as soon as a user is out of range of a WiFi access point or hotspot. For example in one scenario an individual lives in a neighborhood with good cellular coverage. He subscribes broadband service from the local cable company and has installed a WiFi access point for convenience. He recently purchased a dual mode mobile phone and begins using Yahoo Messenger with Voice service at home. The individual particularly enjoys chatting with his mother in Budapest using the IM based voice network Yahoo Messenger with Voice in the evening while walking his dog. Unfortunately the phone call is abruptly cut off whenever he walks beyond the coverage of his WiFi access point. The individual must make a cellular phone call to resume the conversation.

In another scenario on a typical day before heading to work another dual mode phone user enjoys having a cup of coffee at a downtown caf that provides hotspot Internet access. Usually the user uses her dual mode mobile phone to make several SKYPE phone calls over the Hotspot to start the day. In one instance the user calls a local utility company to file a complaint. After waiting minutes for a utility company customer service representative and at which time the user needs to leave for work she is connected to a customer service representative. To her dismay the SKYPE phone call is disconnected when she leaves the caf and walks to her car in the parking lot.

Therefore there is a need to provide a system and method to switch a voice call from an IM voice network to a cellular voice network.

In one aspect the present invention includes a system for switching a voice call from an IM voice network to a cellular voice network including a service gateway associated with the IM based and cellular voice networks and logic for determining the circumstances under which the voice call is switched to the cellular voice network. The service gateway is preferably adapted to receive voice calls from a call network and create call records identifying the voice calls. In one embodiment the call record includes an IM user identity a call reference and a cellular phone number.

In another aspect the present invention includes a wireless phone adapted to switch an IM based voice call to a cellular based voice call the phone preferably having an IM phone agent a cellular phone agent and a switchover agent. In one embodiment the IM phone agent processes IM based voice calls from a service gateway via an IM voice network using an IM user identity. Similarly the cellular phone agent processes cellular based voice calls from a service gateway via a cellular voice network using a cellular phone number. In a preferred embodiment the phone includes an audio module.

In another aspect the present invention includes a method of switching an IM based voice call to a cellular based voice call in which a voice call destined for a wireless phone is received in a service gateway a first call record associated with the service gateway identifying the voice call is created and an IM based voice call is established over an IM voice network with an IM phone agent associated with the wireless phone wherein information about the IM based voice call is included in the first call record. The voice call destined for the wireless phone is connected to the IM based voice call whereby at least a portion of the first call record is sent to a switchover agent associated with the wireless phone. A second call record is created which is associated with the wireless phone wherein the second call record includes at least a portion of the first call record and further information about the IM based voice call. A cellular based voice call is established including information about the cellular based voice call in the first call record the cellular based voice call is associated with the IM based voice call a signal is sent to a cellular phone agent associated with the wireless phone indicating that the cellular based voice call is for switch over purpose and the cellular based voice call is established with the service gateway.

In one embodiment the service gateway establishes the IM based voice call with the IM phone agent using an IM user identity over the IM voice network. In another embodiment the service gateway communicates with the IM phone agent using a protocol such Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions SIMPLE protocol an Extensible Messaging and Presence Protocol XMPP an IM protocol based on Open System for Communication in Realtime OSCAR or a proprietary protocol.

In another embodiment the wireless phone includes an audio module whereby the IM based voice call is connected to the audio module by sending voice signals from the IM based voice call to the audio module and by sending voice signals from the audio module to the IM based voice call.

In another embodiment a method is provided in which the service gateway switches the voice call destined for the wireless phone from the IM based voice call to the cellular based voice call based on information about one or more of the IM based and cellular based voice calls. In another embodiment the service gateway connects the voice call destined for the wireless phone to the cellular based voice call by sending voice signals from the voice call destined for the wireless phone to the cellular based voice call and by sending voice signals from the cellular based voice call to the voice call destined for the wireless phone. In another embodiment the service gateway disconnects the voice call destined for the wireless phone from the IM based voice call by not sending voice signals from the voice call destined for the wireless phone to the IM based voice call and by not sending voice signals from the IM based voice call to the voice call destined for the wireless phone.

In another embodiment the service gateway sends a switchover command having a call reference to the switchover agent. The service gateway may send the switch over command to the switchover agent via a messaging service such as a Short Message Service a Multimedia Messaging Service or an Instant Messaging service or via the IM based voice call or via the cellular based voice call.

In yet another embodiment the switchover agent may request a user of the wireless phone whether the user wishes to switch from the IM based voice call to the cellular based voice call.

In still another embodiment a method of the present invention can include monitoring of the voice quality of at least one of the IM based voice call and the cellular based voice call and determining whether to switch the voice call destined for the wireless phone based on attributes of voice quality.

In another embodiment a method of the present invention may include the wireless phone establishing a cellular based voice call to the service gateway after establishing an IM based voice call.

In the following description for the purposes of explanation specific numbers materials and configurations are set forth in order to provide a thorough understanding of the invention. It will be apparent however to a person of ordinary skill in the art that these specific details are merely exemplary embodiments of the invention. In some instances well known features may be omitted or simplified so as not to obscure the present invention. Furthermore reference in the specification to one embodiment or an embodiment is not meant to limit the scope of the invention but instead merely provides an example of a particular feature structure or characteristic of the invention described in connection with the embodiment. Insofar as various embodiments are described herein the appearances of the phase in an embodiment in various places in the specification are not meant to refer to a single or same embodiment.

With reference to the drawings wherein like numerals indicate like elements there is shown in in accordance with at least one embodiment a simplified block diagram depicting a system for switching over a voice call from an Instant Messaging voice network to a cellular voice network. A service gateway provides to a wireless phone a voice call service. As will be apparent to those having skill in the art service gateway may include any device or devices suitable to serve as a network node equipped for interfacing with another network that uses different protocols and as such may contain devices such as protocol translators impedance matching devices rate converters fault isolators or signal translators as necessary to provide system interoperability. Service gateway may comprise a protocol translation mapping gateway which interconnects networks with different network protocol technologies by performing the required protocol conversions. Service gateway may be a computer configured to perform the tasks of a gateway and or a router.

In one embodiment wireless phone connects to an IM voice network to receive the voice call service using an IM user identity . IM voice network may be selected from any suitable Instant Messaging IM based voice network such as but not limited to Yahoo Messenger with Voice network Google Talk network or American Online AOL Instant Messenger Phoneline Service network or the like. IM voice network may include Skype voice network. IM user identity is preferably any suitable identifier such as but not limited to a user name screen name or a telephone number.

In one embodiment wireless phone connects to IM voice network using a WiFi network for example a hotspot WiFi network a corporate WiFi network a municipal WiFi network or a residential WiFi network. IM voice network may include the Internet and or an Internet service provider network.

In one embodiment wireless phone connects to a cellular voice network to receive the voice call service. Wireless phone receives the voice call service using a cellular phone number . Cellular voice network includes a cellular network. Cellular voice network is preferably selected from among a Global System for Mobile Communications GSM network a Wideband Code Division Multiple Access W CDMA network a General Packet Radio Service GPRS network a Code Division Multiple Access One cdmaOne network a CDMA2000 network a third generation 3G network a CDMA 1 Evolution Data Optimized 1 EV DO network a High Speed Downlink Packet Access HSDPA network or an Enhanced Data Rates for GSM Evolution EDGE network.

Service gateway connects to a call network . Call network is preferably selected from a Public Switched Telephone network PSTN a cellular voice network or a corporate telephone network. In one embodiment call network includes an IM voice network . Service gateway processes a voice call with call network . Voice call may be selected from an IM based voice call such as a Yahoo Messenger with Voice call Google Talk voice call American Online Instant Messenger Phoneline call or Skype voice call or a public or corporate telephone call.

In one embodiment service gateway receives voice call destined for wireless phone . Service gateway establishes an IM based voice call to wireless phone over IM voice network using IM user identity . Service gateway connects voice call to voice call . After voice call is established wireless phone connects to voice call via voice call .

During voice call service gateway establishes a cellular based voice call to wireless phone over cellular voice network using cellular phone number . Voice call is related to voice call . Service gateway connects voice call to voice call . Wireless phone switches over from voice call to voice call . After the switch over is completed wireless phone connects to voice call via voice call .

Now referring to in one embodiment a voice call is established wherein wireless phone includes a switchover agent an IM phone agent and a cellular phone agent . As will be apparent to one having ordinary skill in the art the switchover agent may be or include software containing suitable programming or hardware such as a processor adapted to perform the switchover agent operations as discussed hereinbelow. Similarly IM phone agent may be or include a software program and or suitable processor for the processing of IM based voice call with service gateway . IM phone agent communicates with switchover agent over an Application Programming Interface API or an inter process communication mechanism such as an inter process function call. IM phone agent processes IM based voice call from service gateway over IM voice network using IM user identity . Likewise cellular phone agent may be or include a software program and or suitable processor for the processing of cellular based voice call with service gateway . Preferably cellular phone agent communicates with switchover agent in a similar fashion as IM phone agent . Cellular phone agent processes cellular based voice call from service gateway over cellular voice network using cellular phone number .

In one embodiment service gateway receives voice call from call network destined for wireless phone . Service gateway creates a call record which includes IM user identity cellular phone number and a call reference identifying voice call .

Service gateway establishes IM based voice call with IM phone agent using IM user identity over IM voice network . To communicate with IM phone agent service gateway uses a protocol such as but not limited to Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions SIMPLE protocol an Extensible Messaging and Presence Protocol XMPP an IM protocol based on Open System for Communication in Realtime OSCAR or a proprietary protocol. Service gateway stores information about IM based voice call in call record .

Service gateway connects voice call to IM based voice call by sending voice signals from voice call to IM based voice call and by sending voice signals from voice call to voice call .

Wireless phone preferably includes an audio module for telephony functionalities including for example a speaker and a microphone not shown . Wireless telephone connects IM based voice call to audio module by sending voice signals from voice call to audio module and by sending voice signals from audio module to IM based voice call .

During the establishment of IM based voice call service gateway sends call reference to switchover agent . Service gateway may send call reference to switchover agent in a variety of ways as will be apparent and understood to a skilled artisan such as but not limited to via IM phone agent as part of the call setup procedure for IM based voice call or in a proprietary header of a SIP INVITE message. In this latter embodiment IM phone agent extracts call reference from the SIP INVITE message and sends call reference to switchover agent . Switchover agent creates call record . Call record includes call reference and information about IM based voice call . The information about IM based voice call stored in call record at wireless phone includes transport information for the IM based voice call such as a transmitting Real time Transport Protocol User Datagram Protocol RTP UDP port and a receiving RTP UDP port at wireless phone . The information is for connecting IM based voice call to audio module for example by sending voice signals from the receiving RTP UDP port to audio module and by sending voice signals from audio module to the transmitting RTP UDP port. In one embodiment the information includes an audio codec for IM based voice call service gateway processes voice signals to and from voice call based on the audio codec.

During voice call service gateway uses cellular phone number in call record to establish cellular based voice call to cellular phone agent over cellular voice network . By way of example service gateway uses Integrated Service Digital Network User Party ISUP protocol to communicate with cellular voice network and cellular voice network uses GSM Call Control CC protocol to communicate with cellular phone agent . Service gateway stores information about voice call in call record .

Service gateway sends call reference to switchover agent when establishing voice call . Service gateway can send call reference to switchover agent in a variety of ways such as but not limited to via cellular phone agent as part of the call setup procedure for voice call or as a calling party number. In this latter embodiment service gateway sends call reference as calling party number in an ISUP Initial Address Message IAM to cellular voice network . In one embodiment cellular voice network receives call reference and sends call reference as calling party number to cellular phone agent in a GSM CC SETUP message. Cellular phone agent receives call reference and sends call reference to switchover agent .

Switchover agent receives call reference . Switchover agent retrieves call record with matching call reference . Switchover agent determines that voice call is associated with IM based voice call . Switchover agent sends a response to cellular phone agent indicating that voice call is for switch over purpose. Cellular phone agent receives response and automatically establishes voice call with service gateway . In one embodiment switchover agent does not connect voice call to audio module . Switchover agent stores information about voice call in call record . The information about voice call stored in call record at wireless phone includes transport information for the cellular based voice call such as a transmitting cellular channel and a receiving cellular channel at wireless phone . The information is for connecting voice call to voice module for example by sending voice signals from the receiving cellular channel to voice module and by sending voice signals from voice module to the transmitting cellular channel. In one embodiment the information includes an audio codec for voice call service gateway processes voice signals to and from voice call based on the audio codec.

Now referring to an embodiment of a process for switching over a voice call in accordance with one embodiment of the present invention is shown. Service gateway connects voice call to IM based voice call and is in process of switching over to cellular based voice call . A description of the switchover decision is provided in further detail hereinbelow.

Service gateway switches voice call from IM based voice call to voice call based on information about voice calls and in call record . The information about IM based voice call stored in call record at service gateway includes transport information for the IM based voice call such as a transmitting Real time Transport Protocol User Datagram Protocol RTP UDP port and a receiving RTP UDP port at service gateway . The information is for connecting IM based voice call to voice call for example by sending voice signals from the receiving RTP UDP port to voice call and by sending voice signals from voice call to the transmitting RTP UDP port. In one embodiment the information includes an audio codec for IM based voice call service gateway processes voice signals to and from voice call based on the audio codec.

The information about voice call stored in call record at service gateway includes transport information for the cellular based voice call such as a line card or a digital channel at service gateway . The information is for connecting voice call to voice call for example by sending voice signals from the line card to voice call and by sending voice signals from voice call to the line card. In one embodiment the information includes an audio codec for voice call service gateway processes voice signals to and from voice call based on the audio codec.

Service gateway connects voice call to cellular based voice call by sending voice signals from voice call to voice call and by sending voice signals from voice call to voice call . Service gateway disconnects voice call from IM based voice call by not sending voice signals from voice call to IM based voice call and by not sending voice signals from voice call to voice call .

In one embodiment service gateway sends a switch over command to switchover agent . Switch over command includes call reference . Service gateway preferably sends switch over command to switchover agent directly via a messaging service such as a Short Message Service SMS a Multimedia Messaging Service MMS or an Instant Messaging IM service. Service gateway may send switch over command via voice call or via IM based voice call .

Switchover agent receives switch over command . Switchover agent retrieves call record that matches call reference in switch over command . Switchover agent determines to switch over from IM based voice call to voice call based on information about voice calls and in call record . Switchover agent disconnects IM based voice call from audio module by not sending voice signals from voice call to audio module and by not sending voice signals from audio module to voice call . Switchover agent connects voice call to audio module by sending voice signals from voice call to audio module and by sending voice signals from audio module to voice call .

A wireless phone preferably includes an input module such as but not limited to a keypad and may include a display screen. In one embodiment after receiving switch over command switchover agent switches over based on user input. Switchover agent notifies user of wireless phone such as by displaying a textual or graphical representation of the switchover offer on the display screen to which the user may respond by inputting a response using an input module on the phone such as a keypad. Switchover agent receives an input indicating that the switchover offer has been accepted by the user and switches over. As will be apparent to those having skill in the art a switchover offer may be an audio offer to which a user can respond verbally or using an input module.

In one embodiment after receiving switchover command switchover agent monitors the voice quality of voice calls and . For example switchover agent receives voice quality of IM based voice call from IM phone agent and voice quality of voice call from cellular phone agent . In another example switchover agent receives voice quality of IM based voice call from IM voice network and voice quality of voice call from cellular voice network . In yet another example switchover agent receives voice quality of voice calls and from service gateway . The voice quality can be measured using an attribute indicative of radio signal strength such as but not limited to voice quality measured using dropped packet rate dynamic jitter buffer depth or the like. In another embodiment switchover agent makes the decision to switch over the call based on a determination that the voice quality of voice call is better than the voice quality of IM based voice call and switches over. In one embodiment switchover agent determines that the voice quality of IM based voice call is below an acceptable threshold and switches over.

In one embodiment service gateway may establish voice call based on specific criteria such as when service gateway determines that wireless phone is under coverage of cellular voice network . In another embodiment service gateway establishes voice call when service gateway determines that the voice quality of IM based voice call is below an acceptable threshold.

In another embodiment after establishing IM based voice call wireless phone establishes voice call to service gateway .

In one embodiment wireless phone makes an outgoing call using IM based voice service. The outgoing call includes an IM based voice call between service gateway and wireless phone . Service gateway establishes a cellular based voice call with wireless phone so that service gateway can switch over from the IM based voice call to the cellular based voice call .

Although the invention herein has been described with reference to particular embodiments it is to be understood that these embodiments are merely illustrative of the principles and applications of the present invention. It is therefore to be understood that numerous modifications may be made to the illustrative embodiments and that other arrangements may be devised without departing from the spirit and scope of the present invention as defined by the appended claims.

