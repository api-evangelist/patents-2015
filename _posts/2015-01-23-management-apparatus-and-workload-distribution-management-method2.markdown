---

title: Management apparatus and workload distribution management method
abstract: A management apparatus deploys, when loads of one or more first virtual machines deployed on a first system satisfy a first load condition, one or more second virtual machines on a second system, and distributes processing of a business operation across the first and second virtual machines. The management apparatus allows a different second virtual machine to be added to the second system when, after the second virtual machines are deployed, the loads of the first virtual machines satisfy the first load condition and loads of the second virtual machines satisfy a second load condition. The management apparatus restricts the addition of the different second virtual machine to the second system when, after the second virtual machines are deployed, the loads of the first virtual machines satisfy the first load condition but the loads of the second virtual machines do not satisfy the second load condition.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09588789&OS=09588789&RS=09588789
owner: FUJITSU LIMITED
number: 09588789
owner_city: Kawasaki
owner_country: JP
publication_date: 20150123
---
This application is based upon and claims the benefit of priority of the prior Japanese Patent Application No. 2014 029801 filed on Feb. 19 2014 the entire contents of which are incorporated herein by reference.

The embodiments discussed herein are related to a management apparatus and a workload distribution management method.

Cloud computing has been proposed as one way to utilize computer resources in recent years. In cloud computing a user accesses a computer owned by a third party via a network and uses resources of the computer to conduct desired information processing instead of outfitting a user s personal computer with resources needed for the desired information processing. A cloud system implementing cloud computing provides resources for users as services. It is often the case that a cloud system is implemented as a virtualization system allowing a plurality of virtual computers sometimes referred to as virtual machines or logic machines to be deployed so as to flexibly allocate resources to a number of users.

Cloud computing is sometimes classified into three types of cloud services private public and hybrid in terms of the degree of resource sharing. In a private cloud a single organization solely owns the cloud system and users of the organization for example users of various departments use the cloud system sharing the resources. In a public cloud a service provider owns the cloud system and a large indefinite number of users use the cloud system via a wide area network. Public cloud services are offered to users for example by charging on a pay as you go basis i.e. charges are proportional to the usage such as the number of virtual machines used the amount of allocated resources or the duration of use based upon agreement between each user and the service provider. A hybrid cloud is a cloud computing environment where private and public cloud systems cooperate with each other.

In connection with hybrid cloud computing a load balancer has been proposed which distributes work across internal servers in an enterprise network and cloud servers in a cloud network residing outside the enterprise network. The load balancer transfers requests from users to the internal servers while the loads placed on the internal servers are low and transfers requests from users to cloud servers only when the loads on the internal servers are high. This helps the enterprise avoid capital expenditure on extra resources to deal with peak processing demand thus reducing the cost of establishing and maintaining the internal servers. Note that there is also proposed a management server for migrating a virtual machine among a plurality of data centers. The management server calculates the degree of connectivity among a plurality of virtual machines from the volume of communication and the response speed among the virtual machines and selects a virtual machine to be migrated according to the calculated degree of connectivity.

An application of cloud computing is considered herein where virtual machines deployed on system 1 are caused to process one particular business operation and additional virtual machines are deployed on system 2 when the workloads placed on the virtual machines of system 1 become high to thereby distribute the processing of the particular business operation across the virtual machines in systems 1 and 2. For example system 1 may be implemented as a private cloud system while system 2 may be implemented as a public cloud system. In this case in response to an increase in the loads on the virtual machines of system 1 additional virtual machines may be deployed on system 2 in anticipation of reducing the load of each virtual machine.

However system 1 may also include virtual machines engaging in a different business operation for example virtual machines used by a different department within the same company other than the virtual machines in charge of the particular business operation above. When unused resources in the virtual machines dedicated to the particular business operation have increased resources allocated to the virtual machines may be reduced by reallocating some of the resources to the virtual machines engaging in the different business operation. In this case even if one or more virtual machines are added to system 2 for the particular business operation the loads on the virtual machines in system 1 appear to still remain high. Thus determining the addition of virtual machines to system 2 based only on the loads on the virtual machines in system 1 may lead to the deployment of an excessive number of virtual machines.

According to one embodiment there is provided a management apparatus including a communicating unit that acquires information indicating loads of one or more first virtual machines deployed on a first system and acquire when one or more second virtual machines are deployed on a second system information indicating loads of the second virtual machines and a processor that performs a procedure including deploying when the loads of the first virtual machines satisfy a first load condition the second virtual machines on the second system and distributing processing of a business operation across the first virtual machines and the second virtual machines and allowing a different second virtual machine to be added to the second system when after the second virtual machines are deployed the loads of the first virtual machines satisfy the first load condition and the loads of the second virtual machines satisfy a second load condition and restricting the addition of the different second virtual machine to the second system when after the second virtual machines are deployed the loads of the first virtual machines satisfy the first load condition but the loads of the second virtual machines do not satisfy the second load condition.

The object and advantages of the invention will be realized and attained by means of the elements and combinations particularly pointed out in the claims.

It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory and are not restrictive of the invention.

Several embodiments will be described below with reference to the accompanying drawings wherein like reference numerals refer to like elements throughout.

The management apparatus includes a communicating unit and a control unit . The communicating unit is a communication interface for carrying out communication with the systems and . The communicating unit may be a wire communication interface connected to a communication device such as a router or a switch by a cable or a wireless communication interface connected to a base station by a wireless link. The control unit determines the deployment of virtual machines on the systems and as described later. The control unit may include a processor which may be a central processing unit CPU or a digital signal processor DSP . In addition the processor may include an integrated circuit for particular use such as an application specific integrated circuit ASIC or a field programmable gate array FPGA . The processor is able to execute a program stored in a storage device such as random access memory RAM or a hard disk drive HDD . A set of two or more processors multiprocessor may be referred to as the processor .

The communicating unit acquires information indicating workloads of the one or more virtual machines deployed on the system . According to the first embodiment virtual machines and have been deployed on the system . In this case the communicating unit acquires information indicating workloads of the virtual machines and . In addition in the case where one or more virtual machines have been deployed on the system the communicating unit acquires information indicating workloads of the virtual machines in the system . When a virtual machine is deployed on the system as described later the communicating unit acquires information indicating workloads of the virtual machine . The information indicating workloads shows for example CPU utilization of each virtual machine. The CPU utilization of each virtual machine is the percentage of CPU resources in use for example time spent processing instructions to the total CPU resources e.g. CPU time allocated to the virtual machine.

Assume here that the virtual machines and are used to engage in the same business operation for example delivery of Web services . In the case where a plurality of virtual machines have been provided for a particular business operation the processing of the business operation is distributed over the virtual machines.

The control unit detects that the loads placed on the virtual machines and for example the average load between the virtual machines and satisfy a first load condition. Then the control unit deploys the virtual machine on the system to thereby distribute the processing of the particular business operation across the virtual machines and . For the distribution of the business operation processing a load balancer may be employed. This is expected to lead to a reduction in the loads of the virtual machines and . The first load condition is for example that the loads of the virtual machine and have reached or exceeded a first threshold. In other words when the loads of the virtual machines and have increased to high levels the control unit deploys the virtual machine on the system to distribute the increased loads.

After the deployment of the virtual machine the control unit may detect that the loads of the virtual machines and satisfy the first load condition and the loads of the virtual machine satisfy a second load condition. In that case the control unit allows addition of a virtual machine to the system . When the virtual machine is added the business operation processing is distributed across the virtual machines and . This is expected to lead to a reduction in the loads of the virtual machines and . The second load condition is for example that the loads of the virtual machine have reached or exceeded a second threshold. In other words when all the virtual machines and are placed under high loads the control unit adds the virtual machine to the system to provide further load reduction.

On the other hand after the deployment of the virtual machine the control unit may detect that the loads of the virtual machines and satisfy the first load condition but the loads of the virtual machine do not satisfy the second load condition. In that case the control unit restricts adding the virtual machine to the system . When the loads of the virtual machine in the system are low the loads of the virtual machines and in the system possibly remain high due to a cause other than the business operation in which the virtual machines and engage. Therefore the control unit determines that the addition of the virtual machine to the system is not expected to reduce the loads of the virtual machines and

One possible cause that the loads of only the virtual machines and among the virtual machines and remain high is that virtual machines used to engage in a different business operation have been deployed on the system . If load distribution has resulted in an increase in unused resources for example unused CPU resources of the virtual machines and resources having been allocated to the virtual machines and may be reduced by reallocating some of the resources to the virtual machines engaging in the different business operation. Then the resource utilization e.g. CPU utilization of the virtual machines and is calculated to be high and therefore the loads of the virtual machines and appear to remain high. In this case even if the virtual machine is added to the system the resource utilization of the virtual machines and is not expected to be reduced.

In view of the above the management apparatus restricts the addition of the virtual machine to the system . Note that the control unit implements appropriate load balancing to increase the amount of the business operation processing assigned to the virtual machine while decreasing the amount of the operation processing assigned to each of the virtual machines and to thereby prevent a drop in response performance even when the loads of the virtual machines and remain high. In the case where the loads of the virtual machines and satisfy the first load condition but the loads of the virtual machine do not satisfy the second load condition as described above the control unit may transfer at least a part of the virtual machines and deployed on the system to the system .

According to the management apparatus of the first embodiment in the case where the loads of the virtual machines and satisfy the first load condition and the loads of the virtual machine satisfy the second load condition the virtual machine is allowed to be added to the system . On the other hand when the loads of the virtual machines and satisfy the first load condition but the loads of the virtual machine do not satisfy the second load condition the addition of the virtual machine to the system is restricted. Herewith compared to the case of determining whether to add the virtual machine based only on the loads of the virtual machines and the addition of the virtual machine is restricted in situations where the loads of the virtual machines and are not expected to be reduced thus preventing the excessive virtual machine deployment on the system . As a result in the case of being charged in the proportion of the use of the system pay as you go system it is possible to prevent an increase in charges due to the unnecessary deployment of an additional virtual machine.

The private management server is a server computer for managing the private cloud . The private management server provides the clients and with user interfaces used to set up virtual machines to be deployed on the business servers and . In response to a request from each of the clients and or the management server the private management server starts or stops a virtual machine on the business server or . In addition the private management server monitors the loads of virtual machines operating on the business servers and .

The public management server is a server computer for managing the public cloud . The public management server provides the clients and with user interfaces used to set up virtual machines to be deployed on the business servers and . In response to a request from each of the clients and or the management server the public management server starts or stops a virtual machine on the business server or . In addition the public management server monitors the loads of virtual machines operating on the business servers and .

Note that the public management server is usually provided by a service provider. The public management server provides the clients and and the management server with a graphical user interface GUI or an application programming interface API . Via the GUI or API each user indirectly uses the public management server . The public management server is sometimes referred to as the cloud portal.

The clients and are client computers or terminal devices operated by users. The clients and may be used by users engaging in different business operations for example users belonging to different departments within the company . To deploy a virtual machine on the private cloud and cause the virtual machine to process a business operation the client accesses the private management server . On the other hand to explicitly deploy a virtual machine on the public cloud and cause the virtual machine to process the business operation the client accesses the public management server .

Note however that when having used the system of the public cloud the company is charged on a pay as you go basis according to the usage such as the number of virtual machines the amount of allocated resources or the duration of use. On the other hand the use of the system of the private cloud does not incur such pay as you go charges. Therefore the client usually accesses the private management server to preferentially use the system of the private cloud . In the case where the private cloud temporarily runs out of resources load distribution is implemented automatically by using resources of the public cloud as described later. The client need not be aware of the automatic load distribution.

The business servers to are server computers capable of causing a plurality of virtual machines to operate. According to an instruction from the private management server the business server allocates resources such as CPU time and a RAM area to a virtual machine and then starts the virtual machine. In addition the business server stops a virtual machine according to an instruction from the private management server . According to an instruction from the public management server the business server allocates resources to a virtual machine and then starts the virtual machine. In addition the business server stops a virtual machine according to an instruction from the public management server .

The management server is a server computer for managing a hybrid cloud. The management server adjusts operation by operation the number of virtual machines to be deployed on the private cloud and the public cloud . In the case of deploying a virtual machine on the private cloud the management server instructs the private management server to start the virtual machine. On the other hand in the case of deploying a virtual machine on the public cloud the management server instructs the public management server to start the virtual machine.

In order to adjust the number of virtual machines the management server acquires from the private management server information indicating the workload on each virtual machine mainly the CPU utilization in the second embodiment . When the loads on virtual machines engaging in a particular business operation in the private cloud are high the management server adds one or more virtual machines to the private cloud until the number of virtual machines reaches an upper limit predetermined for the business operation. If the loads of virtual machines in the private cloud remain still high even though the number of the virtual machines has reached the upper limit the management server deploys a virtual machine to engage in the particular business operation on the public cloud . In order to add a virtual machine to the public cloud the management server acquires information indicating the load on each virtual machine from the public management server and takes account of both the loads in the private cloud and those in the public cloud as described later.

The CPU is a processor including a computing circuit for carrying out program instructions. The CPU loads at least part of a program and data stored in the HDD into the RAM to execute the program. Note that the CPU may include a plurality of processor cores and the management server may include a plurality of processors and processes to be described later may be executed in parallel using the plurality of processors or processor cores. In addition a set of a plurality of processors multiprocessor may be referred to as the processor .

The RAM is a volatile memory for temporarily storing therein programs to be executed by the CPU and data to be used by the CPU for its computation. Note that the management server may be provided with a different type of memory other than RAM or may be provided with a plurality of memory devices.

The HDD is a nonvolatile storage device to store therein software programs such as an operating system OS middleware and application software and various types of data. Note that the management server may be provided with a different type of storage device such as a flash memory or a solid state drive SDD or may be provided with a plurality of non volatile storage devices.

The image signal processing unit outputs an image on a display connected to the management server according to an instruction from the CPU . Various types of displays including the following may be used as the display a cathode ray tube CRT display a liquid crystal display LCD a plasma display panel PDP and an organic electro luminescence OEL display.

The input signal processing unit acquires an input signal from an input device connected to the management server and sends the input signal to the CPU . Various types of input devices including the following may be used as the input device a pointing device such as a mouse touch panel touch pad or trackball a keyboard a remote controller and a button switch. In addition the management server may be provided with a plurality of types of input devices.

The media reader is a reader for reading programs and data recorded in a storage medium . As the storage medium any of the following may be used a magnetic disk such as a flexible disk FD or HDD an optical disk such as a compact disc CD or digital versatile disc DVD a magneto optical disk MO and a semiconductor memory. The media reader stores programs and data read from the storage medium for example in the RAM or the HDD .

The communication interface is connected to the network and communicates with a different computer for example the private management server via the network . The communication interface may be a wired communication interface connected via a cable to a communication apparatus or a wireless communication interface connected via wireless links to a base station.

Note that the management server may not be provided with the media reader and further may not be provided with the image signal processing unit and the input signal processing unit in the case where these units are controllable from a terminal operated by a user. In addition the display and the input device may be integrally provided on the chassis of the management server . The private management server the public management server the clients and and the business servers to may individually have the same hardware configuration as the management server .

In the case where a plurality of Web servers are deployed HTTP requests sent from the client computers are distributed across the Web servers by a load balancer. According to the second embodiment one each of a load balancer and database server are prepared and located in the private cloud . Locating the database server in the private cloud reduces the risk of data leakage and loss compared to locating it in the public cloud . On the other hand the number of paired Web and application servers increases or decreases according to the loads and such paired Web and application servers are located only in the private cloud or in both the private cloud and the public cloud .

For example the business server runs a hypervisor the business server runs a hypervisor the business server runs a hypervisor and the business server runs a hypervisor . Each of the hypervisors and is middleware to allocate resources of the corresponding business server to virtual machines. Virtual machines to run on the hypervisor virtual machine runs on the hypervisor virtual machines and run on the hypervisor and virtual machines and run on the hypervisor . The virtual machine runs the load balancer each of the virtual machines and runs a Web server each of the virtual machines and runs an application server and the virtual machine runs the database server.

In this case the load balancer on the virtual machine distributes HTTP requests received from the client computers across the virtual machines and . The Web server on the virtual machine accesses the virtual machine the Web server on the virtual machine accesses the virtual machine and the Web server on the virtual machine accesses the virtual machine . Each of the application servers on the virtual machines and executes business logic in response to a request from the corresponding Web server and accesses the virtual machine in the business logic. The database server on the virtual machine carries out data searches and updates according to requests from the application servers.

The application server on the virtual machine transmits the result of the business logic to the virtual machine the application server on the virtual machine transmits the result of the business logic to the virtual machine and the application server on the virtual machine transmits the result of the business logic to the virtual machine . Each of the Web servers on the virtual machines and generates an HTTP response from the received business logic result and then transmits the HTTP response to the virtual machine . The load balancer on the virtual machine transfers the HTTP response to a corresponding client computer. Note that the load balancer monitors the number of HTTP requests being processed by each Web server to thereby estimate the load on the Web server and transfers HTTP requests preferentially to Web servers with low loads.

Next described is load distribution achieved by starting a plurality of paired Web and application servers. is a first diagram illustrating an example of starting and stopping server applications. Assume here that a load balancer a Web server and an application server are running in the private cloud . In addition assume that as for the business operation of providing Web services the number of virtual machines deployed on the private cloud has yet to reach the upper limit.

The management server detects that the loads on virtual machines used to run the Web server and the application server are high. For example the management server detects that the average CPU utilization of the two virtual machines is equal to or more than a threshold. Then the management server instructs the private management server to add virtual machines. The private management server starts a virtual machine to run a Web server and a virtual machine to run an application server in the private cloud . In addition the management server sets the load balancer to distribute HTTP requests also to the Web server

Whether the resources are insufficient or not may be determined for example based on the loads on the virtual machines used to run the Web servers and and the application servers and located in the private cloud . In many cases adding virtual machines to the public cloud is expected to reduce the load on each virtual machine and therefore reduce the loads on the virtual machines deployed on the private cloud . However as described below there is a case where addition of virtual machines does not result in reducing the loads on the virtual machines in the private cloud . In such a case determining the addition of virtual machines based only on the loads of the virtual machines in the private cloud may lead to the deployment of an excessive number of virtual machines.

When the CPU utilization of the virtual machine engaging in Operation A has increased to 80 for example the private management server adds a virtual machine to be used for Operation A to the private cloud and then allocates resources of the CPU to the added virtual machine. Herewith the CPU utilization of each of the two virtual machines for Operation A is reduced to 40 .

With the reduction in the allocation the CPU utilization of the virtual machines engaged on Operation A in the private cloud is calculated to be 60 or more. Then for example the public management server adds a virtual machine to be used for Operation A to the public cloud and allocates resources of the CPU to the added virtual machine. Herewith the CPU utilization of each of the virtual machines engaged on Operation A in the private cloud is reduced to 50 .

However when the entire system of the private cloud is short of resources the allocation of CPU resources to the Operation A virtual machines may be further reduced with the reduction in the CPU utilization. Thus there is a case where even if a virtual machine to be engaged on Operation A is added to the public cloud the loads on the Operation A virtual machines in the private cloud are not reduced and remain high. In view of this according to the second embodiment the management server determines whether the loads on the virtual machines deployed on the private cloud are expected to be reduced by referring also to the loads on the virtual machines deployed on the public cloud . In the case where the loads are not expected to be reduced the management server restricts increasing the total number of virtual machines.

Subsequently the management server instructs the private management server to reduce the number of virtual machines. The private management server stops the virtual machines used to run the Web server and the application server . In addition the management server instructs the public management server to add virtual machines. The public management server starts a virtual machine to run a Web server and a virtual machine to run an application server in the public cloud . Further the management server sets the load balancer to stop distributing HTTP requests to the Web server and start distributing HTTP requests to the Web server . With this virtual machine migration from the private cloud to the public cloud is practically achieved.

Therefore the management server does not increase the total number of virtual machines as in the case of . In addition since only the minimum number of virtual machines for providing Web services has been deployed on the private cloud the management server does not migrate virtual machines from the private cloud to the public cloud . Maintaining in the private cloud the lower limit of the number of virtual machines set for each business operation allows processing of the business operation to be continued even if the system of the public cloud abnormally stops. As a result in this case the management server need not either migrate or add virtual machines.

That is the management server instructs the public management server to reduce the number of virtual machines. The public management server stops the virtual machines used to run the Web server and the application server . In addition the management server instructs the private management server to add virtual machines. The private management server starts a virtual machine to run the Web server and a virtual machine to run the application server in the private cloud . In addition the management server sets the load balancer to stop distributing HTTP requests to the Web server and start distributing HTTP requests to the Web server . Virtual machine migration from the public cloud to the private cloud may be continued until the number of virtual machines deployed on the private cloud reaches the upper limit.

Subsequently the management server detects that the CPU utilization of the virtual machines engaged on Operation A in the public cloud is low 40 while that of the virtual machines engaged on Operation A in the private cloud is 60 or more. Therefore the management server determines that the loads in the private cloud are not reduced by increasing the number of virtual machines to be used for Operation A and thus restricts increasing the number of virtual machines to be used for Operation A.

Instead the management server determines to migrate a virtual machine from the private cloud to the public cloud . The private management server releases resources of the CPU and stops one virtual machine engaged on Operation A. The public management server adds a virtual machine to be used for Operation A to the public cloud and allocates resources of the CPU to the added virtual machine. In the private cloud unallocated CPU resources are created due to the stop of one virtual machine and thus the allocation of CPU resources to the remaining virtual machine engaged on Operation A is expected to be increased.

Note that when the entire system of the private cloud is short of resources migration of virtual machines from the private cloud to the public cloud as in the case above may take place for each of a plurality of business operations. As a result it is expected that the allocation of CPU resources to virtual machines remaining in the private cloud be not reduced and therefore the loads on the virtual machines are reduced not remaining high. According to the second embodiment the lower limit of the number of virtual machines are maintained for each business operation however all virtual machines engaged on a particular business operation may be removed from the private cloud i.e. the lower limit of the number for the business operation is zero .

Next described is load distribution control exercised by the management server . is a block diagram illustrating an example of a software configuration of the management server. The management server includes a parameter setting unit a control information storing unit a load information acquiring unit a deployment determining unit a start and stop instructing unit and a load balancer setting unit . The control information storing unit is implemented as a storage area for example provided in the RAM or the HDD . The parameter setting unit the load information acquiring unit the deployment determining unit the start and stop instructing unit and the load balancer setting unit are implemented for example as modules of a program executed by the CPU .

The parameter setting unit acquires values of parameters input by a user using the input device and stores the acquired parameter values in the control information storing unit as control information. The parameter values are used for control of virtual machine deployment exercised by the deployment determining unit and include the upper limit of the number of virtual machines deployed on the private cloud as described later.

The control information storing unit stores therein the control information used by the deployment determining unit to exercise control over the deployment of virtual machines. As described above the control information includes the parameter values acquired from the user by the parameter setting unit . In addition the control information includes information indicating the state of deployment of virtual machines on the private cloud and the public cloud .

The load information acquiring unit periodically acquires from the private management server load information indicating workload on each of the virtual machines running on the business servers and . For example the CPU utilization which is the percentage of CPU time consumed by a virtual machine for its processing to the total CPU time allocated to the virtual machine is used as an index to indicate workload. As the workload on each virtual machine either instantaneous load or average load over the most recent predetermined time period may be used. The load information acquiring unit calculates as loads associated with each business operation in the private cloud private load the average load of virtual machines engaged on the business operation. In addition in response to a request from the deployment determining unit the load information acquiring unit acquires from the public management server load information indicating workload on each of the virtual machines running on the business servers and . The load information acquiring unit calculates as load associated with each business operation in the public cloud public loads the average load of virtual machines engaged on the business operation.

The deployment determining unit dynamically scales in and out virtual machines engaged on each business operation so that the processing of the business operation is appropriately distributed across a plurality of virtual machines. Scale out is to increase the number of virtual machines to thereby expand the operation processing ability while scale in is to decrease the number of virtual machines to thereby shrink the operation processing ability. The deployment determining unit periodically checks on the private load and determines to start or stop virtual machines running on the business servers to according to the private load. As a general rule virtual machines are deployed preferentially on the business servers and and then when the number of virtual machines in the private cloud has reached the upper limit virtual machines are deployed on the business servers and . Note however that the deployment determining unit may restrict addition of virtual machines to the business servers and according to the public load.

When start or stop of virtual machines on the business servers and has been determined the start and stop instructing unit instructs the private management server to start or stop the virtual machines in response to a request from the deployment determining unit . In addition when start or stop of virtual machines on the business servers and is determined the start and stop instructing unit instructs the public management server to start or stop the virtual machines in response to a request from the deployment determining unit .

When start or stop of virtual machines on the business servers to is determined the load balancer setting unit updates setting information held by the load balancer in response to a request from the deployment determining unit . The setting information of the load balancer includes for example a list of addresses of virtual machines for example Internet Protocol IP addresses to run server applications across which HTTP requests are distributed. For example the load balancer setting unit adds the address of a virtual machine to the list when the virtual machine is started and deletes the address of a virtual machine from the list when the virtual machine is stopped.

The private min parameter indicates the lower limit of the number of virtual machines deployed on the private cloud for the particular business operation. The private limit parameter indicates the upper limit of the number of virtual machines allowed to be deployed in the private cloud for the particular business operation. The private vms parameter indicates the number of virtual machines currently deployed on the private cloud for the particular business operation. The public limit parameter indicates the upper limit of the number of virtual machines allowed to be deployed on the public cloud for the particular business operation. The public vms parameter indicates the number of virtual machines currently deployed on the public cloud for the particular business operation. The values of private min private limit and public limit are designated by the user.

The private loadTh parameter indicates the threshold used to determine whether the loads of virtual machines deployed on the private cloud i.e. the private load for the particular business operation are high. The public loadTh parameter indicates the threshold used to determine whether the loads of virtual machines deployed on the public cloud the public load for the particular business operation are high. The values of private loadTh and public loadTh are designated by the user.

Each field in the virtual machine name column contains the identification information for identifying a virtual machine. The identification information may be a host name given to the virtual machine or an address for example an IP address assigned to the virtual machine. Each field in the deployment zone column contains the information indicating one of the business servers and in the private cloud and the business servers and in the public cloud on which the corresponding virtual machine is deployed. For example private or public is registered in each field of the deployment zone column.

Next described are algorithms used to determine whether to start or stop virtual machines. illustrates an example of criteria for virtual machine deployment. In a migrating flag being set to YES 1 indicates that addition of virtual machines to the public cloud has been restricted and there are virtual machines having been migrated from the private cloud to the public cloud . On the other hand the migrating flag being set to NO 0 indicates that there is no virtual machine having been migrated from the private cloud to the public cloud including the case where migrated virtual machines have all been returned to the private cloud .

 1 When the private load is high the number of virtual machines in the private cloud has not reached the upper limit and the migrating flag is set to NO one or more virtual machines are added to the private cloud .

 2 When the private load is high the number of virtual machines in the private cloud is at the upper limit the migrating flag is set to NO and the number of virtual machines in the public cloud is zero one or more virtual machines are added to the public cloud .

 3 When the private load is high the number of virtual machines in the private cloud is at the upper limit the migrating flag is set to NO the number of virtual machines in the public cloud is one or more and the public load is high one or more virtual machines are added to the public cloud .

 4 When the private load is high the number of virtual machines in the private cloud is at the upper limit the migrating flag is set to NO the number of virtual machines in the public cloud is one or more and the public load is low one or more virtual machines are migrated from the private cloud to the public cloud . With this the migrating flag is updated to YES.

 5 When the private load is high the number of virtual machines in the private cloud is not at the lower limit the migrating flag is set to YES and the public load is low one or more virtual machines are migrated from the private cloud to the public cloud .

 6 When the private load is high the number of virtual machines in the private cloud is at the lower limit the migrating flag is set to YES and the public load is low no action needs to be taken.

 7 When the private load is high the migrating flag is set to YES and the public load is high one or more virtual machines are added to the public cloud .

 8 When the private load is low and the migrating flag is set to YES one or more virtual machines are migrated from the public cloud to the private cloud . If the migration causes the number of virtual machines in the private cloud to reach the upper limit the migrating flag is updated to NO.

 9 When the private load is low the migrating flag is set to NO and the number of virtual machines in the public cloud is one or more the number of virtual machines in the public cloud is cut back.

 10 When the private load is low the number of virtual machines in the private cloud is not at the lower limit the migrating flag is set to NO and the number of virtual machines in the public cloud is zero the number of virtual machines in the private cloud is cut back.

 11 When the private load is low the number of virtual machines in the private cloud is at the lower limit the migrating flag is set to NO and the number of virtual machines in the public cloud is zero no action needs to be taken.

 Step S The load information acquiring unit acquires from the private management server load information indicating the load for example the CPU utilization on each virtual machine in the private cloud . As the load on each virtual machine either instantaneous load or average load over the most recent predetermined time period may be used. Based on the acquired load information the load information acquiring unit calculates the average load for example the average CPU utilization among a plurality of virtual machines engaged on the particular business operation as the private load.

 Step S The deployment determining unit reads the registered load threshold private loadTh of the private cloud from the load determination table and determines whether the private load is equal to or more than private loadTh. If the condition is satisfied the process proceeds to step S. If not the process proceeds to step S.

 Step S The deployment determining unit determines whether the migrating flag is set to YES or a value of 1 . If the migrating flag is set to YES the process proceeds to step S. If the migrating flag is set to NO the process proceeds to step S. Note that the migrating flag may be held by the deployment determining unit or registered in a table stored in the control information storing unit .

 Step S The deployment determining unit reads the deployment number of virtual machines associated with the private cloud private vms and the upper limit associated with the private cloud private limit from the virtual machine number table . Subsequently the deployment determining unit determines whether private vms has reached private limit. If the condition is satisfied the process proceeds to step S. If not the process proceeds to step S.

 Step S The deployment determining unit determines to start one or more virtual machines in the private cloud . The number of virtual machines to be started here is the minimum unit of virtual machines assigned to process the business operation and may vary depending on the business operation. In the case of distributing workloads of Web and application servers in a three tier Web system for example two virtual machines are started. The start and stop instructing unit instructs the private management server to start the virtual machines. The private management server determines resources to be allocated to the virtual machines and then deploys the virtual machines on the business server or . Note that image data used to start the virtual machines includes operating system programs and server application programs. The image data is stored in a predetermined storage device and transferred to the business server on which the virtual machines are deployed.

 Step S The load balancer setting unit identifies a virtual machine to run a server application to which HTTP requests are distributed for example a Web server and registers the address of the virtual machine in the setting information held by the load balancer. Herewith the processing of the business operation is distributed to the virtual machines started in the private cloud .

 Step S The deployment determining unit updates the deployment number associated with the private cloud private vms registered in the virtual machine number table . At this point private vms is increased by the number of the started virtual machines. In addition the deployment determining unit registers identification information of the started virtual machines in the virtual machine deployment table . On this occasion private is set in a corresponding field within the deployment zone column. Subsequently the process ends.

 Step S The deployment determining unit reads the deployment number of virtual machines associated with the public cloud public vms from the virtual machine number table and determines whether public vms is 0. If the condition is satisfied the process proceeds to step S. If not i.e. public vms is one or more the process proceeds to step S.

 Step S The load information acquiring unit acquires from the public management server load information indicating the load for example the CPU utilization of each virtual machine in the public cloud . Based on the acquired load information the load information acquiring unit calculates the average load e.g. the average CPU utilization of a plurality of virtual machines engaged on the particular business operation as the public load.

 Step S the deployment determining unit reads the registered load threshold associated with the public cloud public loadTh from the load determination table and determines whether the public load is equal to or more than public loadTh. If the condition is satisfied the process proceeds to step S.

If not the process proceeds to step S. Step S The deployment determining unit reads the deployment number associated with the public cloud public vms and the upper limit associated with the public cloud public limit from the virtual machine number table . Subsequently the deployment determining unit determines whether public vms has reached public limit. If the condition is satisfied the process ends with no change to the current deployment of virtual machines. If not the process proceeds to step S.

 Step S The deployment determining unit determines to start one or more virtual machines in the public cloud . In the case of distributing workloads of Web and application servers in a three tier Web system for example two virtual machines are started. The start and stop instructing unit instructs the public management server to start the virtual machines. The public management server determines resources to be allocated to the virtual machines and then deploys the virtual machines on the business server or .

 Step S The load balancer setting unit identifies a virtual machine to run a server application to which HTTP requests are distributed for example a Web server and registers the address of the virtual machine in the setting information held by the load balancer.

 Step S The deployment determining unit updates the deployment number associated with the public cloud public vms registered in the virtual machine number table . At this point public vms is increased by the number of the started virtual machines. In addition the deployment determining unit registers identification information of the started virtual machines in the virtual machine deployment table . On this occasion public is set in a corresponding field within the deployment zone column. Subsequently the process ends.

 Step S The deployment determining unit reads from the virtual machine number table the deployment number associated with the private cloud private vms and the lower limit associated with the private cloud private min . Then the deployment determining unit determines whether private vms matches private min. If the condition is satisfied the process ends with no change to the current deployment of virtual machines. If not the process proceeds to step S.

 Step S The deployment determining unit determines to start one or more virtual machines in the public cloud . In the case of distributing workloads of Web and application servers in a three tier Web system for example two virtual machines are started. The start and stop instructing unit instructs the public management server to start the virtual machines. The public management server determines resources to be allocated to the virtual machines and then deploys the virtual machines on the business server or .

 Step S The load balancer setting unit identifies a virtual machine to run a server application to which HTTP requests are distributed for example a Web server and registers the address of the virtual machine in the setting information held by the load balancer.

 Step S The deployment determining unit updates the deployment number associated with the public cloud public vms registered in the virtual machine number table . At this point public vms is increased by the number of the started virtual machines. In addition the deployment determining unit registers identification information of the started virtual machines in the virtual machine deployment table . On this occasion public is set in a corresponding field within the deployment zone column.

 Step S The deployment determining unit determines to stop one or more virtual machines in the private cloud . The number of virtual machines to be stopped here is the minimum unit of virtual machines assigned to process the business operation and is the same number of virtual machines started in step S. The virtual machines to be stopped may be randomly selected from virtual machines running in the private cloud . The load balancer setting unit identifies a virtual machine running a server application to which HTTP requests are distributed for example a Web server and to be stopped and deletes the address of the virtual machine from the setting information held by the load balancer.

 Step S The start and stop instructing unit instructs the private management server to stop the virtual machines. The private management server causes the operating systems of the designated virtual machines to be shut down and releases resources having been allocated to the stopped virtual machines.

 Step S The deployment determining unit updates the deployment number associated with the private cloud private vms registered in the virtual machine number table . At this point private vms is reduced by the number of the stopped virtual machines. In addition the deployment determining unit deletes identification information of the stopped virtual machines from the virtual machine deployment table .

 Step S The deployment determining unit sets the migrating flag to YES or a value of 1 . As a result of steps S to virtual machine migration from the private cloud to the public cloud is achieved. Subsequently the process ends.

 Step S The deployment determining unit determines whether the migrating flag is set to YES or a value of 1 . If the migrating flag is set to YES the process proceeds to step S. If the migrating flag is set to NO the process proceeds to step S.

 Step S The deployment determining unit determines to start one or more virtual machines in the private cloud . In the case of distributing workloads of Web and application servers in a three tier Web system for example two virtual machines are started. The start and stop instructing unit instructs the private management server to start the virtual machines. The private management server determines resources to be allocated to the virtual machines and then deploys the virtual machines on the business server or .

 Step S The load balancer setting unit identifies a virtual machine to run a server application to which HTTP requests are distributed for example a Web server and registers the address of the virtual machine in the setting information held by the load balancer.

 Step S The deployment determining unit updates the deployment number associated with the private cloud private vms registered in the virtual machine number table . At this point private vms is increased by the number of the started virtual machines. In addition the deployment determining unit registers identification information of the started virtual machines in the virtual machine deployment table . On this occasion private is set in a corresponding field within the deployment zone column.

 Step S The deployment determining unit determines to stop one or more virtual machines in the public cloud . The number of virtual machines to be stopped here is the minimum unit of virtual machines assigned to process the business operation and is the same number of virtual machines started in step S. The virtual machines to be stopped may be randomly selected from virtual machines running in the public cloud . The load balancer setting unit identifies a virtual machine running a server application to which HTTP requests are distributed for example a Web server and to be stopped and deletes the address of the virtual machine from the setting information held by the load balancer.

 Step S The start and stop instructing unit instructs the public management server to stop the virtual machines. The public management server causes the operating systems of the designated virtual machines to be shut down and releases resources having been allocated to the stopped virtual machines.

 Step S The deployment determining unit updates the deployment number associated with the public cloud public vms registered in the virtual machine number table . At this point public vms is reduced by the number of the stopped virtual machines. In addition the deployment determining unit deletes identification information of the stopped virtual machines from the virtual machine deployment table .

 Step S The deployment determining unit reads the deployment number associated with the private cloud private vms and the upper limit associated with the private cloud private limit from the virtual machine number table . Subsequently the deployment determining unit determines whether private vms has reached private limit. If the condition is satisfied the process proceeds to step S. If not the process ends.

 Step S The deployment determining unit sets the migrating flag to NO or a value of 0 . As a result of steps S to virtual machine migration from the public cloud to the private cloud is achieved. Subsequently the process ends.

 Step S The deployment determining unit reads the deployment number associated with the public cloud public vms from the virtual machine number table and determines whether public vms is 0. If the condition is satisfied the process proceeds to step S. If not i.e. public vms is one or more the process proceeds to step S.

 Step S The deployment determining unit reads from the virtual machine number table the deployment number associated with the private cloud private vms and the lower limit associated with the private cloud private min . Then the deployment determining unit determines whether private vms matches private min. If the condition is satisfied the process ends. If not the process proceeds to step S.

 Step S The deployment determining unit determines to stop one or more virtual machines in the private cloud . In the case of distributing workloads of Web and application servers in a three tier Web system for example two virtual machines are stopped. The virtual machines to be stopped may be randomly selected from virtual machines running in the private cloud . The load balancer setting unit identifies a virtual machine running a server application to which HTTP requests are distributed for example a Web server and to be stopped and deletes the address of the virtual machine from the setting information held by the load balancer.

 Step S The start and stop instructing unit instructs the private management server to stop the virtual machines. The private management server causes the operating systems of the designated virtual machines to be shut down and releases resources having been allocated to the stopped virtual machines.

 Step S The deployment determining unit updates the deployment number associated with the private cloud private vms registered in the virtual machine number table . At this point private vms is reduced by the number of the stopped virtual machines. In addition the deployment determining unit deletes identification information of the stopped virtual machines from the virtual machine deployment table . Herewith the operation processing ability using a plurality of virtual machines is reduced. Subsequently the process ends.

 Step S The deployment determining unit determines to stop one or more virtual machines in the public cloud . In the case of distributing workloads of Web and application servers in a three tier Web system for example two virtual machines are stopped. The virtual machines to be stopped may be randomly selected from virtual machines running in the public cloud . The load balancer setting unit identifies a virtual machine running a server application to which HTTP requests are distributed for example a Web server and to be stopped and deletes the address of the virtual machine from the setting information held by the load balancer.

 Step S The start and stop instructing unit instructs the public management server to stop the virtual machines. The public management server causes the operating systems of the designated virtual machines to be shut down and releases resources having been allocated to the stopped virtual machines.

 Step S The deployment determining unit updates the deployment number associated with the public cloud public vms registered in the virtual machine number table . At this point public vms is reduced by the number of the stopped virtual machines. In addition the deployment determining unit deletes identification information of the stopped virtual machines from the virtual machine deployment table . Herewith the operation processing ability using a plurality of virtual machines is reduced. Subsequently the process ends.

According to the information processing system of the second embodiment in the case where the workloads on the virtual machines in the private cloud and those in the public cloud are both high it is allowed to add virtual machines to the public cloud . On the other hand in the case where the workloads on the virtual machines in the public cloud are low although those on the virtual machines in the private cloud are high adding further virtual machines to the public cloud to thereby increase the total number of virtual machines is restricted.

Herewith it is possible to prevent an excessive number of virtual machines from being deployed on the public cloud when a reduction in the workloads in the private cloud is not expected thus enabling the efficient use of resources of the public cloud . In the case of being charged on a pay as you go basis according to the usage of the resources of the public cloud it is possible to reduce charges borne by the company.

In addition while increasing the total number of virtual machines is being restricted it is possible to reduce the number of virtual machines whose loads remain high by migrating virtual machines from the private cloud to the public cloud . Further the load balancer appropriately distributes HTTP requests so as to reduce the business operation processing of virtual machines whose loads are remaining high thus controlling a delay in the response time. In addition the minimum number of virtual machines are maintained in the private cloud which allows the business operation to be continued even if the system of the public cloud becomes temporarily not available due to a failure or the like thus reducing the risk of operation suspension.

Note that the information processing of the first embodiment is implemented by causing the management apparatus to execute a program as described above. The information processing of the second embodiment is implemented by causing the private management server the public management server the clients and the business servers to and the management server to execute programs.

The program may be recorded in a computer readable storage medium for example the storage medium . Examples of such a computer readable recording medium include a magnetic disk an optical disk a magneto optical disk and a semiconductor memory. Examples of the magnetic disk are a flexible disk FD and an HDD. Examples of the optical disk are a compact disc CD CD recordable CD R CD rewritable CD RW DVD DVD R and DVD RW. The program may be recorded on portable recording media for distribution. In that case the program may be copied installed from a portable recording medium to another recording medium for example the HDD and then executed.

According to one aspect it is possible to prevent the deployment of an excessive number of virtual machines in workload distribution.

All examples and conditional language provided herein are intended for the pedagogical purposes of aiding the reader in understanding the invention and the concepts contributed by the inventor to further the art and are not to be construed as limitations to such specifically recited examples and conditions nor does the organization of such examples in the specification relate to a showing of the superiority and inferiority of the invention. Although one or more embodiments of the present invention have been described in detail it should be understood that various changes substitutions and alterations could be made hereto without departing from the spirit and scope of the invention.

