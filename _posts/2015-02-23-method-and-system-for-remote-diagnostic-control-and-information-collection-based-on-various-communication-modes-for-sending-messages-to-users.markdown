---

title: Method and system for remote diagnostic, control and information collection based on various communication modes for sending messages to users
abstract: A method, system, and program product for communicating with machines and end users connected to a network. Information sent to or from the machines is transmitted using electronic mail or a via a direct connection. The electronic mail may be transmitted over the Internet to a service center or from a service center to a resource administrator, but also may remain within a local or wide area network for transmission between a machine and an end user or a resource administrator. E-mail messages may be transmitted from a computer which is attached to a device which is being monitored or controlled and include information regarding the status, usage or capabilities of the attached device. The device may send status messages and usage information of the device by an end user to either a resource administrator or to a service center on the Internet through a firewall.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09436420&OS=09436420&RS=09436420
owner: RICOH COMPANY, LTD.
number: 09436420
owner_city: Tokyo
owner_country: JP
publication_date: 20150223
---
This application is a continuation application of U.S. application Ser. No. 13 846 329 filed Mar. 18 2013 which is a continuation Ser. No. 13 446 433 filed Apr. 13 2012 now U.S. Pat. No. 8 429 271 which is a continuation application of U.S. application Ser. No. 13 090 849 filed Apr. 20 2011 now U.S. Pat. No. 8 161 153 which is a continuation application of U.S. patent application Ser. No. 12 715 116 filed Mar. 1 2010 now U.S. Pat. No. 7 958 236 which is a continuation application of U.S. patent application Ser. No. 12 028 281 filed Feb. 8 2008 now U.S. Pat. No. 7 689 691 which is a continuation application of U.S. patent application Ser. No. 11 390 198 filed Mar. 28 2006 now U.S. Pat. No. 7 353 273 which is a continuation application of U.S. patent application Ser. No. 10 784 831 filed Feb. 24 2004 now U.S. Pat. No. 7 043 551 which is a continuation application of U.S. patent application Ser. No. 10 423 983 filed Apr. 28 2003 now U.S. Pat. No. 6 714 971 which is a continuation application of U.S. patent application Ser. No. 09 407 769 filed Sep. 29 1999 now U.S. Pat. No. 6 581 092. The entire contents of the above identified applications are incorporated herein by reference.

The present application is related to U.S. patent application Ser. No. 09 311 148 filed May 13 1999 now U.S. Pat. No. 7 131 070 entitled Application Unit Monitoring and Reporting System and Method U.S. patent application Ser. No. 09 192 583 filed Nov. 17 1998 entitled Method and System for Communicating with a Device Attached to a Computer Using Electronic Mail Messages U.S. patent application Ser. No. 08 883 492 filed Jun. 26 1997 entitled Method and System for Diagnosis and Control of Machines Using Connectionless Modes Having Delivery Monitoring and an Alternate Communication Mode U.S. patent application Ser. No. 08 820 633 filed Mar. 19 1997 entitled Method and System to Diagnose a Business Office Device Based on Operating Parameters Set by a User now U.S. Pat. No. 5 887 216 U.S. patent application Ser. No. 08 733 154 filed Oct. 16 1996 entitled Method and System for Diagnosis and Control of Machines Using Connectionless Modes of Communication now U.S. Pat. No. 5 909 493 U.S. patent application Ser. No. 08 880 683 now U.S. Pat. No. 6 330 628 filed Jun. 23 1997 U.S. patent application Ser. No. 09 107 989 now U.S. Pat. No. 6 801 331 and Ser. No. 09 108 705 both of which were filed Jul. 1 1998 all three of which are entitled Method and System for Controlling and Communicating with Machines Using Multiple Communication Formats and all three of which are divisions of U.S. patent application Ser. No. 08 7624 228 filed Mar. 29 1996 now U.S. Pat. No. 5 818 603 entitled Method and System for Controlling and Communicating with Machines Using Multiple Communication Formats U.S. patent application Ser. No. 08 738 659 now U.S. Pat. No. 6 889 263 and Ser. No. 08 738 461 now U.S. Pat. No. 6 990 952 both of which are entitled Method and System for Diagnosis and Control of Machines Using Connection and Connectionless Modes of Communication filed Oct. 30 1996 and are divisions of and U.S. patent application Ser. No. 08 916 009 entitled Method and System for Diagnosis and Control of Machines Using Connection and Connectionless Modes of Communication filed Aug. 21 1997 which is a continuation of U.S. patent application Ser. No. 08 463 002 filed Jun. 5 1995 entitled Method and System for Diagnosis and Control of Machines Using Connection and Connectionless Modes of Communication now U.S. Pat. No. 5 819 110 and U.S. patent application Ser. No. 08 852 413 filed May 7 1987 entitled Method and System for Controlling and Communicating with Business Office Devices now U.S. Pat. No. 5 774 678 which is a continuation of U.S. patent application Ser. No. 08 698 068 filed Aug. 15 1996 entitled Method and Apparatus for Controlling and Communicating With Business Office Devices now U.S. Pat. No. 5 649 120 which is a continuation of U.S. patent application Ser. No. 08 562 192 filed Nov. 22 1995 now U.S. Pat. No. 5 568 618 which is a continuation of U.S. patent application Ser. No. 08 473 780 filed Jun. 6 1995 entitled Method and Apparatus for Controlling and Communicating With Business Office Devices now U.S. Pat. No. 5 544 289 which is a continuation of U.S. patent application Ser. No. 08 426 679 filed Apr. 24 1995 now U.S. Pat. No. 5 537 554 entitled Method and Apparatus for Controlling and Communicating With Business Office Devices which is a continuation of U.S. patent application Ser. No. 08 282 168 filed Jul. 28 1994 and entitled Method and Apparatus for Controlling and Communicating With Business Office Devices now U.S. Pat. No. 5 412 779 which is a continuation of U.S. patent application Ser. No. 07 549 278 filed Jul. 6 1990 now abandoned the disclosure of each is incorporated herein by reference.

This invention generally relates to the use of network messages for communicating information to an end user regarding the usage of a network resource. The invention is more particularly related to the processing performed within a computer in order to process and forward the appropriate information from the network resource to the end user. The invention is further related to a method and system for sending an electronic mail message to an end user regarding the end user s usage of the network resource. Still further the invention is related to the transmission of a warning message to an end user for example when a number of pages printed by the end user on a network printer is close to a predetermined limit.

Electronic mail e mail has become very popular for communicating information between people and provides the benefits of being inexpensive and convenient to a user. Extensive information and protocols are available explaining how e mail including Internet e mail operates and there are many commercially available programs for implementing e mail functions.

Internet facsimile is also available. See for example Toyoda K Ohno H. Murai J. Wing D. A Simple Mode of Facsimile Using Internet Mail March 1998 The Internet Society Request For Comments RFC 2305 produced by the Internet Engineering Task Force IETF Fax Working Group the entire contents of which are incorporated by reference herein.

Accordingly it is an object of this invention to provide a method system and program product for implementing communication using electronic network messages or e mail.

It is another object of this invention to provide a method system and program product in which an electronic network message regarding usage of a network resource is transmitted to an end user.

It is yet another object of the invention to provide a method system and program product which transmits information regarding usage of a device originating from the device through a computer.

It is yet another object of the invention to provide a method system and program product which transmits summary information regarding usage of a device originating from the device through a service center to a resource manager or resource administrator.

It is a further object of the invention to provide a method system and program product which transmits information regarding usage of a device originating from a device to a resource manager or resource administrator or to a service center.

It is yet another object of the invention to provide a method system and program product which transmits information regarding usage of a device to an end user.

These and other objects are accomplished by a method system and program product in which an electronic network message regarding the usage of a network resource is received by a computer. When it is determined that the electronic network message contains information regarding usage of the network resource by a particular end user a communication may be transmitted from the computer to the end user. For example the end user may receive a warning message that a number of printed pages is getting close to a predetermined limit.

In an embodiment of the invention a message regarding the usage of a device by a particular end user may be sent from the device either to a resource administrator or through a firewall to a service center. Resource usage of network devices by a particular end user may be transmitted from the devices to transmit the appropriate information regarding usage of the devices to either the resource administrator or a service center. For some resources a device driver may be needed to perform this task. Resource usage such as for example the number of pages printed by an end user is tracked for an intranet so that an end user s resource usage is still tracked even if the user changes stations on the intranet. When for example a user receives a message that his her usage of a particular network resource is close to a predetermined limit the user may take an appropriate action such as for example requesting an increase of the resource limit. If the user exceeds his her limit he she may be prohibited from using further network resources. A device or network resource may be any type of device including a hard disk space a business office device such as a printer a copier a scanner or a facsimile machine a digital camera or any other electronic device which is desired to be remotely monitored and or controlled including equipment for remotely monitoring and controlling utility meters and household appliances. In this context a user or an end user may include both human users and electronic users such as for example a software agent.

The invention also relates to the transmission of an outgoing e mail message from a computer containing information from an attached device as one means to transmit the resource usage information to a resource administrator or a service center. Information from the device may be transmitted to a device driver of the computer and subsequently to a Messaging Application Programming Interface MAPI of the computer. If desired the transmission of the electronic mail message from the device may establish a TCP Transmission Control Protocol connection between the computer and the device which functions as a message transfer agent. As a further alternative one or more files may be created within the computer and these files may be written to a mail spool directory of the computer. When the computer detects the existence of the file s in the mail spool directory an e mail message is transmitted from the computer. If it is desired and if the environment supports it the information may be sent directly to the resource administrator or the service center without using e mail transmission.

Referring now to the drawings wherein like numerals designate identical or corresponding parts throughout the several views and more particularly to thereof there is illustrated a figure showing various machines and computers for monitoring diagnosing and controlling the operation of the machines. In there is a first network such as a Local Area Network LAN connected to computer workstations and . The workstations can be any type of computers including IBM Personal Computer compatible devices Unix based computers or Apple Macintoshes. Also connected to the network are a digital copier printer a facsimile machine and a printer . The devices and are referred to as machines or monitored devices and other types of devices may be used as the machines or monitored devices including any of the devices discussed below. Also a facsimile server not illustrated may be connected to the network and have a telephone ISDN Integrated Services Digital Network wireless or cable connection. In addition to the digital copier printer facsimile machine and printer being connected to the network these devices may also include conventional telephone and or ISDN and or cable connections and respectively. As is explained below the business office machines or business devices and communicate with a remote monitoring diagnosis and control station also referred to as a monitoring device through the Internet via the network or by a direct telephone ISDN wireless or cable connection.

In the Internet is generally designated by . The Internet includes a plurality of interconnected computers and routers designated by A I. The manner of communicating over the Internet is known through Request For Comments RFC documents obtained from www.ietf.org. TCP IP Transmission Control Protocol Internet Protocol related communication is described for example in the book TCP IP Illustrated Vol. 1 The Protocols by Stevens from Addison Wesley Publishing Company 1994 which is incorporated herein by reference.

In a firewall is connected between the Internet and the network . A firewall is a device that allows only authorized computers to access a network or other computer via the Internet. Firewalls are known and commercially available devices and or software for example include SunScreen from Sun Microsystems Inc. Similarly a firewall is connected between the Internet and a network . Also a firewall is connected between the Internet and a workstation .

The network is a conventional network and includes a plurality of workstations and . These workstations may be different departments within a company such as marketing manufacturing design engineering and customer service departments. In addition to the workstations connected via the network there is a workstation which is not directly connected to the network . Information in a data base stored in a disk may be shared using proper encryption and protocols over the Internet to the workstations connected directly to the network . Also the workstation includes a direct connection to a telephone line and or ISDN and or cable and the data base in disk may be accessed through the telephone line ISDN or cable. The cable used by this invention may be implemented using a cable which typically is used to carry television programming cable which provides for high speed communication of digital data typically used with computers or the like or may be implemented using any desired type of cable.

Information of the business office machines and may be stored in one or more of the data bases stored in the disks and . Each of the customer service marketing manufacturing and engineering departments may have their own data base or may share from one or more data bases. Each of the disks used to store data bases is a non volatile memory such as a hard disk or optical disk. Alternatively the data bases may be stored in any storage device including solid state and or semiconductor memory devices. As an example disk contains the marketing data base disk contains the manufacturing data base disk contains the engineering data base and disk contains the customer service data base. Alternatively the disks and store one or more of the data bases.

In addition to the workstations and being connected to the Internet these workstations may also include a connection to a telephone line ISDN or cable which provides a secure connection to the machine being monitored diagnosed and or controlled and is used during a connection mode of communication. Additionally if one of the Internet telephone ISDN or cable is not operating properly one of the others can be automatically used for communication.

A feature of the present invention is the use of a connectionless mode of communication e.g. Internet e mail or transmission between a machine and a computer for monitoring diagnosing and controlling the machine and transmitting information regarding resource usage to an end user. Alternatively the e mail which is transmitted may be implemented using a connection mode of communication. The IBM Dictionary of Computing by George McDaniel 1994 defines a connectionless mode transmission to be the transmission of a single unit of data from a source service access point to one or more destination service access points without establishing a connection. The IBM Dictionary also defines a connection mode transmission to be the transmission of units of data from a source service access point to one or more destination service access points via a connection. The connection is established prior to data transfer and released following data transfer. Additional information about the connection mode and the connectionless mode of operation is described in the Handbook of Computer Communications Standards Vol. 1 2nd Edition by William Stallings 1990 which is incorporated herein by reference. In order to transfer data from one DTE Data Terminal Equipment to another DTE there is a unique identifier or address for each DTE. This unique identifier or address is usable in both connection modes and connectionless modes of communication.

There is a multi port communication interface which allows the digital copier to communicate with external devices. Reference numeral represents a telephone ISDN or cable line and represents a network. Further information of the multi port communication interface is described with respect to . An interface controller is used to connect an operation panel to a system bus . The operation panel includes standard input and output devices found on a digital copier including a copy button keys to control the operation of the copier such as number of copies reducement enlargement darkness lightness etc. Additionally a liquid crystal display may be included within the operation panel to display parameters and messages of the digital copier to a user.

A storage interface connects storage devices to the system bus . The storage devices include a flash memory which can be substituted by a conventional EEPROM and a disk . The disk includes a hard disk optical disk and or a floppy disk drive. There is a connection connected to the storage interface which allows for additional memory devices to be connected to the digital copier. The flash memory is used to store semi static state data which describes parameters of the digital copier which infrequently change over the life of the copier. Such parameters include the options and configuration of the digital copier. An option interface allows additional hardware such as an external interface to be connected to the digital copier. A clock tinier is utilized to keep track of both the time and date and also to measure elapsed time.

On the left side of the various sections making up the digital copier are illustrated. Reference numeral designates a sorter and contains sensors and actuators used to sort the output of the digital copier. There is a duplexer which allows a duplex operation to be performed by the digital copier and includes conventional sensors and actuators. The digital copier includes a large capacity tray unit which allows paper trays holding a large number of sheets to be used with the digital copier. The large capacity tray unit includes conventional sensors and actuators.

A paper feed controller is used to control the operation of feeding paper into and through the digital copier. A scanner is used to scan images into the digital copier and includes conventional scanning elements such as a light mirror etc. Additionally scanner sensors are used such as a home position sensor to determine that the scanner is in the home position and a lamp thermistor to ensure proper operation of the scanning lamp. There is a printer imager which prints the output of the digital copier and includes a conventional laser printing mechanism a toner sensor and an image density sensor. A fuser is used to fuse the toner onto the page using a high temperature roller and includes an exit sensor a thermistor to assure that the fuser is not overheating and an oil sensor. Additionally there is an optional unit interface used to connect to optional elements of the digital copier such as an automatic document feeder a different type of sorter collator or other elements which can be added to the digital copier.

The CPU or other microprocessor or circuitry executes a monitoring process to monitor the state of each of the sensors of the digital copier and a sequencing process is used to execute the instructions of the code used to control and operate the digital copier. Additionally there is a central system control process executed to control the overall operation of the digital copier and a communication process used to assure reliable communication to external devices connected to the digital copier. The system control process monitors and controls data storage in a static state memory such as the ROM of a semi static memory such as the flash memory or disk or the dynamic state data which is stored in a volatile or non volatile memory such as the RAM or the flash memory or disk . Additionally the static state data may be stored in a device other than the ROM such as a non volatile memory including either of the flash memory or disk .

The above details have been described with respect to a digital copier but the present invention is equally applicable to other business office machines or devices such as an analog copier a facsimile machine a scanner a printer a facsimile server or other business office machines or an appliance with which a user interfaces such as for example a microwave oven VCR digital camera cellular phone palm top computer etc. Additionally the present invention includes other types of machines which operate using a connection mode or connectionless mode of communication and also e mail such as a metering system including a gas water or electricity metering system household appliances vending machines or any other device which Performs mechanical operations such as automobiles and has a need to be monitored and performs a function. In addition to monitoring special purpose machines and computers the invention can be used to monitor control and diagnose a general purpose computer which would be the monitored and or controlled device and information regarding resource usage by an end user may be communicated to a resource manager a service center and to the end user.

Another sub system of includes a fire wall an intranet and a printer connected thereto. In this sub system there is not a separate general purpose computer connected between the intranet or a different type of computer network but the functions of sending and receiving electronic mail messages by the printer and similarly by a copier are performed by circuitry a microprocessor or any other type of hardware contained within or mounted to the printer .

An alternate type of sub system includes the use of an Internet service provider which may be any type Of Internet service provider including known commercial companies such as America Online Netcom CompuServe Niftyserve the Internet service provider Erols or any other Internet service provider. In this sub system a computer is connected to the Internet service provider through a modem for example such as a telephone line modem a cable modem modems which use any type of wires such as modems used over an ISDN Integrated Services Digital Network line ASDL Asymmetric Digital Subscriber Line modems which use frame relay communication any digital or analog modem wireless modems such as a radio frequency modem a fiber optic modem or a device which uses infrared light waves. Further a business office device is connected to the computer . As an alternative to the business office device and any other device illustrated in a different type of machine may be monitored or controlled such as a digital copier any type of appliance security system or utility meter such as an electrical water or gas utility meter or any other device discussed herein.

Also illustrated in is a fire wall connected to a network . The network may be implemented as any type of computer network such an Ethernet network for example. Networking software which may be used to control the network includes any desired networking software including software commercially available from Novell or Microsoft. The network may be implemented as an Intranet if desired. A computer connected to the network may be used to obtain information from a business office device and generate reports such as reports showing problems which occurred in various machines connected to the network and usage reports of the devices connected to the network . In this embodiment a computer is connected between the business office device and the network . This computer receives e mail communications from the network and forwards the appropriate commands or data or any other information to the business office device . While it has been stated that the business office device is connected to the computer there is no requirement for a wired connection between the business office device and the computer and communication between the business office device and the computer may be accomplished using wires or wireless methods including through the use of radio frequency connections and light connections which may be through an infrared connection or through fiber optics. Similarly each of the various networks and intranets illustrated in may be established using any desired manner including through the establishment of wireless networks such as radio frequency networks. The wireless communication described herein may be established using spread spectrum techniques including techniques which use a spreading code and frequency hopping techniques such as the frequency hopping wireless network which is disclosed in the Bluetooth Specification which is described at the world wide web site www.bluetooth.com which is incorporated herein by reference.

Another sub system illustrated in includes a fire wall an intranet a computer connected thereto and a copier . The computer may be used to generate reports and request diagnostic or control procedures. These diagnostic and control procedures may be performed with respect to the copier or any of the other devices illustrated in or used with . While illustrates a plurality of fire walls the fire walls are preferable but optional equipment and therefore the invention may be operated without the use of fire walls if desired.

From the message transfer agents e mail messages are stored in user mailboxes which are transferred to the user agent and ultimately transmitted to the user at a terminal which functions as a receiving terminal.

The TCP provides a connection mode of transmission. However a direct connection is usually not established between the sending terminal and receiving terminal . Thus the transmission of an electronic mail message may be considered a connectionless mode of communication when it is being referred to as between two users or terminals but when considering the transfer between MTAs the communication is usually a connection mode of communication.

As the Internet is a network accessible by many people and organizations it is not considered to be secure. Therefore messages transmitted over the Internet should be encrypted to keep the messages confidential. Encryption mechanisms are known and commercially available which may be used with the present invention. For example a C library function crypt is available from Sun Microcomputers for use with the Unix operating system and other encryption and decryption routines are known and commercially available and may also be used with this invention.

As an alternative to the general structure of a single computer may be used which functions as the user terminal and also the message transfer agent. As illustrated in the device is connected to a computer which includes the message transfer agent . If desired the other components on the sending side of may be included in the computer of including the user agent and the queue of mail to be sent .

A further alternative structure is shown in in which the message transfer agent is formed as part of the device . Further the message transfer agent is connected to the message transfer agent by the TCP connection . This embodiment of illustrates a case in which the device is directly connected to the TCP connection and has an e mail capability. A common instance of this embodiment of may be the device is a facsimile machine with an e mail capability of RFC 2305 a simple mode of facsimile using Internet mail .

The transmitted messages are received by the relay MTA and if desired stored in a queue of mail . The mail is then forwarded to the local MTA of a receiving host . The mail may be placed in one or more of the user mailboxes and subsequently forwarded to the user agent and finally forwarded to the user at a terminal . If desired the user may not be required to be at the terminal and the mail may be directly forwarded to the terminal without user interaction. Other local MTAs at the receiving side include MTA and local MTA which may have their own mailboxes user agents and terminals.

The various computers utilized by the present invention including the computers and of may be implemented as illustrated in . Further any other computer utilized by this invention may be implemented in a similar manner to the computer illustrated in if desired including the service machine computer and computer of . However not every element illustrated in is required in each of these computers. In the computer includes a CPU which may be implemented as any type of processor including commercially available microprocessors from companies such as Intel Motorola Hitachi and NEC for example. There is a working memory such as a RAM and a wireless interface which communicates with a wireless device . The communication between the interface and device may use any wireless medium such as radio waves or light waves for example. The radio waves may be implemented using a spread spectrum technique such as Code Division Multiple Access CDMA communication or using a frequency hopping technique such as that disclosed in the Bluetooth specification.

There is a ROM and a flash memory although any other type of nonvolatile memory may be utilized in addition to or in place of the flash memory such as an EPROM or an EEPROM for example. An input controller has connected thereto a keyboard and a mouse . There is a serial interface connected to a serial device . Additionally a parallel interface is connected to a parallel device a universal serial bus interface is connected to a universal serial bus device and also there is an IEEE 1394 device commonly referred to as a fire wire device connected to an IEEE 1394 interface . The various elements of the computer are connected by a system bus . A disk controller is connected to a floppy disk drive and a hard disk drive . A communication controller allows the computer to communicate with other computers or send e mail messages for example over a telephone line or a network . An I O Input Output controller is connected to a printer and a hard disk for example using a SCSI Small Computer System Interface bus. There is also a display controller connected to a CRT Cathode Ray Tube although any other type of display may be used including a liquid crystal display a light emitting diode display a Plasma display etc.

A more detailed exemplary implementation of the device driver of is illustrated in . The device driver includes a device function support module which may be implemented to perform the conventional and or desired functions of a device driver. The device driver also includes a remote control and diagnostic module . If desired the remote control and diagnostic module may be implemented to perform some or all of the control and or diagnostic functions which are described in the related patent and patent applications and are incorporated by reference above. By implementing the control and diagnostic module in the device driver the cost of the device may be reduced and the resources and capabilities of the device may be eliminated or reduced such as by reducing the amount of memory in the device such as DRAM Dynamic Random Access Memory or flash memory for example. This reduced cost is possible as the hardware resources of the computer may be utilized in place of constructing additional hardware to go into the device if desired. Various information including log information and error information may be stored in a data base which includes device data using any desired hardware and data or data base management software. Further software within the device may be reduced by increasing the functions performed by the device driver including functions performed by the remote control and diagnostic module and the device function support module . These two software modules may be implemented in one software module if desired. Additionally the software which keeps track of the usage of the device may be removed from the device itself and included in the device driver .

Since Printer A and Printer B are connected to a network they have Internet Protocol IP addresses. The printers and can send status messages to either the Resource Administration station or to the Service Center of through the Firewall of . As previously shown a message can be sent directly to the Resource Administration station if urgent service is needed. Urgent service may include for example a copy machine needing toner a printer running out of paper a paper jam a lack of electrical power or any other device problem which requires immediate attention either manually or electronically. Also if a particular end user is approaching a predetermined limit on a number of pages allowed to be printed by that user a message may be transmitted quickly to the user. Non urgent messages may include for example usage reports such as the number of pages or jobs printed by a printer the number of calls received by a facsimile machine data concerning facsimile transmissions made by a particular end user or users of an intranet the number of copies made by a particular end user the amount of time an end user has spent utilizing a particular network device and facsimile information for facsimile transmissions made by a particular end user or an office.

Exemplary details of transmission of urgent and non urgent transmission are disclosed for example in U.S. Pat. No. 5 819 110 and as discussed below. Means other than electronic mail may be used for the purpose of calling attention for urgent service. For routine information however the Service Center may manage all resources on the Intranet and may send predetermined selected information to the Resource Administration station using electronic mail. Although the information may be available for example on the World Wide Web busy end users tend to forget to check web sites. Thus electronic mail is well suited for obtaining the attention of a proper recipient of the message.

It is to be noted that messages transmitted to the Service Center are generated by the network devices. The Service Center may be the central servicing center of a large corporation for example while a Resource Administrator may be an entity responsible for managing local resources for an intranet for an office site. It is also to be noted that network devices may include household appliances and meters. In such cases the Resource Administrator may for example be a home computer user. In some instances the Resource Administrator and the Service Center may be the same workstation having software modules necessary to handle both types of management responsibilities.

For an e mail mode of communication there is an e mail input processor and an e mail output processor . Incoming e mail mode communications pass through buffer and a decryption process is performed in step . The decrypted information is stored in buffer and passed to a conventional parsing process . As explained above one or more of the actions and are performed and outgoing messages pass through the buffer to the output message process . Then the e mail mode outgoing messages pass through a buffer after which they are encrypted by the encryption process . The encrypted messages then pass through buffer and are transmitted via the e mail output process over a network such as the Internet to their final destination.

Any type of e mail mode of communication may be used by the present invention. An inexpensive and readily available medium through which e mail messages may pass is the Internet processing electronic mail messages. The e mail input and output processes may be according to any known Internet e mail protocol such as used by the BSD Unix mail system which is incorporated into the SunOS 4.1.X. Also other information describing Internet e mail operations are readily available through various sources on the Internet itself. It is well known that Internet e mail requires an identifier or address of the machine which is to receive the e mail. Further Internet e mail protocols typically construct an electronic mail message to include an envelope a header and a body. The envelope typically includes the identifier or address of the machine or person which is to receive the e mail and the identifier or address of the originator of the message or where replies to the message are to be sent. The header typically includes a description of the encoding type or version of the e mail message. The identifier or address of Internet e mail addresses typically include a name which identifies the recipient or user of an e mail server followed by the symbol followed by the domain name or host name of the mail server. These various features of e mail are utilized by the BSD Unix mail system of the SunOS 4.1.X. While the Internet provides an inexpensive manner of an e mail mode of communication the Internet electronic mail system may be slow or unreliable and therefore in certain circumstances instead of using an e mail process a direct connection process as described above is performed.

If step determines that an event does not require an e mail mode of communication step determines if the direct communication channel is ready. For example it determines if network the telephone or ISDN line is available. If it is a direct communication process is performed in step to transmit the appropriate information. If the direct channel is not ready step notifies the user through the operation panel that there is a problem with the device. If step determines that the event requires an e mail mode of transmission step calls an e mail communication process. The process of then returns to the calling process.

When step determines that the information is not for the resource manager step determines whether the information is to be sent to the device. When step determines that the information is for the device step packages the information for the device step sends the packaged information to the device and the process of returns to the calling process. When step determines that the information is not for the device step identifies the destination for the information to be sent. Step then packages the information for the destination which is identified. Step sends the information to the destination and the process of returns to the calling process.

Additionally e mail messages also contain what is referred to as an envelope which is used by the message transfer agents for delivery. The envelope may be specified by SMTP commands such as mail from and RCPT 2 . Further information about the envelope is specified in RFC 821 which is incorporated herein by reference. A third part of an e mail message is the message body which is the content of the message. RFC 822 specifies the body as lines of ASCII text. In the body is set forth in lines .

There may be files attached to electronic mail messages for example as illustrated in . The attached file in is an executable file which allows a user to execute the programming code contained within the file. The attachment of files including executable files to electronic mail messages is a known feature of e mail messages.

Step determines if the user clicked the attached file which causes the attached file to be executed. Alternative manners of executing the attached file may be performed such as double clicking the attached file saving the attached file and using a command of the operating system to cause the file to execute or the attached file may be executed in any other way. After the user causes the execution of the attached file to begin flow proceeds to step which executes the attached file. In the preferred form of the invention the attached file causes commands to be transmitted to the device driver. In step the device driver receives the commands from the executing attachment and sends the appropriate commands and information to the attached device. In step the operation specified by the attached file is performed by the device. Such an operation may be any type of operation including any of the operation control functions or data requests or manipulations described in any of the related patents and patent applications specified above. Exemplary operations performed by the device including remote control and diagnostic operations the transmitting of information pertaining to the operation or failures which have occurred within the device and also operating parameters utilized by or stored in the device.

While the process of has been explained with respect to the use of a device driver the device driver is a convenient label for the routine which allows control of the attached device and any other type of software which controls the attached device may be utilized in place of the device driver. For example the e mail program itself may be able to send commands and or data directly to the attached device. The attached device may be any of the devices which have been explained above.

One manner of causing the execution of the program code is to use a graphical pointing device such as a mouse connected to the computer having the user place a pointer on the object representing the file e.g. the attached file summary.exe and subsequently having the user press a button while the user points to the file.

When step determines that the attached e mail is for a user e.g. the e mail is unassociated with the attached device and is not used to control or monitor the attached device flow proceeds from step to step which allows the user to view reply to forward or perform any other desired function on this e mail. From steps and control flows to step which determines if there are additional e mail messages. If there are more messages flow proceeds back to step . If there are no more messages the process of ends.

Another alternative to using e mail is to send to a user of the computer an e mail message with a web address where an executable file may be downloaded. Unlike attaching executable code this method will at least allow the user to verify the web site before downloading and executing code. This method requires more work by the user but allows the user to check the source of the executable code.

In addition to receiving electronic mail messages which are used for monitoring and or controlling an attached device the invention also includes the transmission of e mail messages which contain information of the device attached to the computer. The present invention prepares data for transmission in e mail messages such as the information which is illustrated in which are explained below.

Step then sends the message to an outmail object. An outmail object is preferably a software object or routine executing within the computer which performs the transmission out of the computer. The manner in which the transmission is performed in the Microsoft Windows environment is through the use of the Messaging Application Programming Interface MAPI . The MAPI allows interaction with the messaging system and does not require a programmer to write all code which is utilized to transmit messages. By setting the MAPI in Windows to a specific program such as the Microsoft Outlook Express e mail program when a message is transmitted to the outmail object the MAPI client the message transmission may became automated. Details regarding the implementation and use of MAPI are set forth in the book Inside MAPI by. Irving De la Cruz and Les Thalaer published by the Microsoft Press 1996 which is incorporated herein by reference. Any feature regarding the use of MAPI disclosed in this book may be utilized to implement the present invention using the MAPI client. In step the e mail message is transmitted out of the client preferably using the outmail object.

The outmail object has been described as being the Windows MAPI. However any other outmail object may be used to assist in the transmission of e mail messages. Alternatively a software object does not have to be used but any desired code which assists in the transmission of the outmail object may be utilized.

An alternative manner of transmitting e mail messages according to the present invention is illustrated in . The method of is preferably performed in a Unix environment although any other software or operating system environment may be utilized as long as the desired steps are performed. In after starting step prepares the message to be sent. This step is utilized to obtain the information which is to be transmitted and may be performed in a similar manner as when step of is performed if desired. In step of the mail output files are prepared and include the message which was prepared in step . In step the output files which may be one or more files the number of files being the number appropriate to the operating system are stored in an outgoing mail directory which in Unix is referred as the mail spool directory. This directory in Unix may be located at var spool mqueue although any other appropriate directory may be used. Once the appropriate file s is are stored in the desired location step is performed which transmits an electronic mail message corresponding to the file s which has been stored. The process of then ends.

The present invention may be utilized to create informational reports regarding status or other information of the device which is being monitored. The information of the devices May be transmitted Over the Internet to another company or to a computer of the same company or alternatively may be transmitted as an e mail which remains within the private network such as the local area network or a wide area network of a company. A machine which receives e mail messages prepared and transmitted in accordance with the teachings of this invention may be transmitted to a device such as the service machine illustrated in or the Service Machine of the Service Center illustrated in . The service machine may then notify an appropriate entity such as a third party service center a service center of the device manufacturer such as the copier or printer manufacturer s service center or other authorized service center or any other entity and indicate that a specific problem exists. Such notification may be performed through electronic mail through a direct computer connection through a telephone call to a person using a facsimile transmission through the indication of a voice message or in any other desired manner.

Step of determines whether the resource is available to the user. The Driver of queries the network resource management software residing in the Resource Administrators station of to determine whether the Resource of is available to the User . Alternatively the software may reside at the Service Center of if it can be accessed synchronously. As a further alternative the Driver of may have access to a small database of user permission information which is regularly updated by the Service Center or the Resource Administrator of . If it is determined in step of that the user is not allowed to use the Resource step displays a message to the user and control is returned to the calling process.

If it is determined in step that the user can use the Resource step sends the Job to the Resource of . Step of determines whether the Job terminated normally. If step determines that the Job did not terminate normally step displays a message to the user and control is returned to the calling process. If step determines that the Job terminated normally in step the Driver sends the user and resource usage information to the Service Center and control is returned to the calling process.

When step determines the resource s usage is above 100 step configures the network resource management software at the Resource Administrator station to block or deny access to the particular resource by the user. The Resource Administrator may alternatively change the limit or reset the count if desired. Control is then returned to the calling process.

The present invention may be utilized to create informational reports regarding status usage or other information of the device which is being monitored. The information of the devices may be transmitted over the Internet to another company or to a computer of the same company or alternatively may be transmitted as an e mail which remains within the private network such as the local area network or a wide area network of a company. A machine which receives e mail messages prepared and transmitted in accordance with the teachings of this invention may be transmitted to a device such as the service machine illustrated in . The service machine may then notify an appropriate entity such as an end user a third party service center a service center of the device manufacturer such as the copier or printer manufacturer s service center or other authorized service center or any other entity and indicate that a specific problem exists or indicate informational summary information. Such notification may be performed through electronic mail through a direct computer connection through a telephone call to a person using a facsimile transmission through the indication of a voice message or in any other desired manner.

In its preferred implementation the present invention utilizes computers having separate housings than the device to which they are attached. This would allow the invention to be inexpensively implemented for installations which already have an existing computer for performing the desired processing as the new hardware costs may be reduced. Such an arrangement may also permit implementation of the invention without hardware changes to the device. However if desired the present invention may be implemented by including the appropriate processing and data storage capabilities in the device which is being monitored and or controlled in addition to or as an alternative to a separate computer connected to the device. Further this invention may be particularly applicable to existing installations such as a print server. A print server is connected to a computer network and receives requests to perform printing operations and distributes these printing operations to appropriate printing devices connected to the print server.

This application relates to and builds on various concepts which have been disclosed in the cross referenced patents and patent applications which have been incorporated into this application by reference. This patent application is intended to include not only the inventions disclosed in the related applications but also the combinations of various features and functions of the individual embodiments which have been disclosed in this and each of the related applications. Thus a feature disclosed in one of the related applications or patents may be readily applied to a concept disclosed in this invention and also the concepts disclosed in one or more of the other applications may be applied to concepts or features disclosed in other s of the applications. Further an e mail message may be used for only one of sending and receiving with communication in the other direction being performed using a different mode of communication such as one of the other communication modes disclosed herein or a communication mode disclosed in the related patents and patent applications.

This invention may be conveniently implemented using a conventional general purpose digital computer or microprocessor programmed according to the teachings of the present specification as will be apparent to those skilled in the computer art. Appropriate software coding can readily be prepared by skilled programmers based on the teachings of the present disclosure as will be apparent to those skilled in the software art. The invention may also be implemented by the preparation of application specific integrated circuits or by interconnecting an appropriate network of conventional component circuits as will be readily apparent to those skilled in the art.

The present invention includes a computer program product which is a storage medium including instructions which can be used to program a computer to perform a process of the invention. The storage medium can include but is not limited to any type of disk including floppy disks optical discs CD ROMs and magneto optical disks ROMs RAMs EPROMs EEPROMs magnetic or optical cards or any type of media suitable for storing electronic instructions.

Obviously numerous modifications and variations of the present invention are possible in light of the above teachings. It is therefore to be understood that within the scope of the appended claims the invention may be practiced otherwise then as specifically described herein.

