---

title: Client device token based multifactor authentication
abstract: A multifactor authentication (MFA) enforcement server provides multifactor authentication services to users and existing services. During registration, the MFA enforcement server changes a user's password on an existing service to a password unknown to the user. During normal usage when the user accesses the existing service through the MFA enforcement server, the MFA enforcement server enforces a multifactor authentication enforcement policy.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09148405&OS=09148405&RS=09148405
owner: Tyfone, INC.
number: 09148405
owner_city: Portland
owner_country: US
publication_date: 20150128
---
The present invention relates generally to authentication and more specifically to multifactor authentication.

Computer systems typically authenticate users prior to allowing access. For example a desktop computer may authenticate a user with a username and password. When the user provides the correct username and password the user is authenticated and is allowed access to computer resources.

In the following detailed description reference is made to the accompanying drawings that show by way of illustration various embodiments of an invention. These embodiments are described in sufficient detail to enable those skilled in the art to practice the invention. It is to be understood that the various embodiments of the invention although different are not necessarily mutually exclusive. For example a particular feature structure or characteristic described in connection with one embodiment may be implemented within other embodiments without departing from the scope of the invention. In addition it is to be understood that the location or arrangement of individual elements within each disclosed embodiment may be modified without departing from the scope of the invention. The following detailed description is therefore not to be taken in a limiting sense and the scope of the present invention is defined only by the appended claims appropriately interpreted along with the full range of equivalents to which the claims are entitled. In the drawings like numerals refer to the same or similar functionality throughout the several views.

In operation a user registers with MFA enforcement server to define the MFA policy to be applied in the future. The MFA policy may include enforcement of any number or type of authentication factors e.g. challenge questions physical presence of token out of band factors such as SMS or return phone call etc. . In addition the MFA policy may map different levels of authentication to different levels of content access through content filtering. For example if a user can satisfy a subset of the authentication factors then the MFA policy may allow authentication of the user while restricting access to some content. In this manner MFA enforcement server may act as both a content intermediary as well as an authentication intermediary between existing service and client device .

After registration is complete the user logs in to the existing service through MFA enforcement server . During the login process MFA enforcement server enforces one or more MFA policies defined during registration. For example if an MFA policy includes checking for the presence of a physical token then MFA enforcement server may detect the presence of optional token prior to allowing authentication. If the MFA policy is satisfied then MFA enforcement server logs in to existing service on behalf of the user. In some embodiments MFA enforcement server also filters content unidirectionally or bidirectionally according to the MFA policy in effect.

At MFA enforcement server asks the user for a new password that the user will provide in the future when authenticating to existing service with MFA enforcement server as an authentication intermediary. This password is referred to herein as the password known to the user. At the user provides a new password shown as orange in the example of . After the user has changed the known password from apple to orange . In some embodiments the and are omitted and the user maintains the same known password.

At MFA enforcement server changes the password used to log in to existing service to a value unknown to the user. This password is referred to herein as the password unknown to the user. In the example of MFA enforcement server changes the user s password at existing service to superlongpw . The password unknown to the user may be set to any value of any length. In some embodiments the password unknown to the user is randomly generated.

At MFA enforcement server gathers additional registration information from the user. The additional registration information may include any amount or type of information. For example any necessary account data or metadata may be collected at this time including data identifying the user billing data MFA policy definition data etc. In some embodiments the additional registration information includes MFA policy definitions for multiple existing services or multiple users. For example the registration may be for an administrator account that defines one or more MFA policies for multiple users and or multiple existing services.

In some embodiments MFA enforcement server automatically seeks the presence of one or more multifactor tokens. For example MFA enforcement server may detect the presence of token . Example embodiments of token include a secure element e.g. smartcard chip embedded in a phone or a microSD card with a secure element. The microSD card may be in a phone in the USB slot of a PC or any other client device. In some embodiments the secure element maybe running identification services or applets. When the presence of a token is detected MFA enforcement server may record the identity of the token to be included in an MFA policy.

MFA policy definition data collected by MFA enforcement server may also include out of band authentication process definitions such as a voice call to enter PIN or SMS with one time number. Any additional multifactor authentication data may be collected at this time.

At the completion of the registration process MFA enforcement server is established as an authentication intermediary between the user operating client device and existing service . The user no longer knows the proper credentials to directly login to existing service .

Registration component is accessed when a user registers for the MFA service see . Registration information collected by registration component is stored in data store . For example as shown in registration information collected and stored may include user registration information and one or more MFA policies.

MFA enforcement component functions as an authentication intermediary between a user operating client device and existing service . When a registered user wishes to authenticate to a service on existing service the user provides login credentials to MFA enforcement server at . In some embodiments the login credentials provided to MFA enforcement server include the password known to the user. In the example of the credentials include the user s username Steve and the password known to the user orange established as described with reference to .

If the user s credentials sent at correspond to a registered user MFA enforcement component performs multifactor enforcement at . MFA enforcement at is performed in accordance with one or more MFA policies stored at data store . For example if during registration the user specified that a the physical presence of a token is a factor then MFA enforcement component will query client device to detect the presence or non presence of token . Further if an MFA policy specifies an out of band communication as a factor then MFA enforcement component will perform any out of band action identified in the MFA policy e.g. SMS or phone call .

As described above the MFA policy being enforced may include any number or type of factors. During operation a user may satisfy all less than all or none of the factors specified in the MFA policy beyond the credentials initially provided at . Based on the MFA policy and level of user compliance with the MFA enforcement at MFA enforcement component will login to existing service using the credentials established as described above with reference to . In the example of these credentials include the user s username Steve and the password unknown to the user superlongpw . When the proper credentials are provided at the existing service authenticates MFA enforcement server as the user.

Content filter filters content to and from client device and also filters content to and from existing service . The filter rules employed are specified in the MFA policy in effect and may vary based on the level of multifactor authentication satisfaction. For example an MFA policy may specify that if a user provides correct credentials but fails to provide any further authentication then read only access may be provided. In this case content filter allows client device to read but not change content at existing service . Also for example an MFA policy may specify that if a user provides correct credentials but fails to provide any further authentication then some content on existing service is to be blocked completely. In this case content filter allows client device to read some but not content at existing service .

In some embodiments content filter may block content and in other embodiments content filter may substitute content based on the MFA policy in effect and the MFA level satisfied by the user. In some embodiments content filter is omitted and MFA enforcement server does not function as a content intermediary.

As shown in the user information may include account information such as contact and billing information. The user information may also include a token identity challenge questions or any other authentication factors corresponding to the user. The user information also includes data specific to applications that are registered. In the example of the user is registered for two applications shown as netpeoplesite.com and bankingdebitcredit.com . The domain bankingdebitcredit.com is a fictitious name used herein to represent a banking website. One skilled in the art will understand that any number or type of services may be registered in the manner shown for netpeoplesite.com and bankingdebitcredit.com.

For each registered application the user information includes usernames passwords both known and unknown to the user and MFA policies. Other information may also be stored the example shown in is intentionally kept brief for simplicity of explanation.

MFA policy definition data may include for example records that define multiple possible MFA factors levels and content filtering rules. For example as shown in different MFA levels may be defined based on which factors are satisfied by the user. These levels may or may not be hierarchical. Some embodiments include user defined content filter rules not shown that are enforced based on the MFA level satisfied during authentication.

MFA policies may also identify restrictions on future access based on the MFA level satisfied during authentication. For example a user may be restricted access to N number of authentications without validation of a multifactor token. After N authentications the user may be denied access and or a master account holder may be informed of such a violation. The master account holder may be able to reset or change the restrictions of the sub account holders.

MFA policies may also require periodic password changes. For example the password unknown to the user may be changed periodically without the user s knowledge. Further the password known to the user may be changed periodically by the user in accordance with an MFA policy.

One skilled in the art will understand that MFA policies are not limited to the data shown in . Any number or type of authentication factors may be utilized any number of MFA levels may be defined and any type or amount of content filter may also be defined without departing from the scope of the present invention.

In the specific example of a user accesses MFA enforcement server at mfaenfserver.com username where mfaenfserver.com is a fictitious domain used herein to refer to MFA enforcement server and username is a username uniquely pairing the user and MFA enforcement server . If at the user satisfies MFA according to a defined policy MFA enforcement server authenticates the user to multiple applications also according to a defined MFA policy.

In some embodiments the multiple applications and correspond to resources on the same existing service. For example in a corporate environment applications and may correspond to different application on a corporate network e.g. email calendaring document sharing remote desktop etc. . When the user authenticates to MFA enforcement server then MFA enforcement server in turn authenticates to the applications on the corporate network on behalf of the user. Content filtering for each application may then take place based on MFA level as described above.

Smartcard chip is capable of secure communications. When queried smartcard chip can provide secure identity information useful for authentication purposes. For example referring back to smartcard chip within token can communicate securely with MFA enforcement server during registration as well as during MFA enforcement.

When token takes on a memory card form factor as shown in the token may be available or unavailable as an authentication factor at the wish of the user. For example a user may have an MFA policy defined that allows a restricted but sufficient level of content access when token is not present. The user may wish to intentionally omit token from client device when full access is not required or desired e.g. when travelling to decrease the chance of a data breach in the event client device is lost or stolen. Further when token is in a portable format such as a memory card a user may carry the memory card and insert it as necessary into different client devices depending on the client device available and the level of authentication and content access desired.

Further token is shown as a USB dongle and this is also not a limitation of the present invention. For example in some embodiments token includes a microSD card inserted in a USB carrier. Also for example in some embodiments token is embedded in client device .

Networks and may include the internet although this is not a limitation of the present invention. For example in some embodiments network may include the internet and network may include a corporate network or a network separated from the internet by a firewall. In these embodiments an entity that controls existing service may deploy MFA enforcement server to enforce multifactor authentication without being forced to alter the native authentication mechanism of existing service .

Also in some embodiments both networks and include elements of the internet. In these embodiments an entity separate from both the user and the existing service may provide MFA enforcement services. This is consistent with the example domain mfaenforce.com as described above.

Referring now to login credentials for a service are received from a user. The service corresponds to any of the existing services described herein. For example the login credentials may include a username and password for a social networking site a banking site a corporate network or any other service requiring authentication. At the service is accessed and the password is changed to a value unknown to the user. In the example of the password unknown to the user corresponds to superlongpw . At the completion of and the user no longer has the knowledge new password needed to directly login into the service.

At an MFA policy is enforced when the user accesses the service. In some embodiments the MFA policy was defined when the user registered for the service. The MFA policy may require that any number or type of authentication factor be satisfied and may also device MFA levels based on how many factors can be satisfied. For example in some embodiments the MFA policy requires that the physical presence of a token be verified. In some embodiments the presence of the token can be verified by communicating with a secure element within the token. The token may take on any form factor including an embedded secure element in a phone or computer a secure element in a memory card or the like. In some embodiments the token takes on the form factor of a microSD memory card.

Depending on the outcome of multifactor authentication the MFA enforcement server logs in to the existing service on behalf of the user and may also filter content.

Referring now to at a username and password are received from a user. At the presence of a token associated with the user is verified. At the MFA enforcement server logs in to the existing service using the username provided and a password unknown to the user.

Although the present invention has been described in conjunction with certain embodiments it is to be understood that modifications and variations may be resorted to without departing from the scope of the invention as those skilled in the art readily understand. Such modifications and variations are considered to be within the scope of the invention and the appended claims.

