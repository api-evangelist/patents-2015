---

title: Storage device for performing in-storage computing operations, method of operation the same, and system including the same
abstract: A storage device performs in-storage computing operation, and includes a non-volatile memory configured to store data and a controller. The controller may include an on-chip memory and may control an operation of the non-volatile memory. The controller receives a data processing code generated by a host, overlays the data processing code on the on-chip memory, processes first data corresponding to the data processing code among the data stored in the non-volatile memory, and transmits the processed first data to the host.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09652416&OS=09652416&RS=09652416
owner: Samsung Electronics Co., Ltd.
number: 09652416
owner_city: Suwon-si, Gyeonggi-do
owner_country: KR
publication_date: 20150209
---
A claim of priority under 35 U.S.C. 119 a is made to Korean Patent Application No. 10 2014 0017997 filed on Feb. 17 2014 the disclosure of which is hereby incorporated by reference in its entirety.

Embodiments of the present disclosure relate to a storage device and more particularly to a storage device for performing in storage computing operations a method of operating the same and a system including the same.

In data server systems including a normal server and a database a massive amount of data herein below referred to as big data is stored in a relational database or a NoSQL database. Data that is desired is extracted from among the big data stored in the relational database or the NoSQL database using a structured query language SQL or a unique query language.

The big data is transmitted from the database to a main memory of a server and a processor of the server extracts the desired data from among the big data stored in the main memory. However since only part of the big data stored in the main memory of the server is extracted by the processor of the server extraction of the desired data using the processor of the server is not efficient in terms of data traffic. Moreover since the big data is transmitted from the database to the server the data traffic between the server and the database is not decreased.

Some embodiments of the present disclosure may provide a storage device for performing in storage computing operations to reduce a required computing power of a host and or network traffic.

Some embodiments of the present disclosure may also provide a method of generating a data processing code that can be executed in a storage device using a cross compiler of a host transmitting the data processing code to the storage device and performing in storage computing operations corresponding to the data processing code.

According to some embodiments of the present disclosure there may be provided a storage device including a non volatile memory configured to store data and a controller. The controller may include an on chip memory and may control an operation of the non volatile memory. The controller may receive a data processing code generated by a cross compiler of a host overlay the data processing code on the on chip memory process first data corresponding to the data processing code among the data stored in the non volatile memory and transmit the processed first data to the host.

The controller may further include a central processing unit CPU including a plurality of cores and an interface controller configured to generate an interrupt in response to a command including the data processing code. Among the plurality of cores a core that operates in response to the interrupt overlays the data processing code on the on chip memory.

The core may store the data processing code in the non volatile memory after overlaying the data processing code on the on chip memory. Alternatively the core may overlay firmware stored in the on chip memory with the data processing code and may roll back the firmware to the on chip memory after the data processing finishes.

The on chip memory may be a tightly coupled memory TCM a dynamic random access memory DRAM or a static random access memory SRAM . The storage device may be a solid state drive SSD an embedded multimedia card eMMC or a universal flash storage UFS .

According to other embodiments of the present disclosure there may be provided a data processing system including the above described storage device and an interface connected between a host and the storage device. The interface may be serial advanced technology attachment SATA or serial attached small computer system interface SCSI i.e. SAS.

The data processing system may provide a file hosting service a cloud storage service an internet hosting service or a web hosting service.

According to further embodiments of the present disclosure there may be provided a method of operating a storage device which includes a non volatile memory storing data and a controller controlling an operation of the non volatile memory. The method may include receiving a data processing code generated by a cross compiler of a host overlaying the data processing code on a memory included in the storage device processing first data corresponding to the data processing code which has been overlaid on the memory among the data stored in the non volatile memory and transmitting the processed first data to the host.

The overlaying the data processing code may include generating an interrupt in response to a command including the data processing code and overlaying the data processing code on the memory according to control of a core that operates in response to the interrupt among a plurality of cores included in a CPU. The memory may be a TCM a DRAM or an SRAM.

The present disclosure now will be described more fully hereinafter with reference to the accompanying drawings in which embodiments of the present disclosure are shown. This present disclosure may however be embodied in many different forms and should not be construed as limited to the embodiments set forth herein. Rather these embodiments are provided so that this disclosure will be thorough and complete and will fully convey the scope of the present disclosure to those skilled in the art. In the drawings the size and relative sizes of layers and regions may be exaggerated for clarity. Like numbers refer to like elements throughout.

It will be understood that when an element is referred to as being connected or coupled to another element it can be directly connected or coupled to the other element or intervening elements may be present. In contrast when an element is referred to as being directly connected or directly coupled to another element there are no intervening elements present. As used herein the term and or includes any and all combinations of one or more of the associated listed items and may be abbreviated as .

It will be understood that although the terms first second etc. may be used herein to describe various elements these elements should not be limited by these terms. These terms are only used to distinguish one element from another. For example a first signal could be termed a second signal and similarly a second signal could be termed a first signal without departing from the teachings of the disclosure.

The terminology used herein is for the purpose of describing particular embodiments only and is not intended to be limiting of the present disclosure. As used herein the singular forms a an and the are intended to include the plural forms as well unless the context clearly indicates otherwise. It will be further understood that the terms comprises and or comprising or includes and or including when used in this specification specify the presence of stated features regions integers steps operations elements and or components but do not preclude the presence or addition of one or more other features regions integers steps operations elements components and or groups thereof.

Unless otherwise defined all terms including technical and scientific terms used herein have the same meaning as commonly understood by one of ordinary skill in the art to which this present disclosure belongs. It will be further understood that terms such as those defined in commonly used dictionaries should be interpreted as having a meaning that is consistent with their meaning in the context of the relevant art and or the present application and will not be interpreted in an idealized or overly formal sense unless expressly so defined herein.

The data processing system may be implemented as a personal computer PC an internet data center IDC a system managing a database or a portable electronic device. The portable electronic device may be implemented as a smartphone a tablet PC a mobile internet device MID or a wearable computer.

The host may control a data process with respect to the storage . The host may provide an application programming interface API for an application programmer.

For instance when an application programmer writes a program code CODE necessary for data processing using the API a cross compiler executed in the host may generate an executable file e.g. a data processing code for the storage from the program code CODE. For instance the data processing code may be a binary code or a binary file. In other words the host may provide a code overlay method for controlling the storage for the application programmer.

A program or the cross compiler executed in the host may generate a command CMD including the data processing code and may transmit the command CMD to the storage through an interface . For instance the command CMD may be an in storage computing command. For instance the interface connected between the host and the storage may be implemented using a serial advanced technology attachment SATA or a serial attached small computer system interface SCSI i.e. SAS.

The host may be implemented as a server an integrated circuit IC a system on chip SoC a printed circuit board PCB an application processor AP or a mobile AP.

The storage may perform in storage computing operations based on the command CMD transmitted from the host . The in storage computing operations may include a scan operation a join operation and or a comparison operation performed not in the host but in the storage .

The storage may include a controller a dynamic random access memory DRAM and a plurality of flash memories through where n is a natural number . The storage may be a flash based memory device. For instance the storage may be implemented as a solid state drive SSD an embedded SSD eSSD a smart SSD a multimedia card MMC an embedded MMC eMMC or a universal flash storage UFS .

The controller may control data processing operations e.g. a write operation and a read operation occurring between the DRAM and the flash memories through . The controller may also control a data filtering operation.

From the point of view of the controller the DRAM may function as a main memory and the flash memories through may function as an auxiliary memory. For instance the DRAM may be an example of a volatile memory and the flash memories through may be an example of a non volatile memory. The flash memories through may be implemented as NAND flash memories simply referred to as NAND or NOR flash memories.

The controller may be implemented as an IC or an SoC. The controller may include a bus a host interface controller a central processing unit CPU an on chip memory a DRAM controller and a plurality of flash memory controllers through 

The CPU may control through the bus the operations of the host interface controller the on chip memory the DRAM controller and the plurality of flash memory controllers through . The CPU may include at least one core.

The host interface controller may control or interface commands and or data between the host and the storage . The host interface controller may generate an interrupt INT in response to the command CMD that is output from the host and may transmit the interrupt INT to the CPU . The interrupt INT may indicate a request related with the in storage computing operations.

According to some embodiments the host interface controller may write a data processing code DP CODE included in the command CMD to the on chip memory according to the control of the CPU . For instance the on chip memory may be a memory that can be accessed by a core related with the interrupt INT. For instance the on chip memory may be implemented as a tightly coupled memory TCM or a static random access memory SRAM .

According to other embodiments the host interface controller may transmit the data processing code DP CODE included in the command CMD to the DRAM controller under the control of the CPU . Accordingly the DRAM controller may write the data processing code DP CODE to the DRAM .

In other words the data processing code DP CODE may be written to the corresponding memory or using an overlay or overlaying method. The overlay or overlaying method means replacement of a block stored in instructions or data with another. Here writing may be construed to include overlaying.

The data processing code DP CODE may be a query related with data filtering. The data processing code DP CODE overlaid on the memory or may be loaded to the CPU and the CPU may execute the data processing code DP CODE. According to the control of the CPU each of the flash memory controllers through may process data corresponding to the data processing code DP CODE in corresponding one of the flash memories through and may transmit the processed data to the host through the bus and the host interface controller .

Conventionally data filtering is performed by a host. However according to some embodiments of the present disclosure the storage may perform the data filtering based on the data processing code DP CODE and transmit only the filtering result to the host . As a result the load of the data filtering on the host and the power consumption of the host are reduced. In addition since the host can use the filtering result that is output from the storage the load of the host is also reduced.

The DRAM controller may write data to the DRAM or read data from the DRAM . The flash memory controllers through may perform a write operation and a read operation on the flash memories through respectively through respectively channels.

For instance when there is no request for an input output from the host the cores CORE and CORE do not operate. However the cores CORE and CORE may perform internal jobs for flash translation layer FTL operations such as a garbage collection and or wear leveling . At this time one e.g. CORE of the cores CORE and CORE may execute the data processing code DP CODE included in the command CMD that is output from the host .

For instance the core CORE may process the interrupt INT. In other words the core CORE that does in storage computing operations overlays firmware stored in a memory area with the data processing code DP CODE. Here overlaying may mean replacement.

When the data processing code DP CODE having a start position e.g. a fixed offset FO is included in a framework together with dummies only the data processing code DP CODE without the dummies may be included in the command CMD and transmitted to the storage .

For instance when the firmware in the memory area is executed the core CORE may stop the firmware and overlay the firmware with the data processing code DP CODE. However when the firmware in the memory area is not executed the core CORE may just overlay the firmware with the data processing code DP CODE. For instance when the data processing code DP CODE is overlaid on the memory area the data processing code DP CODE may be overlaid on a memory area defined by the start position e.g. the fixed offset FO in the framework of the on chip memory .

The data processing code DP CODE stored in the memory area may be loaded to the core CORE and then executed. For instance a program counter may jump to the start position FO and therefore the data processing code DP CODE may be executed. As described above the data processing code DP CODE may include a query for the data filtering. For instance the query may be a structured query language SQL .

Referring to firmware FW stored in the memory area of the on chip memory is overlaid with the data processing code DP CODE. When data processing corresponding to the data processing code DP CODE is terminated the firmware FW may be rolled back to the memory area according to control of the core CORE. In detail when the data processing corresponding to the data processing code DP CODE is terminated the core CORE may reload the firmware FW which has been stored in one of the memories and through to the memory area . In other words a procedure in which the firmware FW is reloaded to the memory area of the on chip memory may be referred to as a rollback.

Referring to the data processing code DP CODE may be overlaid on a memory region other than a memory region that stores firmware FW in the memory area of the on chip memory . Thereafter the program counter may jump to the start position FO of the data processing code DP CODE.

The host interface controller receives the command CMD including the data processing code DP CODE generates the interrupt INT in response to the command CMD and transmits the interrupt INT to the core CORE of the CPU in operation . The core CORE that operates based on the interrupt INT overlays the data processing code DP CODE that is output from the host interface controller on the memory area of the on chip memory in operation S. At this time an overlay method is the same as the method described above with reference to .

The core CORE determines whether it is necessary to store the data processing code DP CODE in operation S. For example it is determined that it is necessary to store the data processing code DP CODE in operation S if it is expected to continuously use the data processing code DP CODE in the storage . If it is determined that it is necessary to store the data processing code DP CODE in operation S at least one of the flash memory controllers through writes the data processing code DP CODE to at least one of the flash memories through according to the control of the core CORE in operation .

After the data processing code DP CODE is written to at least one of the flash memories through or when it is not necessary to store the data processing code DP CODE e.g. when the data processing code DP CODE is temporarily used in the storage the core CORE controls the program counter to jump to the start position FO of the data processing code DP CODE in operation .

The data processing code DP CODE is executed according to the control of the core CORE. For instance when the data processing code DP CODE is a code or a query that enables particular data to be extracted from data stored in at least one of the flash memories through the core CORE may extract the particular data from the data that is output from the at least one of the flash memories through in operation S and may transmit the extracted data to the host through the host interface controller and the interface in operation S.

When the extraction finishes the core CORE may roll back the firmware FW to the on chip memory and may control the program counter to jump to a start position of the firmware FW or FW.

The data processing system may be implemented as a system that provides a file hosting service a cloud storage service an internet hosting service or a web hosting service. In other embodiments the data processing system may be implemented as a network attached storage NAS .

The main computing server may control the operations of the storage servers and through a first network. Each of the storage servers and may control the operations of storages corresponding thereto through a second network. Each of the storages may perform the in storage computing operations as described above with reference to .

The first network and the second network may be one network or may be different networks. At least one of the first network and the second network may be a wired network or a wireless network.

As the in storage computing operations are performed by the storages each of the storages may perform an operation of extracting particular data from data e.g. big data . In other words since each of the storages instead of the host or performs data extraction power consumption of the host or is reduced. In addition since each storage does not transmit the extracted data but transmits data that has been processed through the in storage computing operations to the host or a network traffic between the storage and the host or is decreased.

As described above according to some embodiments of the present disclosure a storage device may perform in storage computing operations corresponding to a data processing code transmitted from a host and the storage device may transmit a result of the in storage computing operations to the host. Accordingly since data corresponding to the data processing code transmitted from the host may be processed in the storage device computing power of the host and the power consumption of the host are reduced and the network traffic between the host and the storage device is also reduced.

While the present disclosure has been particularly shown and described with reference to exemplary embodiments thereof it will be understood by those of ordinary skill in the art that various changes in forms and details may be made therein without departing from the spirit and scope of the present disclosure as defined by the following claims.

