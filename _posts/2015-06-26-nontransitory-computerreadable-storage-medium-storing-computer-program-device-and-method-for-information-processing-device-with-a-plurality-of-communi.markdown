---

title: Non-transitory computer-readable storage medium storing computer program, device, and method for information processing device with a plurality of communication interfaces
abstract: An information processing device may select a communication target device that is to communicate with the information processing device. The information processing device may store received first communication device identification information in the storage in a case that the first communication device identification information is received. The information processing device may store received second communication device identification information in the storage in a case that the second communication device identification information is received. The information processing device may perform the communication with the communication target device in a case that particular first communication device identification information is stored in the storage. The information processing device may perform the communication with the communication target device in a case that only the particular second communication device identification information is stored in the storage but the particular first communication device identification information is not stored in the storage.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09442684&OS=09442684&RS=09442684
owner: BROTHER KOGYO KABUSHIKI KAISHA
number: 09442684
owner_city: Nagoya, Aichi
owner_country: JP
publication_date: 20150626
---
This application claims priority to Japanese Patent Application No. 2014 132554 filed on Jun. 27 2014 the contents of which are hereby incorporated by reference into the present application.

The technology disclosed in this specification relates to an information processing apparatus or the like for communicating with devices.

Conventionally a user installs a driver into a personal computer referred to as PC or other such information processing apparatus selects default printer and stores the default printer IP address in the PC. When the user instructs the PC to print the PC uses the stored IP address to send the print data to the default printer. Technology for performing data communications between an information processing apparatus and a device such as a printer like this is known.

However when the information processing apparatus is provided with two or more types of communication interfaces there are cases where it is possible to communicate with a default device using a plurality of communication paths. In cases like this user friendliness may be lost when the communication path used when communicating with the default device is not selected properly.

One technique disclosed in the present application is a non transitory computer readable storage medium storing a computer program for an information processing device configured to communicate with a plurality of devices. The information processing device may comprise a first wireless communication interface configured for communication in accordance with a first communication standard a second wireless communication interface configured for communication in accordance with a second communication standard that is different from the first communication standard a storage an operation unit and one or more processors. The computer program may include instructions for causing the one or more processors of the information processing device to perform receiving via the first wireless communication interface in a case that first communication device identification information is transmitted from a first communication device the first communication device identification information for identifying the first communication device that can be communicated using the first wireless communication interface. The computer program may cause the one or more processors to perform receiving via the second wireless communication interface in a case that second communication device identification information is transmitted from a second communication device the second communication device identification information for identifying the second communication device that can be communicated using the second wireless communication interface. The computer program may cause the one or more processors to perform storing the received first communication device identification information in the storage in a case that the first communication device identification information is received. The computer program may cause the one or more processors to perform storing the received second communication device identification information in the storage in a case that the second communication device identification information is received. The computer program may cause the one or more processors to perform selecting a communication target device that is to communicate with the information processing device from among the plurality of devices. The computer program may cause the one or more processors to perform accepting via the operation unit an execution instruction for executing a process for performing a communication of data with the communication target device. The computer program may cause the one or more processors to perform performing the communication with the communication target device via the first wireless communication interface in a case that particular first communication device identification information is stored in the storage. The particular first communication device identification information may be the first communication device identification information of the first communication device that is the selected communication target device. The computer program may cause the one or more processors to perform performing the communication with the communication target device via the second wireless communication interface in a case that only the particular second communication device identification information is stored in the storage but the particular first communication device identification information is not stored in the storage. The particular second communication device identification information may be the second communication device identification information of the second communication device that is the selected communication target device.

A wireless LAN I F of the information processing apparatus is provided with a first wireless communication I F and a second wireless communication I F . The first wireless communication I F complies with the Wi Fi registered trademark of the Wi Fi Alliance protocol and is an interface for performing Wi Fi access point and other such wireless communications between devices via a relay device. In the present specification a communication executed using the first Wi Fi wireless communication I F is defined as Wi Fi communication . With a Wi Fi communication it is possible to communicate with a communication destination device using an IP address. Furthermore with Wi Fi communication it is also possible to communicate with a communication destination device using information for identifying the communication destination device and or a MAC address. The first wireless communication I F can perform a Wi Fi communication with a first wireless communication I F of the MFP via a wireless communication the access point and a wireless communication . The first wireless communication OF can also perform a Wi Fi communication with the scanner via the wireless communication the access point and a wireless communication . The first wireless communication I F can also perform a Wi Fi communication with the color laser printer via the wireless communication the access point and a wireless communication .

Alternatively the second wireless communication I F complies with the Wi Fi Direct described as WFD hereinbelow protocol and is an interface for performing a wireless communication between one device and another device which functions as a Wi Fi Direct relay device without going through a relay device. In the present specification a communication executed using the second wireless communication I F is defined as WFD communication . With a WFD communication it is also possible to communicate with a communication destination device using information for identifying the communication destination device e.g. a device ID and or a MAC address. Furthermore with a WFD communication it is also possible to communicate with a communication destination device using an IP address. The second wireless communication I F can perform wireless communications and in the WFD mode directly with each of the MFP the scanner and the color laser printer . Note that with WFD communication and Wi Fi communication the wireless communication is conducted based on the 802.11 standard of The Institute of Electrical and Electronics Engineers inc. referred to as IEEE and equivalent standards for example 802.11a 11b 11g 11n or the like .

The second wireless communication I F may be configured to be used at a lower priority than the first wireless communication I F . This is because there are cases in which Wi Fi communication provides advantages over WFD communication such as lower power consumption and the ability to communicate simultaneously with a large number of devices. The present invention is not limited to a configuration where the first wireless communication I F and the second wireless communication I F are two physically separate interfaces. The concept includes a single interface physically functioning as either the first wireless communication I F or the second wireless communication I F in accordance with software support.

The access point is a device that functions as a Wi Fi access point and has a service set identifier also referred to as SSID . The SSID is a name for identifying the access point . The information processing apparatus can send a print request or a scan request to the MFP the scanner and the color laser printers based on communication via the wireless LAN I F by executing a print scan application .

The information processing apparatus is for example a portable device such as a portable phone or a portable terminal device. The information processing apparatus comprises a display module a touch screen an input I F a wireless LAN I F an NFC I F a central processing unit referred to as CPU a read only memory referred to as ROM a random access memory referred to as RAM and a storage . These elements are mutually connected via an I O port .

The display module receives an image signal output from the CPU and displays an image based on the received image signal. As the display module for example an LCD or an organic EL display may be used. The touch screen is made from a transparent member and disposed so as to cover a surface of the display module . The touch screen detects a position that was touched by a user s finger or the like and outputs the detected position information to the CPU . The input I F is for example an operation button. The wireless LAN  I F is an interface for executing a wireless communication in the wireless LAN mode.

The CPU executes programs stored in the storage . The RAM temporarily stores information required for processing to be performed by the CPU . The storage is configured by combining a flash memory a hard disk referred to as HDD a buffer of the CPU and so on. The storage can store image data document data and the like. The storage stores a program . The program includes the print scan application hereinafter indicated as the application and an operating system hereinafter referred to as the OS . The CPU executes processing according to the program .

The storage may be a computer readable storage medium. The computer readable storage medium is a non transitory medium such as a ROM RAM flash memory hard disk etc. A ROM RAM flash memory hard disk etc. are tangible mediums. An electrical signal carrying a program to be downloaded from a server etc. on the Internet is not included in the non transitory medium.

The application is an application for causing the CPU to execute processing such as sending a printing command from the information processing apparatus to the MFP or the like. The OS is a program that provides basic functions and is commonly used by the application and the like. The OS includes programs and the like for conducting a wireless communication with the wireless LAN I F . Moreover the OS is a program for the respective programs to acquire information that was acquired by the various types of hardware or for providing an application programming interface referred to as API for the respective programs to give commands to the various types of hardware.

Moreover the storage stores a communication target device table TB. The communication target device table TB is a table for storing various information for identifying a communication target device. The communication target device is a device that is set forth each use. The communication target device is a device that is preferentially used among a plurality of devices when such a plurality of devices capable of executing processing pertaining to a certain use exists. The communication target device may be referred to as a default device or a second device depending on the difference in the communication path that is used. The default device is the communication target device for communicating using a Wi Fi communication via the first wireless communication I F . The second device is the communication target device for communicating using a WFD communication via the second wireless communication I F . That is the default device and the second device are the same device that is using a different communication path.

A model name an IP address and a MAC address are stored in the default device storage area as information related to a default device. Furthermore a model name an IP address an SSID a device ID and a MAC address are stored in the second device storage area as information related to a second device.

Each of the model names and is information for identifying each type of device. In a first embodiment the model name for the MFP is Ink MFP . The model name for the scanner device is Scan . The model name for the color laser printer device is Laser .

Each of the IP addresses and is an identification number that is allocated to each device and used in Wi Fi communication. Each of the MAC addresses and is a physical address for identifying each device. Each of the MAC address and can be used as information for executing a WFD communication with a default device. The SSID is identification information for identifying an access point to be used when executing a Wi Fi communication with a default device. The device ID is identification information that is allocated to each device and used in a WFD communication.

In the example of the communication target device table TB shown in when device capable of executing processing related to the use of the photo printing exists in a plurality with regard to that use it can be seen that the MFP is set as the device that is preferentially used among the plurality of devices. For example in the present case the MFP and the color laser printer are available for the use of the photo printing .

The configuration of the MFP is now explained. The MFP mainly comprises a CPU a storage a wireless LAN I F a button input section a panel a printer and a scanner . The wireless LAN I F is provided with a first wireless communication I F and a second wireless communication I F . The first wireless communication I F is an interface for executing a Wi Fi communication. The second wireless communication I F is an interface for executing a WFD communication. These constituent elements are mutually communicable via an I O port .

The CPU executes a program stored in the storage . The storage is configured by combining a RAM a ROM a flash memory an hard disk referred to as HDD a buffer of the CPU and so on. As with the storage the storage may be a computer readable storage medium. The storage stores the program and MIB information . The program includes an OS and the like.

MIB information is information related to the MFP itself and is exported to an external apparatus such as the information processing apparatus . The external apparatus can acquire the MIB information from the MFP in accordance with a request from the external apparatus. The MIB information includes a model name a MAC address Wi Fi status information SSID historical information an IP address and so forth. The model name is information for identifying the MFP . In the present embodiment the model name is Ink MFP . The MAC address is the physical address for identifying the MFP . The Wi Fi status information is various information related to a Wi Fi communication. The Wi Fi status information includes information as to whether or not a power source for the first wireless communication I F is ON and information showing an access point that exists within the communication range of the first wireless communication I F for example. The SSID historical information shows the SSID of an access point where the MFP had been connected in the past. The IP address is information for identifying the MFP .

The button input section is a key for executing the respective functions of the MFP . The button input section may also be configured integrally as a touch screen with the panel . The panel displays the various types of functional information of the MFP . The printer is a portion for executing printing using the image data stored in the storage . The scanner is a portion for executing reading.

In the ensuing explanation the CPU to execute programs such as an application and an operating system is sometimes simply referred to by the program name. For example the indication of application may mean the CPU that executes the application . In the present specification the description the CPU of the information processing apparatus receives various types of information includes the technical meaning the CPU of the information processing apparatus acquires various types of information via the wireless LAN I F . Further the description the CPU of the information processing apparatus transmits various types of information includes the technical meaning the CPU of the information processing apparatus outputs various types of information via the wireless LAN I F .

Here a definition of the words data and information will be explained. In the present specification information is used as a concept superordinate to data . Consequently A data may be rephrased as A information . Further even if the information has a different format as data e.g. text format binary format flag format etc. this is treated as the same information as long as it is recognized that the meaning is the same. For example as long as the device treats this as information indicating that the number of print copies is two parts data of the text format COPY 2 and data of the binary format 10 is the same information. However the aforementioned distinction between information and data is not rigid and exceptions to the rule are also allowed.

In the present specification data and information before and after receiving a prescribed operation are regarded as the same data and information. For example it is supposed that key information that is not encoded is stored in the storage and that key information that has been encoded written as encoded key information hereinbelow has been received through the wireless LAN I F . In this case when the key information stored in the storage matches decoded key information obtained by decoding the encoded key information the key information the encoded key information and the decoded key information are all treated as the same key information . The prescribed operation is not limited to encoding decoding and may be a hashing operation or the like.

Processing in which the CPU controls various components in accordance with the application will be explained below using . The flow in is started in accordance with an execution instruction for a communication target device registration process being inputted. The communication target device registration process stores information related to a communication target device in the communication target device table TB. The input of an execution instruction for the communication target device registration process for example may be executed by a user touching a registration process execution button displayed on the display module .

In S the CPU determines whether or not a use designation operation that designates any of the three types of uses i.e. photo printing web printing or scan has been received. For example the application in the display module displays an icon corresponding to each of the aforementioned three types of uses on the display module . Then when a site where an icon is being displayed has been touched the CPU determines that the use denoted by the touched icon has been designated. The processing returns to S when the determination is negative S NO and proceeds to S when the determination is affirmative S YES .

In S the CPU determines whether or not a communication target device designation instruction has been inputted. The communication target device designation instruction is input by the user to designate a communication target device. For example the CPU may cause the display on the display module of a communication target device designation screen for receiving a communication target device designation. The configuration may be such that a list of the names of devices that were connected in the past may be displayed on the communication target device designation screen and the selection of any device may be accepted. Furthermore identification information for identifying a device that was connected in the past may be stored in the storage together with the device name. Examples of identification information are an IP address a MAC address and so forth. The configuration may also be such that an input column for the identification information for identifying the communication target device may be displayed on the communication target device designation screen and the input of the relevant identification information may be accepted. The processing proceeds to S when the determination is negative S NO and proceeds to S when the determination is affirmative S YES .

In S the CPU temporarily stores identification information for identifying the device designated as the communication target device in the storage as designated device identification information.

In S the CPU starts a Wi Fi communication device search thread. The Wi Fi communication device search thread is a program for determining whether or not a Wi Fi communication device that is capable of communicating using the first wireless communication I F is included among a plurality of external devices that is the MFP the scanner and the color laser printer . Specifically the CPU broadcasts a packet to the plurality of external devices requesting that the external devices respond with identification information e.g. an IP address and waits for the identification information responses from the external devices.

In S the CPU starts a WFD communication device search thread. The WFD communication device search thread is a program for determining whether or not a WFD communication device that is capable of communicating using the second wireless communication I F is included among a plurality of external devices that is the MFP the scanner and the color laser printer . Specifically the CPU uses the second wireless communication I F to broadcast a packet requesting that the external devices respond with identification information e.g. an IP address . Then the CPU waits for the identification information responses from the external devices.

In S the CPU determines whether or not Wi Fi communication device identification information has been received. This determination may be made in accordance with whether or not an IP address has been received in response to the packet broadcast in the Wi Fi communication device search thread S . When the determination is affirmative S YES the CPU is able to determine that a Wi Fi communication device is included among the plurality of external devices. Accordingly the processing proceeds to S.

In S the CPU executes a first Wi Fi communication device save process. The content of the first Wi Fi communication device save process will be explained using .

In S the CPU uses the IP address received in S to acquire information related to the Wi Fi communication device from the relevant Wi Fi communication device. The acquisition of information related to the Wi Fi communication device is performed using the first wireless communication I F . The information related to the Wi Fi communication device may be MIB information. In the present embodiment a case in which the MAC address and the model name of the Wi Fi communication device are acquired as the information related to the Wi Fi communication device will be explained as an example.

In S the CPU determines whether or not the device identified using the IP address received in S and the Wi Fi communication device related information acquired in S matches the communication target device designated in S. This determination is affirmative when the IP address included in the designated device identification information stored in S and the IP address received in S are a match and is negative when these IP addresses do not match. Or this determination is affirmative when the MAC address included in the designated device identification information and the MAC address acquired in S are a match and is negative when these MAC addresses do not match. The information related to the Wi Fi communication device received by the first wireless communication I F may be encoded and the designated device identification information stored in the storage may be encoded. When the determination in S is affirmative S YES the processing proceeds to S.

In S the CPU stores information that was received from the Wi Fi communication device in the communication target device table TB. That is the CPU registers the Wi Fi communication device as the communication target device. This is another way of saying that the CPU registers the Wi Fi communication device as the default device. Register is the same as saying configure. Furthermore this is the same as saying that the CPU stores the Wi Fi communication device in the communication target device table TB as the communication target device. Specifically in the communication target device table TB the CPU selects the row corresponding to the use selected in S from among photo printing to scan . Then the CPU writes the model name the IP address and the MAC address of the device configured as the communication target device to the default device storage area in the selected row. This information was acquired in S and S. For example when photo printing has been selected in S the IP address and so forth are written in area R of . The processing then returns to S of .

When the determination in S is negative S NO the processing proceeds to S. In S the CPU stores the IP address of the Wi Fi communication device and the MAC address and model name of the Wi Fi communication device in the storage in a mutually associated manner. This makes it possible for the CPU to store the Wi Fi communication device as a default device candidate. The processing then returns to S of .

Alternatively when the determination in S of is negative S NO the processing proceeds to S. In S the CPU determines whether or not identification information has been received for a WFD communication device. This determination may be made in accordance with whether or not a device ID has been received in response to the packet that was broadcast in the WFD communication device search thread S . When the determination is affirmative S YES the CPU is able to determine that a WFD communication device is included among the plurality of external devices. Accordingly the processing proceeds to S.

In S the CPU executes a first WFD communication device save process. The contents of the first WFD communication device save process will be explained using . In S the CPU acquires from the OS the SSID of the access point to which the information processing apparatus is currently connected.

In S the CPU uses the device ID acquired in S to acquire information related to the WFD communication device from the relevant WFD communication device. The acquisition of the information related to the WFD communication device is performed using the second wireless communication I F . The information related to the WFD communication device may be MIB information. This will be explained in detail. The CPU via the second wireless communication I F sends query information requesting the MIB information that the WFD communication device is storing. Then the CPU receives via the second wireless communication I F the MIB information returned in response to the query information. In the present embodiment a case in which a model name a MAC address Wi Fi status information SSID historical information and an IP address are acquired as the MIB information will be explained as an example. The Wi Fi status information and the SSID historical information are only returned from a device that is capable of a Wi Fi communication.

In S the CPU determines whether or not the device identified using the device ID received in S and the WFD communication device related information acquired in S matches the communication target device designated in S. This determination may be affirmative when the device ID included in the designated device identification information stored in S matches the device ID received in S and may be negative when these device IDs do not match. The content described above in S is also applicable in S. When the determination in S is affirmative S YES the processing proceeds to S.

In S the CPU stores information received from the WFD communication device in the communication target device table TB. That is the CPU registers the WFD communication device as the communication target device. Specifically in the communication target device table TB the CPU selects the row corresponding to the use selected in S from among photo printing to scan . Then the CPU writes the model name the IP address the SSID the device ID and the MAC address of the device configured as the communication target device to the second device storage area in the selected row. This information was acquired in S and S. Furthermore the CPU stores the Wi Fi status information and the SSID historical information acquired in S in the storage . For example when photo printing has been selected in S the IP address and so forth are written in area R of . The processing then proceeds to S. The content described above in S is also applicable in S.

When the determination in S is negative S NO the processing proceeds to S. In S the CPU stores the device ID of the WFD communication device the IP address the MAC address and the model name of the Wi Fi communication device in the storage in a mutually associated manner This makes it possible for the CPU to store the WFD communication device as a second device candidate. The processing then proceeds to S.

In S the CPU determines whether or not the WFD communication device is also a Wi Fi communication device. In other words a determination is made as to whether or not the device that was determined to be able to execute a WFD communication in S is also able to execute a Wi Fi communication. This determination may be made in accordance with whether or not the Wi Fi status information or the SSID historical information was acquired in S. In a case that the determination is negative S NO the processing returns to S of .

Alternatively when a determination was made in S that the WFD communication device is also a Wi Fi communication device S YES the processing proceeds to S. Hereinafter a device that is both a WFD communication device and a Wi Fi communication device will be described as a Wi Fi WFD communication device. In S the CPU determines whether or not a Wi Fi WFD communication device is in a state capable of executing a Wi Fi communication. This determination is affirmative when the Wi Fi status information acquired in S shows that the Wi Fi function of the Wi Fi WFD communication device is valid and the SSID historical information includes the same SSID as the SSID acquired in S. On the other hand this determination is negative when at least one of these is not so. Furthermore the determination may be affirmative when the Wi Fi status information shows that the Wi Fi function of the Wi Fi WFD communication device is valid regardless of the SSID historical information. This determination may be affirmative when the CPU uses a Wi Fi communication to send prescribed data to the Wi Fi WFD communication device and received returned data and may be negative when the CPU does not receive this returned data. An example of the prescribed data is a Ping packet complying with an ICMP referred to as Internet Control Message Protocol . When the determination is affirmative S YES the processing proceeds to S.

In S the CPU determines whether or not the Wi Fi WFD communication device is within Wi Fi communication range. This determination may be made in accordance with whether or not the CPU attempted to communicate with the Wi Fi WFD communication device via the first wireless communication I F and was able to receive various information. The determination may also be made in accordance with whether or not the Wi Fi status information acquired in S shows that a communication had been performed between the information processing apparatus and the Wi Fi WFD communication device. The processing returns to S of when the determination is negative S NO and proceeds to S when the determination is affirmative S YES .

Alternatively when it has been determined in S that the Wi Fi WFD communication device is not able to execute a Wi Fi communication S NO the processing proceeds to S. In S the CPU sends a Wi Fi communication start instruction to the Wi Fi WFD communication device. The Wi Fi communication start instruction is information for instructing the Wi Fi WFD communication device to configure a device status that will enable the execution of a Wi Fi communication.

In S the CPU within a prescribed period of time after sending the Wi Fi communication start instruction determines whether or not the IP address of the Wi Fi WFD communication device has been received from the Wi Fi WFD communication device via a WFD communication. The prescribed period of time may be one second for example. The processing returns to S of when the determination is negative S NO and proceeds to S when the determination is affirmative S YES .

In S the CPU determines whether or not the Wi Fi WFD communication device and the communication target device designated in S are a match. This determination is affirmative for example when the IP address included in the designated device identification information stored in S and the IP address of the Wi Fi WFD communication device are a match and is negative when these IP addresses do not match. The content described above in S is also applicable in S. When the determination in S is affirmative S YES the processing proceeds to S.

In S the CPU stores various information related to the Wi Fi WFD communication device in the default device storage area . That is the CPU registers the Wi Fi WFD communication device as the communication target device. Since the specific process is the same as the processing content of S described above an explanation will be omitted here. The processing then returns to S of .

When the determination in S is negative S NO the processing proceeds to S. In S the CPU stores the IP address of the Wi Fi WFD communication device and the MAC address and model name of the Wi Fi WFD communication device in the storage in a mutually associated manner. This makes it possible for the CPU to store the Wi Fi WFD communication device as a default device candidate. The processing then returns to S of .

When the determination is negative in S of S NO the processing proceeds to S. In S the CPU determines whether or not a fixed period of time has elapsed since starting the Wi Fi communication device search thread or the WFD communication device search thread in S or S. The processing returns to S when the determination is negative S NO and proceeds to S when the determination is affirmative S YES .

In S the CPU ends the Wi Fi communication device search thread started in S. In S the CPU ends the WFD communication device search thread started in S.

In S the CPU determines whether the device designated in S is stored in the communication target device table TB as either a default device or a second device. That is the CPU determines whether or not the device designated in S is registered as the communication target device. When the determination is affirmative S YES the CPU ends the processing and when the determination is negative S NO the processing proceeds to S.

In S the CPU executes processing for accepting a communication target device selection. A specific example will be explained. The CPU displays a communication target device selection screen on the display module . The communication target device selection screen is for accepting the selection of a default device and or a second device. A list of device names of devices stored as default device candidates in S and S is displayed on the communication target device selection screen as default device selection candidates. Furthermore a list of device names of devices stored as second device candidates in S is displayed on the communication target device selection screen as second device selection candidates. Then when any device from among the default device selection candidate devices has been selected the CPU configures the selected device as the default device. The contents of the processing for configuring the default device are the same as the contents described above in S. Furthermore when any device from among the second device selection candidate devices has been selected the CPU configures the selected device as the second device. The contents of the processing for configuring the second device are the same as the contents described above in S.

In S the CPU determines whether or not only a second device was registered in S. In other words the CPU determines whether or not only a WFD communication device was selected in S. When the determination is negative S NO the CPU ends the processing and when the determination is affirmative S YES the processing proceeds to S.

In S the CPU executes default device determination process. The default device determination process is for determining whether or not the second device registered in S is also a Wi Fi communication device. Since the second device is none other than the WFD communication device the default device determination process can also be called processing for determining whether or not the WFD communication device is also capable of executing a Wi Fi communication. That is the contents of the default device determination process are the same as the contents of S to S described above.

The registration of the communication target device is complete as a result of the communication target device registration process of and being completed. In accordance with this only a device for which at least one of the default device and the second device has been stored in the communication target device table TB is registered as the communication target device.

Image processing will be explained using . In S the CPU determines whether or not an input of a command to execute image processing has been accepted. This determination will be explained in detail. First the CPU accepts a use designation operation for designating any of the three types of uses of photo printing web printing or scan and displays an operation screen corresponding to each use. In a case that the accepted use is photo printing or web printing the CPU acquires print target data. Specifically in the case of photo printing the CPU either reads photo data that has been stored in the storage or causes a not shown camera section to take a photograph and acquires photo data created by the photography. In the case of web printing the CPU acquires web page data sent by a not shown web server and received by the information processing apparatus . The acquired print target data is displayed in a preview manner on the operation screen. Then a command for executing the image processing pertaining to the selected use is inputted in accordance with the user touching a process execution button in the operation screen. The processing returns to S when the determination is negative S NO and proceeds to S when the determination is affirmative S YES . In an example for explaining the present embodiment a case in which a photo printing execution command has been inputted will be explained below.

In S the CPU determines whether or not a default device that is a Wi Fi communication device is registered in the use photo printing . This determination will be explained in detail. When information such as the IP address is stored in the default device storage area Refer to area R of in the photo printing row of the communication target device table TB a determination of affirmative is made in S S YES . Alternatively when information such as the IP address is stored in the second device storage area Refer to area R of without information such as the IP address being stored in the default device storage area Refer to area R of in the photo printing row of the communication target device table TB a determination of negative is made in S S NO .

That is when the IP address and so forth are stored only in the second device storage area Refer to area R of in the photo printing row of the communication target device table TB the communication target device is determined to be the second device that is the WFD communication device . At this occasion whether or not information used in S is stored only in the second device storage area does matter. Here is a specific example a case is assumed where one information e.g. an IP address of a communication target device is stored in the default device storage area and another information indicating that a communication target device is a WFD communication device is stored in the second device storage area . In this case if the one information is not information used for the determination of S it is a state where the other information indicating that the communication target device is a WFD communication device is stored only in the storage e.g. the second device storage area .

When the determination in S is negative S NO the processing proceeds to S. In S the CPU communicates with the communication target device using a WFD communication and displays on the display module the fact that photo printing is to be executed. For example a character string such as Photo printing to be executed using a WFD communication may be displayed on the display module .

In S the CPU sends query information to the communication target device via the second wireless communication I F . The query information is for requesting the MIB information that is stored in the communication target device. In S the CPU receives the MIB information that is sent in response to the query information via the second wireless communication I F . In the present embodiment a case in which a model name a MAC address Wi Fi status information SSID historical information and an IP address are acquired as the MIB information will be explained as an example.

In S the CPU determines whether or not the communication target device is also a Wi Fi communication device. In other words the CPU determines whether or not the WFD communication device is also capable of executing a Wi Fi communication. This determination may be made in accordance with whether or not the same SSID as the SSID in the photo printing row of the communication target device table TB was acquired in S as the SSID historical information. The processing proceeds to S when the determination is negative S NO and proceeds to S when the determination is affirmative S YES .

The contents of the steps in S to S are the same as the contents of the steps in S to S of . Furthermore the content of S is the same as the content of S of . Accordingly explanations will be omitted here.

In S the CPU determines whether or not the communication target device is in a state that enables the execution of a Wi Fi communication. The CPU may perform this determination by performing the same process as in S on the basis of the Wi Fi status information acquired in S. Furthermore the CPU may perform this determination in the same way as S by sending the prescribed data to the communication target device. An example of the prescribed data is a Ping packet. When the determination is affirmative S YES the processing proceeds to S.

In S the CPU displays on the display module the fact that print processing will be executed on the communication target device using a Wi Fi communication. In S the CPU sends print data to the communication target device using a Wi Fi communication. The CPU may display a print execution button on the display module at this time and send the print data in response to the user having touched this print execution button. The CPU then ends the processing.

Alternatively when the determination in S is negative S NO the processing proceeds to S. In S the CPU determines whether or not the communication target device is capable of executing a WFD communication. When the determination is negative S NO the CPU ends the processing and when the determination is affirmative S YES the processing proceeds to S.

In S the CPU displays on the display module the fact that print processing is to be executed on the communication target device using a WFD communication. In S the CPU sends print data to the communication target device using a WFD communication. The CPU may display a print execution button on the display module at this time and may send the print data in response to the user having touched this print execution button. The CPU then ends the processing.

A case in which the MFP is registered as the communication target device will be explained as an example. Also a case in which photo printing is selected as the use will be explained. When the MFP has been selected as the communication target device S YES or S and it has been determined that the MFP is a Wi Fi communication device S YES the IP address and so forth are stored in the default device storage area of the communication target device table TB Refer to area R of . This makes it possible for the CPU to register the default device for photo printing use. When the MFP has been determined to be a WFD communication device S YES the IP address and so forth are stored in the second device storage area of the communication target device table TB Refer to area R of . This makes it possible for the CPU to register the second device for photo printing use. Then when a photo printing execution command is inputted S YES a determination is made as to whether the default device or the second device is registered as the communication target device S . Specifically when the IP address and other such information is stored in the default device storage area Refer to area R in in the photo printing row of the communication target device table TB it is determined that the default device is registered S YES . Therefore the CPU uses a Wi Fi communication to send print data to the MFP which is the communication target device S . Alternatively when the IP address and other such information is stored only in the second device storage area Refer to area R of it is determined that only the second device is registered S NO . Therefore the CPU uses a WFD communication to send the print data to the MFP which is the communication target device S . This makes it possible for the CPU to execute a communication with the communication target device by automatically selecting the appropriate I F from among the first wireless communication I F and the second wireless communication I F . Accordingly user friendliness can be increased.

When it is determined that only the second device is registered as the communication target device S NO the CPU can send the communication target device query information requesting the MIB information that the communication target device is storing S and can acquire the MIB information from the communication target device S . Then When it is determined that the communication target device is also capable of executing a Wi Fi communication S YES the CPU can additionally store the default device as a communication target device S . This makes it possible for the CPU to execute communications with the communication target device using the first wireless communication I F as much as possible.

When a communication target device selection has been accepted S and only the second device has been registered as the communication target device S YES the CPU can send the communication target device query information requesting the MIB information that the communication target device is storing and can acquire the MIB information from the communication target device S . Then When it is determined that the communication target device is also capable of executing a Wi Fi communication the CPU can additionally store the default device as a communication target device S . This makes it possible for the CPU to execute communications with the communication target device using the first wireless communication I F as much as possible.

When the communication target device is not in a state that enables the execution of a Wi Fi communication using the first wireless communication I F S NO or S NO the CPU can send by using a WFD communication via the second wireless communication I F a Wi Fi communication start instruction to the communication target device S S . The Wi Fi communication start instruction is information for instructing the communication target device to configure a device status that enables the execution of a Wi Fi communication. This makes it possible for the CPU to send the MFP a Wi Fi communication start instruction using a WFD communication. That is it becomes possible to use a low priority WFD communication to configure the communication target device to be able to execute a high priority Wi Fi communication.

When it has been determined that the default device and the second device are registered as the communication target device S YES and YES but that the communication target device is not in a state that enables the execution of a Wi Fi communication S NO the CPU can switch the communication path of the communication target device to a WFD communication that uses the second wireless communication I F S . This makes it possible to ensure the redundancy of the communication path thereby enabling a communication with the communication target device to be executed reliably.

When it is determined that only the second device is registered as the communication target device S NO the CPU can display on the display module information denoting that communication with the communication target device is to be performed using a WFD communication S . When it is determined that the default device is registered as the communication target device S YES the CPU can display on the display module information denoting that communication with the communication target device is to be performed using a Wi Fi communication S . This makes it possible to make the user aware of which of the first wireless communication I F and the second wireless communication I F is to be used.

The first embodiment described above was a mode in which in a case that one device is detected as a Wi Fi communication device and a WFD communication device the CPU configures the Wi Fi communication device as the default devices S S and configures the WFD communication device as the second device S . The second embodiment illustrates a mode in which in the case that one device is detected as a Wi Fi communication device and a WFD communication device the CPU configures the device whose existence was detected first as the default device. Since the configuration of the network used in the second embodiment has already been explained in the first embodiment an explanation will be omitted here.

In the second embodiment Sis executed instead of S of . In S the CPU determines whether or not a Wi Fi communication device has already been registered as the default device. Specifically the CPU selects from among photo printing to scan in the communication target device table TB the row that corresponds to the use that was selected in S. Then the CPU determines whether or not information denoting a Wi Fi communication device is stored in the default device storage area of the selected row. When the determination is negative the CPU configures a WFD communication device as the default device. When the determination is affirmative the CPU configures a WFD communication device as the second device.

Furthermore in the second embodiment Sis executed instead of S of . In S the CPU determines whether or not a WFD communication device has already been registered as the default device. Specifically the CPU determines whether or not information denoting a WFD communication device is stored in the default device storage area of the row corresponding to the use that was selected in S in the communication target device table TB . When the determination is affirmative the CPU reconfigures the WFD communication device which is configured as the default device to the second device. Then the CPU configures the Wi Fi communication device as the default device. Specifically in the communication target device table TB the CPU moves the information stored in the default device storage area to the second device storage area . Then the CPU stores information denoting the Wi Fi communication device in the default device storage area . Alternatively when the determination is negative the CPU configures the Wi Fi communication device as the default device.

In the second embodiment Sis executed instead of S of . The content of Sis the same as the content of Sdescribed above and therefore an explanation will be omitted here.

In a case that one device is detected as both the Wi Fi communication device and the WFD communication device 

when the one device has been detected as a WFD communication device prior to being detected as a Wi Fi communication device the CPU can configure the WFD device as the default device. Then when the one device has been detected as the Wi Fi communication device thereafter the CPU can reconfigure the WFD device as the second device and configure the Wi Fi communication device as the default device. This makes it possible for the CPU to configure a default device during a period when a Wi Fi communication device has not been detected.

While specific embodiments of the present invention have been described in detail above such description is for illustrative purposes only and is not intended to limit the scope and claims of the invention. Techniques described in the claims of the invention include various modifications and changes made to the specific examples illustrated above. Modifications will be described below.

A case in which the image processing of and is commenced in response to a print process or scan process execution command having been inputted in S was explained but the present invention is not limited to this aspect. The image processing of and may be commenced in accordance with a preview button which instructs the display of a preview of the acquired photo data having been pressed on the photo printing operation screen. When the preview button has been pressed S YES a preview image of the print target is displayed on the display module . The print setting may or may not be reflected on the preview display at this time. Then print processing may be commenced in response to a print button on the preview display screen being pressed. In the case of web printing the image processing of and may be commenced in accordance with the preview button for instructing the display of a preview of the acquired web page data having been pressed.

In the example explained in the present embodiment a case in which a photo printing execution command is inputted in S as an execution instruction for processing for communicating a prescribed data e.g. print data to the communication target device was explained. However the execution instruction for processing for communicating a prescribed data is not limited to an instruction by which like the print execution instruction a data communication is executed without user confirmation subsequent to the instruction. A specific instruction by which a data communication is executed after a confirmation instruction for confirming with the user whether or not a data communication may be executed subsequent to the instruction is included within the range of a data communication processing execution instruction . A preview display instruction can be considered one example of an instruction by which a data communication is executed after a confirmation instruction. When the preview display instruction is performed a display that previews the print target data is performed. The print execution button is also displayed together with the preview display. The user confirms the preview display and when printing is desired touches the print button. When the print button is touched the processing transitions to the execution of a print data communication.

In S the processing for configuring the Wi Fi WFD communication device as the default device may be a temporary process. For example the CPU may cause information such as the IP address to be stored in the default device storage area of the communication target device table TB S . Then after the processing of S and S has ended the CPU may delete the information that was stored in the default device storage area .

In the second embodiment a mode for configuring both the default device and the second device was explained but the present invention is not limited to this mode. There may also be a mode for storing only the default device. In this case when the WFD communication device has already been registered as the default device in S the CPU may configure the Wi Fi communication device as the default device in place of the WFD communication device. Specifically the CPU may store in an overwritten manner information denoting the Wi Fi communication device in the default device storage area of the communication target device table TB. Furthermore in a case that the Wi Fi communication device has already been registered as the default device in S the CPU need not cause the WFD communication device information to be stored in the communication target device table TB.

There may be a variety of methods for determining whether or not a WFD communication device is also a Wi Fi communication device in S. For example the CPU may execute this determination by comparing the MAC addresses. Specifically the CPU may execute the determination in accordance with whether or not the MAC address acquired in S and the MAC address of the Wi Fi communication device stored in the storage are a match. The MAC address of the Wi Fi communication device is information that is stored in the storage in S. Because a MAC address is a physical address that can uniquely identify an external device and in addition is commonly used information the MAC address makes it possible to reliably execute a determination process.

In S and S a configuration that acquires information from an external device is not limited to a configuration that uses MIB information. The configuration may be such that an external device replies with various information as a response to an information acquisition request from the information processing apparatus .

The condition for sending a Wi Fi communication start instruction in S can be configured in a variety of ways. For example the CPU may send a Wi Fi communication start instruction S when it has been determined that a Wi Fi WFD communication device is able to execute a Wi Fi communication S YES and a history of a Wi Fi communication previously executed with the Wi Fi WFD communication device remains in the storage . This makes it possible to prevent an unnecessary Wi Fi communication start instruction from being sent.

In S the present invention may also have a mode for receiving the IP address of a Wi Fi WFD communication device via a Wi Fi communication.

In S the CPU stores the information needed for executing a WFD communication e.g. device ID MAC address in the storage even in a case that a Wi Fi communication is executed with a Wi Fi WFD communication device. This makes it possible to switch over from a Wi Fi communication to a WFD communication using the device ID and MAC address in a case that a Wi Fi communication is not able to be used with the Wi Fi WFD communication device S NO . This enables the communication system to be provided with redundancy.

A plurality of default devices may be configured for each use. For example there may be a first default device and a second default device. The application may execute a communication with the first default device on a priority basis and may communicate with the second default device when it is not possible to communicate with the first default device. Then a Wi Fi communication device may be stored in the communication target device table TB as the first default device and a WFD communication device may be stored in the communication target device table TB as the second default device.

The processing for accepting the input of the communication target device designation instruction in S can be omitted. In this case when the determination in S is affirmative the processing proceeds to S. Furthermore S S S and S may be omitted. The processing for determining whether or not the Wi Fi WFD communication device is within the Wi Fi communication range S can be omitted. In this case when the determination in S is affirmative the processing proceeds to S. The processing for sending the Wi Fi communication start instruction S can be omitted. In this case when the determination in S is negative the processing may return to S of . From the above generally speaking the information processing apparatus may comprise at least receiving first communication device identification information receiving second communication device identification information selecting a communication target device storing the received first communication device identification information storing the received second communication device identification information accepting an execution instruction and performing the communication . As a specific example the information processing apparatus may execute at least S S S or S S or S or S S S and S or S.

The present invention is not limited to a configuration for registering a default device in the communication target device table TB in S S and S. For example the user can register a default device by operating the touch panel and inputting an IP address and the like.

The timing at which the application acquires from the OS the SSID of the network to which the information processing apparatus is currently connected is not limited to the timing of S. For example the SSID may be acquired at the timing at which a print preview is displayed and or at the timing at which the application is started.

The value of the IP address and the character string of the SSID used in this embodiment are merely examples and various values and character strings may be used.

The model name may be anything so as long as they are able to differentiate the devices for instance they may be configured only from symbols without including numbers. Moreover a name such as the device name capable of differentiating the devices may be used in substitute for the model name.

The information processing apparatus may also be configured so that an external memory such as a memory card can be connected thereto. Furthermore in substitute for the storage a configuration of storing the various types of data in an external memory can be adopted.

While the MFP was explained as an example of the image processing apparatus the configuration is not limited thereto. The configuration may also adopt a sewing machine that performs stitching or quilting of a predetermined image based on instruction data. The configuration may also adopt a sewing machine that performs decorative stitching or sewing to form work pieces or products based on image data. The configuration may also adopt a 3D printer that generates 3D images via spraying or machining based on instruction data or the like. The configuration may also adopt work piece manufacturing equipment or product manufacturing equipment that forms work pieces or products via spraying or machining based on image data or the like. As an example of image data 3D image data or 3D CAD data may be used. The configuration may also adopt a scanner that forms image data based on output data from a sensor which optically or electrically detects the profile of an object or based on output data from a sensor that is mounted on the object. The configuration may also adopt a scanner creates data indicating the shape or movement of an object based on the output from a sensor. As an example of image data moving image data or 3D image data may be used.

Each program may be constituted by a single program module or by a plurality of program modules. Each example may adopt another replaceable configuration which is within the context of the present invention. Adoptable configurations include a computer the CPU or the like which executes processing based on a program the print scan application or the like a computer which executes processing based on a program other than an image processing program such as an operating system and other applications a hardware configuration the touch screen or the like which operates according to an instruction by a computer and a configuration in which a computer and a hardware configuration work in conjunction with each other. Obviously adoptable configurations also include a computer which executes processing by coupling processing based on a plurality of programs and a hardware configuration which operates according to an instruction by a computer which executes processing by coupling processing based on a plurality of program

