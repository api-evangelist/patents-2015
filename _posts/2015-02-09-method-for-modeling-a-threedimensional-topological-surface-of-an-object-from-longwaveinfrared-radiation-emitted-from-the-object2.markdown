---

title: Method for modeling a three-dimensional topological surface of an object from long-wave-infrared radiation emitted from the object
abstract: A method and apparatus is provided for modeling a three-dimensional topological surface of an object acquiring, using a thermal imaging camera, a first image of the object, wherein the first image comprises a plurality of pixels each representative of at least one component of thermal data, calculating a normal vector for each pixel in the first image, corresponding to the normal vector on a surface of the object, generating a three-dimensional model representing a surface of the object based on aggregating the normal vector for each pixel together in the first image.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09609238&OS=09609238&RS=09609238
owner: The United States of America as represented by the Secretary of the Army
number: 09609238
owner_city: Washington
owner_country: US
publication_date: 20150209
---
Governmental Interest The invention described herein may be manufactured used and licensed by or for the U.S. Government. Research underlying this invention was sponsored by the U.S. Army Research Laboratory ARL and was accomplished under Cooperative Agreement Number W911N F 12 2 0019.

Embodiments of the present invention generally relate to a method for modeling a three dimensional topological surface of an object from thermal radiation emitted from the object.

Long wavelength infrared LWIR imaging has many practical applications. LWIR is generally a passive tool because it is a measure of a signal emitted by an object thus not requiring an additional light source. One major disadvantage of LWIR imaging is the lack of contrast with respect to background objects and noise. Images of people tend to look washed out and ghostlike and it is difficult to obtain information from the images which would allow reliable and repeatable identification of a person s characterizing facial or other features.

Therefore there is a need in the art for improvements in LWIR imaging to enhance identifiability of an object in accordance with exemplary embodiments of the present invention.

Embodiments of the present invention relate to a method for modeling a surface of an object. A method and apparatus is provided for modeling a surface of an object acquiring using a thermal imaging camera a first image of the object wherein the first image comprises a plurality of pixels each representative of at least one component of thermal data calculating a normal vector for each pixel in the first image corresponding to the normal vector on a surface of the object generating a three dimensional model representing a surface of the object based on aggregating the normal vector for each pixel together in the first image.

Embodiments of the present invention are directed to a method and apparatus for generating a three dimensional topological model of the surface of an object emitting thermal radiation using an image captured by a camera. The image captured by the thermal camera contains several component parts of data for each pixel in the image. For each pixel a surface plane is established by calculating a set of angles with reference to the camera s line of sight and the base of the camera. Once the surface plane is established a normal vector for each pixel is calculated. The normal vectors for all the pixels are integrated over the entire image forming a function representing the surface of the object. If the result of the function at each x y position is computationally rendered and or plotted against a third axis z the topology of the surface of the object can be visualized in three dimensions.

Thermal imaging involves using heat emitted from objects to form images. Heat is emitted by all objects above absolute zero and the amount of radiation emitted by an object increases with temperature. Thermal imaging allows one to see variations in temperature across a particular object or body. When viewed through a thermal imaging camera warmer objects are generally distinguishable from cooler backgrounds. Heat is typically captured by a thermal imaging camera in the infrared radiation IR spectrum. Depending on the particular object imaged some types of thermal radiation may give rise to excessive noise or not enough data to distinguish the features of an object. One spectrum of thermal imaging that may be of interest is LWIR which is defined as electromagnetic radiation or light having wavelengths of about 8 15 m. This spectrum is generally emitted by humans and other warm blooded animals. However those skilled in the art will appreciate that the invention is not limited to imaging using the LWIR spectra and that in embodiments of the present invention other spectra can be used for thermal imaging also.

The topology generator comprises a plane module a normal module and a surface module . The topology generator may be embodied as computer software executing on the computer system . A thermal camera is coupled to the computer system . Thermal camera is configured to acquire images representative of thermal radiation emitted by one or more target object s such as thermal radiation emitting object . As such the thermal camera and the topology generator do not require a light source to illuminate the object . According to one embodiment the thermal camera is a polarimetric camera equipped with a Stirling cooled mercury cadmium telluride focal plane array of 640 by 480 pixels. In this embodiment the array has a spectral response range of 7.5 11.1 m. In this embodiment the thermal camera is configured to record a sequence of 32 bit images at a frame rate of 120 Hz and a well known Fourier modulation technique is applied to the images to obtain radiation data of object in the form of a Stokes Vector recorded by camera collectively referred to as camera data .

When positioned in a non illuminated environment containing object thermal camera captures the radiation emitting from the object . In some instances the object may be a human a running vehicle an animal or the like. The thermal camera acquires thermal data emitted from the object and generates camera data corresponding to the radiation e.g LWIR emitted from the object . In one embodiment the camera data includes the polarization state of the total wave emanating from the object along with several other parameters as components of the Stokes vector. Those of ordinary skill in the art recognize that the Stokes vector comprises 4 elements 1 total intensity of emitted radiation 2 tendency of emitted radiation to be horizontally or vertically polarized 3 tendency of radiation to be polarized at 45 degree angle 4 tendency of the radiation being right circularly or left circularly polarized. Those of ordinary skill in the art recognize that the degree of linear polarization DoLP is calculated using S Sand Sby the thermal camera . The magnitude and direction of the electric field vector at each pixel is determinable based on these four elements. In this embodiment the camera data comprises at least the Stokes parameters S S S and DoLP for each pixel of the array of camera . The camera may configured to output Stokes Vector data directly or such values may be computed externally by an image processor for the camera data . The Stokes parameters may comprise a data vector in camera data . In general only parameters S Sand DoLP are utilized while Sis generally not used by the methods described below except to normalize the quantities to the total amount of intensity.

The recorded images contain both reflected and emitted waves. As a consequence of the Fresnel equations the emitted waves are polarized parallel to the plane of emission which is defined by the line of sight of the camera and the surface normal N. In contrast reflected waves are polarized perpendicular to this plane. In other words the emitted and the reflected polarization states are orthogonal.

According to some embodiments each of plane module normal module and surface module comprises software instructions residing in memory and executable by one or more processors as CPUs CPU to CPU N in . The plane module calculates the orientation of a plane with respect to the ground shown in and for each pixel in an image captured by the thermal camera based on the camera data .

Subsequently the plane information from the plane module is provided to the normal module . The normal module calculates the surface normal vectors at each pixel in the image wherein the surface normal is a vector perpendicular to the surface on the object at the point on the surface corresponding to pixel . Once the surface normal vector for each pixel is calculated the surface module integrates the surface normal vectors for all the pixels over the entire image to obtain a function f x y defining the surface of the object . The surface module then determines the value of the function f x y at each point x y to determine a third dimension value for each point. The value of the function f x y at each point represents the topological height of every pixel representing a planar patch of the object visible by the camera . The surface module can plot the value of the function f x y on a third axis z perpendicular to the plane formed by the x and y axes as three dimensional surface representation of the object . In some embodiments the vectors comprising camera data can be mapped to the representation to generate a more visually discernible view of the surface of the object .

The data points x y and z may be stored digitally in an array pointer and or in any other electronic data structure or file structure as commonly used in computers. The data points can be rendered into a viewable model for display on a display device for example model in . One such technique is by a wiremesh plot for example. Once rendered the image may be manipulated in many ways. For example the vantage point of the image may be altered to view the image at various angles and or distances. Other image processing may be implemented as conventional. The image may be printed in a 2 D form e.g. using an ink jet or laser printer. Alternatively or additionally the image may be printed in a 3 D form using a 3 D printer.

According to some embodiments the topology generator requires a numerical value for the complex index of refraction n for particular surfaces such as human skin. The effective refractive index is considered to be constant over a human body. The real part of this effective n is between 1.4 and 1.6 and the imaginary part is between 0.01 and 0.03.

The method begins at step and proceeds to step . At step a camera e.g. camera of acquires a first image of an object. The image comprises a plurality of pixels each representative of at least one component of thermal data e.g. there are values for each of the Stokes parameters in each of the pixels for the first image . According to exemplary embodiments the camera is a thermal polarimetric camera. The camera captures various data points regarding polarization of light emitted from each portion of the object facing the camera. No light source is required in the method besides the thermal data e.g. long wave infrared radiation emitted from the object itself. The camera may be used in a nocturnal setting where in some instances an object is present such as a human or a vehicle and in some cases no objects are present. The method is invoked as described when an object is present.

In exemplary embodiments the thermal data is embodied in several images captured by the camera. The images contain at each pixel polarization state information such as intensity and other information regarding the light. In exemplary embodiments the thermal data captures spectral emissivity absorptivity and reflectivity r of the thermal radiation being emitted by the object.

As the method proceeds to step for each pixel of the image captured by the camera a surface normal vector is calculated. The calculated surface normal vector corresponds to a normal vector on the surface of the object . The surface calculation is described in more detail in text accompanying below. Once surface information is available the method proceeds to step when a three dimensional model is generated for the surface of the object based on an aggregation of the normal vectors for each surface incident to the pixel together described in more detail with respect to . The method terminates at step .

The method begins at step and proceeds to step . Given that a camera such as camera in has captured thermal data emitted from an object in the form of an image a first angle with respect to a line of sight from the camera to the object is determined for each pixel of the image based on the camera data . The first angle is measured as between a normal emanating from a point on the object e.g. normal in represented by the pixel of the image and the camera s line of sight e.g. vector in .

Those of ordinary skill in the art will recognize that the components of the thermal data spectral emissivity absorptivity and reflectivity r of the thermal radiation being emitted by the object the thermal data being contained in the camera data are related according to the following equation 1 Eq. 1 

The angle the angle between N the normal surface at the pixel and the line of sight of camera must be determined. The polarization state with respect to the plane of emission from the object is denoted by the subscript p or for perpendicular and for parallel .

In order to obtain the first angle DoLP is used. The DoLP is contained within the camera data for each pixel of the image captured by camera . The definition of DoLP can be expressed as a function of as follows 

These equations are known to those of ordinary skill in the art as simple geometrical relationships between the degree of linear polarization and the angle between the camera s line of sight and the normal vector of the surface at the pixel being examined.

If the surface of object is partitioned into planar facets i.e. small surfaces representing a plane at each pixel and possible multiple reflections of the emitted radiation are neglected then the equation can be solved to obtain . By equating Equations 2a 2c to the experimentally measured DoLP and then numerically or analytically solving for a value for is calculated for each pixel.

At step a second angle is calculated. Angle is defined as the azimuthal angle the angle between the plane and some reference plane e.g. the floor plane . The second angle is calculated according to the following formula 0 or Eq. 3 

The values of the Stokes parameters Sand Sare contained in the camera data for each pixel in the image captured by the camera . Accordingly is obtained and subsequently can be calculated.

Equation 3 determines up to an ambiguity of radians because the Stokes parameters contained in camera data are invariant under a rotation of radians. Such an ambiguity constitutes an additional unknown in the mathematical solution. To resolve this ambiguity an additional boundary condition is introduced that the surface normal must point away from the subject s head on the occluding boundary in the case of a human as object . In other words is set to or on the occluding boundary so that the normal N at a pixel satisfies the above requirement. After is chosen on the occluding boundary we move to the neighboring pixels and is chosen for these neighboring pixels in such a way that the normal for these pixels points in the same direction as the normal on the occluding boundary. This process is continued iteratively for all remaining ambiguous s for which the corresponding is larger than some threshold. The s for which the corresponding is smaller than the threshold are left unchanged because these facets are only slightly tilted with respect to the line of sight of the camera. In other embodiments this additional boundary condition may be different for objects other than human faces and bodies or the like.

Once is known the surface normal for each pixel is calculated at step according to the following equation 

Since and have already been solved for in equations 2a 2c 3 and 4 these values can be substituted in Equations 6 and 7 to solve for the derivative of f x y with respect to x and with respect to y. Finally the surface normal vector N for each pixel is determined through Equation 5 at step .

At step each normal vector N corresponding to a pixel of the captured image is integrated to generate a surface function which defines the surface f x y of the object.

A number of methods are available to integrate N and obtain f x y up to an additive constant. According to one embodiment the Frankot Chellapa method is chosen for simplicity and robustness to noise. The Frankot Chellapa method enforces the integrability condition N 0 for all points on the support of f x y and thus the surface normal is smoothed in cases where object may have some surface discontinuities.

The function f x y accepts 2 parameters x y which correlate to a pixel location in a two dimensional grid. Substituting a pixel location for x and y in the function f x y a value of the function is obtained and is interpreted as the topological depth of the object at a particular location. Accordingly a third dimension z is introduced as the value of function f x y showing the depth of object . At step the function f x y is used to generate a topological plot of the object in three dimensions x y and z. The topological plot is shown as a wire mesh in .

The method moves to step where one of the images shown in is mapped directly onto the plot to provide a more accurate visualization of the object . In one embodiment each pixel is painted with the corresponding value of the DoLP pixel for example. For illustrative purposes illustrates the image mapped onto the wire mesh to generate model . Each pixel value from image is mapped to a corresponding point in the wire mesh plot by the surface module so that the wire mesh is easily recognizable. The method terminates at step .

Many thermal cameras can generate a Stokes vector. If a component of the Stokes vector for each pixel is taken and combined an image can be formed. For example the Scomponent produces the Simage . The Scomponent produces the Simage . The degree of linear polarization DoLP component produces the image . Finally the Scomponent produces the Simage .

As readily apparent certain portions of the subject s face are much easier to distinguish recognize in the improved image when compared to the conventional images i.e. eye brows eye lashes teeth wrinkles in the forehead etc. Image can be mapped onto the three dimensional surface representation shown in to provide a better view of the object being captured by camera .

Aspects related to this invention have been previously disclosed by Kristan P. Gurton Alex J. Yu and Gorden Videen in LWIR Polarimetry for Enhanced Facial Recognition in Thermal Imagery Proc. of SPIE Vol. 9099 pp. 90990G 1 G 9 2014 and Enhanced facial recognition for thermal imagery using polarimetric imaging Optics Letters Vol. 39 No. 13 pp. 3857 3859 2014 herein incorporated by reference in their entireties.

The foregoing description for purpose of explanation has been described with reference to specific embodiments. However the illustrative discussions above are not intended to be exhaustive or to limit the invention to the precise forms disclosed. Many modifications and variations are possible in view of the above teachings. The embodiments were chosen and described in order to best explain the principles of the present disclosure and its practical applications to thereby enable others skilled in the art to best utilize the invention and various embodiments with various modifications as may be suited to the particular use contemplated.

Various elements devices modules and circuits are described above in associated with their respective functions. These elements devices modules and circuits are considered means for performing their respective functions as described herein. While the foregoing is directed to embodiments of the present invention other and further embodiments of the invention may be devised without departing from the basic scope thereof and the scope thereof is determined by the claims that follow.

