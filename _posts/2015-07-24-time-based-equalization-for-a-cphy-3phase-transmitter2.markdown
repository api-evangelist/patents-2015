---

title: Time based equalization for a C-PHY 3-phase transmitter
abstract: A method, an apparatus, and a computer program product for data communication over a multi-wire, multi-phase interface are provided. The method may include providing a sequence of symbols to be transmitted on a 3-wire interface, each symbol in the sequence of symbols defining one of three voltage states for each wire of the 3-wire interface, driving all wires of the 3-wire interface to a common voltage state during a transition from a first transmitted symbol to a second transmitted symbol, driving each wire of the 3-wire interface in accordance with the second transmitted symbol after a predetermined delay. Each wire may be in a different voltage state from the other wires of the 3-wire interface during transmission of the each symbol. The common voltage state may lie between two of the three voltage states.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09553635&OS=09553635&RS=09553635
owner: QUALCOMM Incorporated
number: 09553635
owner_city: San Diego
owner_country: US
publication_date: 20150724
---
The present disclosure relates generally to high speed data communications interfaces and more particularly to conditioning signals transmitted on a multi wire multi phase data communication link.

Manufacturers of mobile devices such as cellular phones may obtain components of the mobile devices from various sources including different manufacturers. For example an application processor in a cellular phone may be obtained from a first manufacturer while the display for the cellular phone may be obtained from a second manufacturer. The application processor and a display or other device may be interconnected using a standards based or proprietary physical interface. For example a display may provide an interface that conforms to the Display System interface DSI standard specified by the Mobile Industry Processor Interface MIPI Alliance.

Higher frequency components of a high speed signal traveling through a channel can be significantly attenuated due to channel bandwidth limitations and the degree of attenuation may correlate to the frequency of the signal. The losses of high frequency components can cause inter symbol interference ISI and can increase jitter. A commonly used compensation technique employs pre emphasis at the transmitter which may also be referred to as feed forward equalization FFE . FFE can be employed in single ended and differential line drivers but has limited effect on other types of drivers.

In one example a three wire interface C PHY defined by the MIPI Alliance uses a trio of conductors rather than differential pairs to transmit information between devices. Each of the three wires may be in one of three signaling states during transmission of a symbol over the C PHY interface. Clock information is encoded in a sequence of symbols transmitted on the C PHY link and a receiver generates a clock signal from transitions between consecutive symbols. In a C PHY interface the maximum speed of the communication link and the ability of a clock data recovery CDR circuit to recover clock information may be limited by the maximum time variation related to transitions of signals transmitted on the different wires of the communication link.

Embodiments disclosed herein provide systems methods and apparatus that enable improved communications on a multi wire and or multiphase communications link. The communications link may be deployed in apparatus such as a mobile terminal having multiple Integrated Circuit IC devices.

In an aspect of the disclosure a method of data communication includes providing a sequence of symbols to be transmitted on a 3 wire interface each symbol in the sequence of symbols defining one of three voltage states for each wire of the 3 wire interface driving all wires of the 3 wire interface to a common voltage state for a predetermined time interval during a transition from a first transmitted symbol to a second transmitted symbol and driving each wire of the 3 wire interface in accordance with the second transmitted symbol after the predetermined time interval has elapsed. Each wire may be in a different voltage state from the other wires of the 3 wire interface during transmission of the each symbol. The common voltage state may lie between two of the three voltage states.

In an aspect of the disclosure an apparatus for data communication includes means for providing a sequence of symbols to be transmitted on a 3 wire interface each symbol in the sequence of symbols defining one of three voltage states for each wire of the 3 wire interface means for driving all wires of the 3 wire interface to a common voltage state during a transition from a first transmitted symbol to a second transmitted symbol and means for driving each wire of the 3 wire interface in accordance with the second transmitted symbol after a predetermined delay. Each wire may be in a different voltage state from the other wires of 3 wire interface during transmission of the each symbol. The common voltage state may lie between two of the three voltage states.

In an aspect of the disclosure an apparatus for data communication includes a plurality of line drivers coupled to a 3 wire bus an encoder configured to provide a sequence of symbols to be transmitted on the 3 wire bus each symbol in the sequence of symbols defining one of three voltage states for each wire of the 3 wire bus where each wire is in a different voltage state from the other wires of 3 wire bus during transmission of the each symbol and a processing system configured to cause the plurality of line drivers to drive all wires of the 3 wire bus to a common voltage state during a transition from a first transmitted symbol to a second transmitted symbol and cause the plurality of line drivers to drive each wire of the 3 wire bus in accordance with the second transmitted symbol after a predetermined delay. The common voltage state may lie between two of the three voltage states.

In an aspect of the disclosure a processor readable storage medium is disclosed. The storage medium may be a non transitory storage medium and may store code that when executed by one or more processors causes the one or more processors to provide a sequence of symbols to be transmitted on a 3 wire interface each symbol in the sequence of symbols defining one of three voltage states for each wire of the 3 wire interface drive all wires of the 3 wire interface to a common voltage state during a transition from a first transmitted symbol to a second transmitted symbol drive each wire of the 3 wire interface in accordance with the second transmitted symbol after a predetermined delay. The common voltage state may lie between two of the three voltage states. Each wire may be in a different voltage state from the other wires of 3 wire interface during transmission of the each symbol.

The detailed description set forth below in connection with the appended drawings is intended as a description of various configurations and is not intended to represent the only configurations in which the concepts described herein may be practiced. The detailed description includes specific details for the purpose of providing a thorough understanding of various concepts. However it will be apparent to those skilled in the art that these concepts may be practiced without these specific details. In some instances well known structures and components are shown in block diagram form in order to avoid obscuring such concepts.

As used in this application the terms component module system and the like are intended to include a computer related entity such as but not limited to hardware firmware a combination of hardware and software software or software in execution. For example a component may be but is not limited to being a process running on a processor a processor an object an executable a thread of execution a program and or a computer. By way of illustration both an application running on a computing device and the computing device can be a component. One or more components can reside within a process and or thread of execution and a component may be localized on one computer and or distributed between two or more computers. In addition these components can execute from various computer readable media having various data structures stored thereon. The components may communicate by way of local and or remote processes such as in accordance with a signal having one or more data packets such as data from one component interacting with another component in a local system distributed system and or across a network such as the Internet with other systems by way of the signal.

Moreover the term or is intended to mean an inclusive or rather than an exclusive or. That is unless specified otherwise or clear from the context the phrase X employs A or B is intended to mean any of the natural inclusive permutations. That is the phrase X employs A or B is satisfied by any of the following instances X employs A X employs B or X employs both A and B. In addition the articles a and an as used in this application and the appended claims should generally be construed to mean one or more unless specified otherwise or clear from the context to be directed to a singular form.

Certain aspects of the invention may be applicable to a C PHY interface specified by the MIPI Alliance which may be deployed to connect electronic devices that are subcomponents of a mobile apparatus such as a telephone a mobile computing device an appliance automobile electronics avionics systems etc. Examples of a mobile apparatus include a cellular phone a smart phone a session initiation protocol SIP phone a laptop a notebook a netbook a smartbook a personal digital assistant PDA a satellite radio a global positioning system GPS device a multimedia device a video device a digital audio player e.g. MP3 player a camera a game console a wearable computing device e.g. a smartwatch a health or fitness tracker etc. an appliance a sensor a vending machine or any other similarly functioning device.

The C PHY interface is a high speed serial interface that can provide high throughput over bandwidth limited channels. The C PHY interface may be deployed to connect application processors to peripherals including displays and cameras. The C PHY interface encodes data into symbols that are transmitted in a three phase signal over a set of three wires which may be referred to as a trio or trio of wires. The three phase signal is transmitted on each wire of the trio in different phases. Each three wire trio provides a lane on a communications link. A symbol interval may be defined as the interval of time in which a single symbol controls the signaling state of a trio. In each symbol interval one wire is undriven while the remaining two of the three wires are differentially driven such that one of the two differentially driven wires assumes a first voltage level and the other differentially driven wire assumes to a second voltage level different from the first voltage level. The undriven wire may float be driven or terminated such that it assumes a third voltage level that is at or near the mid level voltage between the first and second voltage levels. In one example the driven voltage levels may be V and V with the undriven voltage being 0 V. In another example the driven voltage levels may be V and 0 V with the undriven voltage being V 2. Different symbols are transmitted in each consecutively transmitted pair of symbols and different pairs of wires may be differentially driven in different symbol intervals.

The communication link may include multiple channels and . One or more channel may be bidirectional and may operate in half duplex and or full duplex modes. One or more channel and may be unidirectional. The communication link may be asymmetrical providing higher bandwidth in one direction. In one example described herein a first communications channel may be referred to as a forward channel while a second communications channel may be referred to as a reverse channel . The first IC device may be designated as a host system or transmitter while the second IC device may be designated as a client system or receiver even if both IC devices and are configured to transmit and receive on the communications channel . In one example the forward channel may operate at a higher data rate when communicating data from a first IC device to a second IC device while the reverse channel may operate at a lower data rate when communicating data from the second IC device to the first IC device .

The IC devices and may each include a processor or other processing and or computing circuit or device . In one example the first IC device may perform core functions of the apparatus including establishing and maintaining wireless communications through a wireless transceiver and an antenna while the second IC device may support a user interface that manages or operates a display controller and may control operations of a camera or video input device using a camera controller . Other features supported by one or more of the IC devices and may include a keyboard a voice recognition component and other input or output devices. The display controller may include circuits and software drivers that support displays such as a liquid crystal display LCD panel touch screen display indicators and so on. The storage media and may include transitory and or non transitory storage devices adapted to maintain instructions and data used by respective processors and and or other components of the IC devices and . Communication between each processor and its corresponding storage media and and other modules and circuits may be facilitated by one or more internal bus and and or a channel and or of the communication link .

The reverse channel may be operated in the same manner as the forward channel and the forward channel and the reverse channel may be capable of transmitting at comparable speeds or at different speeds where speed may be expressed as data transfer rate and or clocking rates. The forward and reverse data rates may be substantially the same or differ by orders of magnitude depending on the application. In some applications a single bidirectional channel may support communications between the first IC device and the second IC device . The forward channel and or the reverse channel may be configurable to operate in a bidirectional mode when for example the forward and reverse channels and share the same physical connections and operate in a half duplex manner. In one example the communication link may be operated to communicate control command and other information between the first IC device and the second IC device in accordance with an industry or other standard.

The communication link of may be implemented according to MIPI Alliance specifications for C PHY and may provide a wired bus that includes a plurality of signal wires denoted as M wires . The M wires may be configured to carry N phase encoded data in a high speed digital interface such as a mobile display digital interface MDDI . The M wires may facilitate N phase polarity encoding on one or more of the channels and . The physical layer drivers and may be configured or adapted to generate N phase polarity encoded data for transmission on the communication link . The use of N phase polarity encoding provides high speed data transfer and may consume half or less of the power of other interfaces because fewer drivers are active in N phase polarity encoded data links.

N phase polarity encoding devices and or can typically encode multiple bits per transition on the communication link . In one example a combination of 3 phase encoding and polarity encoding may be used to support a wide video graphics array WVGA frames per second LCD driver IC without a frame buffer delivering pixel data at 810 Mbps for display refresh.

Signaling states defined for each of the 3 wires in a 3 wire 3 phase polarity encoding scheme may include an undriven state a positively driven state and a negatively driven state. The positively driven state and the negatively driven state may be obtained by providing a voltage differential between two of the signal wires and or and or by driving a current through two of the signal wires and or connected in series such that the current flows in different directions in the two signal wires and or . The undriven state may be realized by placing an output of a driver of a signal wire or in a high impedance mode. Alternatively or additionally an undriven state may be obtained on a signal wire or by passively or actively causing an undriven signal wire or to attain a voltage level that lies substantially halfway between positive and negative voltage levels provided on driven signal wires and or . Typically there is no significant current flow through an undriven signal wire or . Signaling states defined for a 3 wire 3 phase polarity encoding scheme may be denoted using the three voltage or current states 1 1 and 0 .

A 3 wire 3 phase polarity encoder may employ line drivers to control the signaling state of signal wires and . The drivers may be implemented as unit level current mode or voltage mode drivers. In one example each driver may receive sets of two or more of signals and that determine the output state of corresponding signal wires and . In one example the sets of two signals and may include a pull up signal PU signal and a pull down signal PD signal that when high activate pull up and pull down circuits that drive the signal wires and toward a higher level or lower level voltage respectively. In this example when both the PU signal and the PD signal are low the signal wires and may be terminated to a mid level voltage.

For each transmitted symbol interval in an M wire N phase polarity encoding scheme at least one signal wire or is in the midlevel undriven 0 voltage or current state while the number of positively driven 1 voltage or current state signal wires or is equal to the number of negatively driven 1 voltage or current state signal wires or such that the sum of current flowing to the receiver is always zero. For each symbol the state of at least one signal wire or is changed from the symbol transmitted in the preceding transmission interval.

In operation a mapper may receive and map 16 bit data to 7 symbols . In the 3 wire example each of the 7 symbols defines the states of the signal wires and for one symbol interval. The 7 symbols may be serialized using parallel to serial converters that provide a timed sequence of symbols for each signal wire and . The sequence of symbols is typically timed using a transmission clock. A 3 wire 3 phase encoder receives the sequence of 7 symbols produced by the mapper one symbol at a time and computes the state of each signal wire and for each symbol interval. The 3 wire encoder selects the states of the signal wires and based on the current input symbol and the previous states of signal wires and

The use of M wire N phase encoding permits a number of bits to be encoded in a plurality of symbols where the bits per symbol is not an integer. In the simple example of a 3 wire communications link there are 3 available combinations of 2 wires which may be driven simultaneously and 2 possible combinations of polarity on the pair of wires that is driven yielding 6 possible states. Since each transition occurs from a current state 5 of the 6 states are available at every transition. The state of at least one wire is required to change at each transition. With 5 states log 5 2.32 bits may be encoded per symbol. Accordingly a mapper may accept a 16 bit word and convert it to 7 symbols because 7 symbols carrying 2.32 bits per symbol can encode 16.24 bits. In other words a combination of seven symbols that encode five states has 5 78 125 permutations. Accordingly the 7 symbols may be used to encode the 2 65 536 permutations of 16 bits.

Information may be encoded in the direction of rotation at each phase transition and the 3 phase signal may change direction for each signaling state. Direction of rotation may be determined by considering which signal wires and or are in the 0 state before and after a phase transition because the undriven signal wire and or changes at every signaling state in a rotating three phase signal regardless of the direction of rotation.

The encoding scheme may also encode information in the polarity of the two conductors and or that are actively driven. At any time in a 3 wire implementation exactly two of the conductors are driven with currents in opposite directions and or with a voltage differential. In a simple implementation data may be encoded using two bit values where one bit is encoded in the direction of phase transitions and the second bit is encoded in the polarity for the current state.

The timing chart illustrates data encoding using both phase rotation direction and polarity. The curves and relate to signals carried on three signal wires and respectively for multiple phase states. Initially the phase transitions are in a clockwise direction and the most significant bit is set to binary 1 until the rotation of phase transitions switches at a time to a counterclockwise direction as represented by a binary 0 of the most significant bit. The least significant bit reflects the polarity of the signal in each state.

According to certain aspects disclosed herein one bit of data may be encoded in the rotation or phase change in a 3 wire 3 phase encoding system and an additional bit may be encoded in the polarity of the two driven wires. Additional information may be encoded in each transition of a 3 wire 3 phase encoding system by allowing transition to any of the possible states from a current state. Given 3 rotational phases and two polarities for each phase 6 states are available in a 3 wire 3 phase encoding system. Accordingly 5 states are available from any current state. Accordingly there may be log 5 2.32 bits encoded per symbol transition which allows the mapper to accept a 16 bit word and encode it in 7 symbols.

N Phase data transfer may use more than three wires provided in a communication medium such as a bus. The use of additional signal wires that can be driven simultaneously provides more combinations of states and polarities and allows more bits of data to be encoded at each transition between states. This can significantly improve throughput of the system and reduce the power consumption over approaches that use multiple differential pairs to transmit data bits while providing increased bandwidth.

In one example an encoder may transmit symbols using 6 wires with 2 pairs of wires driven for each state. The 6 wires may be labeled A through F such that in one state wires A and F are driven positive wires B and E negative and C and D are undriven or carry no current . For six wires there may be 

Of the 4 wires driven the possible combinations of two wires driven positive and the other two must be negative . The combinations of polarity may include 

Accordingly the total number of different states may be calculated as 15 6 90. To guarantee a transition between symbols 89 states are available from any current state and the number of bits that may be encoded in each symbol may be calculated as log 89 6.47 bits per symbol. In this example a 32 bit word can be encoded by the mapper into 5 symbols given that 5 6.47 32.35 bits.

The general equation for the number of combinations of wires that can be driven for a bus of any size as a function of the number of wires in the bus and number of wires simultaneously driven 

The wire state decoder may extract a sequence of symbols from phase encoded signals received on the signal wires and . The symbols are encoded as a combination of phase rotation and polarity as disclosed herein. The wire state decoder may include a CDR circuit that extracts a clock that can be used to reliably capture symbols from the signal wires and . A transition occurs on least one of the signal wires and at each symbol boundary and the CDR circuit may be configured to generate the clock based on the occurrence of a transition or multiple transitions. An edge of the clock may be delayed to allow time for all signal wires and to have stabilized and to thereby ensure that the current symbol is captured for decoding purposes.

A C PHY 3 phase transmitter includes drivers that provide high low and middle level voltages onto the transmit channel. This results in some variable transitions between consecutive symbol intervals. Low to high and high to low voltage transitions may be referred to as full swing transitions while low to middle and high to middle voltage transitions may be referred to as half swing transitions. Different types of transitions may have different rise or fall times and may result in different zero crossings at the receiver. These differences can result in encoding jitter which may impact link signal integrity performance.

Certain transitions between transmitted symbols may be detectable by a single differential receiver or while other transitions may be detected by two or more of the differential receivers and . In one example the states or relative states of two wires may be unchanged after a transition and the output of a corresponding differential receiver or may also be unchanged after the phase transition. In another example both wires in a pair of signal wires and or may be in the same state in a first time interval and both wires may be in a same second state in a second time interval and the corresponding differential receiver or may be unchanged after the phase transition. Accordingly a clock generation circuit may include a transition detect circuit and or other logic to monitor the outputs of all differential receivers and in order to determine when a phase transition has occurred. The clock generation circuit may generate a receive clock signal based on detected phase transitions.

Changes in signaling states of the 3 wires may be detected at different times for different combinations of the signal wires and or . The timing of detection of signaling state changes may vary according to the type of signaling state change that has occurred. The result of such variability is illustrated in the simplified timing chart of . Markers and represent occurrences of transitions in the difference signals provided to the transition detection circuit . The markers and are assigned different heights in the timing chart for clarity of illustration only and the relative heights of the markers and are not intended to show a specific relationship to voltage or current levels polarity or weighting values used for clock generation or data decoding. The timing chart illustrates the effect of timing of transitions associated with symbols transmitted in phase and polarity on the three signal wires and . In the timing chart transitions between some symbols may result in variable capture windows and or collectively symbol capture windows during which symbols may be reliably captured. The number of state changes detected and their relative timing can result in jitter on the clock signal .

Variability in the sizes of the symbol windows and jitter may be caused in part by the electrical characteristics of the signal wires and as illustrated in the timing diagram depicted in . The throughput of a C PHY communications link may be affected by duration and variability in signal transition times. For example variability in detection circuits may be caused by manufacturing process tolerances variations and stability of voltage and current sources and operating temperature. Certain impediments to accomplishing higher data rates are attributable to channel bandwidth and its increased effect on higher frequency components of digital signals. For example attenuation of the higher frequencies can affect signal rise and fall times. In conventional line drivers pre emphasis circuits may be provided whereby the pre emphasis circuits operate to increase the detection of transitions at the receiver. Some pre emphasis circuits may affect the timing of signals by initiating a transition early or terminating a transition late. Other pre emphasis circuits may increase the current flow provided by the driver during transitions.

In each of the examples shown in the timing charts and the initial symbol z see transitions to a different symbol. As shown in the timing charts and signal A is initially in a 1 state signal B is in a 0 state and signal C is in the 1 state. Accordingly the differential receivers initially measure a 1 difference and the differential receiver measures a 2 difference as shown in the timing charts for the differential receiver outputs.

In a first example corresponding to the timing charts a transition occurs from symbol z to symbol x see in which signal A transitions to a 1 state signal B transitions to a 1 state and signal C transitions to a 0 state with the differential receiver transitioning from 1 difference to a 2 difference differential receiver remaining at a 1 difference and differential receiver transitioning from 2 difference to a 1 difference .

In a second example corresponding to the timing charts a transition occurs from symbol z to symbol z in which signal A transitions to a 1 state signal B remains at the 0 state and signal C transitions to a 1 state with two differential receivers and transitioning from 1 difference to a 1 difference and differential receiver transitioning from 2 difference to a 2 difference .

In a third example corresponding to the timing charts a transition occurs from symbol z to symbol x in which signal A remains at the 1 state signal B transitions to the 1 state and signal C transitions to a 0 state with the differential receiver transitioning from a 1 difference to a 2 difference the differential receiver transitioning from a 1 difference to a 1 difference and the differential receiver transitioning from 2 difference to a 1 difference .

These examples illustrate transitions in difference values spanning 0 1 2 3 4 and 5 levels. Pre emphasis techniques used for typical differential or single ended serial transmitters were developed for two level transitions and may introduce certain adverse effects if used on a MIPI Alliance C PHY signal. In particular a pre emphasis circuit that overdrives a signal during transitions may cause overshoot during transitions spanning 1 or 2 levels and may cause false triggers to occur in edge sensitive circuits.

The concept of periodic sampling and display of the signal is useful during design adaptation and configuration of systems which use a clock data recovery circuit that re creates the received data timing signal using frequent transitions appearing in the received data. A communication system based on Serializer Deserializer SERDES technology is an example of a system where an eye pattern can be utilized as a basis for judging the ability to reliably recover data based on the eye opening of the eye pattern .

An M wire N Phase encoding system such as a 3 wire 3 phase encoder may encode a signal that has at least one transition at every symbol boundary and the receiver may recover a clock using those guaranteed transitions. The receiver may require reliable data immediately prior to the first signal transition at a symbol boundary and must also be able to reliably mask any occurrences of multiple transitions that are correlated to the same symbol boundary. Multiple receiver transitions may occur due to slight differences in rise and fall time between the signals carried on the M wires e.g. a trio of wires and due to slight differences in signal propagation times between the combinations of signal pairs received e.g. A B B C and C A outputs of differential receivers and of .

Drivers receivers and other devices used in a C PHY 3 Phase decoder may exhibit different switching characteristics that can introduce relative delays between signals received from the three wires. Multiple receiver output transitions may be observed at each symbol interval boundary and or due to slight differences in the rise and fall time between the three signals of the trio of signal wires and due to slight differences in signal propagation times between the combinations of pairs of signals received from the signal wires . The eye pattern may capture variances in rise and fall times as a relative delay in transitions near each symbol interval boundary and . The variances in rise and fall times may be due to the different characteristics of the 3 Phase drivers. Differences in rise and fall times may also result in an effective shortening or lengthening of the duration of the symbol interval for any given symbol.

A signal transition region represents a time or period of uncertainty where variable signal rise times prevent reliable decoding. State information may be reliably determined in an eye opening representing the time period in which the symbol is stable and can be reliably received and decoded. In one example the eye opening may be determined to begin at the end of the signal transition region and end at the symbol interval boundary of the symbol interval . In the example depicted in the eye opening may be determined to begin at the end of the signal transition region and end at a time when the signaling state of the signal wires and or the outputs of the three differential receivers and have begun to change to reflect the next symbol.

The maximum speed of a communication link configured for N Phase encoding may be limited by the duration of the signal transition region compared to the eye opening corresponding to the received signal. The minimum period for the symbol interval may be constrained by tightened design margins associated with the CDR circuit in the decoder illustrated in for example. Different signaling state transitions may be associated with different variations in signal transition times corresponding to two or more signal wires and or thereby causing the outputs of the differential receivers and in the receiving device to change at different times and or rates with respect to the symbol interval boundary where the inputs of the differential receivers and begin to change. A delay element may be provided in the CDR circuit to accommodate possible large variations in received signal transition times at the outputs of two or more of the differential receivers and . The delay element may be provided in one or more of a state change detect circuit such as the transition detect circuit illustrated in and or the clock generation circuit shown in . In one example the delay element may have a minimum delay period that exceeds the duration of the transition region . The maximum delay time provided by this delay element may not extend beyond the time when the eye opening closes. In some instances the maximum delay time provided by the delay element may not extend beyond the commencement of the next symbol interval at the symbol interval boundary corresponding to the termination of the symbol interval . At faster data rates the eye opening can become small in comparison to the symbol interval and the effect of symbol transition variability may be determinative of the maximum symbol transmission rate.

The duration of any single transition is unlikely to span the full range of the signal transition region t since it is unlikely that a minimum possible signal transition time and a maximum possible transition time occurs during a single symbol transition. In one example the signal transition region may be bounded by the time of the first zero crossing detected at the output of a differential receiver or and the time of the last zero crossing at the end of the signal transition region detected at the output of a differential receiver or for all possible symbol transitions. The transition times observed at the outputs of the differential receiver and may correspond to the times taken for the voltage at the connectors and or signal wires or to reach a signaling state after a change in one or more inputs of the drivers in a transmitter.

The longest possible transition time may be determined by the characteristics of one or more of the signal wires and or signal wires or and the type of state transition involved. In one example the longest possible transition time may be determined by the rise or fall time of one or more signals. Rise and fall times may be determined by the nature and voltage levels of the original and or the final states. Typically the longest possible transition time corresponds to a transition between an actively driven state and an undriven state.

A high value of tfor the signal transition region relative to the symbol interval can result in increased design difficulty associated with the CDR circuit or clock generation circuit . For example the clock generation circuit may employ a delay element or timer that is triggered by the first zero crossing of the outputs of the three differential receiver and . The state of the outputs of all three differential receivers and may not be safely sampled until all of the differential receivers and have reached their final state which may be defined by the end of the transition region. Accordingly the timer may preferably expire shortly after the end of the signal transition region at which time the clock generation circuit may output a clock edge that is used to sample the outputs of the three differential receivers and

In some devices delay elements in the CDR circuit can be afflicted by variations in manufacturing process circuit supply voltage and die temperature PVT variation and may generate delays that vary significantly. In such systems the nominal operating condition of the CDR circuit is generally set by design to generate a clock edge somewhere in the middle of the eye opening in order to ensure that a clock edge occurs after the end of the signal transition region and prior to the commencement of the transition region to the next symbol even under worst case PVT effects. Difficulty can arise in designing a CDR circuit that guarantees a clock edge within the eye opening when the signal transition region is large compared to the eye opening . For example a typical delay element may produce a delay value that changes by a factor of 2 over all PVT conditions and the eye opening must be larger than the signal transition region in order that a non adjustable delay value can be chosen.

In some instances the duration of the signal transition region may be calculated based on the maximum timing between a change in input to one or more drivers of a transmitting circuit see and corresponding transitions observed or expected at the outputs of differential receivers in a receiver see . In other instances a modified transition region may be determined at the outputs of the receivers as the maximum difference between the time of a first transition at the output of one of the receivers and the time corresponding to the terminating symbol interval boundary of the symbol interval of the last transition at the output of the other receivers for all symbol transitions.

According to certain aspects disclosed herein transmit encoding jitter may be reduced and link performance may be improved through the use of time based equalization that may increase the horizontal eye opening observed at a receiver. In some examples a 3 phase transmitter adapted according to certain aspects disclosed herein may force all wires in a trio to a common voltage for a short period of time at each transition between symbols.

Time based equalization can provide lower power solutions to jitter than other techniques including such as amplitude based channel equalization approaches. For example pre emphasis schemes may reduce source resistance to obtain larger swings and de emphasis schemes may introduce contention on output pads to reduce the signal swing and de emphasize the direct current DC component in the transmitted signal. Pre emphasis and de emphasis schemes may alter the transmitter impedance which can increase reflections in the transmission channel. The use of time based equalization as disclosed herein maintains transmitter impedance unaltered and avoids adding latency in the data transmission path that can arise from processing overhead needed to detect patterns of signals that activate pre emphasis or de emphasis circuits.

In this example the C PHY interface may be adapted to force each of the three signal wires and to a predefined intermediate or common voltage level for a predetermined time interval commencing at or near the start of the transitions between transmitted symbols. In some examples the intermediate or common voltage level may correspond to the mid level voltage level . The predefined intermediate or common voltage level may be selected based on the time required for one or more of the three signal wires to be driven from the intermediate or common voltage level to one of the three voltage levels that represent signaling states. A transition signal may be provided to control the driving of the three signal wires and during the transition interval. As illustrated the transition signal includes pulses that are active at the beginning of each symbol . Each pulse may have a duration t that may be calculated to enable each of the three signal wires and to reach the predefined intermediate or common voltage level an example depicted the predefined intermediate or common voltage level coincides with the mid level voltage level . At a time that may correspond to the falling edge of the pulse each of the three signal wires is driven to the voltage level defined by the current symbol . In this manner all transitions may be aligned when the times required to transition from the predefined intermediate or common voltage level to each of the three voltage levels and are equalized or substantially equalized.

Pulses on the transition signal may have a short duration relative to the symbol interval . For example the duration of the pulses may be 50 picoseconds or 75 picoseconds while the symbol transmission time may be 400 picoseconds. In some examples the pulses may have a duration that is less than or limited to 25 of the duration of a symbol interval . Upon termination of a pulse each signal wire and transitions to the state defined by the next symbol for transmission.

The transition signal may have a period that matches the period of the transmission clock that controls the data rate on the C PHY interface. The pulse duration may be controlled configured or tuned using a delay element for example. The pulse duration may be controlled configured or tuned to obtain an optimized transition time between the symbols where optimization may be accomplished when jitter is minimized without increasing the total transition time by an amount that jeopardizes the capture window available at the receiver. One effect on the transmitted signals is that the zero crossings for all the three differential signal pairs A B B C A C may converge on the same value at the beginning and at the end of each symbol . Thus the encoding jitter in the transmitted signal is reduced and the horizontal eye opening at the receiver is increased.

According to certain aspects disclosed herein the pull up signal and the pull down signal may be provided to gating or selecting logic such as the multiplexers and . The gating or selecting logic may be controlled by the transition signal which may correspond to the transition signal illustrated in . When in a low logic state the transition signal may cause the multiplexers to pass the pull up signal and the pull down signal through to the line driver circuit as the PU signal and the PD signal respectively. When in a high logic state the transition signal may cause the multiplexers to provide a high logic state on both the PU signal and the PD signal . As a result transistors and are turned on and the output of the line driver circuit is actively driven toward the mid level voltage level . In some instances dedicated transistors not shown responsive to the transition signal may be used to drive the output of the line driver circuit to a common voltage level. In such instances the common voltage may be selectable and or variable and may be different from the mid level voltage level .

In the illustrated example the processing circuit may be implemented with a bus architecture represented generally by the bus . The bus may include any number of interconnecting buses and bridges depending on the specific application of the processing circuit and the overall design constraints. The bus links together various circuits including the one or more processors and storage . Storage may include memory devices and mass storage devices and may be referred to herein as computer readable media and or processor readable media. The bus may also link various other circuits such as timing sources timers peripherals voltage regulators and power management circuits. A bus interface may provide an interface between the bus and one or more transceivers . A transceiver may be provided for each networking technology supported by the processing circuit. In some instances multiple networking technologies may share some or all of the circuitry or processing modules found in a transceiver . Each transceiver provides a means for communicating with various other apparatus over a transmission medium. Depending upon the nature of the apparatus a user interface e.g. keypad display speaker microphone joystick may also be provided and may be communicatively coupled to the bus directly or through the bus interface .

A processor may be responsible for managing the bus and for general processing that may include the execution of software stored in a computer readable medium that may include the storage . In this respect the processing circuit including the processor may be used to implement any of the methods functions and techniques disclosed herein. The storage may be used for storing data that is manipulated by the processor when executing software and the software may be configured to implement any one of the methods disclosed herein.

One or more processors in the processing circuit may execute software. Software shall be construed broadly to mean instructions instruction sets code code segments program code programs subprograms software modules applications software applications software packages routines subroutines objects executables threads of execution procedures functions algorithms etc. whether referred to as software firmware middleware microcode hardware description language or otherwise. The software may reside in computer readable form in the storage or in an external computer readable medium. The external computer readable medium and or storage may include a non transitory computer readable medium. A non transitory computer readable medium includes by way of example a magnetic storage device e.g. hard disk floppy disk magnetic strip an optical disk e.g. a compact disc CD or a digital versatile disc DVD a smart card a flash memory device e.g. a flash drive a card a stick or a key drive a random access memory RAM a ROM a PROM an erasable PROM EPROM an EEPROM a register a removable disk and any other suitable medium for storing software and or instructions that may be accessed and read by a computer. The computer readable medium and or storage may also include by way of example a carrier wave a transmission line and any other suitable medium for transmitting software and or instructions that may be accessed and read by a computer. Computer readable medium and or the storage may reside in the processing circuit in the processor external to the processing circuit or be distributed across multiple entities including the processing circuit . The computer readable medium and or storage may be embodied in a computer program product. By way of example a computer program product may include a computer readable medium in packaging materials. Those skilled in the art will recognize how best to implement the described functionality presented throughout this disclosure depending on the particular application and the overall design constraints imposed on the overall system.

The storage may maintain software maintained and or organized in loadable code segments modules applications programs etc. which may be referred to herein as software modules . Each of the software modules may include instructions and data that when installed or loaded on the processing circuit and executed by the one or more processors contribute to a run time image that controls the operation of the one or more processors . When executed certain instructions may cause the processing circuit to perform functions in accordance with certain methods algorithms and processes described herein.

Some of the software modules may be loaded during initialization of the processing circuit and these software modules may configure the processing circuit to enable performance of the various functions disclosed herein. For example some software modules may configure internal devices and or logic circuits of the processor and may manage access to external devices such as the transceiver the bus interface the user interface timers mathematical coprocessors and so on. The software modules may include a control program and or an operating system that interacts with interrupt handlers and device drivers and that controls access to various resources provided by the processing circuit . The resources may include memory processing time access to the transceiver the user interface and so on.

One or more processors of the processing circuit may be multifunctional whereby some of the software modules are loaded and configured to perform different functions or different instances of the same function. The one or more processors may additionally be adapted to manage background tasks initiated in response to inputs from the user interface the transceiver and device drivers for example. To support the performance of multiple functions the one or more processors may be configured to provide a multitasking environment whereby each of a plurality of functions is implemented as a set of tasks serviced by the one or more processors as needed or desired. In one example the multitasking environment may be implemented using a timesharing program that passes control of a processor between different tasks whereby each task returns control of the one or more processors to the timesharing program upon completion of any outstanding operations and or in response to an input such as an interrupt. When a task has control of the one or more processors the processing circuit is effectively specialized for the purposes addressed by the function associated with the controlling task. The timesharing program may include an operating system a main loop that transfers control on a round robin basis a function that allocates control of the one or more processors in accordance with a prioritization of the functions and or an interrupt driven main loop that responds to external events by providing control of the one or more processors to a handling function.

At block a sequence of symbols may be generated or otherwise provided for transmission on a 3 wire interface. Each symbol in the sequence of symbols may define one of three voltage states for each wire of the 3 wire interface. Each wire is in a different voltage state from the other wires of the 3 wire interface during transmission of the each symbol.

At block all wires of the 3 wire interface may be driven to a common voltage state during a transition from a first transmitted symbol to a second transmitted symbol. The common voltage state may lie between two of the three voltage states defined for each wire of the 3 wire interface.

At block each wire of the 3 wire interface may be driven in accordance with the second transmitted symbol after a predetermined delay. In one example all wires of the 3 wire interface may be driven to the common voltage state for a predetermined time interval commencing at the beginning of a transition from a first transmitted symbol to a second transmitted symbol where the predetermined delay corresponds to the predetermined time interval. When the predetermined time interval has elapsed the 3 wire interface may then assume a signaling state corresponding to the second transmitted symbol.

In one example the three voltage states include a first voltage state a second voltage state greater than the first voltage state and a mid level voltage state that lies between the first voltage state and the second voltage state. The common voltage state may lie between the first voltage state and the second voltage state. In some instances the common voltage state may be the mid level voltage state.

In some instances a duration of pulses to be provided in a transition signal may be selected using a programmable delay element or the like. The duration of the pulses in the transition signal may be selected or determined based on a time interval during which there is signal uncertainty at a boundary between consecutive symbols transmitted on the 3 wire interface. The time interval may correspond to the signal transition region illustrated in . The transition signal may be generated such that a pulse occurs at each transition between the consecutive symbols. The transition signal may cause all wires of the 3 wire interface to be driven to the common voltage state for the duration of each pulse. The duration of the pulses may be selected and or adjusted to minimize the time interval during which there is signal uncertainty and to reduce encoding jitter on the 3 wire interface. In one example the transition signal may minimize differences in the time that two or more wires of the 3 wire interface begin to transition from a state defined by a current symbol to a state defined by a next symbol.

In some instances a pulse may be provided at each transition between consecutive symbols transmitted on the 3 wire interface. The pulse may have a duration corresponding to the predetermined delay. All wires of the 3 wire interface may be driven towards the common voltage state for the duration of the pulse. In one example the pulse may have a duration of at least 50 picoseconds. In another example the pulse may have a duration of less than 75 picoseconds. In some examples the pulse may have a duration that is less than 25 of a symbol interval during which a symbol is transmitted on the 3 wire interface.

In various examples phase shifted versions of a 3 phase signal may be concurrently transmitted on the 3 wire interface such that the 3 phase signal is transmitted in a different phase on each wire of the 3 wire interface. In some instances a phase shifted version of a 3 phase signal is transmitted on each wire of the 3 wire interface such that the phase shifted version transmitted on each wire is 120 degrees phase shifted from the phase shifted version transmitted on each of the other wires of the 3 wire interface.

The processor is responsible for general processing including the execution of software stored on the computer readable storage medium . The software when executed by the processor causes the processing circuit to perform the various functions described supra for any particular apparatus. The computer readable storage medium may also be used for storing data that is manipulated by the processor when executing software including data decoded from symbols transmitted over the connectors or wires which may be configured as data lanes and clock lanes. The processing circuit further includes at least one of the modules and . The modules and may be software modules running in the processor resident stored in the computer readable storage medium one or more hardware modules coupled to the processor or some combination thereof. The modules and or may include microcontroller instructions state machine configuration parameters or some combination thereof.

In one configuration the apparatus may be configured for data communication over a C PHY 3 phase interface. The apparatus may include a module and or circuit that is configured to provide a sequence of symbols to be transmitted on a 3 wire interface a signal forcing module and or circuit that is configured to drive all wires of the 3 wire interface to a common voltage state during a transition from a first transmitted symbol to a second transmitted symbol a module and or circuit that is configured to drive each wire of the 3 wire interface in accordance with the second transmitted symbol and a module and or circuit that is configured to provide pulses in a transition signal at each transition between consecutive symbols transmitted on the 3 wire interface.

It is understood that the specific order or hierarchy of steps in the processes disclosed is an illustration of exemplary approaches. Based upon design preferences it is understood that the specific order or hierarchy of steps in the processes may be rearranged. Further some steps may be combined or omitted. The accompanying method claims present elements of the various steps in a sample order and are not meant to be limited to the specific order or hierarchy presented.

The previous description is provided to enable any person skilled in the art to practice the various aspects described herein. Various modifications to these aspects will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other aspects. Thus the claims are not intended to be limited to the aspects shown herein but is to be accorded the full scope consistent with the language claims wherein reference to an element in the singular is not intended to mean one and only one unless specifically so stated but rather one or more. Unless specifically stated otherwise the term some refers to one or more. All structural and functional equivalents to the elements of the various aspects described throughout this disclosure that are known or later come to be known to those of ordinary skill in the art are expressly incorporated herein by reference and are intended to be encompassed by the claims. Moreover nothing disclosed herein is intended to be dedicated to the public regardless of whether such disclosure is explicitly recited in the claims. No claim element is to be construed as a means plus function unless the element is expressly recited using the phrase means for. 

