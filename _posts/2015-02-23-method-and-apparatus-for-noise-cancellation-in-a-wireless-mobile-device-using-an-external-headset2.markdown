---

title: Method and apparatus for noise cancellation in a wireless mobile device using an external headset
abstract: A method, system, and apparatus for noise cancelation is disclosed herein, which may be used in a wireless unit (WU) and a headset removably connected to the WU. The WU may include a processor, a memory, a user interface, internal microphones and internal speakers. The headset may include microphones and speakers, and be powered by the WU. The WU may receive an ambient noise at microphone(s), including a headset microphone, which may generate a signal based on the ambient noise. The WU processor may then calculate an estimate of the ambient noise based on the signal, calculate an inverse of the estimated ambient noise based on the estimate of the ambient noise, cancel the estimated ambient noise from an audio output signal based on the application of the inverse of the estimated ambient noise, and send the audio output signal to the speakers of the headset or the WU.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09613611&OS=09613611&RS=09613611
owner: 
number: 09613611
owner_city: 
owner_country: 
publication_date: 20150223
---
This application claims the benefit of U.S. Provisional Application No. 61 943 521 filed Feb. 24 2014 which is incorporated by reference as if fully set forth.

The disclosed embodiments are generally directed to a method and apparatus in the field of wireless mobile devices. More specifically the disclosed embodiments are directed to reducing or canceling ambient noise when a wireless mobile device headset is used.

When a user is listening to an audio output from a wireless device such as a phone conversation music or an audio component of a multimedia content the user may also hear ambient noise. Ambient noise may be produced by people equipment traffic or even other multimedia devices nearby and is undesirable. The goal of noise cancelation is to somehow reduce or remove the ambient noise so that the user hears only the desired audio output from the wireless device.

Current noise cancelation techniques may include a set of speakers and a set of microphones in each ear cup of a noise canceling headset. The microphones are typically positioned in proximity to the outside of the ear cups to detect the ambient noise whereas the speaker may also be positioned on the inside of the ear cup to subtract the ambient noise from the intended audio that is also played into the ear on the inside of the ear cups. To do the processing headphones may include a processor to receive the input from the ambient noise detecting microphones on the outside of the ear cup then calculate the noise estimate and then play back the inverted or negative version of the ambient noise from the speakers on the inside of the ear cup. The processor may also scale the noise estimate because there is inherent isolation from the outside of the ear cups to the inside which reduces the level of ambient noise on the inside of the ear cups. Since this process takes some processing power from an electronic computation device the noise canceling headphones may require batteries as well.

A method system and apparatus for noise cancelation is disclosed herein which may be used in a wireless unit WU a headset removably connected to the WU. The WU may include a processor a memory a user interface internal microphones and internal speakers. The headset may include microphones and speakers and be powered by the WU. The WU may receive an ambient noise at one or more microphones including a microphone of a headset. The microphone s may then generate a signal based on the ambient noise and the processor of the WU may calculate an estimate of the ambient noise based on the signal. The processor of the WU may then calculate an inverse of the estimated ambient noise based on the estimate of the ambient noise cancel the estimated ambient noise from an audio output signal based on the application of the inverse of the estimated ambient noise and send the audio output signal to the speakers of the headset or the internal speakers of the WU.

Through the use of a standard headset with a microphone and speakers the noise cancelation technique described herein may use the processing power of the mobile phone and may require no other additional hardware. Further the noise cancelation described herein can be implemented as a standalone software application as part of another software application or as part of the operating system or middleware of the WU.

Further the noise cancelation may include receiving and applying input from a user. The user input may indicate one or more scaling factors. Further the user input may indicate one or more phase shifts. Also the user input may include selecting one or more of the internal microphones or selecting one or more of the headset microphones or selecting both. In addition the user input may include selecting one or more ambient noise components for canceling.

The method and apparatus disclosed herein may apply to mobile wireless devices including for example but not limited to cell phones feature phones smart phones tablet PCs with wireless connectivity and all future devices that generally share similar characteristics. As used herein a microphone may refer to a single microphone or one or more microphones and the terms may be used interchangeably. As used herein a speaker may refer to a single speaker or one or more speakers and the terms may be used interchangeably. As used herein a wireless unit WU may refer to a mobile device that is able to wirelessly transmit or receive digital or analog data or voice information a wireless device or a mobile wireless device and the terms may be used interchangeably.

The WU may also use one or more internal speakers one or more internal microphones and a connector plug not shown for electrical connection to an external headset. Internal speakers and microphones may be used for making voice and multimedia calls. In other words the user may speak or input other audio input through the microphones and may hear voice or other audio output from the speakers . The headset when plugged into the connector may serve the same purpose. One or more microphones on the headset may be used for inputting audio and one or more speakers on the headset may be used for outputting of audio by the mobile device.

In Equation 1 audio may be what the user actually hears and ambient noise may be the undesirable component as shown in . This may be the case for example when the user is listening to an audio output from the wireless device such as a phone conversation music or audio component of a multimedia content. Ambient noise may be produced by people equipment traffic or even other multimedia devices nearby and is typically undesirable. In this scenario the goal of noise cancelation may be to somehow remove the ambient noise so that the user may hear audio desired audio from the device Equation 2 

In equation 4 the residual noise may be small ideally zero if the ambient noise is estimated perfectly.

In Equation 5 ambient noise may be corrected by noise cancelation. This may produce audio ambient noise estimate of ambient noise Equation 6 audio residual noise Equation 7 

Additional microphones and speakers as well as the processor and battery make current noise canceling headphones too heavy too bulky and much too expensive. In addition since these headphones require batteries of their own to operate the user has to either replace the batteries from time to time or charge them which makes them inconvenient. Examples disclosed herein describe noise cancelation technology that may be easy to use cheap light and may not require its own battery.

A method system and apparatus are disclosed herein for implementing noise cancelation using the existing components of a wireless mobile device and a headset with a speaker and microphone. The technique described may make use of the processor and power source within the mobile device and hence may not require its own battery. Examples disclosed herein make use of the internal speaker and microphone included in the wireless mobile device and the speaker and microphone of a headset that may be plugged into the mobile device.

The ambient noise is selectively detected by the microphone on the headset the microphone on the WU or both and may then be processed by the processor in the WU to create the noise estimate. The headset microphone WU microphone or both may generate a signal based on the ambient noise and send the signal to the processor to create the noise estimate. The processor may then subtract the estimated ambient noise from the audio that may be delivered to the WU internal speaker s the headset speakers or both thereby canceling the effect of the ambient noise. The WU may also include components such as a battery as a power supply memory to execute programs a SIM card and user input output devices such as a keypad or a touchscreen or both. The WU may also include RF circuitry and an antenna not shown to facilitate the wireless connectivity. The headset may be removably connected to the wireless mobile device with a headset connector plug . The WU may provide power to the headset. As a result the headset may not include a battery or other power source. In a further example the headset may also not include a processor.

In a further example the headset may include speakers s but not a microphone and only the microphone of the mobile device detects the ambient noise. The mobile device microphone may then generate a signal based on the ambient noise and send the signal to the processor to create the noise estimate. The processor may then subtract the estimated ambient noise from the audio that may be delivered or sent to the WU internal speaker s the headset speakers or both thereby canceling the effect of the ambient noise.

Software code such as middleware application software or as part of the operating system that runs on the processor may perform the noise cancelation as described above. For simplicity this software will be referred to herein as the noise cancelation application NCA . One of ordinary skill in the art will understand that the software may be embedded code middleware an application part of the operating system and the like. A variety of classifications of the software may be used with the examples described herein.

Besides controlling the processor to do the main elements of the noise cancelation NCA may also include a user interface where the user may provide input and also see performance and diagnostic data from the noise cancelation process. One of the inputs from the user may be a scale factor which determines how the noise estimate is scaled before subtraction. Another input may be to select whether the headset speakers mobile device speakers or both are used in detecting the ambient noise.

The examples disclosed herein may require no additional hardware beyond the wireless mobile device itself and a headset with speaker s only or with speakers and one or more microphones. Such headsets are widely available and cost very little especially compared to the current noise canceling headphones on the market today. For comparison purposes a simple headset that can be used to implement the examples disclosed herein may cost as little as 10 20 whereas the noise canceling headphones from brands such as SONY BOSE and others may cost 250 350 at current prices.

In a further example the earphones or headset may include a plug to connect with the WU earpieces or speakers but no microphone. In yet a further example the earphones or headset may include a plug to connect with the WU and a microphone but no earpieces or speakers.

When the user is listening to audio portion of a multimedia content or is on a phone call there may be a desired audio component. The ambient noise may be subtracted from this audio component. In other words the inverse of the ambient noise waveform may be added or applied to the audio component that is sent to the headset speaker . This can be written as Equation 8 

In Equation 8 s t is the audio output signal that the user hears when the user is wearing the headset and there is ambient noise. Further a t is the desired audio signal such as the voice or media content coming from the headset earpiece of speaker and n t is the ambient noise that the user hears. When the ambient noise is detected and an estimate of it is obtained then the inverse of this noise estimate may be added or applied to the audio signal from the mobile device as follows circumflex over Equation 9 Equation 10 

In Equation 9 circumflex over n t is the noise estimate. In Equation 10 t is the small residual noise after cancelation. When there is no desired audio component as above then the user may be wearing the headset only for its noise canceling use. In that case the inverse of the ambient noise waveform may be sent to the headset speaker . This canceling waveform may cancel the ambient noise that the user is hears. The cancelation can be shown as follows circumflex over Equation 11 Equation 12 

In an example two adjustments or calibrations may be used. These may improve performance of the noise canceler and can be used alone or in combination. Headsets whether noise canceling or not may have some level of noise isolation because they simply cover the ear opening and reduce the amount of sound waves penetrating. As a result the ambient noise that goes through the earpiece of the headset and reaches the ear canal may be attenuated as compared to the ambient noise that is received by the mobile device microphone or the headset microphone. As a first example calibration a calibration may be used to assure that the correct amount of noise is canceled. If this calibration is desired the NCA may present the user with a calibration scale on the mobile device screen. The user may then change the calibration in other words the noise scaling and find the optimum level by listening to the headset at the same time. The calibration interface may be presented to the user as a slider a dial or any other virtual switch on the user interface. The user may set the desired setting on the touchscreen or may use any other button such as the volume control switches to input the calibration level when the NCA prompts the user to do so. In an example the calibration may be described mathematically as follows circumflex over Equation 13 

In Equation n t and n t are the ambient noise that the headset microphone and mobile device microphone are detecting respectively. As in equations above circumflex over n t is the estimate of the ambient noise that the user is hearing. Further the noise detected by the headset microphone and the noise detected by the mobile device microphone may be scaled by and respectively. In example these two scaling factors may be completely different and set by the user separately or they may be the same. Alternatively they may be related to each other by another factor one scaling factor may be some multiple of the other scaling factor. Further either or both of the scaling factors may be set to zero.

A second calibration may be utilized to correct any small time shifts. Although the headset microphone or the mobile device microphone or both may be used to detect the ambient noise level this may often not be exactly the same waveform that reaches the ear. This is because there may be a physical separation between the microphones and the ear which may translate into a very small time shift a phase shift between the ambient noise the user hears and the ambient noise the microphones detects. Additionally the processing in the processor is not instantaneous and may account for some time delay as well. If this phase shift is small it may be imperceptible and may not affect noise cancelation performance. However if the phase shift is large it may negatively affect the noise cancelation and may even make it worse than having no noise cancelation. This can be shown mathematically as follows circumflex over Equation 14 

In Equation 14 the noise detected by the headset microphone and the noise detected by the device microphone are shifted or delayed by and respectively in addition to being scaled. Note that the two time shift values may be the same or different or may be related to each other by an offset. Also note that either or both of the time shift values may be set to zero.

There are two example methods to correct the phase shift time shift if it is significant. One example method is to take the Fast Fourier Transform FFT of the ambient noise from the mobile device microphone and from the headset microphone and calculate the shift amount that corresponds to the maximum correlation. The shift amount may be the time difference between the headset and mobile device microphones. If only one microphone such as only the headset microphone is used in detecting the ambient noise then there may be no need for this step.

The second example method of correcting the time difference between the mobile device and headset microphones and between the microphones and what the user hears through the headset speaker is to do this interactively. In this manner the NCA may present the user with sliders dials or other visual ways to input these on the device screen. The user may find the optimum setting by changing the correction on the screen while listening to the headset.

Various applications and use cases may use the technology disclosed herein. Below are some but not necessarily all example applications and use cases. The example applications and use cases are some but not necessarily all of the ways the technology disclosed herein may be used. As a result these examples are not intended to be exhaustive. There are many other applications of the same principles and the same technology.

The first example use case may occur when a user wants to use the headset only for noise cancelation purposes and not listening to any other audio. In this case the user may wear the headset plug the headset into the mobile device start the NCA on the mobile device and if necessary adjust the scaling factor and time shift or phase shift using the controls presented by the NCA on the mobile device screen. The user may decide to use the headset microphone the mobile device microphone or both microphones for noise cancelation. When the user has completed the selections the user may hit the Apply button and the NCA will apply the user s settings for noise cancelation. The effect is that the ambient noise the user hears will be canceled out and the user will experience much reduced noise or silence through the headset earpieces.

The second example use case is similar to the first example use case except that the user may be listening to an audio content such as voice during a phone call or music from a media file while still employing noise cancelation of the NCA. In this case the effect may be to reduce or eliminate the ambient noise and delivery of the clear audio content to the user through the headset. In this example use case the user may start the NCA and make scaling and time shift adjustments if necessary as in the first example use case.

In a third example use case the NCA is not a standalone application but may be integrated into another media application that runs on the mobile device. Such media applications include those that may download or stream music from a content delivery network CDN such as PANDORA SPOTIFY AMAZON MP3 player APPLE ITUNES or similar. These media application may give the user access to the media content from a CDN either wirelessly streaming real time or from the storage on the mobile device itself. The NCA may be integrated into one of these media applications such that the features and user interface of the NCA may be included in the features and user interface of the media application. For example the user can start a streaming music application such as PANDORA and this application may present the user the option to start noise cancelation option to adjust scaling and option to adjust time shift . In an example this may be considered as the white box version of the NCA.

In a fourth example use case the NCA may be included in the operating system OS or other resident middleware software on the mobile device itself. In this case the features and controls of the NCA may be absorbed into the features and user interface of the OS or middleware and may be accessible through the screens and menus of the OS or middleware. In effect the NCA functionality may be resident on the mobile device and may work in conjunction with any media application such as those mentioned in the third example use case or by itself.

In the four example use cases described above and in others that are not mentioned the basic principle of estimating ambient noise through the headset microphone and or through the mobile device microphone may be the same. The noise is received and estimated a scaling factor may be applied a time shift may be applied and the resulting waveform may be inverted and added to the audio output signal sent to the user headset speakers.

There are alternative example implementations of the technology described above also. According to one such example variation the noise cancelation application NCA may detect and selectively cancel individual frequency components or frequency bands. This may be the better option when there is an ambient noise source that is generating noise at a particular frequency or a frequency band. It may be easier to detect that frequency component invert it and cancel it from the audio delivered to the user.

When working in this example alternative implementation the NCA may calculate the FFT of the detected ambient noise and select a number of frequency components as candidates for cancelation. Then the scaling and time shift may be performed with or without user input as before and the inverse of those noise components may be added to the audio component sent to the user s headset thereby canceling the offending noise components that the user is hearing from the ambience.

Another alternative implementation may include calculating the frequency composition of the ambient noise for example by using an FFT and calculating the frequency composition of any desirably audio signal for example by using an FFT and deciding which frequency components of the ambient noise are likely to interfere with the desirable audio signal and subtracting those frequency components from the audio sent to the microphones. A feature of this example may include presenting to the user a representation of the frequency components of the ambient noise for example in the form of a bar chart on the touchscreen and receiving input from the user indicating which frequency components to subtract. Alternatively the frequency components that are likely to interfere with the desired audio signal may be automatically subtracted without requiring user input. In the case that there is no desirable audio and the user is using the headset only to cancel out the ambient noise so the user can achieve silence then all of the frequency components of the ambient noise may be undesirable. In this case a signal to subtract all of frequency components of the ambient noise may be generated and used to cancel the effect of the ambient noise. In another example the highest in other words most interfering frequency components of the ambient noise may be selected and noise cancellation may be applied only to those components as well. In an example where the user is presented with a representation of the frequency components of the ambient noise the user may be able to select in the user interface the components to be subtracted and further select the scaling factor and phase shift to be applied.

In an example the user interface for receiving user input for the scaling factor and for the phase shift do not need to label these inputs as scaling factor or phase shift but rather they may be labeled in a way that may make it easier for the user to understand and use the user interface.

In a further example the headset may connect to the WU wirelessly instead of using or in addition to the connector plug. The headset may connect to the WU wirelessly using for example the BLUETOOTH standard.

Other alternative implementations are possible without being outside the principles and methods described herein. The implementations and variations of those described herein are not meant to be limiting of the scope of the technology to those implementations but they are simply examples to show the general working principles. One of ordinary skill in the art will understand that the variations and different use cases described here can be used in combination.

Although features and elements are described above in particular combinations one of ordinary skill in the art will appreciate that each feature or element may be used alone or in any combination with the other features and elements. In addition the methods described herein may be implemented in a computer program software or firmware incorporated in a computer readable medium for execution by a computer or processor. Examples of computer readable media include electronic signals transmitted over wired or wireless connections and computer readable storage media. Examples of computer readable storage media include but are not limited to a read only memory ROM a random access memory RAM a register cache memory semiconductor memory devices magnetic media such as internal hard disks and removable disks magneto optical media and optical media such as compact disk CD ROM disks and digital versatile disks DVDs . A processor in association with software may be used to implement a radio frequency transceiver for use in a WU user equipment UE terminal base station a radio network controller RNC or any host computer.

