---

title: Method and apparatus to improve noise immunity of a touch sense array
abstract: A method for improving noise immunity of capacitive sensing circuit associated with a touch sense array is disclosed. The capacitive sensing circuit receives a response signal from a touch sense array. The capacitive sensing circuit measures a noise component of the response signal. When a level of noise of the noise component within a passband of the capacitive sensing circuit is greater than a threshold, the capacitive sensing circuit changes at least one parameter of capacitive sensing circuit to move the passband substantially outside the frequency spectrum of the noise component.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09645690&OS=09645690&RS=09645690
owner: PARADE TECHNOLOGIES, LTD.
number: 09645690
owner_city: Santa Clara
owner_country: US
publication_date: 20150728
---
This application claims the benefit of U.S. patent application Ser. No. 13 246 565 filed on Sep. 27 2011 now U.S. Pat. No. 9 092 098 Issued on Jul. 28 2015 and claims the benefit of Provisional Application No. 61 477 146 filed on Apr. 19 2011 both of which are incorporated by reference in their entirety.

This disclosure relates to the field of user interface devices and in particular to capacitive sense devices.

Computing devices such as notebook computers personal data assistants PDAs kiosks and mobile handsets have user interface devices which are also known as human interface devices HID . One user interface device that has become more common is a touch sensor pad also commonly referred to as a touchpad . A basic notebook computer touch sensor pad emulates the function of a personal computer PC mouse. A touch sensor pad is typically embedded into a PC notebook for built in portability. A touch sensor pad replicates mouse X Y movement by using two defined axes which contain a collection of sensor elements that detect the position of one or more conductive objects such as a finger. Mouse right left button clicks can be replicated by two mechanical buttons located in the vicinity of the touchpad or by tapping commands on the touch sensor pad itself. The touch sensor pad provides a user interface device for performing such functions as positioning a pointer or selecting an item on a display. These touch sensor pads may include multi dimensional sensor arrays for detecting movement in multiple axes. The sensor array may include a one dimensional sensor array detecting movement in one axis. The sensor array may also be two dimensional detecting movements in two axes.

Another user interface device that has become more common is a touch screen. Touch screens also known as touchscreens touch windows touch panels or touchscreen panels are transparent display overlays which are typically either pressure sensitive resistive or piezoelectric electrically sensitive capacitive acoustically sensitive surface acoustic wave SAW or photo sensitive infra red . The effect of such overlays allows a display to be used as an input device removing the keyboard and or the mouse as the primary input device for interacting with the display s content. Such displays can be attached to computers or as terminals to networks. Touch screens have become familiar in retail settings on point of sale systems on ATMs on mobile handsets on kiosks on game consoles and on PDAs where a stylus is sometimes used to manipulate the graphical user interface GUI and to enter data. A user can touch a touch screen or a touch sensor pad to manipulate data. For example a user can apply a single touch by using a finger to touch the surface of a touch screen to select an item from a menu.

Electronic systems that include touch screens are sensitive to a variety of noise sources. Noise coupled into touch screens and circuitry for applying and measuring the presence of a touch on a touch screen hereinafter touch controllers may result in significantly reduced accuracy resulting in false touches and the reported location of a touch on a touch screen. depicts various paths that induced noise currents may take between a source of noise a user of a touch screen and the touch screen and touch controller. The main sources of induced noise include 1 switching regulators employed in DC AC DC DC and AC DC converters used in power supplies and battery chargers for touch controllers and nearby external electronic equipment 2 electromagnetic noise emitted by external electronic equipment for example by high speed motors during operation of the external equipment i.e. in vacuum cleaners mixers washing machines etc 3 noise emitted by radio transmitting equipment e.g. radio stations mobile communications CB radios etc and 4 noise emitted by high voltage power lines.

These noise sources may emit electromagnetic radiation over a narrow band of frequency a wideband of frequencies or both under different operating conditions. Of the noise sources listed above chargers and power supplies for use with touch screens are the most common and cause the largest number of false or inaccurate touch events reported by touch controllers. for example depict amplitude vs. time and frequency for common mode noise emitted by a battery charger under different load conditions. The number of harmonics the fundamental frequency and amplitude of common mode charger noise depend on charger type charger electronics and charger physical construction. As shown in harmonic frequencies change during the battery charge process resulting in a frequency band of noise that changes with time but generally has a narrow bandwidth.

Radiated noise may be coupled into conductors of the touch screen and or touch controller radio transmitting equipment. The coupled radiated noise signal waveform type depends on the environment. The waveforms may be simple sine waves or waveforms with several tens of harmonics.

Noise sources generated internally within touch controllers may include internal charge pumps communication lines LCDs etc.

A touch controller s response to injected noise depends to a large degree on the frequency response characteristic of a touch screen measurement channel within the touch controller. The measurement channel frequency response of a conventional touch controller is shown in . The frequency response characteristic shown in contains high sensitivity zones 200 250 KHz 700 750 Khz and low sensitivity zones to noise. If a harmonic of injected noise coincides with one or more of the high sensitivity zones the touch controller accuracy may be significantly reduced resulting in false touches etc. This is demonstrated in which illustrates the effects of noise having harmonic components that coincide with a measurement channel response characteristic. shows the effect of harmonically induced noise on raw counts of a simulated finger touch over time as the amplitude of the harmonically induced noise increases.

A method for improving noise immunity of capacitive sensing circuit associated with a touch sense array is described. In one embodiment the capacitive sensing circuit receives a response signal from a touch sense array. The capacitive sensing circuit measures a noise component of the response signal. The noise component may have a frequency spectrum within a passband corresponding to the operating frequency of the capacitive sensing circuit. When a level of noise of the noise component within the passband is greater than a threshold the capacitive sensing circuit changes at least one parameter of capacitive sensing circuit to move the passband substantially outside the frequency spectrum of the noise component. As used herein the term threshold refers to but is not limited to an absolute fixed level of noise a relative level of noise a computed level of noise a changing level of noise or a signal to noise ratio. Alternatively other thresholds may be used as would be appreciated by one of ordinary skill in the art having the benefit of this disclosure.

In one embodiment changing a sensing frequency passband involves forcing synchronization of the sensing frequency passband of the capacitive sensing circuit to cause the frequency spectrum of the noise component to substantially match the passband of the capacitive sensing circuit.

In an embodiment determining whether the level of noise is above the threshold is effected by the capacitive sensing circuit listening to the level of noise by measuring the level of noise in a mutual capacitance mode when all receive RX electrodes are tied together in a single channel and a transmit TX signal absent on TX electrodes. Listening may be incorporated into a data stream resulting from a touch sense array scanning process by having the capacitive sensing circuit alternating between listening to the level of noise and performing a full panel scan of the touch sense array. In another embodiment the capacitive sensing circuit interleaves listening to the level of noise and performing a partial scan of the touch sense array.

In an embodiment measuring a noise component of the response signal and changing the sensing frequency passband involves the capacitive sensing circuit listening to the level of noise interleaved with performing a panel scan of the touch sense array and measuring the level of noise. If the level of noise is above a threshold the capacitive sensing circuit is switched to a next available sensing frequency passband. The above process is repeated until all available sensing frequency passbands are exhausted. An available sensing frequency passband having the lowest level of noise is selected for further scans.

The above method is most effective for reducing the influence of a narrowband induced noise such as for example noise emitted by different chargers or electroluminescent ballast circuits. By shifting a measurement channel passband noise influence on touch measurements is significantly reduced by rendering the capacitive sensing circuit relatively immune to noise induced false touches and to the presence of water. In addition conclusions drawn concerning the presence of noise may be made before touch position reporting.

In the following description for purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of the present invention. It will be evident however to one skilled in the art that the present invention may be practiced without these specific details. In other instances well known circuits structures and techniques are not shown in detail but rather in a block diagram in order to avoid unnecessarily obscuring an understanding of this description.

Reference in the description to one embodiment or an embodiment means that a particular feature structure or characteristic described in connection with the embodiment is included in at least one embodiment of the invention. The phrase in one embodiment located in various places in this description does not necessarily refer to the same embodiment.

In one embodiment the sensor array includes sensor elements N where N is a positive integer that are disposed as a two dimensional matrix also referred to as an XY matrix . The sensor array is coupled to pins N of the processing device via one or more analog buses transporting multiple signals. In this embodiment each sensor element N is represented as a capacitor. The self capacitance of each sensor in the sensor array is measured by a capacitance sensor in the processing device .

In one embodiment the capacitance sensor may include a relaxation oscillator or other means to convert a capacitance into a measured value. The capacitance sensor may also include a counter or timer to measure the oscillator output. The capacitance sensor may further include software components to convert the count value e.g. capacitance value into a sensor element detection decision also referred to as switch detection decision or relative magnitude. It should be noted that there are various known methods for measuring capacitance such as current versus voltage phase shift measurement resistor capacitor charge timing capacitive bridge divider charge transfer successive approximation sigma delta modulators charge accumulation circuits field effect mutual capacitance frequency shift or other capacitance measurement algorithms. It should be noted however instead of evaluating the raw counts relative to a threshold the capacitance sensor may be evaluating other measurements to determine the user interaction. For example in the capacitance sensor having a sigma delta modulator the capacitance sensor is evaluating the ratio of pulse widths of the output instead of the raw counts being over or under a certain threshold.

In one embodiment the processing device further includes processing logic . Operations of the processing logic may be implemented in firmware alternatively it may be implemented in hardware or software. The processing logic may receive signals from the capacitance sensor and determine the state of the sensor array such as whether an object e.g. a finger is detected on or in proximity to the sensor array e.g. determining the presence of the object where the object is detected on the sensor array e.g. determining the location of the object tracking the motion of the object or other information related to an object detected at the touch sensor.

In another embodiment instead of performing the operations of the processing logic in the processing device the processing device may send the raw data or partially processed data to the host . The host as illustrated in may include decision logic that performs some or all of the operations of the processing logic . Operations of the decision logic may be implemented in firmware hardware software or a combination thereof. The host may include a high level Application Programming Interface API in applications that perform routines on the received data such as compensating for sensitivity differences other compensation algorithms baseline update routines start up and or initialization routines interpolation operations or scaling operations. The operations described with respect to the processing logic may be implemented in the decision logic the applications or in other hardware software and or firmware external to the processing device . In some other embodiments the processing device is the host .

In another embodiment the processing device may also include a non sensing actions block . This block may be used to process and or receive transmit data to and from the host . For example additional components may be implemented to operate with the processing device along with the sensor array e.g. keyboard keypad mouse trackball LEDs displays or other peripheral devices .

The processing device may reside on a common carrier substrate such as for example an integrated circuit IC die substrate or a multi chip module substrate. Alternatively the components of the processing device may be one or more separate integrated circuits and or discrete components. In one embodiment the processing device may be the Programmable System on a Chip PSoC processing device developed by Cypress Semiconductor Corporation San Jose Calif. Alternatively the processing device may be one or more other processing devices known by those of ordinary skill in the art such as a microprocessor or central processing unit a controller special purpose processor digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable device. In an alternative embodiment for example the processing device may be a network processor having multiple processors including a core unit and multiple micro engines. Additionally the processing device may include any combination of general purpose processing device s and special purpose processing device s .

In one embodiment the electronic system is implemented in a device that includes the touch sensing surface as the user interface such as handheld electronics portable telephones cellular telephones notebook computers personal computers personal data assistants PDAs kiosks keyboards televisions remote controls monitors handheld multi media devices handheld video players gaming devices control panels of a household or industrial appliances or other computer peripheral or input devices. Alternatively the electronic system may be used in other types of devices. It should be noted that the components of electronic system may include all the components described above. Alternatively electronic system may include only some of the components described above or include additional components not listed herein.

Capacitance sensor includes multiplexer control demultiplexer and multiplexer clock generator signal generator demodulation circuit and analog to digital converter ADC . ADC is further coupled with touch coordinate converter . Touch coordinate converter outputs a signal to the processing logic .

The transmit and receive electrodes in the electrode matrix may be arranged so that each of the transmit electrodes overlap and cross each of the receive electrodes such as to form an array of intersections while maintaining galvanic isolation from each other. Thus each transmit electrode may be capacitively coupled with each of the receive electrodes. For example transmit electrode is capacitively coupled with receive electrode at the point where transmit electrode and receive electrode overlap.

Clock generator supplies a clock signal to signal generator which produces a TX signal to be supplied to the transmit electrodes of touch sensor . In one embodiment the signal generator includes a set of switches that operate according to the clock signal from clock generator . The switches may generate a TX signal by periodically connecting the output of signal generator to a first voltage and then to a second voltage wherein said first and second voltages are different.

The output of signal generator is connected with demultiplexer which allows the TX signal to be applied to any of the M transmit electrodes of touch sensor . In one embodiment multiplexer control controls demultiplexer so that the TX signal is applied to each transmit electrode in a controlled sequence. Demultiplexer may also be used to ground float or connect an alternate signal to the other transmit electrodes to which the TX signal is not currently being applied.

Because of the capacitive coupling between the transmit and receive electrodes the TX signal applied to each transmit electrode induces a current within each of the receive electrodes. For instance when the TX signal is applied to transmit electrode through demultiplexer the TX signal induces an RX signal on the receive electrodes in matrix . The RX signal on each of the receive electrodes can then be measured in sequence by using multiplexer to connect each of the N receive electrodes to demodulation circuit in sequence.

The mutual capacitance associated with each intersection between a TX electrode and an RX electrode can be sensed by selecting every available combination of TX electrode and an RX electrode using demultiplexer and multiplexer . To improve performance multiplexer may also be segmented to allow more than one of the receive electrodes in matrix to be routed to additional demodulation circuits . In an optimized configuration wherein there is a 1 to 1 correspondence of instances of demodulation circuit with receive electrodes multiplexer may not be present in the system.

When an object such as a finger approaches the electrode matrix the object causes a decrease in the mutual capacitance between only some of the electrodes. For example if a finger is placed near the intersection of transmit electrode and receive electrode the presence of the finger will decrease the mutual capacitance between electrodes and . Thus the location of the finger on the touchpad can be determined by identifying the one or more receive electrodes having a decreased mutual capacitance in addition to identifying the transmit electrode to which the TX signal was applied at the time the decreased mutual capacitance was measured on the one or more receive electrodes.

By determining the mutual capacitances associated with each intersection of electrodes in the matrix the locations of one or more touch contacts may be determined. The determination may be sequential in parallel or may occur more frequently at commonly used electrodes.

In alternative embodiments other methods for detecting the presence of a finger or conductive object may be used where the finger or conductive object causes an increase in capacitance at one or more electrodes which may be arranged in a grid or other pattern. For example a finger placed near an electrode of a capacitive sensor may introduce an additional capacitance to ground that increases the total capacitance between the electrode and ground. The location of the finger can be determined from the locations of one or more electrodes at which an increased capacitance is detected.

The induced current signal is rectified by demodulation circuit . The rectified current output by demodulation circuit can then be filtered and converted to a digital code by ADC .

The digital code is converted to touch coordinates indicating a position of an input on touch sensor array by touch coordinate converter . The touch coordinates are transmitted as an input signal to the processing logic . In one embodiment the input signal is received at an input to the processing logic . In one embodiment the input may be configured to receive capacitance measurements indicating a plurality of row coordinates and a plurality of column coordinates. Alternatively the input may be configured to receive row coordinates and column coordinates.

In one embodiment a system for tracking locations of contacts on a touch sensing surface may determine a force magnitude for each of the contacts based on the capacitance measurements from the capacitive sensor array. In one embodiment a capacitive touch sensing system that is also capable of determining a magnitude of force applied to each of a plurality of contacts at a touch sensing surface may be constructed from flexible materials such as PMMA and may have no shield between the capacitive sensor array and an LCD display panel. In such an embodiment changes in capacitances of sensor elements may be caused by the displacement of the sensor elements closer to a VCOM plane of the LCD display panel.

It should be noted that a measurement channel particularly the combination of the demodulation circuit the clock generator and the signal generator of the capacitance sensor and the processing logic of may be configured and operated to be relatively immune to injected noise if noise harmonics coincide with the low sensitivity zones depicted in . is a state diagram of one embodiment of an adaptive frequency selection method that may be employed in the system of to render the capacitive sensor relatively immune to injected noise by shifting the passband of the conversion channel of the capacitance sensor outside the induced noise spectrum.

The capacitive sensor is initially in a normal operation state . The capacitive sensor transitions to a noise detection state to measure a noise component of a response signal of the measurement channel. When a level of noise of the noise component is below a threshold the capacitive sensor transitions back to the normal operation state and the process repeats. If in state the level of noise of the noise component exceeds the threshold then the capacitive sensor transitions to a state where at least one scanning parameter of the capacitive sensor is changed to move the passband of the measurement channel substantially outside the frequency spectrum of the noise component. Scanning parameters may include but are not limited to sensing frequency integration time driving signal a number of sub conversions per conversion cycle and a number of transmit TX cycles in an individual sub conversion. As used herein a sub conversion refers to a short conversion which is used to measure one cell of a signal during several measurements. As used herein a cell refers to a cross section of transmit and receive electrodes on a capacitive sensing surface. The final result is formed by employing a mathematical transformation on the set of several measurements of the cell i.e. averaging .

Shifting a channel frequency passband using the circuit of according to the method described above in require shifting of baseline capacitance and may suffer from parasitic effects that may degrade touch response. A possible solution to these drawbacks is shown in . is a schematic block diagram of the circuit of modified to include an additional channel that forces synchronization of the sensing frequency passband to cause the frequency spectrum of the noise component to substantially match the passband of the capacitive sensing circuit. The circuit of now includes an additional multiplexer and a pulse width modulation PWM circuit coupled to an output of the flip flop . Under normal operating conditions the circuit of operates as in . When the multiplexer is switched to an additional channel the circuit causes the frequency spectrum of the noise component to substantially match the passband of the capacitive sensing circuit. For correct operation the frequency passband of the forced synchronization channel may be lower than a minimal operational panel frequency employed with the current source sink .

One or more methods may be employed to measure a level of noise once forced synchronization is applied to determine whether the level of noise is above a threshold. In one embodiment a raw counts series i.e. a measured series of data may be analyzed during several panel scan sessions and a conclusion may be drawn about the noise level. Raw counts are digital values that are a direct result of a capacitance measurement from a capacitive sensor as output from an analog to digital converter. In a related embodiment the raw counts levels may be analyzed during several conversions around a touch area of a conductive object proximate to the touch sense array as shown in Figures ISA. In such circumstances response data digital values may be analyzed around touch positions to save processing resources. shows the dependence between a baseline and forced synchronized channel operational frequency. is relative to the circuit of and shows an absence of parasitic effect of baseline shifting due to changes in sensing frequency passband.

In another embodiment another method is based on analyzing touch position jitter history of a touch position of a conductive object proximate to the touch sense array.

In another embodiment a measurement of noise level is obtained while applying a TX signal for a predetermined number of cycles e.g. 2 3 and analyzing a distribution of the noise level during a second set of one or more measurement cycles e.g. 20 30 where the first set of cycles is less than the second set of cycles and where during the second set of cycles full conversion measurements are performed.

In still another embodiment the capacitive sensor listens to i.e. measures the presence of noise on an RX channel when transmit TX signals are absent. is schematic block diagram of a capacitive sense array configured for listening to a level of noise by measuring the level of noise in a mutual capacitance mode when all receive RX electrodes are tied together in a single channel and a transmit TX signal absent on TX electrodes. Listening is insensitive to touches and water and permits measuring only the noise level. A conclusion about the presence and level of noise may be drawn before touch position reporting. As a result the system can reject noisy measurements of capacitance and preemptively warn the host about the unacceptable level of noise.

Embodiments of the present invention described herein include various operations. These operations may be performed by hardware components software firmware or a combination thereof. As used herein the term coupled to may mean coupled directly or indirectly through one or more intervening components. Any of the signals provided over various buses described herein may be time multiplexed with other signals and provided over one or more common buses. Additionally the interconnection between circuit components or blocks may be shown as buses or as single signal lines. Each of the buses may alternatively be one or more single signal lines and each of the single signal lines may alternatively be buses.

Certain embodiments may be implemented as a computer program product that may include instructions stored on a computer readable medium. These instructions may be used to program a general purpose or special purpose processor to perform the described operations. A computer readable medium includes any mechanism for storing or transmitting information in a form e.g. software processing application readable by a machine e.g. a computer . The computer readable storage medium may include but is not limited to magnetic storage medium e.g. floppy diskette optical storage medium e.g. CD ROM magneto optical storage medium read only memory ROM random access memory RAM erasable programmable memory e.g. EPROM and EEPROM flash memory or another type of medium suitable for storing electronic instructions. The computer readable transmission medium includes but is not limited to electrical optical acoustical or other form of propagated signal e.g. carrier waves infrared signals digital signals or the like or another type of medium suitable for transmitting electronic instructions.

Additionally some embodiments may be practiced in distributed computing environments where the computer readable medium is stored on and or executed by more than one computer system. In addition the information transferred between computer systems may either be pulled or pushed across the transmission medium connecting the computer systems.

Although the operations of the method s herein are shown and described in a particular order the order of the operations of each method may be altered so that certain operations may be performed in an inverse order or so that certain operation may be performed at least in part concurrently with other operations. In another embodiment instructions or sub operations of distinct operations may be in an intermittent and or alternating manner.

In the foregoing specification the invention has been described with reference to specific exemplary embodiments thereof. It will however be evident that various modifications and changes may be made thereto without departing from the broader spirit and scope of the invention as set forth in the appended claims. The specification and drawings are accordingly to be regarded in an illustrative sense rather than a restrictive sense.

