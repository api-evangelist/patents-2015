---

title: Method, controller, and system for processing data packet
abstract: A method, a controller, and a system for processing a data packet are disclosed. The method includes receiving, by a controller, a data packet that is reported by a switch and does not match a forwarding rule; after it is determined that a type of the data packet is a broadcast data packet, generating a forwarding rule for the data packet, where the forwarding rule includes an action attribute being discarded; and sending the forwarding rule of the data packet to the switch, so that when receiving the data packet again, the switch discards the data packet according to the action attribute of the forwarding rule. In the present invention, a broadcast storm on a network can be avoided without shielding a port of a switch. Therefore, for a fully-connected network, a forwarding capability of a port and a quantity of available transmission links on the network are ensured.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09571382&OS=09571382&RS=09571382
owner: Huawei Technologies Co., Ltd.
number: 09571382
owner_city: Shenzhen
owner_country: CN
publication_date: 20150209
---
This application is a continuation of International Application No. PCT CN2013 071327 filed on Feb. 4 2013 which claims priority to Chinese Patent Application No. 201210318795.1 filed on Aug. 31 2012 both of which are hereby incorporated by reference in their entireties.

The present invention relates to the field of network communications technologies and in particular to a method a controller and a system for processing a data packet.

Generally a data center uses a fully connected network structure to improve network communications efficiency. One type of fully connected network structure may be as follows. Switches at different layers are connected in a pairwise mode and each switch at the bottom layer is connected to a certain quantity of hosts. When a switch on a network receives a broadcast data packet flooding needs to be performed on the broadcast data packet on all ports except a receiving port in a virtual local area network VLAN to which the switch belongs. However when a loop exists on a fully connected network a broadcast data packet may be repeatedly broadcasted on the loop which causes a broadcast storm.

The fully connected network may be implemented based on a software defined network SDN technology. A network applying the SDN technology generally includes several network devices and a controller controlling the network devices. The core of the SDN is to separate a control plane of a network device for example a switch from a data forwarding plane of the network device where the data forwarding plane performs data forwarding based on a flow table and the control plane provides an application programming interface API for the controller to perform control. On an SDN network a routing table in a switch is empty at an initial stage. When a forwarding rule matching a received data packet cannot be found from the routing table of the switch the switch requests a forwarding rule by reporting the data packet to a controller forwards the data packet according to a forwarding rule delivered by the controller and stores the forwarding rule in the routing table. Generally the default forwarding rule delivered by the controller to the switch is broadcasting the data packet. Referring to is a schematic diagram of an SDN based fully connected network architecture. In each S represents a switch and there are two layers of switches namely core switches and access switches each h represents a host connected to an access switch and a controller is connected to each switch switches at different layers are connected in a pairwise mode and each access switch is connected to two hosts.

To avoid a broadcast storm in the prior art data on a network may be broadcasted over the Spanning Tree Protocol STP . When STP is used a network topology is constructed for switches on the network according to a tree structure one switch is selected from the tree structure and is used as a root bridge device all switches form a tree starting from the root bridge device the root bridge device sends a configuration packet on a timed basis after a non root bridge device receives the configuration packet the non root bridge device re calculates configuration information and forwards the configuration packet. If a switch can receive the configuration packet from more than two ports there is more than one transmission link from the switch to the root bridge device and a forwarding loop is formed between the switch and the root bridge device. In this case the switch selects one port and shields other ports so as to eliminate the forwarding loop on the network.

During the study on the prior art the inventor discovers that because a switch needs to avoid occurrence of a broadcast storm by shielding ports forwarding capabilities of the ports on the network are suppressed which is equivalent to that for a fully connected network a quantity of available transmission links on the network is reduced thereby reducing a utilization rate of the transmission links on the network.

Embodiments of the present invention provide a method a controller and a system for processing a data packet so as to solve a problem in the prior art that a utilization rate of a network link is reduced when STP is used to suppress a broadcast storm.

To solve the foregoing technical problem the embodiments of the present invention disclose the following technical solutions.

In a first aspect a method for processing a data packet is provided where the method includes receiving by a controller the data packet that is reported by a switch and does not match a forwarding rule after it is determined that a type of the data packet is a broadcast data packet generating a forwarding rule for the data packet where the forwarding rule includes an action attribute being discarded and sending the forwarding rule of the data packet to the switch so that when receiving the data packet again the switch discards the data packet according to the action attribute of the forwarding rule.

With reference to the first aspect in a first possible implementation manner the forwarding rule further includes aging time so that the switch discards the data packet when receiving the data packet again within the aging time.

With reference to the first aspect or the first possible implementation manner in a second possible implementation manner before the generating a forwarding rule for the data packet the method further includes determining that attribute information of the data packet matches set attribute information where the set attribute information includes at least one piece of the following information a protocol type a source address a destination address a source port number a destination port number a virtual local area network identifier VLAN ID a VLAN priority and an Ethernet type.

With reference to the first aspect or the first possible implementation manner in a third possible implementation manner before the sending the forwarding rule of the data packet to the switch the method further includes setting the action attribute of the data packet to broadcast and sending the data packet to the switch so that the switch broadcasts the data packet according to the action attribute of the data packet.

With reference to the first aspect or the first possible implementation manner or the second possible implementation manner or the third possible implementation manner in a fourth possible implementation manner the forwarding rule includes at least one piece of the following information of the data packet a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority an Ethernet type and a service type.

In a second aspect a controller is provided where the controller includes a receiving unit configured to receive a data packet that is reported by a switch and does not match a forwarding rule a determining unit configured to determine that a type of the data packet received by the receiving unit is a broadcast data packet a generating unit configured to after the determining unit determines that the type of the data packet is a broadcast data packet generate a forwarding rule for the data packet where the forwarding rule includes an action attribute being discard and a sending unit configured to send the forwarding rule of the data packet generated by the generating unit to the switch so that when receiving the data packet again the switch discards the data packet according to the action attribute of the forwarding rule.

With reference to the second aspect in a first possible implementation manner the forwarding rule generated by the generating unit further includes aging time so that the switch discards the data packet when receiving the data packet again within the aging time.

With reference to the second aspect or the first possible implementation manner in a second possible implementation manner the determining unit is further configured to when it is determined that attribute information of the data packet matches set attribute information trigger the generating unit to execute generating a forwarding rule for the data packet where the set attribute information includes at least one piece of the following information a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority and an Ethernet type.

With reference to the second aspect or the first possible implementation manner in a third possible implementation manner the controller further includes a setting unit configured to set the action attribute of the data packet received by the receiving unit to broadcast and the sending unit is further configured to send to the switch the data packet of which action attribute is set to broadcast by the setting unit so that the switch broadcasts the data packet according to the action attribute of the data packet.

In a third aspect a system for processing a data packet is provided where the system includes a controller described in an embodiment of the present invention and a plurality of switches connected to the controller the plurality of switches form a ring network and any one switch of the plurality of switches is a first switch and the first switch is configured to receive a forwarding rule of a data packet sent by the controller where an action attribute of the forwarding rule of the data packet is discard and is further configured to discard after receiving the data packet again the data packet according to the action attribute of the forwarding rule of the data packet.

In the embodiments of the present invention when a switch receives a data packet and does not match a forwarding rule of the data packet the switch reports the data packet to a controller when determining that the data packet is a broadcast data packet the controller generates a forwarding rule for the data packet and sends the forwarding rule to the switch where the forwarding rule includes an action attribute being discarded. Because the switch is located on a fully connected network when the switch receives the data packet again the switch can match the forwarding rule of the data packet and discard the data packet according to the action attribute of the forwarding rule of the data packet thereby preventing the switch from broadcasting the data packet repeatedly and avoiding occurrence of a broadcast storm. In addition in the present invention a broadcast storm on a network can be avoided without shielding a port of a switch. Therefore for a fully connected network a forwarding capability of a port and a quantity of available transmission links on the network are ensured and a utilization rate of the transmission links on the network is increased accordingly.

The following embodiments of the present invention provide a method a controller and a system for processing a data packet.

To help those skilled in the art better understand the technical solutions provided in the embodiments of the present invention and make the objectives features and advantages of the present invention more comprehensible the following further describes the technical solutions provided in the embodiments of the present invention in detail with reference to the accompanying drawings.

Referring to is a flowchart of an embodiment of a method for processing a data packet according to the present invention. This embodiment describes a process of broadcasting a data packet from a controller side.

Step A controller receives a data packet that is reported by a switch and does not match a forwarding rule.

When the switch does not match a forwarding rule of the data packet it indicates that the data packet is a data packet received by the switch for the first time. In this case the switch reports the data packet to the controller and requests the controller to deliver a forwarding policy for the data packet.

Step After it is determined that a type of the data packet is a broadcast data packet generate a forwarding rule for the data packet where the forwarding rule includes an action attribute being discarded.

Because a broadcast data packet causes a broadcast storm on a fully connected network in this embodiment the controller needs to identify the type of the data packet so as to perform processing on the broadcast data packet. The type of the data packet may be identified according to a destination Medium Media Access Control MAC address of the data packet. When the destination MAC address is all F it can be determined that the type of the data packet is a broadcast data packet.

Because the data packet reported by the switch is the data packet received by the switch for the first time the controller may generate a forwarding rule for the data packet where the forwarding rule is subsequently used as a forwarding policy of the data packet. The forwarding rule may include at least one piece of the following information of the data packet a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority an Ethernet type and a service type and the forwarding rule may not include an ingress port of the data packet on the switch. In addition the forwarding rule further includes the action attribute being discard. Optionally the forwarding rule may further include aging time.

Optionally because broadcast data packets may be further subdivided into different types of broadcast data packets in this embodiment the controller may further match attribute information of the broadcast data packet with preset attribute information after identifying that the data packet is a broadcast data packet so as to meet a user s requirements for processing a specific type of broadcast data packet. The set attribute information may include at least one piece of the following information a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority and an Ethernet type. For example for an Address Resolution Protocol ARP data packet and a Dynamic Host Configuration Protocol DHCP data packet that both are broadcast data packets if a user customizes that this embodiment of the present invention needs to be applied to the ARP data packet attribute information of the ARP data packet may be preset when the received data packet is a broadcast data packet the controller further confirms whether the attribute information of the data packet matches the attribute information of the ARP data packet and when the attribute information of the data packet matches the attribute information of the ARP data packet it indicates that the broadcast data packet is an ARP data packet and a forwarding rule is generated according to the ARP data packet.

Step Send the forwarding rule of the data packet to the switch so that when receiving the data packet again the switch discards the data packet according to the action attribute of the forwarding rule.

In this embodiment for the data packet reported by the switch for the first time the controller may set the action attribute of the data packet to broadcast and send the set data packet to the switch so that the switch is controlled to broadcast the data packet. After the controller sends a forwarding rule to the switch the switch can store the forwarding rule. Subsequently when confirming according to information included in the forwarding rule that the data packet is received again the switch may discard according to the action attribute included in the forwarding rule the data packet received again thereby avoiding a broadcast storm on the network.

Further when the forwarding rule includes aging time the switch may discard the data packet when receiving the data packet again within the aging time.

It can be seen from the foregoing embodiment that when a switch receives a data packet and does not match a forwarding rule of the data packet the switch reports the data packet to a controller and after determining that the data packet is a broadcast data packet the controller generates a forwarding rule for the data packet and sends the forwarding rule to the switch where the forwarding rule includes an action attribute being discard. Because the switch is located on a fully connected network when the switch receives the data packet again the switch can match the forwarding rule of the data packet and discard the data packet according to the action attribute of the forwarding rule of the data packet thereby preventing the switch from broadcasting the data packet repeatedly and avoiding occurrence of a broadcast storm. In addition in the present invention a broadcast storm on a network can be avoided without shielding a port of a switch. Therefore for a fully connected network a forwarding capability of a port and a quantity of available transmission links on the network are ensured and a utilization rate of the transmission links on the network is increased accordingly.

Referring to is a flowchart of another embodiment of a method for processing a data packet according to the present invention. This embodiment describes a process of broadcasting a data packet from a switch side.

Step When a forwarding rule of the data packet is not matched report the data packet to a controller.

When the switch does not match a forwarding rule of the data packet it indicates that the data packet is a data packet received by the switch for the first time. In this case the switch reports the data packet to the controller and requests the controller to deliver a forwarding policy for the data packet.

Step Receive a forwarding rule that is generated for the data packet and sent by the controller where the forwarding rule is a forwarding rule generated for the data packet after the controller determines that a type of the data packet is a broadcast data packet and the forwarding rule includes an action attribute being discarded.

Because a broadcast data packet causes a broadcast storm on a fully connected network in this embodiment the controller needs to identify the type of the data packet so as to perform processing on the broadcast data packet. The type of the data packet may be identified according to a destination MAC address of the data packet. When the destination MAC address is all F it can be determined that the type of the data packet is a broadcast data packet.

Because the data packet reported by the switch is a data packet received by the switch for the first time the controller may generate a forwarding rule according to the data packet where the forwarding rule is subsequently used as a forwarding policy of the data packet. The forwarding rule may include at least one piece of the following information of the data packet a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority an Ethernet type and a service type and the forwarding rule may not include an ingress port of the data packet on the switch. In addition the forwarding rule further includes the action attribute being discard. Optionally the forwarding rule may further include aging time.

Optionally because broadcast data packets may be further subdivided into different types of broadcast data packets in this embodiment the controller may further match attribute information of the broadcast data packet with preset attribute information after identifying that the data packet is a broadcast data packet so as to meet a user s requirements for processing a specific type of broadcast data packet. The set attribute information may include at least one piece of the following information a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority and an Ethernet type.

In this embodiment for the data packet reported by the switch for the first time the controller may set the action attribute of the data packet to broadcast and send the set data packet to the switch the switch broadcasts the data packet on the network according to the action attribute of the data packet after the switch receives a forwarding rule that is generated by the controller according to the data packet the switch can store the forwarding rule.

Step When the data packet is received again discard the data packet according to the action attribute included in the forwarding rule.

When confirming according to information included in the forwarding rule that the data packet is received again the switch may discard according to the action attribute included in the forwarding rule the data packet received again thereby avoiding a broadcast storm on the network.

It can be seen from the foregoing embodiment that when a switch receives a data packet and does not match a forwarding rule of the data packet the switch reports the data packet to a controller and after determining that the data packet is a broadcast data packet the controller generates a forwarding rule for the data packet and sends the forwarding rule to the switch where the forwarding rule includes an action attribute being discarded. Because the switch is located on a fully connected network when the switch receives the data packet again the switch can match the forwarding rule of the data packet and discard the data packet according to the action attribute of the forwarding rule of the data packet thereby preventing the switch from broadcasting the data packet repeatedly and avoiding occurrence of a broadcast storm. In addition in the present invention a broadcast storm on a network can be avoided without shielding a port of a switch. Therefore for a fully connected network a forwarding capability of a port and a quantity of available transmission links on the network are ensured and a utilization rate of the transmission links on the network is increased accordingly.

Referring to is a schematic diagram of a connection of switches on a fully connected network applied in an embodiment of the present invention. In core switches include a switch and a switch and access switches include a switch and a switch where the switch and the switch are connected to the switch and the switch respectively and each switch includes a port and a port . In a solid line connected between ports represents a link connection between switches and a dashed line represents a flow direction of a data packet transmitted in the foregoing link. Four switches shown in are all connected to a controller where the controller is not shown in .

Referring to is a flowchart of a third embodiment of a method for broadcasting a data packet according to the present invention. This embodiment describes with reference to a process of processing a data packet in detail.

Step The switch does not match a forwarding rule of the data packet and reports the data packet to a controller.

It is assumed that the data packet received by the port of the switch is a data packet received by the switch for the first time. Therefore the switch does not match a forwarding rule of the data packet and the switch reports the data packet to the controller and requests the controller to deliver a forwarding policy for the data packet.

Step The controller determines that the data packet is a broadcast data packet and determines that attribute information of the data packet matches set attribute information.

When the controller identifies that a destination MAC address of the data packet is all F it can be determined that the data packet is a broadcast data packet. Then the controller matches attribute information of the broadcast data packet with preset attribute information where the set attribute information may include at least one piece of the following information a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority and an Ethernet type. Assuming that the attribute information preset by a user in this embodiment is a protocol type ARP after the controller identifies the broadcast data packet a subsequent step is further executed when it is further determined that a protocol type of the broadcast data packet is ARP.

Step The controller sets an action attribute of the data packet to broadcast and generates a forwarding rule for the data packet where the forwarding rule includes an action attribute being discard and aging time.

In this embodiment for a data packet reported by the switch for the first time the controller sets an action attribute of the data packet to broadcast so that the switch can broadcast the data packet received for the first time. In addition the controller generates a forwarding rule for the data packet received by the switch where the forwarding rule may include at least one piece of the following information of the data packet a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority an Ethernet type and a service type and the forwarding rule may not include an ingress port of the data packet on the switch. When the forwarding rule is generated the action attribute being discard and the aging time are further included so that when receiving the data packet again the switch can discard according to the action attribute the data packet received again within the set aging time.

Step The switch broadcasts according to the action attribute of the data packet the data packet sent by the controller and when receiving the data packet again within the aging time of the forwarding rule the switch discards the data packet according to the action attribute included in the forwarding rule.

With reference to for the data packet reported by the switch in step the switch can broadcast according to the action attribute set in the data packet the data packet by using the port after receiving the data packet delivered by the controller. Subsequently when the switch receives the data packet matching information in the forwarding rule again and the aging time of the forwarding rule does not expire the switch can discard the data packet thereby avoiding a broadcast storm on the network.

In when the switch broadcasts the received data packet to the port of the switch by using the port the switch executes a process the same as that executed by the foregoing switch . Similarly when the switch and the switch receive a data packet transmitted according to a transmission direction of the data packet in the switch and the switch execute the process the same as that executed by the foregoing switch which is not further described herein.

It can be seen from the foregoing embodiment that when a switch receives a data packet and does not match a forwarding rule of the data packet the switch reports the data packet to a controller and after determining that the data packet is a broadcast data packet the controller generates a forwarding rule for the data packet and sends the forwarding rule to the switch where the forwarding rule includes an action attribute being discard. Because the switch is located on a fully connected network when the switch receives the data packet again the switch can match the forwarding rule of the data packet and discard the data packet according to the action attribute of the forwarding rule of the data packet thereby preventing the switch from broadcasting the data packet repeatedly and avoiding occurrence of a broadcast storm. In addition in the present invention a broadcast storm on a network can be avoided without shielding a port of a switch. Therefore for a fully connected network a forwarding capability of a port and a quantity of available transmission links on the network are ensured and a utilization rate of the transmission links on the network is increased accordingly.

Referring to is a schematic diagram of a network architecture applying an embodiment of the present invention. In a controller is connected to switches S S S S S and S the S is connected to hosts h and h the S is connected to hosts h and h the S is connected to hosts h and h and the S is connected to host h and h. It is assumed that the host sends an ARP request data packet on a network to request a MAC address of the h and that the ARP request data packet is a broadcast data packet that needs to be controlled by using this embodiment of the present invention. With reference to the following describes an example of processing a data packet applying this embodiment of the present invention. The processing process is implemented based on OpenFlow of an SDN technology. The processing process is as follows.

The switch S searches for a forwarding rule of the ARP request data packet when the switch S does not find a forwarding rule matching the APR request data packet the switch S reports the ARP request data packet to the controller in a form of PacketIn defined in the OpenFlow and requests the controller for a forwarding policy.

After receiving the ARP request data packet the controller learns a source MAC address and a source Internet Protocol IP address of the host h by using the ARP request data packet and identifies that the data packet is an ARP data packet according to a protocol type 0x0806 of the ARP request data packet. Therefore the controller sets an action action attribute of the ARP request data packet to broadcast and sends the ARP request data packet to the switch S in a form of PacketOut defined in the OpenFlow. In addition the controller generates an accurately matched forwarding rule according to the ARP request data packet where the forwarding rule may not include an ingress port of the data packet on the switch and the controller sets the action attribute of the forwarding rule to discard and may set aging time of the forwarding rule to 5 seconds s where the forwarding rule may include 11 tuples. Subsequently when the switch S receives a data packet matching the 11 tuples in the forwarding rule again the switch S discards the data packet so as to avoid occurrence of a broadcast storm where examples of the 11 tuples included in the forwarding rule may be shown as follows match OFMatch dl dst ff ff ff ff ff ff dl src 00 00 00 00 00 16 dl type 0x806 dl vlan Oxffff dl vpcp 0 nw dst 10.0.0.32 nw src 10.0.0.22 nw proto 1 nw tos 0 tp dst 1 tp src 0 where a first tuple dl dst represents an Ethernet destination address a second tuple dl src represents an Ethernet source address a third tuple dl type represents an Ethernet frame type a fourth tuple dl vlan represents a VLAN ID a fifth tuple dl vpcp represents a VLAN priority a sixth tuple nw dst represents a destination IP address IP destination address a seventh tuple nw src represents a source IP address IP source address an eighth tuple nw proto represents a network layer protocol type or lower 8 bits of ARP Operation code IP protocol or lower 8 bits of ARP Operation code a ninth tuple nw tos represents an IP type of service a tenth tuple tp dst represents a Transmission Control Protocol TCP or User Datagram Protocol UDP destination port number TCP UDP destination port and an eleventh tuple tp src represents a TCP or UDP source port number TCP UDP source port .

The switch S transmits according to a transmission direction of the data packet the ARP request data packet to the switch S connected to the host h. When each switch involved in the foregoing transmission process receives the ARP request data packet the switch executes a process the same as that executed by the switch S which is not further described herein.

After broadcasting the ARP request data packet to the host h the switch S obtains an ARP reply data packet sent by the host h. The switch S does not have a forwarding rule matching the ARP reply data packet and then the switch S reports the reply data packet to the controller and requests a forwarding policy of the ARP reply data packet.

After receiving the ARP reply data packet the controller transmits the ARP reply data packet to the host h according to the learned source MAC address and source IP address of the host h in a unicast manner so that the host h learns the MAC address of the host h.

Corresponding to the embodiments of the method for processing a data packet of the present invention the present invention further provides embodiments of a controller an apparatus for processing a data packet a switch and a system for processing a data packet. The embodiments are the controller the apparatus the switch and the system that are configured to execute the foregoing method embodiments. For related descriptions reference may be made to the descriptions of the foregoing method embodiments.

The receiving unit is configured to receive a data packet that is reported by a switch and does not match a forwarding rule.

The determining unit is configured to determine that a type of the data packet received by the receiving unit is a broadcast data packet.

The generating unit is configured to after the determining unit determines that the type of the data packet is a broadcast data packet generate a forwarding rule for the data packet where the forwarding rule includes an action attribute being discarded.

The sending unit is configured to send the forwarding rule of the data packet generated by the generating unit to the switch so that when receiving the data packet again the switch discards the data packet according to the action attribute of the forwarding rule.

Optionally the forwarding rule generated by the generating unit further includes aging time so that the switch discards the data packet when receiving the data packet again within the aging time.

Optionally the determining unit may be further configured to when it is determined that attribute information of the data packet matches set attribute information trigger the generating unit to execute generating a forwarding rule for the data packet where the set attribute information includes at least one piece of the following information a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority and an Ethernet type.

Optionally the controller may further include a setting unit not shown in configured to set the action attribute of the data packet received by the receiving unit to broadcast and the sending unit is further configured to send to the switch the data packet of which action attribute is set to broadcast by the setting unit so that the switch broadcasts the data packet according to the action attribute of the data packet.

It can be seen from the foregoing embodiment that a controller receives a data packet that is reported by a switch and does not match a forwarding rule and after determining that the data packet is a broadcast data packet the controller generates a forwarding rule for the data packet and sends the forwarding rule to the switch where the forwarding rule includes an action attribute being discarded. Because the switch is located on a fully connected network when the switch receives the data packet again the switch can match the forwarding rule of the data packet and discard the data packet according to the action attribute of the forwarding rule of the data packet thereby preventing the switch from broadcasting the data packet repeatedly and avoiding occurrence of a broadcast storm. In addition in the present invention a broadcast storm on a network can be avoided without shielding a port of a switch. Therefore for a fully connected network a forwarding capability of a port and a quantity of available transmission links on the network are ensured and a utilization rate of the transmission links on the network is increased accordingly.

Referring to is an apparatus for processing a data packet disclosed by an embodiment of the present invention.

The processing apparatus includes at least one communication bus at least one network interface a memory and at least one processor .

The communication bus is configured to connect all components of the processing apparatus including the network interface the memory and the processor so as to implement communication between the foregoing components.

The memory includes a receiving unit configured to receive a data packet that is reported by a switch and does not match a forwarding rule a determining unit configured to determine that a type of the data packet received by the receiving unit is a broadcast data packet. Optionally the determining unit may be further configured to when it is determined that attribute information of the data packet matches set attribute information trigger the generating unit to execute generating a forwarding rule for the data packet where the set attribute information includes at least one piece of the following information a protocol type a source address a destination address a source port number a destination port number a VLAN ID a VLAN priority and an Ethernet type a generating unit configured to after the determining unit determines that the type of the data packet is a broadcast data packet generate a forwarding rule for the data packet where the forwarding rule includes an action attribute being discard. Optionally the forwarding rule generated by the generating unit may further include aging time so that the switch discards the data packet when receiving the data packet again within the aging time and a sending unit configured to send the forwarding rule of the data packet generated by the generating unit to the switch so that when receiving the data packet again the switch discards the data packet according to the action attribute of the forwarding rule.

Optionally the memory may further include a setting unit not shown in configured to set the action attribute of the data packet received by the receiving unit to broadcast and the sending unit is further configured to send to the switch the data packet of which action attribute is set to broadcast by the setting unit so that the switch broadcasts the data packet according to the action attribute of the data packet.

It can be seen from the foregoing embodiment that a controller receives a data packet that is reported by a switch and does not match a forwarding rule and after determining that the data packet is a broadcast data packet the controller generates a forwarding rule for the data packet and sends the forwarding rule to the switch where the forwarding rule includes an action attribute being discard. Because the switch is located on a fully connected network when the switch receives the data packet again the switch can match the forwarding rule of the data packet and discard the data packet according to the action attribute of the forwarding rule of the data packet thereby preventing the switch from broadcasting the data packet repeatedly and avoiding occurrence of a broadcast storm. In addition in the present invention a broadcast storm on a network can be avoided without shielding a port of a switch. Therefore for a fully connected network a forwarding capability of a port and a quantity of available transmission links on the network are ensured and a utilization rate of the transmission links on the network is increased accordingly.

Referring to is a block diagram of an embodiment of a system for processing a data packet according to the present invention.

The system includes a controller shown in the foregoing embodiments and a plurality of switches connected to the controller where the plurality of switches form a ring network and any one switch of the plurality of switches is a first switch . For convenience in giving a demonstration shows only three switches and one switch among the three switches is set to the first switch described in this embodiment.

The first switch is configured to receive a forwarding rule of a data packet sent by the controller where the forwarding rule of the data packet includes an action attribute being discard and is further configured to discard the data packet according to the action attribute of the forwarding rule of the data packet after receiving the data packet again.

For specific descriptions of the controller in the foregoing embodiment reference may be made to the embodiments shown in the foregoing and which is not further described herein.

It can be seen from the foregoing embodiment that when a switch receives a data packet and does not match a forwarding rule of the data packet the switch reports the data packet to a controller and after determining that the data packet is a broadcast data packet the controller generates a forwarding rule for the data packet and sends the forwarding rule to the switch where the forwarding rule includes an action attribute being discarded. Because the switch is located on a fully connected network when the switch receives the data packet again the switch can match the forwarding rule of the data packet and discard the data packet according to the action attribute of the forwarding rule of the data packet thereby preventing the switch from broadcasting the data packet repeatedly and avoiding occurrence of a broadcast storm. In addition in the present invention a broadcast storm on a network can be avoided without shielding a port of a switch. Therefore for a fully connected network a forwarding capability of a port and a quantity of available transmission links on the network are ensured and a utilization rate of the transmission links on the network is increased accordingly.

A person skilled in the art may clearly understand that technologies in the embodiments of the present invention may be implemented by software in addition to a necessary universal hardware platform. Based on such an understanding the technical solutions of the present invention essentially or the part contributing to the prior art may be implemented in a form of a software product. The software product is stored in a readable storage medium such as a read only memory ROM random access memory RAM a disk or an optical disc and includes several instructions for instructing a computer device which may be a personal computer a server or a network device to perform the methods described in the embodiments of the present invention.

In each embodiment of the specification description is provided by using a progressive way. Identical and similar parts in each embodiment may refer to each other and each embodiment focuses on parts different from other embodiments. In particular since the system embodiments are basically similar to the method embodiments the descriptions of the system embodiments are relatively simple. For details about related contents reference may be made to the descriptions of the method embodiments.

The foregoing embodiments of the present invention are not intended to limit the protection scope of the present invention. Any modification equivalent replacement and improvement made without departing from the spirit and principle of the present invention shall fall within the protection scope of the present invention.

