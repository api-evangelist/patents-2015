---

title: Dynamic suggested search queries on online social networks
abstract: In one embodiment, a method includes accessing a prior structured query previously selected by a first user of an online social network, where the prior structured query corresponds to a first set of search results and comprises references to one or more objects associated with the online social network, identifying changes to the first set of search results corresponding to the prior structured query, and sending, to a client system of the first user, one or more suggested structured queries for display to the first user, where at least one of the suggested structured queries is a dynamic query comprising at least a portion of the prior structured query and a reference to the identified changes to the first set of search results corresponding to the prior structured query.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09589011&OS=09589011&RS=09589011
owner: Facebook, Inc.
number: 09589011
owner_city: Menlo Park
owner_country: US
publication_date: 20150720
---
This application is a continuation under 35 U.S.C. 120 of U.S. patent application Ser. No. 14 052 585 filed 11 Oct. 2013 which is a continuation in part under 35 U.S.C. 120 of U.S. patent application Ser. No. 13 732 175 filed 31 Dec. 2012 which is a continuation in part under 35 U.S.C. 120 of U.S. patent application Ser. No. 13 556 046 filed 23 Jul. 2012 which is a continuation in part under 35 U.S.C. 120 of U.S. patent application Ser. No. 12 763 162 filed 19 Apr. 2010 issued as U.S. Pat. No. 8 572 129 on 29 Oct. 2013 each of which is incorporated by reference.

This disclosure generally relates to social graphs and performing searches for objects within a social networking environment.

A social networking system which may include a social networking website may enable its users such as persons or organizations to interact with it and with each other through it. The social networking system may with input from a user create and store in the social networking system a user profile associated with the user. The user profile may include demographic information communication channel information and information on personal interests of the user. The social networking system may also with input from a user create and store a record of relationships of the user with other users of the social networking system as well as provide services e.g. wall posts photo sharing event organization messaging games or advertisements to facilitate social interaction between or among users.

The social networking system may send over one or more networks content or messages related to its services to a mobile or other computing device of a user. A user may also install software applications on a mobile or other computing device of the user for accessing a user profile of the user and other data within the social networking system. The social networking system may generate a personalized set of content objects to display to a user such as a newsfeed of aggregated stories of other users connected to the user.

Social graph analysis views social relationships in terms of network theory consisting of nodes and edges. Nodes represent the individual actors within the networks and edges represent the relationships between the actors. The resulting graph based structures are often very complex. There can be many types of nodes and many types of edges for connecting nodes. In its simplest form a social graph is a map of all of the relevant edges between all the nodes being studied.

In particular embodiments a social networking system may generate structured queries that include references to particular social graph elements. These structured queries may be generated for example in response to a text query provided by a user or generated as default queries. By providing suggested structured queries to a user s text query the social networking system may provide a powerful way for users of an online social network to search for elements represented in a social graph based on their social graph attributes and their relation to various social graph elements.

In particular embodiments the social networking system may generate a set of default structured queries for a page of the online social network. The social networking system may identify a page that a user is currently viewing or otherwise accessing and then identifying any social graph elements corresponding to that page. The social graph elements corresponding to a page may be for example the node corresponding to a user or concept profile page or the nodes edges referenced in a structured query used to generate a particular search results page. The social networking system may then generate a set of default structured queries for the page based on the identified social graph elements for that page. For example when accessing a user profile page for the user Mark some of the default structured queries for that page may include Friends of Mark or Photos of Mark . These default structured queries may then be sent and displayed to the user.

In particular embodiments the social networking system may generate suggested structured queries for a user based on user engagement factors. It may be desirable for the social networking system to provide users with structured queries that are more interesting to the user and thus more likely to be engaged with e.g. selected or clicked thru . A variety of factors may be used to increase user engagement such as for example business intelligence user preference history social graph affinity advertising sponsorship or other suitable factors may be used to determine which suggested queries to serve to the user. The social networking system may calculate which structured queries are more likely to be engaged with by a user and then send suggested queries to the user that the user is more likely to engage with.

In particular embodiments the social networking system may generate sponsored queries for a user. An advertiser may identify a company brand product event person or other thing that the advertiser is associated with or wants to sponsor. The social networking system may then identify social graph elements corresponding to the thing the advertiser wants to sponsor and generate one or more structured queries referencing the identified social graph elements. For example an advertiser associated with the application Online Poker may want to sponsor queries referencing the application. In response to receiving an indication the advertiser wants to sponsor queries referencing Online Poker the social networking system may identify a node in a social graph corresponding to the Online Poker application. One or more sponsored queries referencing the identified social graph element may then be generated. For example the social networking system may generate a sponsored query My friends who play Online Poker where the reference to Online Poker is a reference to the social graph entity corresponding to the application Online Poker. These sponsored queries may then be sent to the querying user and displayed on a page accessed by the user.

In particular embodiments the social networking system may generate dynamic queries for a user. A dynamic query is a type of structured query that references additions changes or other updates to objects associated with the online social network. Dynamic queries may relate to trending activity or trending queries by other users on the online social network such as for example Posts by my friends about news story from yesterday or Photos of my friend in location where the querying user just visited . Dynamic queries may also be related to recent timely content. For example the structured query Recent photos of my friends 2 is a dynamic query referencing recently added content to the online social network where the reference to 2 indicates the number of new photos that the query will produce. Similarly the dynamic queries may relate to changes to search results either over time or since the query was last run. Dynamic queries may provide an elegant way for users of the online social network to see that particular updates have occurred or are occurring on the online social network.

In particular embodiments the social networking system may allow users to share structured queries and search results with other users of the online social network. Users of the online social network may want to share structured queries and their corresponding search results with other users of the online social network allowing those users to view the query and or search results. The social networking system may receive a selection from a first user of a structured query that the first user wants to share with one or more second users of the online social network. Structured queries and search results may be shared with any suitable users of the online social network such as for example users within a threshold degree of separation of the first user particular groups or networks or publically. The social networking system may then send the selected structured query to one or more second users. For example a first user may select a particular structured query such as My friends who work at Facebook . The social networking system may then generate search results corresponding to that structured query. The search results page may include an activatable link allowing the first user to share the structured query and or search results directly from the search results page such as a Share this search with your friends link. The first user may select this link and in response the social networking system may share the structured query and one or more of the search results by displaying them a page of a second user such as the second user s newsfeed page. The second user may then select the shared query which may then be executed by the social networking system for the second user.

In particular embodiments the social networking system may generate structured queries that are displayed with previews of the search results corresponding to the queries. When a structured query is generated the social networking system may also generate search results corresponding to one or more of the structured queries. The search results may be generated concurrently with the structured queries or in response to a selection e.g. mousing over of one of the structured queries by the querying user. The structured queries and search results could then be sent to the querying user for display where one or more of the queries could be displayed with a preview of the search results corresponding to the query. The preview could be displayed in any suitable manner. For example the querying user may mouse over a structured query and a preview for that structured query may be generated and displayed just below the query where the preview may show the names and thumbnail photos of some of the matching search results. Previews of search results may be displayed in association with any suitable type of search query. Furthermore if a structured query is shared with other users the shared structured query may be displayed with a preview of the search results. By generating previews to display with structured queries the social networking system may provide an a quick and convenient way for users of the online social network to review search results for a particular query.

The embodiments disclosed above are only examples and the scope of this disclosure is not limited to them. Particular embodiments may include all some or none of the components elements features functions operations or steps of the embodiments disclosed above.

This disclosure contemplates any suitable network . As an example and not by way of limitation one or more portions of network may include an ad hoc network an intranet an extranet a virtual private network VPN a local area network LAN a wireless LAN WLAN a wide area network WAN a wireless WAN WWAN a metropolitan area network MAN a portion of the Internet a portion of the Public Switched Telephone Network PSTN a cellular telephone network or a combination of two or more of these. Network may include one or more networks .

Links may connect client system social networking system and third party system to communication network or to each other. This disclosure contemplates any suitable links . In particular embodiments one or more links include one or more wireline such as for example Digital Subscriber Line DSL or Data Over Cable Service Interface Specification DOCSIS wireless such as for example Wi Fi or Worldwide Interoperability for Microwave Access WiMAX or optical such as for example Synchronous Optical Network SONET or Synchronous Digital Hierarchy SDH links. In particular embodiments one or more links each include an ad hoc network an intranet an extranet a VPN a LAN a WLAN a WAN a WWAN a MAN a portion of the Internet a portion of the PSTN a cellular technology based network a satellite communications technology based network another link or a combination of two or more such links . Links need not necessarily be the same throughout network environment . One or more first links may differ in one or more respects from one or more second links .

In particular embodiments client system may be an electronic device including hardware software or embedded logic components or a combination of two or more such components and capable of carrying out the appropriate functionalities implemented or supported by client system . As an example and not by way of limitation a client system may include a computer system such as a desktop computer notebook or laptop computer netbook a tablet computer e book reader GPS device camera personal digital assistant PDA handheld electronic device cellular telephone smartphone other suitable electronic device or any suitable combination thereof. This disclosure contemplates any suitable client systems . A client system may enable a network user at client system to access network . A client system may enable its user to communicate with other users at other client systems .

In particular embodiments client system may include a web browser such as MICROSOFT INTERNET EXPLORER GOOGLE CHROME or MOZILLA FIREFOX and may have one or more add ons plug ins or other extensions such as TOOLBAR or YAHOO TOOLBAR. A user at client system may enter a Uniform Resource Locator URL or other address directing the web browser to a particular server such as server or a server associated with a third party system and the web browser may generate a Hyper Text Transfer Protocol HTTP request and communicate the HTTP request to server. The server may accept the HTTP request and communicate to client system one or more Hyper Text Markup Language HTML files responsive to the HTTP request. Client system may render a webpage based on the HTML files from the server for presentation to the user. This disclosure contemplates any suitable page files including webpages or pages presented as a user interface of a native application. As an example and not by way of limitation webpages may render from HTML files Extensible Hyper Text Markup Language XHTML files or Extensible Markup Language XML files according to particular needs. Such pages may also execute scripts such as for example and without limitation those written in JAVASCRIPT JAVA MICROSOFT SILVERLIGHT combinations of markup language and scripts such as AJAX Asynchronous JAVASCRIPT and XML and the like. Herein reference to a webpage encompasses one or more corresponding webpage files which a browser may use to render the webpage and vice versa where appropriate.

In particular embodiments social networking system may be a network addressable computing system that can host an online social network. Social networking system may generate store receive and send social networking data such as for example user profile data concept profile data social graph information or other suitable data related to the online social network. Social networking system may be accessed by the other components of network environment either directly or via network . In particular embodiments social networking system may include one or more servers . Each server may be a unitary server or a distributed server spanning multiple computers or multiple datacenters. Servers may be of various types such as for example and without limitation web server news server mail server message server advertising server file server application server exchange server database server proxy server another server suitable for performing functions or processes described herein or any combination thereof. In particular embodiments each server may include hardware software or embedded logic components or a combination of two or more such components for carrying out the appropriate functionalities implemented or supported by server . In particular embodiments social networking system may include one or more data stores . Data stores may be used to store various types of information. In particular embodiments the information stored in data stores may be organized according to specific data structures. In particular embodiments each data store may be a relational database. Particular embodiments may provide interfaces that enable a client system a social networking system or a third party system to manage retrieve modify add or delete the information stored in data store .

In particular embodiments social networking system may store one or more social graphs in one or more data stores . In particular embodiments a social graph may include multiple nodes which may include multiple user nodes each corresponding to a particular user or multiple concept nodes each corresponding to a particular concept and multiple edges connecting the nodes. Social networking system may provide users of the online social network the ability to communicate and interact with other users. In particular embodiments users may join the online social network via social networking system and then add connections i.e. relationships to a number of other users of social networking system whom they want to be connected to. Herein the term friend may refer to any other user of social networking system with whom a user has formed a connection association or relationship via social networking system .

In particular embodiments social networking system may provide users with the ability to take actions on various types of items or objects supported by social networking system . As an example and not by way of limitation the items and objects may include groups or social networks to which users of social networking system may belong events or calendar entries in which a user might be interested computer based applications that a user may use transactions that allow users to buy or sell items via the service interactions with advertisements that a user may perform or other suitable items or objects. A user may interact with anything that is capable of being represented in social networking system or by an external system of third party system which is separate from social networking system and coupled to social networking system via a network .

In particular embodiments social networking system may be capable of linking a variety of entities. As an example and not by way of limitation social networking system may enable users to interact with each other as well as receive content from third party systems or other entities or to allow users to interact with these entities through an application programming interfaces API or other communication channels.

In particular embodiments a third party system may include one or more types of servers one or more data stores one or more interfaces including but not limited to APIs one or more web services one or more content sources one or more networks or any other suitable components e.g. that servers may communicate with. A third party system may be operated by a different entity from an entity operating social networking system . In particular embodiments however social networking system and third party systems may operate in conjunction with each other to provide social networking services to users of social networking system or third party systems . In this sense social networking system may provide a platform or backbone which other systems such as third party systems may use to provide social networking services and functionality to users across the Internet.

In particular embodiments a third party system may include a third party content object provider. A third party content object provider may include one or more sources of content objects which may be communicated to a client system . As an example and not by way of limitation content objects may include information regarding things or activities of interest to the user such as for example movie show times movie reviews restaurant reviews restaurant menus product information and reviews or other suitable information. As another example and not by way of limitation content objects may include incentive content objects such as coupons discount tickets gift certificates or other suitable incentive objects.

In particular embodiments social networking system also includes user generated content objects which may enhance a user s interactions with social networking system . User generated content may include anything a user can add upload send or post to social networking system . As an example and not by way of limitation a user communicates posts to social networking system from a client system . Posts may include data such as status updates or other textual data location information photos videos links music or other similar data or media. Content may also be added to social networking system by a third party through a communication channel such as a newsfeed or stream.

In particular embodiments social networking system may include a variety of servers sub systems programs modules logs and data stores. In particular embodiments social networking system may include one or more of the following a web server action logger API request server relevance and ranking engine content object classifier notification controller action log third party content object exposure log inference module authorization privacy server search module ad targeting module user interface module user profile store connection store third party content store or location store. Social networking system may also include suitable components such as network interfaces security mechanisms load balancers failover servers management and network operations consoles other suitable components or any suitable combination thereof. In particular embodiments social networking system may include one or more user profile stores for storing user profiles. A user profile may include for example biographic information demographic information behavioral information social information or other types of descriptive information such as work experience educational history hobbies or preferences interests affinities or location. Interest information may include interests related to one or more categories. Categories may be general or specific. As an example and not by way of limitation if a user likes an article about a brand of shoes the category may be the brand or the general category of shoes or clothing. A connection store may be used for storing connection information about users. The connection information may indicate users who have similar or common work experience group memberships hobbies educational history or are in any way related or share common attributes. The connection information may also include user defined connections between different users and content both internal and external . A web server may be used for linking social networking system to one or more client systems or one or more third party system via network . The web server may include a mail server or other messaging functionality for receiving and routing messages between social networking system and one or more client systems . An API request server may allow a third party system to access information from social networking system by calling one or more APIs. An action logger may be used to receive communications from a web server about a user s actions on or off social networking system . In conjunction with the action log a third party content object log may be maintained of user exposures to third party content objects. A notification controller may provide information regarding content objects to a client system . Information may be pushed to a client system as notifications or information may be pulled from client system responsive to a request received from client system . Authorization servers may be used to enforce one or more privacy settings of the users of social networking system . A privacy setting of a user determines how particular information associated with a user can be shared. The authorization server may allow users to opt in or opt out of having their actions logged by social networking system or shared with other systems e.g. third party system such as for example by setting appropriate privacy settings. Third party content object stores may be used to store content objects received from third parties such as a third party system . Location stores may be used for storing location information received from client systems associated with users. Ad pricing modules may combine social information the current time location information or other suitable information to provide relevant advertisements in the form of notifications to a user.

In particular embodiments a user node may correspond to a user of social networking system . As an example and not by way of limitation a user may be an individual human user an entity e.g. an enterprise business or third party application or a group e.g. of individuals or entities that interacts or communicates with or over social networking system . In particular embodiments when a user registers for an account with social networking system social networking system may create a user node corresponding to the user and store the user node in one or more data stores. Users and user nodes described herein may where appropriate refer to registered users and user nodes associated with registered users. In addition or as an alternative users and user nodes described herein may where appropriate refer to users that have not registered with social networking system . In particular embodiments a user node may be associated with information provided by a user or information gathered by various systems including social networking system . As an example and not by way of limitation a user may provide his or her name profile picture contact information birth date sex marital status family status employment education background preferences interests or other demographic information. In particular embodiments a user node may be associated with one or more data objects corresponding to information associated with a user. In particular embodiments a user node may correspond to one or more pages.

In particular embodiments a concept node may correspond to a concept. As an example and not by way of limitation a concept may correspond to a place such as for example a movie theater restaurant landmark or city a website such as for example a website associated with social networking system or a third party website associated with a web application server an entity such as for example a person business group sports team or celebrity a resource such as for example an audio file video file digital photo text file structured document or application which may be located within social networking system or on an external server such as a web application server real or intellectual property such as for example a sculpture painting movie game song idea photograph or written work a game an activity an idea or theory another suitable concept or two or more such concepts. A concept node may be associated with information of a concept provided by a user or information gathered by various systems including social networking system . As an example and not by way of limitation information of a concept may include a name or a title one or more images e.g. an image of the cover page of a book a location e.g. an address or a geographical location a website which may be associated with a URL contact information e.g. a phone number or an email address other suitable concept information or any suitable combination of such information. In particular embodiments a concept node may be associated with one or more data objects corresponding to information associated with concept node . In particular embodiments a concept node may correspond to one or more pages.

In particular embodiments a node in social graph may represent or be represented by a page which may be referred to as a profile page . Profile pages may be hosted by or accessible to social networking system . Profile pages may also be hosted on third party websites associated with a third party server . As an example and not by way of limitation a profile page corresponding to a particular external webpage may be the particular external webpage and the profile page may correspond to a particular concept node . Profile pages may be viewable by all or a selected subset of other users. As an example and not by way of limitation a user node may have a corresponding user profile page in which the corresponding user may add content make declarations or otherwise express himself or herself. As another example and not by way of limitation a concept node may have a corresponding concept profile page in which one or more users may add content make declarations or express themselves particularly in relation to the concept corresponding to concept node .

In particular embodiments a concept node may represent a third party webpage or resource hosted by a third party system . The third party webpage or resource may include among other elements content a selectable or other icon or other inter actable object which may be implemented for example in JavaScript AJAX or PHP codes representing an action or activity. As an example and not by way of limitation a third party webpage may include a selectable icon such as like check in eat recommend or another suitable action or activity. A user viewing the third party webpage may perform an action by selecting one of the icons e.g. eat causing a client system to send to social networking system a message indicating the user s action. In response to the message social networking system may create an edge e.g. an eat edge between a user node corresponding to the user and a concept node corresponding to the third party webpage or resource and store edge in one or more data stores.

In particular embodiments a pair of nodes in social graph may be connected to each other by one or more edges . An edge connecting a pair of nodes may represent a relationship between the pair of nodes. In particular embodiments an edge may include or represent one or more data objects or attributes corresponding to the relationship between a pair of nodes. As an example and not by way of limitation a first user may indicate that a second user is a friend of the first user. In response to this indication social networking system may send a friend request to the second user. If the second user confirms the friend request social networking system may create an edge connecting the first user s user node to the second user s user node in social graph and store edge as social graph information in one or more of data stores . In the example of social graph includes an edge indicating a friend relation between user nodes of user A and user B and an edge indicating a friend relation between user nodes of user C and user B. Although this disclosure describes or illustrates particular edges with particular attributes connecting particular user nodes this disclosure contemplates any suitable edges with any suitable attributes connecting user nodes . As an example and not by way of limitation an edge may represent a friendship family relationship business or employment relationship fan relationship follower relationship visitor relationship subscriber relationship superior subordinate relationship reciprocal relationship non reciprocal relationship another suitable type of relationship or two or more such relationships. Moreover although this disclosure generally describes nodes as being connected this disclosure also describes users or concepts as being connected. Herein references to users or concepts being connected may where appropriate refer to the nodes corresponding to those users or concepts being connected in social graph by one or more edges .

In particular embodiments an edge between a user node and a concept node may represent a particular action or activity performed by a user associated with user node toward a concept associated with a concept node . As an example and not by way of limitation as illustrated in a user may like attended played listened cooked worked at or watched a concept each of which may correspond to a edge type or subtype. A concept profile page corresponding to a concept node may include for example a selectable check in icon such as for example a clickable check in icon or a selectable add to favorites icon. Similarly after a user clicks these icons social networking system may create a favorite edge or a check in edge in response to a user s action corresponding to a respective action. As another example and not by way of limitation a user user C may listen to a particular song Imagine using a particular application SPOTIFY which is an online music application . In this case social networking system may create a listened edge and a used edge as illustrated in between user nodes corresponding to the user and concept nodes corresponding to the song and application to indicate that the user listened to the song and used the application. Moreover social networking system may create a played edge as illustrated in between concept nodes corresponding to the song and the application to indicate that the particular song was played by the particular application. In this case played edge corresponds to an action performed by an external application SPOTIFY on an external audio file the song Imagine . Although this disclosure describes particular edges with particular attributes connecting user nodes and concept nodes this disclosure contemplates any suitable edges with any suitable attributes connecting user nodes and concept nodes . Moreover although this disclosure describes edges between a user node and a concept node representing a single relationship this disclosure contemplates edges between a user node and a concept node representing one or more relationships. As an example and not by way of limitation an edge may represent both that a user likes and has used at a particular concept. Alternatively another edge may represent each type of relationship or multiples of a single relationship between a user node and a concept node as illustrated in between user node for user E and concept node for SPOTIFY .

In particular embodiments social networking system may create an edge between a user node and a concept node in social graph . As an example and not by way of limitation a user viewing a concept profile page such as for example by using a web browser or a special purpose application hosted by the user s client system may indicate that he or she likes the concept represented by the concept node by clicking or selecting a Like icon which may cause the user s client system to send to social networking system a message indicating the user s liking of the concept associated with the concept profile page. In response to the message social networking system may create an edge between user node associated with the user and concept node as illustrated by like edge between the user and concept node . In particular embodiments social networking system may store an edge in one or more data stores. In particular embodiments an edge may be automatically formed by social networking system in response to a particular user action. As an example and not by way of limitation if a first user uploads a picture watches a movie or listens to a song an edge may be formed between user node corresponding to the first user and concept nodes corresponding to those concepts. Although this disclosure describes forming particular edges in particular manners this disclosure contemplates forming any suitable edges in any suitable manner.

In particular embodiments one or more client side and or backend server side processes may implement and utilize a typeahead feature that may automatically attempt to match social graph elements e.g. user nodes concept nodes or edges to information currently being entered by a user in an input form rendered in conjunction with a requested page such as for example a user profile page a concept profile page a search results page a user interface of a native application associated with the online social network or another suitable page of the online social network which may be hosted by or accessible in the social networking system . In particular embodiments as a user is entering text to make a declaration the typeahead feature may attempt to match the string of textual characters being entered in the declaration to strings of characters e.g. names descriptions corresponding to user concepts or edges and their corresponding elements in the social graph . In particular embodiments when a match is found the typeahead feature may automatically populate the form with a reference to the social graph element such as for example the node name type node ID edge name type edge ID or another suitable reference or identifier of the existing social graph element.

In particular embodiments as a user types or otherwise enters text into a form used to add content or make declarations in various sections of the user s profile page home page or other page the typeahead process may work in conjunction with one or more frontend client side and or backend server side typeahead processes hereinafter referred to simply as typeahead process executing at or within the social networking system e.g. within servers to interactively and virtually instantaneously as appearing to the user attempt to auto populate the form with a term or terms corresponding to names of existing social graph elements or terms associated with existing social graph elements determined to be the most relevant or best match to the characters of text entered by the user as the user enters the characters of text. Utilizing the social graph information in a social graph database or information extracted and indexed from the social graph database including information associated with nodes and edges the typeahead processes in conjunction with the information from the social graph database as well as potentially in conjunction with various others processes applications or databases located within or executing within social networking system may be able to predict a user s intended declaration with a high degree of precision. However the social networking system can also provides user s with the freedom to enter essentially any declaration they wish enabling users to express themselves freely.

In particular embodiments as a user enters text characters into a form box or other field the typeahead processes may attempt to identify existing social graph elements e.g. user nodes concept nodes or edges that match the string of characters entered in the user s declaration as the user is entering the characters. In particular embodiments as the user enters characters into a form box the typeahead process may read the string of entered textual characters. As each keystroke is made the frontend typeahead process may send the entered character string as a request or call to the backend typeahead process executing within social networking system . In particular embodiments the typeahead processes may communicate via AJAX Asynchronous JavaScript and XML or other suitable techniques and particularly asynchronous techniques. In particular embodiments the request may be or comprise an XMLHTTPRequest XHR enabling quick and dynamic sending and fetching of results. In particular embodiments the typeahead process may also send before after or with the request a section identifier section ID that identifies the particular section of the particular page in which the user is making the declaration. In particular embodiments a user ID parameter may also be sent but this may be unnecessary in some embodiments as the user may already be known based on the user having logged into or otherwise been authenticated by the social networking system .

In particular embodiments the typeahead process may use one or more matching algorithms to attempt to identify matching social graph elements. In particular embodiments when a match or matches are found the typeahead process may send a response which may utilize AJAX or other suitable techniques to the user s client system that may include for example the names name strings or descriptions of the matching social graph elements as well as potentially other metadata associated with the matching social graph elements. As an example and not by way of limitation if a user entering the characters pok into a query field the typeahead process may display a drop down menu that displays names of matching existing profile pages and respective user nodes or concept nodes such as a profile page named or devoted to poker or pokemon which the user can then click on or otherwise select thereby confirming the desire to declare the matched user or concept name corresponding to the selected node. As another example and not by way of limitation upon clicking poker the typeahead process may auto populate or causes the web browser to auto populate the query field with the declaration poker . In particular embodiments the typeahead process may simply auto populate the field with the name or other identifier of the top ranked match rather than display a drop down menu. The user may then confirm the auto populated declaration simply by keying enter on his or her keyboard or by clicking on the auto populated declaration.

More information on typeahead processes may be found in U.S. patent application Ser. No. 12 763 162 filed 19 Apr. 2010 and U.S. patent application Ser. No. 13 556 072 filed 23 Jul. 2012 which are incorporated by reference.

In particular embodiments the typeahead processes described herein may be applied to search queries entered by a user. As an example and not by way of limitation as a user enters text characters into a query field a typeahead process may attempt to identify one or more user nodes concept nodes or edges that match the string of characters entered into query field as the user is entering the characters. As the typeahead process receives requests or calls including a string or n gram from the text query the typeahead process may perform or causes to be performed a search to identify existing social graph elements i.e. user nodes concept nodes edges having respective names types categories or other identifiers matching the entered text. The typeahead process may use one or more matching algorithms to attempt to identify matching nodes or edges. When a match or matches are found the typeahead process may send a response to the user s client system that may include for example the names name strings of the matching nodes as well as potentially other metadata associated with the matching nodes. The typeahead process may then display a drop down menu that displays names of matching existing profile pages and respective user nodes or concept nodes and displays names of matching edges that may connect to the matching user nodes or concept nodes which the user can then click on or otherwise select thereby confirming the desire to search for the matched user or concept name corresponding to the selected node or to search for users or concepts connected to the matched users or concepts by the matching edges. Alternatively the typeahead process may simply auto populate the form with the name or other identifier of the top ranked match rather than display a drop down menu . The user may then confirm the auto populated declaration simply by keying enter on a keyboard or by clicking on the auto populated declaration. Upon user confirmation of the matching nodes and edges the typeahead process may send a request that informs the social networking system of the user s confirmation of a query containing the matching social graph elements. In response to the request sent the social networking system may automatically or alternately based on an instruction in the request call or otherwise search a social graph database for the matching social graph elements or for social graph elements connected to the matching social graph elements as appropriate. Although this disclosure describes applying the typeahead processes to search queries in a particular manner this disclosure contemplates applying the typeahead processes to search queries in any suitable manner.

In connection with search queries and search results particular embodiments may utilize one or more systems components elements functions methods operations or steps disclosed in U.S. patent application Ser. No. 11 503 093 filed 11 Aug. 2006 U.S. patent application Ser. No. 12 977 027 filed 22 Dec. 2010 and U.S. patent application Ser. No. 12 978 265 filed 23 Dec. 2010 which are incorporated by reference.

In particular embodiments the social networking system may receive from a querying first user corresponding to a first user node an unstructured text query. As an example and not by way of limitation a first user may want to search for other users who 1 are first degree friends of the first user and 2 are associated with Stanford University i.e. the user nodes are connected by an edge to the concept node corresponding to the school Stanford . The first user may then enter a text query friends stanford into query field as illustrated in . As the querying user enters this text query into query field the social networking system may provide various suggested structured queries as illustrated in drop down menus . As used herein an unstructured text query refers to a simple text string inputted by a user. The text query may of course be structured with respect to standard language grammar rules e.g. English language grammar . However the text query will ordinarily be unstructured with respect to social graph elements. In other words a simple text query will not ordinarily include embedded references to particular social graph elements. Thus as used herein a structured query refers to a query that contains references to particular social graph elements allowing the search engine to search based on the identified elements. Furthermore the text query may be unstructured with respect to formal query syntax. In other words a simple text query will not necessarily be in the format of a query command that is directly executable by a search engine e.g. the text query friends stanford could be parsed to form the query command intersect school Stanford University friends me or search me friends node ID for Stanford University students ever past intersect which could be executed as a query in a social graph database . Although this disclosure describes receiving particular queries in a particular manner this disclosure contemplates receiving any suitable queries in any suitable manner.

In particular embodiments social networking system may parse the unstructured text query also simply referred to as a search query received from the first user i.e. the querying user to identify one or more n grams. In general an n gram is a contiguous sequence of n items from a given sequence of text or speech. The items may be characters phonemes syllables letters words base pairs prefixes or other identifiable items from the sequence of text or speech. The n gram may comprise one or more characters of text letters numbers punctuation etc. entered by the querying user. An n gram of size one can be referred to as a unigram of size two can be referred to as a bigram or digram of size three can be referred to as a trigram and so on. Each n gram may include one or more parts from the text query received from the querying user. In particular embodiments each n gram may comprise a character string e.g. one or more characters of text entered by the first user. As an example and not by way of limitation the social networking system may parse the text query friends stanford to identify the following n grams friends stanford friends stanford. As another example and not by way of limitation the social networking system may parse the text query friends in palo alto to identify the following n grams friends in palo alto friends in in palo palo alto friend in palo in palo also friends in palo alto. In particular embodiments each n gram may comprise a contiguous sequence of n items from the text query. Although this disclosure describes parsing particular queries in a particular manner this disclosure contemplates parsing any suitable queries in any suitable manner.

In particular embodiments social networking system may identify a plurality of nodes or a plurality of edges corresponding to one or more of the n grams of a text query. Identifying social graph elements that correspond to an n gram may be done in a variety of manners such as for example by determining or calculating for each n gram identified in the text query a score that the n gram corresponds to a social graph element. The score may be for example a confidence score a probability a quality a ranking another suitable type of score or any combination thereof. As an example and not by way of limitation the social networking system may determine a probability score also referred to simply as a probability that the n gram corresponds to a social graph element such as a user node a concept node or an edge of social graph . The probability score may indicate the level of similarity or relevance between the n gram and a particular social graph element. There may be many different ways to calculate the probability. The present disclosure contemplates any suitable method to calculate a probability score for an n gram identified in a search query. In particular embodiments the social networking system may determine a probability p that an n gram corresponds to a particular social graph element. The probability p may be calculated as the probability of corresponding to a particular social graph element k given a particular search query X. In other words the probability may be calculated as p k X . As an example and not by way of limitation a probability that an n gram corresponds to a social graph element may calculated as an probability score denoted as p. The input may be a text query X x x . . . x and a set of classes. For each i j and a class k the social networking system may compute p p class x k X . As an example and not by way of limitation the n gram stanford could be scored with respect to the following social graph elements as follows school Stanford University 0.7 location Stanford Calif. 0.2 user Allen Stanford 0.1. In this example because the n gram stanford corresponds to multiple social graph elements it may be considered an ambiguous n gram by the social networking system . In other words the n gram is not immediately resolvable to a single social graph element based on the parsing algorithm used by the social networking system . In particular embodiments after identifying an ambiguous n gram the social networking system may highlight that n gram in the text query to indicate that it may correspond to multiple social graph elements. As an example and not by way of limitation as illustrated in the term Stanford in query field has been highlighted with a dashed underline to indicate that it may correspond to multiple social graph elements as discussed previously. Although this disclosure describes determining whether n grams correspond to social graph elements in a particular manner this disclosure contemplates determining whether n grams correspond to social graph elements in any suitable manner. Moreover although this disclosure describes determining whether an n gram corresponds to a social graph element using a particular type of score this disclosure contemplates determining whether an n gram corresponds to a social graph element using any suitable type of score.

More information on element detection and parsing queries may be found in U.S. patent application Ser. No. 13 556 072 filed 23 Jul. 2012 U.S. patent application Ser. No. 13 731 866 filed 31 Dec. 2012 and U.S. patent application Ser. No. 13 732 101 filed 31 Dec. 2012 each of which is incorporated by reference.

In particular embodiments the social networking system may access a context free grammar model comprising a plurality of grammars. Each grammar of the grammar model may comprise one or more non terminal tokens or non terminal symbols and one or more terminal tokens or terminal symbols query tokens where particular non terminal tokens may be replaced by terminal tokens. A grammar model is a set of formation rules for strings in a formal language. Although this disclosure describes accessing particular grammars this disclosure contemplates any suitable grammars.

In particular embodiments the social networking system may generate one or more strings using one or more grammars. To generate a string in the language one begins with a string consisting of only a single start symbol. The production rules are then applied in any order until a string that contains neither the start symbol nor designated non terminal symbols is produced. In a context free grammar the production of each non terminal symbol of the grammar is independent of what is produced by other non terminal symbols of the grammar. The non terminal symbols may be replaced with terminal symbols i.e. terminal tokens or query tokens . Some of the query tokens may correspond to identified nodes or identified edges as described previously. A string generated by the grammar may then be used as the basis for a structured query containing references to the identified nodes or identified edges. The string generated by the grammar may be rendered in a natural language syntax such that a structured query based on the string is also rendered in natural language. A context free grammar is a grammar in which the left hand side of each production rule consists of only a single non terminal symbol. A probabilistic context free grammar is a tuple where the disjoint sets and N specify the terminal and non terminal symbols respectively with S N being the start symbol. P is the set of productions which take the form E p with E N N and p Pr E the probability that E will be expanded into the string . The sum of probabilities p over all expansions of a given non terminal E must be one. Although this disclosure describes generating strings in a particular manner this disclosure contemplates generating strings in any suitable manner.

In particular embodiments the social networking system may generate one or more structured queries. The structured queries may be based on the natural language strings generated by one or more grammars as described previously. Each structured query may include references to one or more of the identified nodes or one or more of the identified edges . This type of structured query may allow the social networking system to more efficiently search for resources and content related to the online social network such as for example profile pages by searching for content connected to or otherwise related to the identified user nodes and the identified edges . As an example and not by way of limitation in response to the text query show me friends of my girlfriend the social networking system may generate a structured query Friends of Stephanie where Friends and Stephanie in the structured query are references corresponding to particular social graph elements. The reference to Stephanie would correspond to a particular user node where the social networking system has parsed the n gram my girlfriend to correspond with a user node for the user Stephanie while the reference to Friends would correspond to friend type edges connecting that user node to other user nodes i.e. edges connecting to Stephanie s first degree friends . When executing this structured query the social networking system may identify one or more user nodes connected by friend type edges to the user node corresponding to Stephanie . As another example and not by way of limitation as illustrated in in response to the text query friends who work at facebook the social networking system may generate a structured query My friends who work at Facebook where my friends work at and Facebook in the structured query are references corresponding to particular social graph elements as described previously i.e. a friend type edge a work at type edge and concept node corresponding to the company Facebook . These structured queries may be pre generated and accessed from a cache or generated dynamically in response to input from the user. Although this disclosure describes generating particular structured queries in a particular manner this disclosure contemplates generating any suitable structured queries in any suitable manner.

In particular embodiments social networking system may score the generated structured queries. The score may be for example a confidence score a probability a quality a ranking another suitable type of score or any combination thereof. The structured queries may be scored based on a variety of factors such as for example the page or type of page the user is accessing user engagement factors business intelligence data the click thru rate of particular queries the conversion rate of particular queries user preferences of the querying user the search history of the user advertising sponsorship of particular queries the querying user s social graph affinity for social graph elements referenced in particular queries the intent of the user the general or current popularity of particular queries the usefulness of particular queries the geographic location of the user other suitable factors or any combination thereof. Although this disclosure describes ranking structured queries in a particular manner this disclosure contemplates ranking structured queries in any suitable manner.

In particular embodiments social networking system may send one or more of the structured queries to the querying user. As an example and not by way of limitation after the structured queries are generated the social networking system may send one or more of the structured queries as a response which may utilize AJAX or other suitable techniques to the user s client system that may include for example the names name strings of the referenced social graph elements other query limitations e.g. Boolean operators etc. as well as potentially other metadata associated with the referenced social graph elements. The web browser on the querying user s client system may display the sent structured queries in a drop down menu as illustrated in . In particular embodiments the sent queries may be presented to the querying user in a ranked order such as for example based on a rank previously determined as described above. Structured queries with better rankings may be presented in a more prominent position. Furthermore in particular embodiments only structured queries above a threshold rank may be sent or displayed to the querying user. As an example and not by way of limitation as illustrated in the structured queries may be presented to the querying user in a drop down menu where higher ranked structured queries may be presented at the top of the menu with lower ranked structured queries presented in descending order down the menu. In the examples illustrated in only the seven highest ranked queries are sent and displayed to the user. In particular embodiments one or more references in a structured query may be highlighted e.g. outlined underlined circled bolded italicized colored lighted offset in caps in order to indicate its correspondence to a particular social graph element. As an example and not by way of limitation as illustrated in the references to Stanford University and Stanford Calif. are highlighted outlined in the structured queries to indicate that it corresponds to a particular concept node . Similarly the references to Friends like work at and go to in the structured queries presented in drop down menu could also be highlighted to indicate that they correspond to particular edges . Although this disclosure describes sending particular structured queries in a particular manner this disclosure contemplates sending any suitable structured queries in any suitable manner.

In particular embodiments social networking system may receive from the querying user a selection of one of the structured queries. The nodes and edges referenced in the received structured query may be referred to as the selected nodes and selected edges respectively. As an example and not by way of limitation the web browser on the querying user s client system may display the sent structured queries in a drop down menu as illustrated in which the user may then click on or otherwise select e.g. by touching the query on a touchscreen or keying enter on his keyboard to indicate the particular structured query the user wants the social networking system to execute. Although this disclosure describes receiving selections of particular structured queries in a particular manner this disclosure contemplates receiving selections of any suitable structured queries in any suitable manner.

More information on structured search queries and grammar models may be found in U.S. patent application Ser. No. 13 556 072 filed 23 Jul. 2012 U.S. patent application Ser. No. 13 674 695 filed 12 Nov. 2012 and U.S. patent application Ser. No. 13 731 866 filed 31 Dec. 2012 each of which is incorporated by reference.

In particular embodiments the social networking system may identify a node of the social graph corresponding to a page currently accessed by a user. A user may access any suitable page such as for example a user profile page a concept profile page a search results page a homepage a newsfeed page a notifications page an email or messages page a user interface of a native application associated with the online social network or another suitable page of the online social network. Particular pages of the online social network may correspond to particular social graph elements. In particular embodiments the user may currently be accessing a profile page of the online social network corresponding to a particular user node or concept node . Each user of the online social network may have a user profile page that corresponds to a user node of the user. As an example and not by way of limitation referencing which illustrate a user profile page for the user Mark this page may correspond to a user node of the user Mark . Similarly each concept represented in the online social network may have a concept profile page that corresponds to a concept node representing that concept. As an example and not by way of limitation referencing which illustrate a concept profile page for the politician Barack Obama this page may correspond to a concept node representing the politician Barack Obama note of course that Barack Obama may also have a personal user profile page . In particular embodiments the user may currently be accessing a search results page corresponding to a structured query. The structured query may comprise references to one or more nodes and one or more edges and the search results page may have been generated in response to this structured query. In this case one or more of the nodes referenced in the structured query may be identified by the social networking system as being the nodes corresponding to the page. Although this disclosure describes identifying particular nodes corresponding to particular pages in a particular manner this disclosure contemplates identifying any suitable nodes corresponding to any suitable pages in any suitable manner.

In particular embodiments the social networking system may generate one or more structured queries that each comprise a reference to the identified node s of the page currently accessed by a user. These generated structured queries may be considered the default structured queries for the page. Each of these structured queries may also comprise references to one or more edges that are connected to the identified node. These default structured queries are effectively based on and reference the page currently being accessed by the user. Where the title bar and the query field field are unified fields as described previously the social networking system may essentially use the title of the page which itself may be considered a reference to one or more social graph elements as a template query upon which query modifications are added to generate the default structured queries. As an example and not by way of limitation referencing the title of the page is Barack Obama where this title is unified with the query field such that a user may interact with the title to immediately bring up a drop down menu with a set of default queries for the page that reference the page the user is interacting with i.e. the suggested default queries contain references to the concept node associated with the concept Barack Obama . In particular embodiments if the user is accessing a search results page then the default structured queries generated by the social networking system may comprises references to the social graph elements referenced in the structured query used to generate that search results page. In other words if a structured query comprising references to one or more nodes and one or more edges is used to generate a particular search results page then the default structured queries generated for that page will also include at least references to the one or more nodes and one or more edges of the original structured query. Thus the structured query used to generate a particular search results page may be used as the base upon which expansions of that initial query may be suggested as default queries. Although this disclosure describes generating particular default structured queries in a particular manner this disclosure contemplates any suitable default structured queries in any suitable manner. Moreover although this disclosure describes generating default structured queries for particular types of pages this disclosure contemplates generating default structured queries for any suitable types of pages.

In particular embodiments the social networking system may send one or more of the default structured queries to the querying user for display on the page currently accessed by the user. These structured queries may be sent and displayed as previously described. As an example and not by way of limitation the web browser on the querying user s client system may display the sent structured queries in a drop down menu in association with a query field of a page as illustrated in . The default structured queries generated for a particular page may not be displayed until the user interacts with the query field such as for example by mousing over or clicking on the query field which may cause the structured queries to be sent and displayed in drop down menu . The structured queries displayed in drop down menu may enable the user accessing the page to selected one of the structured queries indicating that the selected structured query should be executed by the social networking system . Although this disclosure describes sending particular default structured queries in a particular manner this disclosure contemplates sending any suitable default structured queries in any suitable manner.

In particular embodiments the social networking system may generate one or more default structured queries in response to a user accessing a page that does not correspond to a particular social graph element. A user may access a page of the online social network that does not necessarily correspond to any particular social graph element such as for example a newsfeed page which may not necessarily correspond to any particular nodes or edges of the social graph . In this case the page may be considered to be in a null state with respect to identifying social graph elements that correspond to the page. Similarly for a page that does correspond to one or more social graph elements the user accessing that page may place the query field of the page into a null state by for example clearing or deleting any title or query that that had previously occupied the field. For a null state page or a query field in a null state the social networking system may generate a set of default structured queries for the page based on a variety of factors such as for example the page or type of page the user is accessing user engagement factors business intelligence data the click thru rate of particular queries the conversion rate of particular queries user preferences of the querying user the search history of the user advertising sponsorship of particular queries the querying user s social graph affinity for social graph elements referenced in particular queries the intent of the user the general or current popularity of particular queries the usefulness of particular queries the geographic location of the querying user other suitable factors or any combination thereof. In particular embodiments when the user is accessing a page that does not correspond to a particular social graph element the social networking system may access a set of default structured queries corresponding to the page. Each of these default structured queries may comprise references to one or more edges or edge types or one or more nodes or node types . As an example and not by way of limitation illustrates a newsfeed page being accessed by a user of the online social network. Some of the default structured queries for this page may include Friends of . . . or People who like . . . as illustrated in drop down menu where these structured queries included references to friend type edges and like type edges respectively. In the example illustrated in the default structured queries contain ellipses to indicate that the user may input text into the query field to complete the query. As another example and not by way of limitation for the same newsfeed page illustrated in the social networking system may generate default structured queries that include My friends Photos of my friends Photos I like or Apps my friends use where these structured queries include reference to both edges and nodes e.g. for the structured query My friends the term My is a reference to the user node of the querying user and the term friends is a reference to friend type edges connected to that node . Although this disclosure describes generating default structured queries for a page that does not correspond to particular social graph elements in a particular manner this disclosure contemplates generating default structured queries for a page that does not correspond to particular social graph elements in any suitable manner.

In particular embodiments the social networking system may calculate a score for each structured query based on one or more user engagement factors. A user engagement factor provides a metric for measuring the engagement of a user of the online social network such as for example by engaging with other users concepts content etc. The score may be for example a confidence score a probability a quality a ranking another suitable type of score or any combination thereof. As an example and not by way of limitation the score for each structured query may represent a probability that the first user will engage with the structured query. As another example and not by way of limitation the score may represent estimate of the degree and depth of user interaction with particular objects against a clearly defined set of goals. Scoring based on user engagement factors may be based on a variety of factors such as for example the page or type of page the user is accessing business intelligence data the click thru rate of particular queries the conversion rate of particular queries user preferences of the querying user the search history of the user advertising sponsorship of particular queries the querying user s social graph affinity for social graph elements referenced in particular queries the intent of the user the geographic location of the user the general or current popularity of particular queries the usefulness of particular queries other suitable factors or any combination thereof. Although this disclosure describes scoring particular structured queries in a particular manner this disclosure contemplates scoring structured queries in any suitable manner.

In particular embodiments social networking system may calculate the score for a structured query based at least in part on business intelligence data. In this context business intelligence data refers to data gathered by social networking system that helps predict or identify queries that users are more likely to engage with or queries that promote one or more business goals. The business intelligence data may be data related particular to the querying user or related to other users of the online social network. As an example and not by way of limitation social networking system may use business intelligence data relating to the querying user to identify queries or query types that the first user is more likely to engage with. As another example and not by way of limitation social networking system may use business intelligence data relating to one or more other users of the online social network e.g. users within a threshold degree of separation users within particular groups or networks or all users of the online social network to identify queries or query types that those users have or are likely to engage with and infer the likelihood of the querying user to engage with such queries.

In particular embodiments social networking system may calculate the score for a structured query based at least in part on a click thru rate for the structured query. Queries or query types with higher click thru rates are more likely to be selected or otherwise engaged with by the querying user. The click thru rate may be for queries or query types with respect to the querying user or other users of the online social network. As an example and not by way of limitation social networking system may identify the click thru rate for particular structured queries or query types and calculate higher scores for queries or query types that have higher click thru rates with respect to the querying user or other users.

In particular embodiments social networking system may calculate the score for a structured query based at least in part on a conversion rate for the structured query. Queries or query types with higher conversion rates are more likely to be further engaged with e.g. the search results are more likely to be interacted with sponsored results more likely to be clicked and purchases made etc. after selection by the querying user. The conversion rate may be for queries or query types with respect to the querying user or other users of the online social network. As an example and not by way of limitation social networking system may identify the conversion rate for particular structured queries or query types and calculate higher scores for queries or query types that have higher conversion rates with respect to the querying user or other users.

In particular embodiments social networking system may calculate the score for a structured query based at least in part on a user preference of the querying user. The user preferences could be specified by the querying user other users e.g. parents or employers of the querying user system administrators third party systems or otherwise determined by social networking system . The user preferences may specify for example queries or query types the user is interested and not interested in receiving. As an example and not by way of limitation social networking system may identify queries or query types preferred by the querying user as specified by the user preference of the user and calculate higher scores for queries or query types that are specified as being preferred by the user similarly queries or query types specified as being not preferred may be scored lower or completely excluded assigned null scores .

In particular embodiments social networking system may calculate the score for a structured query based at least in part on a search history users of the online social network. Structured queries that reference social graph elements or types of elements that the querying user has previously accessed or been accessed by other users that are relevant to the querying user such as his friends or are relevant to the social graph elements the querying user has previously accessed may be more likely to of interest to the querying user. Thus these structured queries may be scored more highly. As an example and not by way of limitation if querying user has previously visited the Stanford University profile page but has never visited the Stanford Calif. profile page when determining the score for structured queries referencing these concepts the social networking system may determine that the structured query referencing the concept node for Stanford University has a relatively high score because the querying user has previously accessed the concept node for the school. As another example and not by way of limitation if the querying user has previously selected queries of particular query types and not selected other types of queries then when scoring structured queries of particular types social networking system may score query types previously selected by the querying user higher than other query types.

In particular embodiments social networking system may calculate the score for a structured query based at least in part on whether the structured query is a sponsored query. An advertiser such as for example the user or administrator of a particular profile page corresponding to a particular node may sponsor a particular node such that a structured query referencing that node may be scored more highly. Sponsored queries are discussed in more detail below.

In particular embodiments social networking system may calculate the score for a structured query based at least in part on a social graph affinity of the user node corresponding to the querying user with respect to one or more of the nodes referenced in the structured query. Structured queries that reference nodes having relatively high social graph affinity e.g. a high affinity coefficient with respect to the querying user may be more likely to of interest to the querying user. Thus these structured queries may be scored more highly. As an example and not by way of limitation social networking system may score a structured query may be based on the degree of separation which may be one measure of affinity between the user node of the querying user and the particular social graph elements referenced in the structured query. Structured queries that reference social graph elements that are closer in the social graph to the querying user i.e. fewer degrees of separation between the element and the querying user s user node may be scored more highly than structured queries that reference social graph elements that are further from the user i.e. more degrees of separation .

In particular embodiments social networking system may calculate the score for a structured query based at least in part on an intent of the querying user. In order to improve the likelihood a user will engage with a suggested query the intent of the user may first be determined and then suggested queries related to that intent may be generated and sent to the user. The determined intent s may correspond to particular queries or query types and queries matching the determined intent of the user may be scored more highly. The social networking system may determine the intent of the user based on a variety of factors such as for example the time of day the proximity of the user to other users or objects social graph information social graph affinity the search history of the user feedback from the user the geographic location of the user other relevant information about the user or any combination thereof. More information on determining the intent of a querying user may be found in U.S. patent application Ser. No. 13 776 469 filed 25 Feb. 2013 which is incorporated by reference.

In particular embodiments social networking system may generate one or more recommendation queries. In contrast to a suggested search query that searches for particular objects associated with the online social network based on particular search criteria as described previously a recommendation query is a query for things that might be interesting for the user to look at or discover. As an example and not by way of limitation social networking system may generate a recommendation query such as Books I should read Movies I should watch Photos you might like or People you might know which can be sent to the querying user. In particular embodiments the search results for a recommendation query could be generated by identifying content that may be of interest to the querying user e.g. content liked or accessed by the user s friends and subtracting out content that has already been discovered or looked at by the querying user e.g. content the querying user has already liked or accessed and then generating search results with the remainder. As an example and not by way of limitation social networking system may receive from the first user a selection of one of the recommendation queries. For example the querying user may select the recommendation query Books I should read. In response social networking system may then generate one or more search results corresponding to the selected recommendation query. Each search result may comprise a reference to a user node or concept node that not connected to the user node corresponding to the querying user but is connected to one or more other nodes corresponding to first degree connections of the querying user or connections within a threshold degree of separation . In other words the search results may include users or concepts the first user is not directly connected to but which the first user may be interested in because the first user s friends or friends of friend etc. are connected to these recommended users or concepts. For example in response to the recommendation query Books I should read social networking system may generate search results corresponding to books liked by the querying user s friends subtract out books already liked by the querying user and send the remaining search results to the querying user which may represent books the querying user may be interested in but has not yet liked . In this way the first user can search for things the user s friends like or are otherwise connected to in social graph while excluding redundant search results of things the first user already likes or is otherwise already connected to in social graph . Although this disclosure describes generating recommendation queries in a particular manner this disclosure contemplates generating recommendation queries in any suitable manner.

In particular embodiments social networking system may send one or more structured queries to the querying user. The structured queries may be displayed on a page currently accessed by the first user. As an example and not by way of limitation the page may be a profile page of the online social network e.g. a user profile page of the querying user or another user or a concept profile page of a concept associated with the online social network a newsfeed page of the online social network a search results page corresponding to a particular structured query or another suitable page of the online social network. In particular embodiments each sent structured query may have a score greater than a threshold score to the querying user. After scoring the structured queries the social networking system may then send only those structured queries having a score greater than a threshold score. As an example and not by way of limitation when a user selects or inputs into a query field social networking system may send the top seven scoring structured queries for display in a drop down menu as illustrated in or may only send the top six scoring structured queries for display as illustrated in . In particular embodiments the sent structured queries may be displayed on a newsfeed page of the online social network. Queries having greater than a threshold score may automatically be pushed to a user. As an example and not by way of limitation the sent structured queries may be displayed as one or more stories in the newsfeed of the querying user as a suggested query separate from query field . The structured queries could be generated and scored as described previously and rather than displaying the structured query in association with a query field the structured query could be generated as a newsfeed store and displayed in a user s newsfeed in response to the user accessing a newsfeed page of the online social network. Although this disclosure describes sending structured queries in a particular manner this disclosure contemplates sending structured queries in any suitable manner.

In particular embodiments social networking system may generate sponsored queries for a user. A particular advertiser may identify a company brand product event person or other thing that the advertiser is associated with or wants to sponsor. Social networking system may then identify social graph elements corresponding to the thing the advertiser wants to sponsor and generate one or more structured queries referencing the identified social graph elements. As an example and not by way of limitation illustrates example default queries of the online social network that include a sponsored query. In this example an advertiser associated with the application Online Poker may want to sponsor queries referencing the application. In response to receiving an indication the advertiser wants to sponsor queries referencing Online Poker social networking system may identify the concept node corresponding to the Online Poker application. Social networking system may then generate one or more sponsored queries referencing the identified social graph element. As an example and not by way of limitation social networking system may generate a sponsored query My friends who play Online Poker where the reference to Online Poker is a reference to the concept node corresponding to the application Online Poker. These sponsored queries may then be sent to the querying user and displayed on a page accessed by the user. Although this disclosure describes generating sponsored queries for a user in a particular manner this disclosure contemplates generating sponsored queries for a user in any suitable manner.

In particular embodiments social networking system may identify a node of the plurality of nodes corresponding to an advertiser. The identified node may correspond to a particular profile page for a company brand product event person or other thing that the advertiser is associated with or wants to sponsor. Social networking system may also identify relevant edges or edge types connected to the identified node such that the edges or edge types may be referenced in any generated sponsored queries. In particular embodiments social networking system may receive from the advertiser an indication that the advertiser wants to sponsor one or more structured queries. The indication may identify one or more nodes of the plurality of nodes that correspond to the advertiser. As an example and not by way of limitation an advertiser associated with the application Online Poker may want to sponsor one or more structured queries for the application. In response social networking system may then identify the concept node corresponding to the application Online Poker illustrated in . As another example and not by way of limitation an advertiser may not want to directly advertise its company brand product etc. and may instead want to indirectly sponsor a structured query. Continuing with the prior example the advertiser associated with the application Online Poker may want to indirectly sponsor one or more structured queries for the application for example by identifying users who play the application and sponsoring queries for those users. In response social networking system may identify friends of the querying user who play Online Poker such as User F as illustrated in and may then generate a sponsored query such as Games played by User F which should generate a search results for Online Poker . In this way the advertiser may indirectly sponsor queries for its company brand product etc. In particular embodiments social networking system may provide a user interface to the advertiser that allows the advertiser to select which structured queries to sponsor. As an example and not by way of limitation social networking system may provide a user interface to the advertiser wherein the user interface displays one or more structured queries available for the advertiser to sponsor. For example an interface similar to the interface displayed in may be provided to the advertiser where a plurality of structured queries are displayed and where the advertiser may simply select or click on a particular structured query to sponsor it or may select or click on some type of separate activatable link such as a button indicating Sponsor this query providing similar functionality . Social networking system may then receive a selection from the advertiser identifying one or more of the structured queries available for the advertiser to sponsor. These selected queries may then be provided to one or more users as sponsored queries. Although this disclosure describes identifying particular objects of the online social network as corresponding to advertisers in a particular manner this disclosure contemplates identifying any suitable objects of the online social network as corresponding to advertisers in any suitable manner.

In particular embodiments social networking system may generate a plurality of structured queries that each comprise references to one or more nodes of the plurality of nodes and one or more edges of the plurality of edges. At least one of the structured queries may be a sponsored query comprising a reference to the identified node and one or more edges of the plurality of edges that are connected to the identified node. As an example and not by way of limitation referencing social networking system may generate a plurality of structured queries as illustrated where the suggested queries My friends who went to Shawshank Redemption and My friends who play Online Poker are sponsored queries and indicated as such. The references to Shawshank Redemption and Online Poker are references to particular concept nodes of social graph corresponding to the movie Shawshank Redemption and the game Online Poker respectively. Similarly the references to my friends went to and who play are references to friend type watched type and played type edges of social graph respectively. In this example a sponsor associated with Shawshank Redemption and Online Poker has sponsored these queries such that they have been generated and provided to the querying user as suggested queries. Although this disclosure describes generating particular sponsored queries in a particular manner this disclosure contemplates generating any suitable sponsored queries in any suitable manner.

In particular embodiments social networking system may send one or more of the generated structured queries to the first user. At least one of the sent structured queries may be a sponsored query. As an example and not by way of limitation social networking system may send a plurality of structured queries as illustrated in and one of the structured queries may be the sponsored query My friends who went to Shawshank Redemption which may be sponsored by an advertiser associated with the movie. In particular embodiments a sponsored query may include an indication that they are sponsored. As an example and not by way of limitation referencing social networking system may generate the sponsored query My friends who play Online Poker and then include the text sponsored after the query to indicate that it is a sponsored query. The sponsored queries may be displayed on a page currently accessed by the first user. As an example and not by way of limitation the page may be a profile page of the online social network e.g. a user profile page of the querying user or another user or a concept profile page of a concept associated with the online social network a newsfeed page of the online social network a search results page corresponding to a particular structured query a notifications page e.g. a page displaying notifications messages emails texts or other communications associated with the online social network a user interface of a native application associated with the online network or another suitable page of the online social network. Although this disclosure describes sending particular sponsored queries in a particular manner this disclosure contemplates sending any suitable sponsored queries in any suitable manner.

In particular embodiments social networking system may generate a plurality of structured queries that each comprise references to one or more nodes of the plurality of nodes and one or more edges of the plurality of edges. At least one of the structured queries may be a dynamic query comprising a reference one or more updates to the social graph. The updates referenced in a dynamic query may be additions changes or other suitable updates to objects associated with the online social network. The particular update may be referenced in the dynamic query. In particular embodiments the one or more updates to social graph may comprise updates within a threshold period of time. As an example and not by way of limitation referencing social networking system may generate a plurality of structured queries as illustrated one of which is the dynamic query Recent photos of my friends 2 new where the reference to 2 new is a reference to updates to social graph . In this case the 2 new may indicate that two new photos of friends of the querying user have been added to the online social network each photo corresponding to a newly added concept node of social graph within a threshold period of time. In particular embodiments the one or more updates to social graph may comprise updates since a particular structured query was last selected by the first user. As an example and not by way of limitation again referencing in the dynamic query Recent photos of my friends 2 new the reference to 2 new may instead indicate that two new photos of friends of the querying user have been added to the online social network since the last time the querying user ran the query Recent photos of my friends . In particular embodiments the one or more updates to social graph may comprise updates performed by one or more users within a threshold degree of separation of the querying user. The threshold degree of separation may be for example one two three or all. As an example and not by way of limitation social networking system may generate dynamic queries referencing updates by the querying user s friends e.g. new photos by the user s friends . As another example and not by way of limitation social networking system may generate dynamic queries referencing global updates e.g. globally trending topics in posts . Although this disclosure describes generating particular dynamic queries in a particular manner this disclosure contemplates generating any suitable dynamic queries in any suitable manner.

In particular embodiments social networking system may generate dynamic queries referencing a variety of updates to the online social network. Any suitable updates to social graph may be referenced. In particular embodiments the updates to social graph may comprise trending activity on the online social network. Trends may be measure with respect to users within a threshold degree of separation and may be measured with respect to activity over any suitable time period. In particular embodiments the updates to social graph may comprise trending queries of the online social network. The trending queries may comprise references to one or more nodes of the plurality of nodes previously searched for by one or more users of the online social network. As an example and not by way of limitation social networking system may generate a particular structured query for the querying user e.g. Photos taken at The Old Pro as illustrated in because other users of the online social network e.g. the querying user s friends have run that particular structured query. In particular embodiments the updates to social graph may comprise adding one or more concept nodes to social graph corresponding to one or more content objects added to the online social network respectively. In this case the dynamic queries may comprise a reference to the concept nodes added to social graph . The content object added to the online social network may be any suitable content object such as for example multimedia objects posts or other suitable objects associated with the online social network. As an example and not by way of limitation continuing with the example illustrated in social networking system may determine that references to the actor Ben Affleck are trending in posts on the online social network by friends of the querying user. Referencing these updates social networking system may then generate a dynamic query My friends posts about Ben Affleck 18 where the reference to 18 indicates that eighteen posts have been made by the querying user s friends about Ben Affleck . In this example the one or more updates to social graph may comprise trending topics or keywords associated with the posts e.g. the term Ben Affleck . In particular embodiments the updates to social graph may comprise updates to one or more edges connecting one or more nodes. Edges may be added deleted or changed within social graph in response to activity by users of the online social network. As an example and not by way of limitation social networking system may generate a dynamic query Newly single girls in Palo Alto 2 new where the reference to 2 new indicates that two female users who live in the city Palo Alto have changed their relationship status from in a relationship to single thus changing the edge type indicating their relationship status from an in a relationship type to a single type edge . As another example and not by way of limitation social networking system may generate a dynamic query Friends who have check in at the Old Pro 3 where the reference to 3 indicates that two friends of the querying user have checked in at the location Old Pro where checking in creates a check in type edge between the user nodes corresponding to those users and the concept node for the location Old Pro . Although this disclosure describes generating dynamic queries referencing particular updates this disclosure contemplates generating dynamic queries referencing any suitable updates.

In particular embodiments social networking system may generate structured queries referencing changes in search results. When generating particular structured queries social networking system may also identify the search results corresponding to the structured queries prior to the user selecting any query in order to determine if any of the search results have changed. In the case that search results have change for example because there are new objects that now match the search criteria of the structured query then social networking system may generate a dynamic query referencing the change in search results. As an example and not by way of limitation referencing social networking system may generate the dynamic query Recent photos of my friends 2 new which indicates that the search results corresponding to the structured query includes two new results. The querying user may then select this structured query and social networking system may generate a search results page where the search results include two results marked as New Results which represent the new search results referenced by the dynamic query. Social networking system may generate structured queries referencing changes in search results in any suitable manner. As an example and not by way of limitation social networking system may access a prior structured query previously selected by the first user e.g. Recent photos of my friends . Social networking system may then identify changes to the search results corresponding to the prior structured query e.g. identifying two new results . The identified changes to the search results may be changes within a threshold period of time or changes since the prior structured query was last selected by the first user. Social networking system may then generate one or more dynamic queries wherein at least one of the dynamic queries comprises the prior structured and references to the identified changes to the search results corresponding to the prior structured query. Although this disclosure describes generating structured queries referencing changes in search results in a particular manner this disclosure contemplates generating structured queries referencing changes in search results in any suitable manner.

In particular embodiments social networking system may send one or more of the generated structured queries to the first user. At least one of the sent structured queries may be a dynamic query. The dynamic query may be displayed with a reference indicating the particular updates to social graph associated with the dynamic query. As an example and not by way of limitation social networking system may send a plurality of structured queries as illustrated in and one of the structured queries may be the dynamic query Recent photos of my friends 2 new which references newly added photos tagged with friends of the querying user. The dynamic queries may be displayed on a page currently accessed by the first user. As an example and not by way of limitation the page may be a profile page of the online social network e.g. a user profile page of the querying user or another user or a concept profile page of a concept associated with the online social network a newsfeed page of the online social network a search results page corresponding to a particular structured query a notifications page e.g. a page displaying notifications messages emails texts or other communications associated with the online social network a user interface of a native application associated with the online network or another suitable page of the online social network. Although this disclosure describes sending dynamic queries to users in a particular manner this disclosure contemplates sending dynamic queries to users in any suitable manner.

In particular embodiments in response to a structured query received from a querying user the social networking system may generate one or more search results where each search result matches or substantially matches the terms of the structured query which includes sponsored queries dynamic queries and other types of structured queries . The social networking system may receive a structured query from a querying user also referred to as the first user corresponding to a first user node . In response to the structured query the social networking system may generate one or more search results corresponding to the structured query. Each search result may include link to a profile page and a description or summary of the profile page or the node corresponding to that page . The search results may be presented and sent to the querying user as a search results page. illustrate example search results pages generated in response to particular structured queries. The structured query used to generate a particular search results page may be shown in query field and the various search results generated in response to the structured query are illustrated in a results field for presented search results. In particular embodiments the query field may also serve as the title bar for the page. In other words the title bar and query field may effectively be a unified field on the search results page. As an example illustrates a search results page with the structured query My friends who work at Facebook in query field . This structured query also effectively serves as the title for the generated page where the page shows a plurality search results of users of the online social network who are employees at the company Facebook . The search results page may also include a field for modifying search results e.g. field in and a field for sharing structured queries and search results e.g. field in . When generating the search results the social networking system may generate one or more snippets for each search result where the snippets are contextual information about the target of the search result i.e. contextual information about the social graph entity profile page or other content corresponding to the particular search result . Although this disclosure describes and illustrates particular search results pages this disclosure contemplates any suitable search results pages.

In particular embodiments the social networking system may generate one or more search results corresponding to a structured query. The search results may identify resources or content e.g. user profile pages content profile pages or external resources that match or are likely to be related to the search query. In particular embodiments each search result may correspond to a particular user node or concept node of the social graph . The search result may include a link to the profile page associated with the node as well as contextual information about the node i.e. contextual information about the user or concept that corresponds to the node . As an example and not by way of limitation referencing B the structured query My friends who work at Facebook in query field generated the various search results illustrated in results field . Each search result in results field shows a link to a profile page of a user illustrated as the user s name which contains an inline link to the profile page and contextual information about that user that corresponds to a user node of the social graph . As another example and not by way of limitation referencing the structured query Recent photos of my friends in query field generated the various search results illustrated in results field . Each search result illustrated in shows a thumbnail of a photograph that corresponds to a concept node of the social graph. In particular embodiments each search result may correspond to a node that is connected to one or more of the selected nodes by one or more of the selected edges of the structured query. In particular embodiments the social networking system may also transmit advertisements or other sponsored content to the client system in response to the structured query. The advertisements may be included in as part of the search results or separately. The advertisements may correspond to one or more of the objects referenced in the search results. In particular embodiments the social networking system may filter out one or more search results identifying particular resources or content based on the privacy settings associated with the users associated with those resources or content. Although this disclosure describes generating particular search results in a particular manner this disclosure contemplates generating any suitable search results in any suitable manner.

More information on generating search results may be found in U.S. patent application Ser. No. 13 556 017 filed 23 Jul. 2012 and U.S. patent application Ser. No. 13 731 939 filed 31 Dec. 2012 each of which is incorporated by reference.

In particular embodiments social networking system may receive from a first user a selection of a structured query the first user wants to share with one or more second users of the plurality of users. Users may want to share queries or results that are interesting or that other users may want to view or otherwise engage with. The selection may indicate whether the user wants to share the query the search results or both and may indicate which users to share with e.g. particular users friends friends of friends publically etc. . As an example and not by way of limitation if a first user runs a particular structured query such as Friends of Mark social networking system may generate a search results page corresponding to this query. The first user may then be able to share this query by copying the URL corresponding to the search results page e.g. https www.facebook.com search Mark photos of and posting it as a story on the user s profile page which may then be shared as a story in the newsfeed of other users of the online social network. In particular embodiments a first user may share a query and or search results directly from a search results page. The search results page may include a field allowing the first user to indicate the user wants to share the structured query the corresponding search results or both as appropriate. As an example and not by way of limitation social networking system may send a search results page to the first user where the search results page may comprise one or more search results corresponding to a selected structured query. The search results page may also comprise an activatable link enabling the first user to share the query and or search results with the one or more second users. For example referencing the search results page may include an activatable link such as the Share this search with your friends link illustrated in field . The first user may click or otherwise activate this link and social networking system may receive the indication the first user has activated the activatable link on the search results page in order to share the structured query and or the search results. In particular embodiments a first user may share a query directly from a query field. As an example and not by way of limitation social networking system may send one or more structured queries to a first user which may be displayed in a drop down menu associated with a query field . One or more of the structured queries may be displayed with an activatable link with the structured query such as a Share this query button next to the query which could be clicked or otherwise selected directly from drop down menu allowing the user to run the query share the query share the search results or any combination thereof. Although this disclosure describes users sharing structured queries in a particular manner this disclosure contemplates users sharing structured queries in any suitable manner.

In particular embodiments in response to receiving a selection of a structured query the first user wants to share social networking system may send the structured query for display on a page associated with one or more second users. In the case where search results are shared the search results may be generated with respect to the first user or with respect to the second user. The shared structured query and or search results may be displayed on a page currently accessed by the second user. As an example and not by way of limitation the page may be a profile page of the online social network e.g. a user profile page of the user or a concept profile page of a concept associated with the online social network a newsfeed page of the online social network a search results page corresponding to a particular structured query a notifications page e.g. a page displaying notifications messages emails texts or other communications associated with the online social network a user interface of a native application associated with the online network or another suitable page of the online social network. In particular embodiments the page may be a newsfeed page of the online social network and the shared structured query and or search results may be displayed as a story in a newsfeed. As an example and not by way of limitation referencing social networking system may generate a newsfeed page as illustrated for the user Justin in response to the user Matthew sharing the search query My friends who work as Facebook . The shared structured query and search results are displayed to the user Justin as a story in the user s newsfeed as illustrated in field . In particular embodiments the page may be a profile page of the online social network corresponding to the second user. As an example and not by way of limitation similar to the example illustrated in the first user may share the structured query and or search results by posting a link as a post on the profile page of a second user and the shared structured query and or search results may then be displayed as a post on the second user s profile page. In particular embodiments the page may be a search results page corresponding to a particular structured query. The structured query may comprise references to one or more nodes and one or more edges and the search results page may have been generated in response to this structured query. As an example and not by way of limitation the shared structured query and or search results may be displayed on a search results page accessed by the second user as a suggested query. Although this disclosure describes sending shared structured queries in a particular manner this disclosure contemplates sending shared structured queries in any suitable manner.

In particular embodiments social networking system may receive a selection of a shared structured query from a second user. In response to receiving a shared structured query from a first user the second user may select the shared structured query. Social networking system may then generate one or more search results corresponding to the shared query and send the search results to the second user e.g. as a search results page . The search results may be generated with respect to the sharing first user or with respect the receiving second user. As an example and not by way of limitation in response to the user Justin clicking on the structured query My friends who work at Facebook shared by the user Matthew in social networking system may generate one or more search results with respect to the user Matthew . In other words when the user Justin selects the shared query social networking system generates search results showing users who work at Facebook who are friends of the user Matthew . The my friends constraint in the structured query is executed with respect to the first user Matthew in this case even though it is being run by the second user Justin . Social networking system may generate search results corresponding to this structured query for the user Justin as if the structured query were executed by the user Matthew allowing the user Justin to see the same search results that the user Matthew would see. Alternatively some search results may be filtered out based on the privacy settings associated with the users corresponding to the search results for example certain search results may be visible to the user Matthew but not visible to the user Justin based on privacy settings associated with the search result . As another example and not by way of limitation in response to the user Justin clicking on the structured query My friends who work at Facebook shared by the user Matthew in social networking system may generate one or more search results with respect to the user Justin . In other words when the user Justin selects the shared query social networking system generates search results showing users who work at Facebook who are friends of the user Justin . The my friends constraint in the structured query is executed with respect to the second user Justin in this case even though it was shared by the first user Matthew . Although this disclosure describes generating search results for a shared query in a particular manner this disclosure contemplates generating search results for a shared query in any suitable manner.

In particular embodiments social networking system may generate structured queries that are displayed with previews of the search results corresponding to the queries. When a structured query is generated as described previously social networking system may also generate search results corresponding to one or more of the structured queries. The search results may be generated concurrently with the structured queries or in response to a selection e.g. mousing over of one of the structured queries by the querying user. The structured queries and search results could then be sent to the querying user for display where one or more of the queries could be displayed with a preview of the search results corresponding to the query. The preview could be displayed in any suitable manner. As an example and not by way of limitation the querying user may mouse over the structured query My friends who work at Facebook as illustrated in and a preview for that structured query may be generated and displayed just below the query where the preview shows the names and thumbnail photos of some of the matching search results. Previews of search results may be displayed in association with any suitable type of query described herein. Furthermore if a structured query is shared with other users as described previously the shared structured query may be displayed with a preview of the search results. As an example and not by way of limitation for the shared structured query Matthew s friends who work at Facebook as illustrated in a preview of the search results for that shared query may be displayed in the newsfeed story along with the shared query. By generating previews to display with structured queries social networking system may provide an a quick and convenient way for users of the online social network to review search results for a particular query without having to leave the current page accessed by the user since search results for multiple queries may be previewed from the query field. Although this disclosure describes generating structured queries with previews of search results in a particular manner this disclosure contemplates generating structured queries with previews of search results in any suitable manner.

In particular embodiments social networking system may generate a plurality of structured queries and generate one or more search results corresponding to at least one of the structured queries. The search results corresponding to each structured query may be generated concurrently with the structured queries or may be generated in response to a selection of the structured query by the querying user. As an example and not by way of limitation social networking system may generate a plurality of structured queries and a plurality of sets of search results corresponding to each structured query respectively. In this case all of the structured queries and their corresponding search results may be generated concurrently. As another example and not by way of limitation social networking system may generate a plurality of structured queries. Social networking system may then generate search results for one or more of the structured queries for example in response to the querying user mousing over on of the structured queries. Alternatively the search results for a particular structured query may be generated before receiving a selection from the user sent to the user s client system and using a client side process the search results may be retrieved e.g. from a client side cache and displayed as a preview once the querying user mouses over the query. Although this disclosure describes generating structured queries and search results in a particular manner this disclosure contemplates generating structured queries and search results in any suitable manner.

In particular embodiments social networking system may send one or more of the structured queries for display to the first user. At least one of the structured queries may be displayed with a preview of one or more of the search results corresponding to the structured query. The preview may comprise some or all of the search results corresponding to the structured query though typically the preview will only include a small sub set of the total search results. Furthermore the preview may be displayed in association with query field e.g. in drop down menu adjacent to the respective structured query as illustrated in or in another suitable location e.g. on a sidebar on the page or as a pop up overlay over the query as it is moused over . Each search result may correspond to a particular node of social graph . Moreover each search result of the preview may include a thumbnail image or one or more snippets of contextual information associated with the node corresponding to the search result. Furthermore each search result of the preview may be associated with a particular profile page of the online social network and each snippet may comprise information from the profile page associated with the search result. As an example and not by way of limitation referencing in response to receiving the text query friends who work at facebook from the querying user social networking system may generate a plurality of structured queries and send those queries for display in a drop down menu associated with query field . One of the structured queries may be My friends who work at Facebook as illustrated in field . The structured query illustrated in field is displayed with a preview of some of the search results corresponding to the structured query My friends who work at Facebook where the name and thumbnail image of each search result is displayed in the preview. The structured queries with previews may be displayed on a page currently accessed by the first user. As an example and not by way of limitation the page may be a profile page of the online social network e.g. a user profile page of the querying user or another user or a concept profile page of a concept associated with the online social network a newsfeed page of the online social network a search results page corresponding to a particular structured query a notifications page e.g. a page displaying notifications messages emails texts or other communications associated with the online social network a user interface of a native application associated with the online network or another suitable page of the online social network. In particular embodiments the querying user may share the structured query with the preview with one or more second users of the online social network. The search results may be generated with respect to the sharing querying user or with respect the receiving second user. As an example and not by way of limitation a first user may share the structured query My friends who work at Facebook and the corresponding search results as illustrated in for example by activating the link Share this search with your friends in field . In response social networking system may generate a story that is displayed in the newsfeed of a second user as illustrated in . The shared structured query Matthew s friends who work at Facebook is displayed with a preview of the search results corresponding to the query as illustrated in field . In this example the search results in the preview illustrated in field are generated with respect to the first user Matthew though they could also be generated with respect to the second user Justin . Although this disclosure describes generating previews for search queries in a particular manner this disclosure contemplates generating previews for search queries in any suitable manner.

In particular embodiments the structured queries with previews of search results may be sent in response to a selection by the querying user. Social networking system may receive from the first user a selection of one of the structured queries. As an example and not by way of limitation the first user may click on touch mouse over or otherwise provide an indication that a particular structured query is being selected. In response social networking system may generate search results for at least the selected structured query. The preview of the search results may then be displayed with the selected structured query. The sent structured queries may be displayed in a drop down menu on the page wherein the preview of the search results may be displayed in the drop down menu e.g. below the respective structured query . Although this disclosure describes generating previews for search queries in a particular manner this disclosure contemplates generating previews for search queries in any suitable manner.

In particular embodiments social networking system may determine the social graph affinity which may be referred to herein as affinity of various social graph entities for each other. Affinity may represent the strength of a relationship or level of interest between particular objects associated with the online social network such as users concepts content actions advertisements other objects associated with the online social network or any suitable combination thereof. Affinity may also be determined with respect to objects associated with third party systems or other suitable systems. An overall affinity for a social graph entity for each user subject matter or type of content may be established. The overall affinity may change based on continued monitoring of the actions or relationships associated with the social graph entity. Although this disclosure describes determining particular affinities in a particular manner this disclosure contemplates determining any suitable affinities in any suitable manner.

In particular embodiments social networking system may measure or quantify social graph affinity using an affinity coefficient which may be referred to herein as coefficient . The coefficient may represent or quantify the strength of a relationship between particular objects associated with the online social network. The coefficient may also represent a probability or function that measures a predicted probability that a user will perform a particular action based on the user s interest in the action. In this way a user s future actions may be predicted based on the user s prior actions where the coefficient may be calculated at least in part a the history of the user s actions. Coefficients may be used to predict any number of actions which may be within or outside of the online social network. As an example and not by way of limitation these actions may include various types of communications such as sending messages posting content or commenting on content various types of a observation actions such as accessing or viewing profile pages media or other suitable content various types of coincidence information about two or more social graph entities such as being in the same group tagged in the same photograph checked in at the same location or attending the same event or other suitable actions. Although this disclosure describes measuring affinity in a particular manner this disclosure contemplates measuring affinity in any suitable manner.

In particular embodiments social networking system may use a variety of factors to calculate a coefficient. These factors may include for example user actions types of relationships between objects location information other suitable factors or any combination thereof. In particular embodiments different factors may be weighted differently when calculating the coefficient. The weights for each factor may be static or the weights may change according to for example the user the type of relationship the type of action the user s location and so forth. Ratings for the factors may be combined according to their weights to determine an overall coefficient for the user. As an example and not by way of limitation particular user actions may be assigned both a rating and a weight while a relationship associated with the particular user action is assigned a rating and a correlating weight e.g. so the weights total 100 . To calculate the coefficient of a user towards a particular object the rating assigned to the user s actions may comprise for example 60 of the overall coefficient while the relationship between the user and the object may comprise 40 of the overall coefficient. In particular embodiments the social networking system may consider a variety of variables when determining weights for various factors used to calculate a coefficient such as for example the time since information was accessed decay factors frequency of access relationship to information or relationship to the object about which information was accessed relationship to social graph entities connected to the object short or long term averages of user actions user feedback other suitable variables or any combination thereof. As an example and not by way of limitation a coefficient may include a decay factor that causes the strength of the signal provided by particular actions to decay with time such that more recent actions are more relevant when calculating the coefficient. The ratings and weights may be continuously updated based on continued tracking of the actions upon which the coefficient is based. Any type of process or algorithm may be employed for assigning combining averaging and so forth the ratings for each factor and the weights assigned to the factors. In particular embodiments social networking system may determine coefficients using machine learning algorithms trained on historical actions and past user responses or data farmed from users by exposing them to various options and measuring responses. Although this disclosure describes calculating coefficients in a particular manner this disclosure contemplates calculating coefficients in any suitable manner.

In particular embodiments social networking system may calculate a coefficient based on a user s actions. Social networking system may monitor such actions on the online social network on a third party system on other suitable systems or any combination thereof. Any suitable type of user actions may be tracked or monitored. Typical user actions include viewing profile pages creating or posting content interacting with content tagging or being tagged in images joining groups listing and confirming attendance at events checking in at locations liking particular pages creating pages and performing other tasks that facilitate social action. In particular embodiments social networking system may calculate a coefficient based on the user s actions with particular types of content. The content may be associated with the online social network a third party system or another suitable system. The content may include users profile pages posts news stories headlines instant messages chat room conversations emails advertisements pictures video music other suitable objects or any combination thereof. Social networking system may analyze a user s actions to determine whether one or more of the actions indicate an affinity for subject matter content other users and so forth. As an example and not by way of limitation if a user may make frequently posts content related to coffee or variants thereof social networking system may determine the user has a high coefficient with respect to the concept coffee . Particular actions or types of actions may be assigned a higher weight and or rating than other actions which may affect the overall calculated coefficient. As an example and not by way of limitation if a first user emails a second user the weight or the rating for the action may be higher than if the first user simply views the user profile page for the second user.

In particular embodiments social networking system may calculate a coefficient based on the type of relationship between particular objects. Referencing the social graph social networking system may analyze the number and or type of edges connecting particular user nodes and concept nodes when calculating a coefficient. As an example and not by way of limitation user nodes that are connected by a spouse type edge representing that the two users are married may be assigned a higher coefficient than a user nodes that are connected by a friend type edge. In other words depending upon the weights assigned to the actions and relationships for the particular user the overall affinity may be determined to be higher for content about the user s spouse than for content about the user s friend. In particular embodiments the relationships a user has with another object may affect the weights and or the ratings of the user s actions with respect to calculating the coefficient for that object. As an example and not by way of limitation if a user is tagged in first photo but merely likes a second photo social networking system may determine that the user has a higher coefficient with respect to the first photo than the second photo because having a tagged in type relationship with content may be assigned a higher weight and or rating than having a like type relationship with content. In particular embodiments social networking system may calculate a coefficient for a first user based on the relationship one or more second users have with a particular object. In other words the connections and coefficients other users have with an object may affect the first user s coefficient for the object. As an example and not by way of limitation if a first user is connected to or has a high coefficient for one or more second users and those second users are connected to or have a high coefficient for a particular object social networking system may determine that the first user should also have a relatively high coefficient for the particular object. In particular embodiments the coefficient may be based on the degree of separation between particular objects. The lower coefficient may represent the decreasing likelihood that the first user will share an interest in content objects of the user that is indirectly connected to the first user in the social graph . As an example and not by way of limitation social graph entities that are closer in the social graph i.e. fewer degrees of separation may have a higher coefficient than entities that are further apart in the social graph .

In particular embodiments social networking system may calculate a coefficient based on location information. Objects that are geographically closer to each other may be considered to be more related or of more interest to each other than more distant objects. In particular embodiments the coefficient of a user towards a particular object may be based on the proximity of the object s location to a current location associated with the user or the location of a client system of the user . A first user may be more interested in other users or concepts that are closer to the first user. As an example and not by way of limitation if a user is one mile from an airport and two miles from a gas station social networking system may determine that the user has a higher coefficient for the airport than the gas station based on the proximity of the airport to the user.

In particular embodiments social networking system may perform particular actions with respect to a user based on coefficient information. Coefficients may be used to predict whether a user will perform a particular action based on the user s interest in the action. A coefficient may be used when generating or presenting any type of objects to a user such as advertisements search results news stories media messages notifications or other suitable objects. The coefficient may also be utilized to rank and order such objects as appropriate. In this way social networking system may provide information that is relevant to user s interests and current circumstances increasing the likelihood that they will find such information of interest. In particular embodiments social networking system may generate content based on coefficient information. Content objects may be provided or selected based on coefficients specific to a user. As an example and not by way of limitation the coefficient may be used to generate media for the user where the user may be presented with media for which the user has a high overall coefficient with respect to the media object. As another example and not by way of limitation the coefficient may be used to generate advertisements for the user where the user may be presented with advertisements for which the user has a high overall coefficient with respect to the advertised object. In particular embodiments social networking system may generate search results based on coefficient information. Search results for a particular user may be scored or ranked based on the coefficient associated with the search results with respect to the querying user. As an example and not by way of limitation search results corresponding to objects with higher coefficients may be ranked higher on a search results page than results corresponding to objects having lower coefficients.

In particular embodiments social networking system may calculate a coefficient in response to a request for a coefficient from a particular system or process. To predict the likely actions a user may take or may be the subject of in a given situation any process may request a calculated coefficient for a user. The request may also include a set of weights to use for various factors used to calculate the coefficient. This request may come from a process running on the online social network from a third party system e.g. via an API or other communication channel or from another suitable system. In response to the request social networking system may calculate the coefficient or access the coefficient information if it has previously been calculated and stored . In particular embodiments social networking system may measure an affinity with respect to a particular process. Different processes both internal and external to the online social network may request a coefficient for a particular object or set of objects. Social networking system may provide a measure of affinity that is relevant to the particular process that requested the measure of affinity. In this way each process receives a measure of affinity that is tailored for the different context in which the process will use the measure of affinity.

In connection with social graph affinity and affinity coefficients particular embodiments may utilize one or more systems components elements functions methods operations or steps disclosed in U.S. patent application Ser. No. 11 503 093 filed 11 Aug. 2006 U.S. patent application Ser. No. 12 977 027 filed 22 Dec. 2010 U.S. patent application Ser. No. 12 978 265 filed 23 Dec. 2010 and U.S. patent application Ser. No. 13 632 869 filed 1 Oct. 2012 each of which is incorporated by reference.

In particular embodiments an advertisement may be text which may be HTML linked one or more images which may be HTML linked one or more videos audio one or more ADOBE FLASH files a suitable combination of these or any other suitable advertisement in any suitable digital format presented on one or more pages in one or more e mails or in connection with search results requested by a user . In addition or as an alternative an advertisement may be one or more sponsored stories e.g. a newsfeed or ticker item on social networking system or may be one or more sponsored queries e.g. a suggested query referencing a particular object . A sponsored story or query may include a reference to a social action by a user such as liking a page liking or commenting on a post on a page RSVPing to an event associated with a page voting on a question posted on a page checking in to a place using an application or playing a game or liking or sharing a website that an advertiser promotes by for example having the social action presented within a pre determined area of a profile page of a user or other page presented with additional information associated with the advertiser bumped up or otherwise highlighted within news feeds or tickers of other users or otherwise promoted. The advertiser may pay to have the social action promoted.

In particular embodiments an advertisement may be requested for display within social networking system pages third party webpages or other pages. An advertisement may be displayed in a dedicated portion of a page such as in a banner area at the top of the page in a column at the side of the page in a GUI of the page in a pop up window in a drop down menu in an input field of the page over the top of content of the page or elsewhere with respect to the page. In addition or as an alternative an advertisement may be displayed within an application. An advertisement may be displayed within dedicated pages requiring the user to interact with or watch the advertisement before the user may access a page or utilize an application. The user may for example view the advertisement through a web browser.

A user may interact with an advertisement in any suitable manner. The user may click or otherwise select the advertisement. By selecting the advertisement the user may be directed to or a browser or other application being used by the user a page associated with the advertisement. At the page associated with the advertisement the user may take additional actions such as purchasing a product or service associated with the advertisement receiving information associated with the advertisement or subscribing to a newsletter associated with the advertisement. An advertisement with audio or video may be played by selecting a component of the advertisement like a play button . Alternatively by selecting the advertisement the social networking system may execute or modify a particular action of the user. As an example and not by way of limitation advertisements may be included among the search results of a search results page where sponsored content is promoted over non sponsored content. As another example and not by way of limitation advertisements may be included among suggested search queries where suggested queries that reference the advertiser or its content products may be promoted over non sponsored queries.

An advertisement may include social networking system functionality that a user may interact with. For example an advertisement may enable a user to like or otherwise endorse the advertisement by selecting an icon or link associated with endorsement. As another example an advertisement may enable a user to search e.g. by executing a query for content related to the advertiser. Similarly a user may share the advertisement with another user e.g. through social networking system or RSVP e.g. through social networking system to an event associated with the advertisement. In addition or as an alternative an advertisement may include social networking system context directed to the user. For example an advertisement may display information about a friend of the user within social networking system who has taken an action associated with the subject matter of the advertisement.

This disclosure contemplates any suitable number of computer systems . This disclosure contemplates computer system taking any suitable physical form. As example and not by way of limitation computer system may be an embedded computer system a system on chip SOC a single board computer system SBC such as for example a computer on module COM or system on module SOM a desktop computer system a laptop or notebook computer system an interactive kiosk a mainframe a mesh of computer systems a mobile telephone a personal digital assistant PDA a server a tablet computer system or a combination of two or more of these. Where appropriate computer system may include one or more computer systems be unitary or distributed span multiple locations span multiple machines span multiple data centers or reside in a cloud which may include one or more cloud components in one or more networks. Where appropriate one or more computer systems may perform without substantial spatial or temporal limitation one or more steps of one or more methods described or illustrated herein. As an example and not by way of limitation one or more computer systems may perform in real time or in batch mode one or more steps of one or more methods described or illustrated herein. One or more computer systems may perform at different times or at different locations one or more steps of one or more methods described or illustrated herein where appropriate.

In particular embodiments computer system includes a processor memory storage an input output I O interface a communication interface and a bus . Although this disclosure describes and illustrates a particular computer system having a particular number of particular components in a particular arrangement this disclosure contemplates any suitable computer system having any suitable number of any suitable components in any suitable arrangement.

In particular embodiments processor includes hardware for executing instructions such as those making up a computer program. As an example and not by way of limitation to execute instructions processor may retrieve or fetch the instructions from an internal register an internal cache memory or storage decode and execute them and then write one or more results to an internal register an internal cache memory or storage . In particular embodiments processor may include one or more internal caches for data instructions or addresses. This disclosure contemplates processor including any suitable number of any suitable internal caches where appropriate. As an example and not by way of limitation processor may include one or more instruction caches one or more data caches and one or more translation lookaside buffers TLBs . Instructions in the instruction caches may be copies of instructions in memory or storage and the instruction caches may speed up retrieval of those instructions by processor . Data in the data caches may be copies of data in memory or storage for instructions executing at processor to operate on the results of previous instructions executed at processor for access by subsequent instructions executing at processor or for writing to memory or storage or other suitable data. The data caches may speed up read or write operations by processor . The TLBs may speed up virtual address translation for processor . In particular embodiments processor may include one or more internal registers for data instructions or addresses. This disclosure contemplates processor including any suitable number of any suitable internal registers where appropriate. Where appropriate processor may include one or more arithmetic logic units ALUs be a multi core processor or include one or more processors . Although this disclosure describes and illustrates a particular processor this disclosure contemplates any suitable processor.

In particular embodiments memory includes main memory for storing instructions for processor to execute or data for processor to operate on. As an example and not by way of limitation computer system may load instructions from storage or another source such as for example another computer system to memory . Processor may then load the instructions from memory to an internal register or internal cache. To execute the instructions processor may retrieve the instructions from the internal register or internal cache and decode them. During or after execution of the instructions processor may write one or more results which may be intermediate or final results to the internal register or internal cache. Processor may then write one or more of those results to memory . In particular embodiments processor executes only instructions in one or more internal registers or internal caches or in memory as opposed to storage or elsewhere and operates only on data in one or more internal registers or internal caches or in memory as opposed to storage or elsewhere . One or more memory buses which may each include an address bus and a data bus may couple processor to memory . Bus may include one or more memory buses as described below. In particular embodiments one or more memory management units MMUs reside between processor and memory and facilitate accesses to memory requested by processor . In particular embodiments memory includes random access memory RAM . This RAM may be volatile memory where appropriate Where appropriate this RAM may be dynamic RAM DRAM or static RAM SRAM . Moreover where appropriate this RAM may be single ported or multi ported RAM. This disclosure contemplates any suitable RAM. Memory may include one or more memories where appropriate. Although this disclosure describes and illustrates particular memory this disclosure contemplates any suitable memory.

In particular embodiments storage includes mass storage for data or instructions. As an example and not by way of limitation storage may include a hard disk drive HDD a floppy disk drive flash memory an optical disc a magneto optical disc magnetic tape or a Universal Serial Bus USB drive or a combination of two or more of these. Storage may include removable or non removable or fixed media where appropriate. Storage may be internal or external to computer system where appropriate. In particular embodiments storage is non volatile solid state memory. In particular embodiments storage includes read only memory ROM . Where appropriate this ROM may be mask programmed ROM programmable ROM PROM erasable PROM EPROM electrically erasable PROM EEPROM electrically alterable ROM EAROM or flash memory or a combination of two or more of these. This disclosure contemplates mass storage taking any suitable physical form. Storage may include one or more storage control units facilitating communication between processor and storage where appropriate. Where appropriate storage may include one or more storages . Although this disclosure describes and illustrates particular storage this disclosure contemplates any suitable storage.

In particular embodiments I O interface includes hardware software or both providing one or more interfaces for communication between computer system and one or more I O devices. Computer system may include one or more of these I O devices where appropriate. One or more of these I O devices may enable communication between a person and computer system . As an example and not by way of limitation an I O device may include a keyboard keypad microphone monitor mouse printer scanner speaker still camera stylus tablet touch screen trackball video camera another suitable I O device or a combination of two or more of these. An I O device may include one or more sensors. This disclosure contemplates any suitable I O devices and any suitable I O interfaces for them. Where appropriate I O interface may include one or more device or software drivers enabling processor to drive one or more of these I O devices. I O interface may include one or more I O interfaces where appropriate. Although this disclosure describes and illustrates a particular I O interface this disclosure contemplates any suitable I O interface.

In particular embodiments communication interface includes hardware software or both providing one or more interfaces for communication such as for example packet based communication between computer system and one or more other computer systems or one or more networks. As an example and not by way of limitation communication interface may include a network interface controller NIC or network adapter for communicating with an Ethernet or other wire based network or a wireless NIC WNIC or wireless adapter for communicating with a wireless network such as a WI FI network. This disclosure contemplates any suitable network and any suitable communication interface for it. As an example and not by way of limitation computer system may communicate with an ad hoc network a personal area network PAN a local area network LAN a wide area network WAN a metropolitan area network MAN or one or more portions of the Internet or a combination of two or more of these. One or more portions of one or more of these networks may be wired or wireless. As an example computer system may communicate with a wireless PAN WPAN such as for example a BLUETOOTH WPAN a WI FI network a WI MAX network a cellular telephone network such as for example a Global System for Mobile Communications GSM network or other suitable wireless network or a combination of two or more of these. Computer system may include any suitable communication interface for any of these networks where appropriate. Communication interface may include one or more communication interfaces where appropriate. Although this disclosure describes and illustrates a particular communication interface this disclosure contemplates any suitable communication interface.

In particular embodiments bus includes hardware software or both coupling components of computer system to each other. As an example and not by way of limitation bus may include an Accelerated Graphics Port AGP or other graphics bus an Enhanced Industry Standard Architecture EISA bus a front side bus FSB a HYPERTRANSPORT HT interconnect an Industry Standard Architecture ISA bus an INFINIBAND interconnect a low pin count LPC bus a memory bus a Micro Channel Architecture MCA bus a Peripheral Component Interconnect PCI bus a PCI Express PCIe bus a serial advanced technology attachment SATA bus a Video Electronics Standards Association local VLB bus or another suitable bus or a combination of two or more of these. Bus may include one or more buses where appropriate. Although this disclosure describes and illustrates a particular bus this disclosure contemplates any suitable bus or interconnect.

Herein a computer readable non transitory storage medium or media may include one or more semiconductor based or other integrated circuits ICs such as for example field programmable gate arrays FPGAs or application specific ICs ASICs hard disk drives HDDs hybrid hard drives HHDs optical discs optical disc drives ODDs magneto optical discs magneto optical drives floppy diskettes floppy disk drives FDDs magnetic tapes solid state drives SSDs RAM drives SECURE DIGITAL cards or drives any other suitable computer readable non transitory storage media or any suitable combination of two or more of these where appropriate. A computer readable non transitory storage medium may be volatile non volatile or a combination of volatile and non volatile where appropriate.

Herein or is inclusive and not exclusive unless expressly indicated otherwise or indicated otherwise by context. Therefore herein A or B means A B or both unless expressly indicated otherwise or indicated otherwise by context. Moreover and is both joint and several unless expressly indicated otherwise or indicated otherwise by context. Therefore herein A and B means A and B jointly or severally unless expressly indicated otherwise or indicated otherwise by context.

The scope of this disclosure encompasses all changes substitutions variations alterations and modifications to the example embodiments described or illustrated herein that a person having ordinary skill in the art would comprehend. The scope of this disclosure is not limited to the example embodiments described or illustrated herein. Moreover although this disclosure describes and illustrates respective embodiments herein as including particular components elements feature functions operations or steps any of these embodiments may include any combination or permutation of any of the components elements features functions operations or steps described or illustrated anywhere herein that a person having ordinary skill in the art would comprehend. Furthermore reference in the appended claims to an apparatus or system or a component of an apparatus or system being adapted to arranged to capable of configured to enabled to operable to or operative to perform a particular function encompasses that apparatus system component whether or not it or that particular function is activated turned on or unlocked as long as that apparatus system or component is so adapted arranged capable configured enabled operable or operative.

