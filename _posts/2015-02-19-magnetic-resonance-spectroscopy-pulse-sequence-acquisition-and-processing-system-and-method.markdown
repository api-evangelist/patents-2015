---

title: Magnetic resonance spectroscopy pulse sequence, acquisition, and processing system and method
abstract: Systems and methods are provided for processing a set of multiple serially acquired magnetic resonance spectroscopy (MRS) free induction decay (FID) frames from a multi-frame MRS acquisition series from a region of interest (ROI) in a subject, and for providing a post-processed MRS spectrum. Processing parameters are dynamically varied while measuring results to determine the optimal post-processed results. Spectral regions opposite water from chemical regions of interest are evaluated and used in at least one processing operation. Frequency shift error is estimated via spectral correlation between free induction decay (FID) frames and a reference spectrum. Multiple groups of FID frames within the acquired set are identified to different phases corresponding with a phase step cycle of the acquisition. Baseline correction is also performed via rank order filter (ROF) estimate and a polynomial fit. Sections of the ROF may be excluded from the polynomial fit, such as for example sections determined to be associated with relevant spectral peaks.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09345421&OS=09345421&RS=09345421
owner: Nocimed, Inc.
number: 09345421
owner_city: Redwood City
owner_country: US
publication_date: 20150219
---
This application is a continuation of U.S. patent application Ser. No. 13 843 117 filed Mar. 15 2013 and titled MAGNETIC RESONANCE SPECTROSCOPY PULSE SEQUENCE ACQUISITION AND PROCESSING SYSTEM AND METHOD which claims the benefit under 35 U.S.C. 119 e of U.S. Provisional Patent Application No. 61 624 284 filed Apr. 14 2012 and titled MAGNETIC RESONANCE SPECTROSCOPY PULSE SEQUENCE ACQUISITION AND PROCESSING SYSTEM AND METHOD the above identified applications are hereby incorporated by reference in their entirety and made a part of this specification for all that they disclose.

The following disclosures are hereby incorporated by reference in their entirety and made a part of this specification for all that they disclose U.S. Patent Publication No. 2008 0039710 filed Jul. 27 2007 and titled SYSTEM AND METHODS USING NUCLEAR MAGNETIC RESONANCE NMR SPECTROSCOPY TO EVALUATE PAIN AND DEGENERATIVE PROPERTIES OF TISSUE U.S. Patent Publication No. 2009 0030308 filed Mar. 21 2008 and titled SYSTEM COMPOSITION AND METHODS FOR LOCAL IMAGING AND TREATMENT OF PAIN International Patent Publication No. WO 2009 148550 filed May 29 2009 and titled BIOMARKERS FOR PAINFUL INTERVERTEBRAL DISCS AND METHODS OF USE THEREOF U.S. Patent Publication No. 2011 0087087 filed Oct. 14 2009 and titled MR SPECTROSCOPYSYSTEM AND METHOD FOR DIAGNOSING PAINFUL AND NON PAINFUL INTERVERTEBRAL DISCS International Patent Publication No. WO 2011 047197 filed Oct. 14 2010 and titled MR SPECTROSCOPY SYSTEM AND METHOD FOR DIAGNOSING PAINFUL AND NON PAINFUL INTERVERTEBRAL DISCS and U.S. patent application Ser. No. 13 830 632 filed Mar. 14 2013 and titled SYSTEMS AND METHODS FOR AUTOMATED VOXELATION OF REGIONS OF INTEREST FOR MAGNETIC RESONANCE SPECTROSCOPY.

This disclosure relates to systems processors devices and methods for measuring chemical constituents in tissue for diagnosing medical conditions. More specifically it relates to systems pulse sequences signal and diagnostic processors diagnostic displays and related methods using novel application of nuclear magnetic resonance including magnetic resonance spectroscopy for diagnosing pain such as low back pain associated with degenerative disc disease.

While significant effort has been directed toward improving treatments for discogenic back pain relatively little has been done to improve the diagnosis of painful discs at least until quite recently.

Magnetic resonance imaging MRI is the primary standard of diagnostic care for back pain. An estimated ten million MRIs are done each year for spine which is the single largest category of all MRIs at an estimated 26 of all MRIs performed. MRI in the context of back pain is sensitive to changes in disc and endplate hydration and structural morphology and often yields clinically relevant diagnoses such as in setting of spondylolysthesis and disc herniations with nerve root impingement e.g. sciatica . In particular context of axial back pain MRI is principally useful for indicating degree of disc degeneration. However degree of disc degeneration has not been well correlated to pain. In one regard people free of back pain often have disc degeneration profiles similar to those of people with chronic severe axial back pain. In general not all degenerative discs are painful and not all painful discs are degenerative. Accordingly the structural information provided by standard MRI exams of the lumbar spine is not generally useful for differentiating between painful and non painful degenerative discs in the region as related to chronic severe back pain.

Accordingly a second line diagnostic exam called provocative discography PD is often performed after MRI exams in order to localize painful discs. This approach uses a needle injection of pressurized dye in awake patients in order to intentionally provoke pain. The patient s subjective reporting of pain level experienced during the injection on increasing scale of 0 10 and concordancy to usual sensation of pain is the primary diagnostic data used to determine diagnosis as a positive discogram indicating painful disc versus a negative discogram for a disc indicating it is not a source of the patient s chronic severe back pain. This has significant limitations including invasiveness pain risks of disc damage subjectivity and lack of standardization of technique. PD has been particularly challenged for high false rates alleged in various studies although recent developments in the technique and studies related thereto have alleged improved specificity of above 90 . Wolfer et al. Pain Physician 2008 11 513 538 ISSN 1533 3159 . However the significant patient morbidity of the needle based invasive procedure is non trivial as the procedure itself causes severe pain and further compromises time from work. Furthermore in another recent study PD was shown to cause significant adverse effects to long term disc health including significantly accelerating disc degeneration and herniation rates on the lateral side of needle puncture . Carragee et al. SPINE Volume 34 Number 21 pp. 2338 2345 2009 . Controversies around PD remain and in many regards are only growing despite the on going prevalence of the invasive painful subjective harmful approach as the secondary standard of care following MRI. PD is performed an estimated 400 000 times annually world wide at an estimated total economic cost that exceeds 750 Million annually. The need for a non invasive painless objective non significant risk more efficient and cost effective test to locate painful intervertebral discs of chronic severe low back pain patients is urgent and growing.

A non invasive radiographic technique to accurately differentiate between discs that are painful and non painful may offer significant guidance in directing treatments and developing an evidence based approach to the care of patients with lumbar degenerative disc disease DDD .

Magnetic resonance spectroscopy MRS and related applications and post processing techniques have been previously described. This includes more recently in relation to intervertebral discs and certain diagnostic applications related to medical conditions such as degenerative disc disease and discogenic low back pain. However such prior efforts and disclosures despite their alleged benefits have nonetheless left open certain remaining needs and opportunities for valuable new improvements still yet to be provided.

A need and opportunity still remain for improved MRS acquisition and or post processing approaches for providing robust spectra representative of chemical environments of tissues being analyzed. In particular such a need and opportunity exists to reduce risk of artifact contribution that might confound chemical analysis of the tissue based upon processed MRS spectral data.

A need and opportunity also still remain for improved MRS approaches for disc tissue analysis and diagnosis such as for example for assisting in the diagnosis of degenerative disc disease and or discogenic low back pain.

One aspect of the present disclosure is an MRS post processor providing enhanced frequency shift artifact correction in signal post processing of acquired MRS data from tissue.

One aspect of the present disclosure is a MRS pulse sequence configured to generate and acquire a diagnostically useful MRS spectrum from a voxel located principally within an intervertebral disc of a patient.

Another aspect of the present disclosure is an MRS signal processor that is configured to select a sub set of multiple channel acquisitions received contemporaneously from multiple parallel acquisition channels respectively of a multi channel detector assembly during a repetitive frame MRS pulse sequence series conducted on a region of interest within a body of a subject.

Another aspect of the present disclosure is an MRS signal processor comprising a phase shift corrector configured to recognize and correct phase shifting within a repetitive multi frame acquisition series acquired by a multi channel detector assembly during an MRS pulse sequence series conducted on a region of interest within a body of a subject.

Another aspect of the present disclosure is a MRS signal processor comprising a frequency shift corrector configured to recognize and correct frequency shifting between multiple acquisition frames of a repetitive multi frame acquisition series acquired within an acquisition detector channel of a multi channel detector assembly during a MRS pulse sequence series conducted on a region of interest within a body of a subject.

According to one mode of this aspect the frequency shift corrector comprises a frequency shift estimator configured to estimate a frequency shift error for the frames among the series and a frequency shift corrector that corrects the frequency shift error based upon the frequency shift estimation for the frames.

According to one embodiment of this mode the frequency shift estimator is configured to estimate the frequency shift error of the MRS data for the frames in the time domain. According to another embodiment the frequency shift estimator is configured to estimate the frequency shift error of the MRS data for the frames in the frequency domain. According to another embodiment the frequency shift corrector is configured to correct in the time domain the frequency shift error estimated by the frequency shift estimator. According to another embodiment the frequency shift corrector is configured to correct in the frequency domain the frequency shift error estimated by the frequency shift estimator. According to another embodiment both the frequency shift estimator is configured to estimate the frequency shift error and the frequency shift corrector is configured to correct the frequency shift error in the time domain. According to another embodiment both the frequency shift estimator is configured to estimate the frequency shift error and the frequency shift corrector is configured to correct the frequency shift error in the frequency domain. According to another embodiment the frequency shift estimator is configured to estimate the frequency shift error in the time domain and the frequency shift corrector is configured to correct the frequency shift error in the frequency domain. According to another embodiment the frequency shift estimator is configured to estimate the frequency shift error in the frequency domain and the frequency shift corrector is configured to correct the frequency shift error in the time domain.

According to another embodiment the frequency shift estimator is configured to estimate the frequency shift by comparing each frame with a reference by means of spectral cross correlation. In one further embodiment the reference is derived from multiple frames.

Another aspect of the present disclosure is a MRS signal processor comprising a frame editor configured to recognize at least one poor quality acquisition frame as determined against at least one threshold criterion within an acquisition channel of a repetitive multi frame acquisition series received from a multi channel detector assembly during a MRS pulse sequence series conducted on a region of interest within a body of a subject.

According to one mode of this aspect the frame editor is further configured to exclude said frames so recognized as poor relative quality from the multi frame acquisition series for further processing by one or more additional signal processors. According to one embodiment of this mode the further processing comprises frequency shift correction by a frequency shift corrector.

According to another mode of this aspect the frame editor comprises a water peak confidence estimator configured to estimate a level or degree of confidence in identifying a water peak signal in the spectral frame and a water confidence threshold criterion. The frame editor is further configured to recognize and exclude frames from the series having an estimated degree of confidence for the water peak that do not meet the threshold criteria. According to one embodiment the degree of confidence is estimated as a percent confidence level on a scale from 0 to 100. According to a further embodiment the threshold criterion comprises at least about 70 percent confidence. According to another embodiment the threshold criterion comprises at least about 90 percent confidence. According to another embodiment the degree of confidence is based at least in part upon an amplitude of the water signal. According to another embodiment the degree of confidence is based at least in part upon a full width half max amplitude FWHM measurement of the water signal.

According to another mode of this aspect the frame editor comprises a full width half maximum FWHM test module which comprises a FWHM measurement of the water peak and a FWHM measurement threshold criterion. The frame editor is further configured to recognize and exclude frames from the series having a computed FWHM of the water peak that exceeds the threshold criteria.

According to another mode of this aspect the frame editor comprises a frequency error test module comprising a frequency error measurement of the water peak and a frequency error threshold criterion. The frequency error is the difference between the computed location of the water peak maximum peak of the spectrum and the defined location of the water peak DC . The editor is further configured to recognize and exclude frames from the series having a frequency error that exceeds the threshold criteria.

Another aspect of the present disclosure is an MRS signal processor that comprises an apodizer to reduce the truncation effect on the sample data. The apodizer can be configured to apodize an MRS acquisition frame in the time domain otherwise generated and acquired by via an MRS aspect otherwise herein disclosed and or signal processed by one or more of the various MRS signal processor aspects also otherwise herein disclosed.

Another aspect of the present disclosure is an MRS diagnostic processor configured to process information extracted from an MRS spectrum for a region of interest in a body of a subject and to provide the processed information in a manner that is useful for diagnosing a medical condition or chemical environment associated with the region of interest.

Another aspect of the present disclosure is an MRS system comprising an MRS pulse sequence MRS signal processor and MRS diagnostic processor and which is configured to generate acquire and process an MRS spectrum representative of a region of interest in a body of a patient for providing diagnostically useful information associated with the region of interest.

Another aspect of the present disclosure is an MRS system which adjusts a spectrum in an upfield range relative to water e.g. about 4.7 ppm . According to one mode at least one region of an upfield range of less than about 3.5 ppm is adjusted based upon at least one roughly mirrored opposite range of greater than about 5.9 or 6 ppm. These may be accomplished within about 0.5 ppm. According to one embodiment the downfield range is reflected around a central line to minor the upfield range and is subtracted from the upfield range. According to one further embodiment the central line is at about water e.g. about 4.7 ppm . According to another embodiment the downfield range is further aligned following reflection for enhanced correlation between the downfield range signals and the upfield range signals. According to another embodiment the correlation between the aligned downfield and upfield regions is measured and used as a test to apply or bypass the adjustment. According to another embodiment a signal noise ratio SNR calculation of the adjusted upfield spectrum following subtraction is compared with an SNR calculation prior to the adjustment in order to determine whether to use the adjusted spectrum or discard it and retain the unadjusted spectrum According to another embodiment the correlation between the reflected and aligned downfield spectrum and the upfield spectrum ranges is used to determine and identify a degree of potential artifact in the upfield spectrum signals.

Still further aspects of the present disclosure comprise various MRS system and method aspects associated with the other MRS system sequence and processor aspects described above.

For example another such aspect comprises processing MRS data from an acquisition series conducted across first and second phase groups comprising first and second sets of acquisition frames acquired at first and second different respective phases along a phase cycle. Further to this aspect the system and method processes at least in part the first and second phase cycle groups separately. According to one mode of this aspect the separate phase group processing comprises at least one of the other processing aspects modes embodiments variations and features elsewhere herein described such as for example one or more of frequency error estimation frame editing frequency correction and phase correction. According to another mode the first and second set of acquisition frames for each phase group are combined into one phase group combined result. According to another mode the first and second phase groups are combined to provide an averaged spectral result following the separate processing. In another mode the first and second sets of each phase group are combined and then the combined phase groups are combined. Another mode comprises reducing or removing artifact separately between the phase groups. In another mode the artifact is removed by combining the phase groups after separate processing and in group frame combining. In another mode frame editing is performed on each phase group and a different number of frames are retained or conversely filtered out in each group prior to combining in group frames and the groups together.

Another aspect of the present disclosure is a method for processing a set of multiple serially acquired magnetic resonance spectroscopy MRS free induction decay FID frames from a multi frame MRS acquisition series from a region of interest ROI in a subject and for providing a post processed MRS spectrum. This method comprises 

According to one mode of this method the chosen feature value comprises a best feature value relative to a quality criterion for the value.

According to another mode the feature comprises signal noise ratio SNR of a spectral peak region of the post processed MRS spectrum.

According to another mode the feature comprises a line width of a spectral peak region of the post processed MRS spectrum.

According to one embodiment of this mode the line width comprises a full width half max FWHM measurement of a spectral peak region of the post processed MRS spectrum.

According to another mode the feature comprises signal noise ratio SNR or full width half max FWHM of a spectral peak region of the post processed MRS spectrum and the spectral peak region comprises at least one of a water region and a second region that is different than the water region and corresponding with a chemical of interest for the MRS acquisition.

According to one embodiment of this mode the second region corresponds with an n acetyl acetate NAA chemical bond.

According to another mode the processing step comprises frame editing by comparing a quality value for a quality of each frame against a threshold value for the quality and determining if the frame is qualified and included or unqualified and excluded in the set for further processing and the parameter comprises the threshold value such the multiple parameter values comprise multiple threshold values and such that varying the multiple threshold values corresponds with varying the frames which are qualified and included or unqualified and excluded from the set for further processing in providing the post processed MRS spectrum.

According to one further embodiment the quality comprises a confidence estimating a water peak location.

According to another further embodiment the quality comprises a frequency error of a water peak location relative to a reference frequency.

According to another further embodiment the quality comprises a full width half max FWHM of a water peak.

According to another mode the processing step comprises frame editing by comparing a quality value for a quality of each frame against a threshold value for the quality and determining if the frame is qualified and included or unqualified and excluded in the set for further processing and also comprises bypassing frame editing if a number of qualified frames is below a threshold number and the parameter comprises the threshold number.

Another mode comprises dynamically varying multiple said parameters of the processing step between multiple said parameter values according to a multi variate matrix comprising multiple combinations of the varied parameter values for each said parameter performing the step on the set at each combination of parameter values and providing said multiple processed results respectively comprising said multiple respective feature values respectively determining the chosen feature value among the multiple feature values based upon the comparison and corresponding to a chosen combination and providing the post processed MRS spectrum by running the step on the set with the multiple parameters assigned to the chosen combination of respective parameter values.

According to one embodiment of this mode the multiple parameters comprise multiple frame editing criteria for qualifying and including or unqualifying and excluding frames from the set for further processing steps to provide the post processed MRS spectrum.

Another aspect of the present disclosure is also a method for processing a set of multiple serially acquired magnetic resonance spectroscopy MRS free induction decay FID frames from a multi frame MRS acquisition series from a region of interest ROI in a subject and for providing a post processed MRS spectrum. The method according to this aspect comprises 

According to one mode of this aspect the identified feature comprises a downfield peak region of the downfield region.

According to another mode the comparison comprises comparing the downfield peak region against an upfield peak region of an upfield region of the spectrum located along a smaller ppm range than a water peak location.

According to another mode the processing operation comprises adjusting the upfield region based on the comparison.

According to one embodiment of this mode the adjusting comprises reducing at least a portion of the upfield region by a subtraction operation based upon the comparison.

According to another mode the comparison comprises mapping a reflection of the downfield region around a center line against the upfield region.

According to one embodiment of this mode the center line is located at about the water peak location.

According to another embodiment the comparison further comprises adjusting the center line to an offset relative to the water peak location to correspond with an optimum correlation between at least a portion of the reflected downfield region and a corresponding portion of the upfield region 

Another embodiment comprises baseline correcting the reflected downfield and upfield regions respectively and subtracting the baseline corrected reflected downfield region from the baseline corrected upfield region.

According to another mode of the present aspect the processing operation comprises qualifying the post processed MRS spectrum based upon the identified feature.

Another mode comprises adjusting a water suppression parameter of the MRS acquisition based upon the comparison.

Another aspect of the present disclosure is also a method for processing a set of multiple serially acquired magnetic resonance spectroscopy MRS free induction decay FID frames from a multi frame MRS acquisition series from a region of interest ROI in a subject and for providing a post processed MRS spectrum. The method according to this aspect comprises 

One mode of this aspect comprises shifting the FID frame by the frequency shift error so as to increase coherence of the FID frame with the reference spectrum.

Another mode comprises forming the reference spectrum by averaging multiple FID frames from the acquisition series.

Another mode comprises performing an initial frequency shift error correction operation by estimating a frequency shift error for each FID frame of the series by determining a location of a water peak by locating maximum peak value in a range around an expected location for the water peak calculating a difference between the determined location and the expected location and adjusting the FID frame by the difference and averaging the respectively shifted FID frames to form the reference spectrum.

According to another mode the series comprises first and second groups of FID frames the FID frames of the first group comprise a first phase and the FID frames of the second group comprises a second phase and the determining is performed on each FID frame for each group separately from the other group.

Another mode comprises comparing the frequency shift error against a threshold value and qualifying and including or disqualifying and excluding the FID frame from the set for further processing to provide the post processed MRS spectrum based upon the comparison.

Another aspect of the present disclosure is also a method for processing a set of multiple serially acquired magnetic resonance spectroscopy MRS free induction decay FID frames from a multi frame MRS acquisition series from a region of interest ROI in a subject and for providing a post processed MRS spectrum. The method according to this aspect comprises adjusting a phase of an FID frame by a phase shift configured to reduce an extent of the absorption spectrum having a negative value.

One mode of this aspect further comprises performing at least one of a golden section search and a parabolic interpretation to compute a fast fourier transform FFT on the FID frame within an iteration loop.

Another aspect of the present disclosure is also a method for processing a set of multiple serially acquired magnetic resonance spectroscopy MRS free induction decay FID frames from a multi frame MRS acquisition series from a region of interest ROI in a subject and for providing a post processed MRS spectrum. The method according to this aspect comprises estimating a line width between two opposite walls of a water peak region of an FID frame of the series comparing the estimated line width against a threshold value and qualifying and including or disqualifying and excluding the FID frame from the set for further processing to provide the post processed MRS spectrum based at least in part upon the comparison.

According to one mode of this aspect the line width comprises a full width half max FWHM of the water peak region.

Another mode comprises calculating an average FWHM for the included FID frames comparing the average FWHM against an average threshold value and assigning a quality indicator to the post processed MRS spectrum based upon the comparison.

Another mode further comprises determining the threshold value based upon a tesla strength of an MRS system from which the MRS acquisition series was acquired.

Another aspect of the current disclosure is also a method for processing a set of multiple serially acquired magnetic resonance spectroscopy MRS free induction decay FID frames from a multi frame MRS acquisition series from a region of interest ROI in a subject and for providing a post processed MRS spectrum. The method according to this aspect comprises 

One mode of this aspect comprises performing at least one of phase shift correction frame editing and frequency shift correction separately for the first and second groups.

Another mode comprises performing the method on a number equal to N groups of FID frames the FID frames comprising similar phasing within each group but different than in other groups processing each of the N groups separately averaging the FID frames separately within each group averaging the group averages together and wherein N equals an integer more than two.

According to one embodiment of this mode the MRS acquisition series comprises a number F of FID frames the different relative phases comprise a unique number S of phase steps and F divided by S equals N wherein N comprises a whole number.

Another aspect of the present disclosure is also a method for processing a set of multiple serially acquired magnetic resonance spectroscopy MRS free induction decay FID frames from a multi frame MRS acquisition series from a region of interest ROI in a subject and for providing a post processed MRS spectrum. The method according to this aspect comprises 

One mode of this aspect also comprises determining first and second regions of the first baseline estimate to be included and excluded respectively for the polynomial fit and fitting the polynomial to only the first regions of the baseline estimate.

Another aspect of the present disclosure is a method performed according to any one of claims to using a processor.

One mode of this aspect further comprises controlling the processor to perform said one or more of said methods using a computer program stored in a non transitory computer readable medium.

Another aspect of the present disclosure comprises performing one or more of the methods elsewhere herein described wherein the ROI comprises a portion of a musculoskeletal joint.

According to another further embodiment the ROI comprises at least a portion of an intervertebral disc.

Another aspect of this disclosure comprises performing any one or more of the methods elsewhere described herein wherein said MRS acquisition series is acquired from a single voxel positioned within the ROI according to a single voxel spectroscopy pulse sequence

Another aspect of this disclosure also comprises performing any one or more of the methods elsewhere described herein wherein said MRS acquisition comprises a multi voxel spectroscopy acquisition comprising multiple said MRS acquisition series corresponding to each said voxel and performing the method on each said MRS acquisition series.

Another aspect of the present disclosure also comprises performing any one or more of the methods described elsewhere herein and further comprising providing an MRS scanner system and acquiring the MRS acquisition series using the MRS scanner system on the subject.

Another aspect of the present disclosure comprises one or more non transitory computer readable media comprising computer instructions configured to cause one or more computer processors to perform actions comprising one or more of the methods described elsewhere herein 

Another aspect of the present disclosure comprises one or more non transitory computer readable media comprising computer instructions configured to cause one or more computer processors to perform actions comprising one or more of the methods described elsewhere herein.

Another aspect of the present disclosure is a method for processing a set of multiple serially acquired magnetic resonance spectroscopy MRS free induction decay FID frames from a multi frame MRS acquisition series from a region of interest ROI in a subject and for providing a post processed MRS spectrum. The method according to this aspect comprises performing a combination of at least two of the following 

Another aspect of the present disclosure comprises one or more non transitory computer readable media comprising computer instructions configured to cause one or more computer processors to perform actions comprising one or more of the methods described elsewhere herein 

One further mode of each of the various aspects noted above and combinations therebetween comprises a magnetic resonance MR system comprising a magnet. According to one embodiment a controller is provided for controlling the magnet to conduct an MR exam of a patient. According to another further embodiment the controller is configured to run a pulse sequence to actuate the magnetic to induce a pulsatile magnetic field in an area corresponding with a patient or tissue such as according to certain pulse sequence aspects disclosed herein and or other pulse sequence embodiments as may be contemplated by one of ordinary skill to the extent consistent with this disclosure. Further to this embodiment the pulsatile magnetic field induced by the pulse sequence is configured to invoke a tissue response unique to the induced pulsatile magnetic field in a region of interest of the tissue designated for evaluation. The tissue response uniquely invoked by the induced pulsatile magnetic field generates signals along a frequency spectrum which emanate from the region of interest and are captured by an antenna receiver coil also provided in spatial relation to the region of interest. The signals of the invoked tissue response comprise unique frequency components corresponding with unique respective chemical constituents in the region of interest of the tissue. Accordingly the spectrum of frequency response components invoked in the region of interest provides MRS information related to the tissue chemistry in that region. In a further embodiment the region of interest comprises at least a portion of an intervertebral disc. In still a further embodiment a voxel is prescribed to correspond with the region of interest and used to determine where spatially the induced and acquired MRS spectrum information is to correspond.

According to another further mode of each of the various aspects noted above a non transitory computer readable medium encoded with a computer program and configured to be run by a processor is provided. According to one embodiment of this mode a processor configured to run the computer program is also provided. According to still a further embodiment the program run by the processor comprises at least one of the MRS signal processing aspects herein disclosed such as for example channel selection phase correction frame editing frequency shift correction apodization baseline correction downstream artifact correction metabolite range measurement and diagnostic interpretative processing.

Each of the foregoing aspects modes embodiments variations and features noted above and those noted elsewhere herein is considered to represent independent value for beneficial use including even if only for the purpose of providing further combination with others and whereas their various combinations and sub combinations are further contemplated aspects also of independent value for beneficial use as may be made by one of ordinary skill based upon a thorough review of this disclosure in its entirety.

Other aspects not specifically described above are also contemplated as made clear in the detailed description below. For example additional aspects of the present disclosure comprises respective methods corresponding with manufacturing and using the systems and devices described in these aspects above and in the description below as would be apparent to one of ordinary skill In addition further more detailed modes embodiments features and variations of such aspects described above and below are also herein contemplated.

This disclosure relates to the following co pending US patent applications which were previously filed and incorporated herein in their entirety by reference thereto US 2008 0039710 US 2009 00300308 US 2011 0087087 U.S. Ser. No. 12 579 371 to Peacock et al. filed Oct. 14 2009 .

This disclosure relates to the following co pending Published PCT Patent Applications which were previously filed and incorporated herein in their entirety by reference thereto WO 2006 081471 WO 2007 035906 WO 2011 047197 International Patent Application No. PCT US2010 052737 to Peacock et al. filed 14 Oct. 2010 .

Many alternative embodiments of the present aspects may be appropriate and are contemplated including as described in these detailed embodiments though also including alternatives that may not be expressly shown or described herein but as obvious variants or obviously contemplated according to one of ordinary skill based on reviewing the totality of this disclosure in combination with other available information. For example it is contemplated that features shown and described with respect to one or more particular embodiments may also be included in combination with another embodiment even though not expressly shown and described in that specific combination.

For purpose of efficiency where reference numbers may be used in the Figures they may be repeated between the Figures where they are intended to represent similar features between otherwise varied embodiments though those features may also incorporate certain differences between embodiments if and to the extent specified as such or otherwise apparent to one of ordinary skill

Various aspects of the present disclosure principally relates to a magnetic resonance spectroscopy MRS pulse sequence and or related post processing system and method. One aspect accordingly combines the detailed embodiments either individually or in combination with one or more others into an overall system. One such system and method contemplated according to one aspect of this disclosure is shown in FIG. . This approach is considered highly beneficial and includes channel selection via a channel selector phase correction via a phase corrector frame editing via a frame editor apodization via an apodizer transformation via a transformer frequency correction via a frequency corrector and combined averaging via a combiner. In addition further embodiments also include in one regard a baseline correction via a baseline corrector and in another regard reflected downfield artifact correction via another appropriately deployed corrector. An additional detailed embodiment is shown in which further illustrates the flow of MRS signal processing according to these system components and further downstream aspects applying post processed spectral results to spectral measurement and diagnostic interpretive processing as consistent with that particular embodiment. Additional particularly beneficial present embodiments of these various aspects of the present disclosure are further described in varying detail below as follows.

One aspect of the present disclosure provides an improved automatic phase correction approach for MRS signal post processing. This provides certain perceived benefits versus other approaches previously described and used in particular at least one such prior disclosure based on fitting a polynomial typically a first order or linear to the phase sequence and then determine the time zero intercept point which would be taken as the zero order phase error. The phase correction approach according to both prior disclosures and the present embodiment are configured to generally operate on the unsuppressed water FID or on the averaged set of time domain complex free induction decay FID frames.

The present phase correction approach is configured to analyze the absorption spectrum and use an optimization approach to maximize or otherwise increase the real part of the absorption spectrum. Such optimization is satisfied by relative enhancements or increases and does not require reaching a true optimum value. This automatically performs a similar function which is otherwise typically required to be done manually on MRI system consoles or other processors in post processing MRS acquired data. The optimization approach according to the specific detailed embodiment presently described is based on using a a golden section search generally described as a technique for finding the extremum minimum or maximum of a unimodal function by successively narrowing the range of values inside which the extremum is known to exist see e.g. Wikipedia description for some background and b parabolic interpolation such as available and may be used via the MATLAB function called fminbnd as may be employed by one of ordinary skill according to the unique applications described contextually hereunder. This computes an FFT on the input data within its iteration loop though it converges very rapidly. An objective function is to find the phase shift which reduces or minimizes the number of FFT bins in the absorption spectrum which have a negative value.

Other more complex objective functions may be employed and have been evaluated but generally this approach has been observed to be adequate despite its simplicity and is not significantly improved upon by more complex methods in test cases observed.

For the purpose of further illustration the algorithm and implementation are described in the header of one exemplary source code embodiment provided below.

Generally speaking the frame editing process measures characteristics of each frame a single time domain Free Induction Decay or FID signal . These characteristics are compared to thresholds. Frames that pass these tests are used to frequency correct previously phase corrected frames frames that don t pass are discarded. If an insufficient number of frames pass the criteria per an additional threshold value that may be chosen and defined then frame editing on the whole may be discarded as may be frequency correction also discarded if the quality of the retained frames are not considered enabling for robust frequency correction . These frames are eventually used in aggregate resulting spectra to provide signals of sufficient signal noise ratio SNR to enable quantification of the chemicals or metabolites represented in the signals. Frame editing removes low quality frames for the purpose of improving the SNR and ultimately improving the quantification of the metabolites. Frame editing is applied to all phase corrected frames prior to frequency correction as part of the Signal Quality Analysis block in . If there are sufficient frames left after editing then frequency correction is performed.

According to the present embodiment and as shown in further flow diagram of there are three frame editing modules or criteria 1 Full Width Half Max FWHM 2 Confidence 3 Frequency Error. Frames with FWHM values greater than a threshold value confidence lower than a threshold value or Frequency Errors greater than a threshold value are flagged to be edited or removed from further analysis. In one further more detailed embodiment these three thresholds values are set statically based upon empirical analysis of a test data set and as a result of non real time e.g. non dynamic relative to a given input signal analysis of the dependency of these thresholds on the desired output high SNR and accurate metabolite measurements. Additionally a single set of thresholds is used for all MRS data independent of system. The thresholds are generally set for intended optimization for the best expected performance over the expected range of MRS data based upon historical data reviewed. However as may also be elsewhere stated herein descriptions related to intended optimizations maximizations or minimizations of certain parameters of metrics are not absolute and are not required to be fully optimum maximum or minimum within the intended scope of the respective disclosure where such language is used. It is contemplated that actual performance may be improved or enhanced e.g. increased or decreased as a given desire may be versus other options. Moreover such performance measures even as to improvements or enhancements may not apply for every case in which the disclosed invention is put to use. The disclosed embodiments are intended to be applicable in wide use and under variable conditions and unique considerations between cases. Accordingly the various performance improvements or enhancements intended by various aspects of the presently disclosed embodiments may actually manifest as intended in some cases but not others.

The FWHM frame editing embodiment and criteria measurement quantifies a spectral peak. More specifically an example of FWHM is illustrated by reference to which is generally well understood in the art though shown here as similarly illustrated in the commercial MR scanner manual available from Siemens Corporation SIEMENS MR Spectroscopy Operator Manual Version syngo MR 2002B . shows spectral analysis measurements incorporated into this present embodiment which measures the FWHM of the water signal wherein by reference to the Figure 

According to one present embodiment if the water FWHM is greater than a threshold value then the frame is flagged to be removed edited from the channel. This editing step is designed to edit out relatively wide water signals as such width has been observed to vary over the course of a multi frame acquisition series. Such wider water signals may at certain times provide tails which can shroud adjacent chemical metabolite peak regions of interest and have been observed to respond unfavorably to water suppression techniques in particular at certain times resulting in side lobe artifacts. This frame editing approach is thus configured in order to prevent such energy in the wide water signals from compromising other metabolite bands. The approach of this embodiment looks in a band around the water signal for the peak finds the two half height points on either side of the peak and computes the width at these points.

One example of this measurement taken across one illustrative multi frame acquisition series is shown in . Here an editing criteria threshold value of about 30 is provided for illustration. This example and others shown below in further illustration of the present frame editing embodiments is illustrative of a single voxel spectroscopy SVS acquisition from an intervertebral disc in the lumbar spine of a human subject acquired via a 3 T MR system and method. The exemplary threshold value of about 30 has been observed to appropriately represent a transition between generally acceptable and typically compromised spectra in a clinical test population evaluated via similar SVS acquisitions in discs.

Additional comparative examples are shown in and respectively for two alternative embodiments featured in relation to another additional test case also for a 3 T SVS acquisition in a lumbar disc.

More specifically show various aspects of one embodiment applying a FWHM threshold criterion of 50. As shown by the FWHM plot along the multi frame SVS acquisition series in the FWHM measurement becomes regularly compromised after about 80 FID frames into the acquisition. However due to the threshold criteria set to 50 most of these compromised frames are retained as is shown in the time intensity plots for the acquisition pre and post frequency correction following frame editing according to this embodiment and FWHM threshold criteria. The resulting post processed spectrum including other post processing modules applied consistent with other aspects of this disclosure is shown in .

For illustrative comparison show similar views of the same aspects for the same SVS acquisition through the post processing aspects revealed but in this different embodiment a FWHM threshold criteria of 20 is applied. The result captures for selective editing removal many more of the compromised frames with widened FWHM which exceed the threshold criteria of 20 as occur beyond the 80frame than in the previous embodiment. This different result is further shown in comparing the time intensity plots of the frame data taken pre and post frame editing and frequency correction. The fully post processed spectrum resulting according to this embodiment and similar additional post processing as according to the immediate preceding embodiment is shown in . This shows higher peak value and narrower more coherent line width for the n acetyl NAA peak region around 2 ppm along the chemical shift CS spectrum versus the prior embodiment applying the higher FWHM threshold criteria to the same input data and otherwise common post processing approaches between embodiments.

The confidence interval is a tool used to signify the reliability of an estimate in a statistical analysis. The interval is the range in a sample distribution between which it is expected that the population value will lie given the particular degree of confidence. The confidence interval value CIV for a frame reflects the confidence that the water spectral line for that frame can be identified from surrounding spectral lines. This is done by characterizing the energy area under the curve of the water line with respect to the region where the water line is expected.

The CIV measurement starts with determining the FWHM of the spectral peak assumed to be water in the center of a region. The bins unit of integration within the FWHM of the water spectral line define the water line energy. The number of bins in the region surrounding and including the water signal greater than bins within the FWHM is counted. The CIV is the number of bins within the water line divided by this difference and ranges between 0 and 1. More specifically the CIV is calculated according to the following formula CIV Water line energy Total energy in region Water line energy

As applied according to the present embodiment frames with relatively little energy outside the FWHM of the water line have a higher confidence than frames with relatively more energy outside this range.

A comparative example demonstrating the beneficial impact of applying such a CIV threshold criteria for frame editing is provided as follows.

For comparison the same acquisition series illustrated in is also illustrated in similar views in . However these figures illustrate an alternative processing embodiment wherein the confidence interval CIV threshold is set to 1 vs. 0.5 according to the immediately preceding embodiment . As shown in the confidence plot in the vast majority of the later frames with compromised confidence drop below the 1 CIV threshold after the 80frame. These are thus flagged and edited with far fewer frames retained as revealed in the time intensity plot post frame editing shown in vs. prior to frame editing as shown again in . The final post processed spectrum according to this embodiment is shown in and reveals are more coherent NAA peak with narrowed line width in the CS region of 2 versus the spectrum shown in for the same acquisition but processed according to that preceding embodiment with the different and more forgiving CIV threshold criteria.

The frequency error is the absolute value of the difference between where the water signal peak is located along the chemical shift spectrum and where it should be. If this difference is large then energy from the water signal can leak into and distort the metabolite peak regions of interest and ultimately compromise robustness of the metabolic spectral range and corresponding diagnostic interpretation. Leakage is due to the finite water suppression bandwidth. Frames that exceed maximum frequency error threshold criteria are flagged for removal from the series for further processing. Frames that do not exceed the maximum frequency error threshold are retained and subsequently frequency corrected to improve coherence Frequency Correction . As with other criteria however if insufficient frames are retained via this criteria then according to one embodiment all frames may instead be retained and frequency correction is aborted in the overall processing regimen. However due to the poor signal quality according to this applied criterion the result may be flagged as potentially compromised.

Another aspect of the present disclosure provides a novel approach for optimizing frame editing criteria. This embodiment proposes enhancement to the otherwise static empirically derived approach described above by providing an approach that sets the frame editing thresholds described dynamically in real time based upon optimizing results for a given input signal. This provides the ability to optimize the frame editing to achieve the highest SNR and best quantification of the metabolites for each input series. Moreover the optimization criteria may be but do not have to be limited to SNR.

The table below lists the range of thresholds used for optimization. The notation that defines the values is of the format Start Increment Stop. The Confidence Threshold for example takes on 3 values 0.5 0.6 and 0.7.

The result of these tests would be a 3 5 4 7 matrix space. The optimization search would then be to find the set of thresholds that maximized the desired metric SNR for example.

Another aspect of the present disclosure is an improved approach for frequency error correction in MRS spectral signal post processing. The following describes the processing flow and functions performed by the MRS post processor to effect robust frequency error correction according to this present embodiment.

A primary purpose of frequency error correction is to reverse frequency shifts which occur on a frame to frame basis such as for example as may occur due to subject movement or to Bvariations resulting from subject respiration. Static frequency errors also occur if the MRI system was not set to correctly center the water signal to zero at the start of the series acquisition. A primary objective of post processing frequency correction is that the residual water signal be positioned at d.c. or 0 Hz in the spectrum for each frame. When the appropriately centered frames are combined by averaging the metabolite signal components will be aligned in frequency and phase and will therefore sum coherently or coherent averaging. This coherent summation post frequency correction will often result in increased metabolite peak height and narrower linewidths. This approach minimizes signal loss due to non coherent averaging and linewidth spread due to frequency error artifact. As the noise component is more random relative to the signal component in the frame spectra the frequency alignment increases the signal without similar increase in noise thus also having the result of increased signal noise ratio SNR .

The approach of the present embodiment is described in further detail as follows. First the MRS multi frame acquisition series is prepared for frequency correction such as for example employing one or more or all of the following phase correction channel selection frame selection zero padding and apodization. Frequency error is then estimated to determine the frequency error for each frame. Frequency correction is then conducted to apply a correction to negate the frequency error. Coherent averaging is then conducted of the complex frequency corrected frames thus computing the final composite spectrum as coherently adjusted according to this novel method.

More detailed frequency estimation embodiments are described as follows. One embodiment for estimating the frequency error operates on the discrete Fourier transform absorption spectrum of each frame to determine the frequency bin representing the peak of the residual water signal. The analysis is limited to a parameter specified range around the zero frequency point or center bin. For one exemplary embodiment configured to work with MRS data acquired via a 3 T MR system this range corresponds to plus and minus about 50 Hz.

In addition to determining the peak frequency of the residual water signal several signal quality and reliability estimations are made which are used in the frame selection process to determine if the frequency error estimate is of sufficient reliability to be applied. These measures include a numerical confidence and an estimate of the linewidth defined as the full width at half amplitude in Hz both of the water signal observed. The result of the frequency error estimation process is a vector of error estimates in Hz corresponding to each FID or MRS frame.

The confidence measure according to the foregoing is computed according to another more detailed illustrative embodiment as follows. The discrete amplitude spectrum is analyzed in the range of the center tuned frequency plus and minus a threshold value such as for example about 40 Hz which may be appropriate in the case of data acquired via a 3 T system and about half that for example with respect to data acquired via a 1.5 T system . The highest peak is located within the range and its width at the half amplitude point is determined. Next the total spectral width of all parts of the spectrum which exceed the half amplitude point of the highest peak is determined. The confidence estimate is made by taking the ratio of the spectral width of the greatest peak divided by the total spectral width which exceeds the threshold. If there is only a single peak above the threshold the confidence estimate will be 1.0. As a number of peaks or spectral components which could be confused with the greatest one increases then the estimate will be reduced accordingly toward approaching 0.0. This provides a simple and robust estimate of the randomness or dispersal of energy in the vicinity of the water peak. Like an entropy measure it has the desirable characteristic that its performance is generally invariant with amplitude.

An alternative approach believed to offer potentially improved performance in particular in cases of relatively lower water signals in spectra is based on spectral correlation. According to this approach a complex cross correlation sequence is computed of the complex apodized discrete fourier transform DFT of each FID and a reference spectrum. The reference spectrum can be that of one of the individual FIDs or the averaged spectrum of multiple FIDs. The process uses the information inherent in all the spectral components which are common and coherent between the test spectrum and the reference to determine the spectral alignment of the two spectra. This is indicated by the location of the peak of a cross correlation coefficient. One advantage contemplated for this embodiment such as in some cases versus the spectral analysis approach described above is that in the case of closely located coherent spectral artifact signals which has been observed in some acquired spectral examples this approach uses this artifact signal to advantage rather than it being disruptive as with spectral analysis. More specifically the spectral analysis approach above may confuse the artifact with the water signal decreasing confidence level. This alternative approach benefits from all correlating signals. The correlation method may also offer greater sensitivity than the spectral analysis method in certain cases as the preceding approach exploits only the residual water signal. For example given sufficiently strong metabolite signals the current embodiment of spectral correlation could be used with complete water suppression. It is to be appreciated however that in relatively low metabolite SNR examples such as small voxels such metabolite signals may not be sufficient to provide this advantage in some circumstances such that the water based spectral analysis approach may be equivalent or even improved in some cases . An additional advantage of the present embodiment however is that the correlation peaks are better behaved than spectral peaks of residual water in the presence of artifact making peak analysis more precise. The result of this process is provided in the same format as for the spectral estimate approach.

Given the frequency error estimates for each frame such as determined by the frequency error estimate approaches described above the correction is then applied to the data. This is done according to one present embodiment in the time domain.

According to another more detailed embodiment this is done by multiplying complex FID data by a linear complex phase function of unity amplitude representing the negative of the frequency error. This is a function for which the phase increments by 2 ferrHz Fs for each sample where ferrrHz is the frequency error in Hz and Fs is the sample rate in samples per second. This has the effect of rotating the spectrum such that the measured water peak will be shifted to the zero or d.c. location. This linear function also has effect of performing a first order phase correction across the spectrum. This frequency correction operation is applied to the frames of each acquisition coil channel which are to be combined.

As previously described it is further contemplated that frequency error correction can also be conducted in the frequency domain simply by shifting the spectra by the appropriate bins to coherently align them e.g. via the water peak per estimate of the bins represented by the shift error from the center point for each FID .

Frame averaging is performed on coherently aligned FID frames per the foregoing approaches. This is done according to another present embodiment in the time domain and may be accomplished by simply averaging the selected complex frame data for each FID. This is performed for the FIDs collected from each of the channels which are to be combined. It is further contemplated according to still further embodiments that this could also be well performed in the frequency domain though the time domain approach has been observed to be more efficient in many cases.

For example another such aspect comprises processing MRS data from an acquisition series conducted across first and second phase groups comprising first and second sets of acquisition frames acquired at first and second different respective phases along a phase cycle. Further to this aspect the system and method processes at least in part the first and second phase cycle groups separately. According to one mode of this aspect the separate phase group processing comprises at least one of the other processing aspects modes embodiments variations and features elsewhere herein described such as for example one or more of frequency error estimation frame editing frequency correction and phase correction. According to another mode the first and second set of acquisition frames for each phase group are combined into one phase group combined result. According to another mode the first and second phase groups are combined to provide an averaged spectral result following the separate processing. In another mode the first and second sets of each phase group are combined e.g. averaged and then the combined phase groups are combined e.g. averaged . Another mode comprises reducing or removing artifact separately between the phase groups. In another mode the artifact is removed by combining the phase groups after separate processing and in group frame combining. In another mode frame editing is performed on each phase group and a different number of frames are retained or conversely filtered out in each group prior to combining in group frames and the groups together.

Another aspect provides an MRS acquisition data set in separate phase cycle groups and a process which is performed on each phase cycle group independently of the other. According to one mode of this aspect the phase of certain excitation pulses in the pulse sequence are changed such that unwanted coherences will have different phases when the signal is acquired and while desired coherences will have the same phase. This is so that when the frames are combined the artifact signals cancel and intended signals combine constructively. It is to be appreciated that such phase step cycling could be transparent to post processors and still achieve sufficiently adequate results in many circumstances. It is also appreciated however that certain benefits may also be provided by integrating phase cycle grouping into post processing such as for example to mitigate degradation of results due to artifact. According to one example embodiment for illustration a processing approach using frame editing may result in fewer frames in one phase cycle group than in the other versus matching them as typically intended for equally weighted averaging. By processing the frames as one overall group without regard to phase cycle grouping the group with more frames would have a higher weighted contribution to the averaged result. This may result in a phase bias in the result with regards to unwanted signal qualities e.g. artifact intended to be removed by the very purpose of the phase cycling. By treating the phase cycle groups separately and averaging them separately their respectively averaged results contribute equal weighting to then thereafter averaging those interim results together. In addition other processing operations such as spectral correlation may not perform as well when attempting to cross correlate FID frames of separate phase cycle groups due to their respective phase differences vs. within the same phase cycle groups first.

The MRS acquisitions are typically collected on multiple channels representing the signals acquired from a multi coil antenna detector array. Zero order phase alignment and frequency correction with or without frame editing will have been performed for each channel though channel selection may have been employed to reduce the channels from all which acquired signals to only those determined to be the strongest per other embodiments contemplated . The remaining step is to combine the composite FIDs from each channel retained. This may be performed according to one approach by merely combining them into one composite average. This may suitably approach optimal results when combining channels of similar SNR. Alternatively this may be done using a maximal ratio combining approach such as often employed for multi channel radio frequency signals in communications technology. According to one illustrative detailed embodiment considered particularly beneficial the channel weighting factors used are based on the total power in each retained channel after apodization.

Another aspect of the present disclosure relates to signal components induced MRS spectra downfield of the water signal in the spectra. This is described by way of various particular embodiments below including by reference to certain Examples 1 4 and corresponding Figures by reference thereto. Such induced downfield signals when present have been observed to co exist with similarly located signals mirrored in the upfield side of the water signal. When present the locations of certain of these downfield signals have been observed with appreciable regularity to roughly minor the locations of metabolite ranges of interest upfield of water. This is particularly observed at downfield regions roughly mirroring peak locations opposite the water reference or center line corresponding with at least one of n acetyl NAA e.g. 1.9 2.3 mirrored location lactic acid alanine LAAL e.g. 1 1.5 and lipid e.g. 0.5 1.5 chemical regions along the spectrum. When these downfield signals are generated they also correspond quite regularly with similarly shaped peaks generated at these respectively mirrored locations.

An exception is found in relatively discrete down field peaks that are often generated more closely downfield of water e.g. 4.7 6.1 ppm in the CS spectrum. These induced peaks closely downfield of water have not been observed to correspond with mirrored peak signals on the corresponding closely upfield side of water e.g. 3.3 4.7 ppm . It is believed that this closely downfield peak when present may correspond with one or more MRS chemical signatures unique to that location e.g. uptake of certain pain medications may manifest in such peaks .

It is believed based on scientific theory and also certain supporting observations including via observations in clinical test data that these downfield signals and corresponding mirrored upfield signals around water e.g. beyond about 6 or 6.1 ppm and below about 3.3 ppm respectively in CS spectrum may comprise side lobes induced by applying water suppression during an applied MRS pulse sequence to and related MRS signal acquisition from a prescribed tissue region of interest in a patient. This would support the roughly symmetrically mirrored and similarly shaped signals on each side of water center line. Because no appreciable chemical or metabolite signals are expected to be generated in this downfield range the signals observed there are considered to be the downfield components of such artifact. Often the corresponding upfield peaks generated in the metabolite regions of interest have more power than these mirrored downfield peaks. However these upfield regions are expected to comprise real discrete chemical peaks known to correspond with the chemical constituents noted when in tissue and so are expected to be additive between real signal when present and the reflected artifact noted.

According to the foregoing this present aspect of the disclosure uses spectral peak artifacts induced in the downfield CS spectrum as a basis by which to adjust the upfield spectrum in a corresponding range roughly mirrored around the water peak location about 4.7 . This is done to remove suspected contributions of similarly mirrored artifact components from real induced chemical signal peak components that may be collocated in this upfield range. This is generally done by subtracting the power along the downfield range from the corresponding mirrored upfield range as further described below. According to one mode the downfield range contemplated is from about 6 or 6.1 ppm and beyond and the upfield range is from about 3.3 ppm and below for this adjustment.

Accordingly one current embodiment captures the downfield signal inverts it around an axis e.g. water to align it against the upfield spectrum and subtracts the inverted downfield spectrum from the upfield spectrum to provide a resulting downfield adjusted spectrum in the upfield range. It is further recognized that the mirroring effect of the downfield artifact signals may not be exactly perfectly symmetrical in all cases and so simple inversion around the water axis may not result in exact corresponding alignment between the inverted downfield artifact peaks and the upfield peaks. Among other reasons side lobes arising from water suppression anomalies would not necessarily be perfectly symmetrical especially via water suppression conducted via a fixed range around 4.7 ppm in the setting of an actual water signal that may not exist exactly at 4.7 or vary about it between frames due to frequency shift and or other anomalous influences . Accordingly the alignment of the reflected downfield spectrum with the upfield spectrum may be further adjusted to better align the peaks to the extent resulting in enhanced correlation and more robust expected spectral results arising from the artificial subtraction step imparted on the originally induced spectrum.

The foregoing general description is further developed in finer detail according to the additional exemplary embodiments as follows 

More specifically downfield generally referring to chemical shift values greater than water nominally 4.7 PPM artifact spectral peak signals believed to be related to water suppression has been observed in some of the clinically acquired MRS data and observed to also correlate to similar artifact signals quasi symmetrically located on opposite up field side of water in range of interest for metabolite signal regions. In particular downfield peaks have been observed quasi symmetrically around water to correspond with proteoglycan PG and lactic acid alanine LAAL related regions of diagnostic interest among other regions as elsewhere noted herein . The purpose of the following examples is to uniquely reflect observed downfield artifact into up field metabolite regions and artificially apply innovative solutions to reverse and correct for this in spectral presentation and or analysis for diagnostic purposes.

Adjustment of the up field artifacts by the down field spectral components believed to be symmetrically reflected as embedded in the upfield spectral range is conducted according to the following steps with the adjustment process illustrated using plots for four exemplary disc studies further described below 

Coarse alignment of upfield and downfield spectra is performed according to one embodiment as follows. The location of the water peak is determined. This is typically the maximum peak value in the spectrum and should be located in a DC centered spectrum at or at least very near bin e.g. when using 2048 point FFTs . All plots shown are in terms of Chemical Shift in PPM. Water corresponds roughly to a chemical shift of 4.707. If the peak is not at DC then the entire spectrum is circularly rotated so that the peak is located at DC. shows a chemical shift spectrum and its minor using water as the line of symmetry. This example shows that the computed water peak is one bin to the left of water. The minor is then one bin to the right of water. shows the input spectrum representing an initial stage of processing a first Example 1 spectrum. The input spectrum shown is post processed according to various embodiments herein shown and described but without baseline correction and pre downfield artifact correction according to the current embodiments.

Next the original and mirrored spectra are more finely aligned. This is because the location of down field and up field spectral components are not always exactly symmetric about water though it is believed that where significant peak correlation results from fine tuning of the alignment such step is supported as reasonable. Such fine alignment is done according to the particular present embodiment by correlating the spectral components in the chemical shift range 3.2 0.5 . show the fine aligned full and zoomed spectra respectively. Specifically noted by reference to that figure the edges of the water suppression artifacts are in alignment. In this illustrative example of the spectral components are aligned when the mirrored spectra is shifted 44 bins to the right. Only the mirrored spectrum is shifted so that we do not change the location of the up field components as they are correctly located and aligned to water.

Baseline correction is an optional step taken in the present embodiment prior to adjustment of the up field spectral components via reflected downfield signal subtraction. The baseline correction algorithm operates only on the metabolite range of interest up field of water. A polynomial is used to fit data in the metabolite range. This method will not generally work on the entire spectra though only ranges of interest need be worked upon in any event. Baseline correction is done separately on the up field and mirrored down field spectra mirrored to the same metabolic range . shows the baseline corrected spectra only done on up field spectral components and shows the baseline correction of the mirrored down field spectra.

At this point the down field spectral components are aligned with the up field components and we have baseline corrected versions of both the up and down field spectra. Adjustment is accomplished by subtracting mirrored downfield spectra from the up field except in the up field range corresponding to the down field component in the Chemical Shift range from about 4.7 to about 6 or 6.1 PPM. What follow are plots of the spectral components and correction using the baseline and non baseline corrected spectra.

Further examples are similarly illustrated in and A C respectively for three additional clinical test cases involving 3 T acquisitions from other discs at other lumbar levels in other subject exams.

Spectral results are evaluated by plotting the adjusted up field spectrum in the range of metabolic interest PPM and generally limiting the Y axis values to provide optimal observation between e.g. 10 of the maximum and minimum in the defined range. Comparison is then made vs. final post processed spectra without the downfield subtraction to understand possible contribution of the artifact being evaluated and general spectral quality analysis e.g. SNR . Metrics such as comparison of resulting SNR of signal region of interest pre vs. post adjustment or correlation measurement of the reflected aligned downfield signals with the upfield signals may also be used according to further embodiments to then determine whether the adjusted result or non adjusted result should be used.

It is also appreciated that measurement data of downfield artifact signal may be subtracted from upfield metabolic ranges of interest vs. performing spectral adjustments. This may relate to the same alignment approaches as above for spectral adjustment but simply not change the shape of the spectrum but rather simply adjust the spectral measurements to account for estimated downfield reflected artifact contribution. Among other benefits of this approach this does not require a step change in the resulting spectrum at the edge s where subtraction is used versus not used.

This data subtraction approach may be conducted as follows. Similar range alignment approaches may be used as with spectral subtraction adjustment approach above. However then this is merely used to determine ranges of up field and reflected downfield artifact measurements to take for subtraction adjustment. This may involve measuring peak and or areas under the curve AUC for metabolic regions of interest and reflected similar ranges on downfield side of water e.g. other side of 4.7 or as reflected and aligned either coarse or finely . Then the values for downfield ranges are subtracted from aligned upfield ranges providing corrected measurements. This may also be evaluated versus upfield ranges measured prior to correction to determine artifact contribution.

The robust basis and approach for reflected downfield artifact correction in upfield signal ranges of MRS spectra is supported by way of this description and illustrative examples shown. It is also appreciated that this may be further developed through refinements over larger sample sizes of data. In particular custom variations may be employed to address certain particular types of reflected artifact signals observed and establish criteria by which to either use different approaches and or whether to use an adjusted spectrum or measurement or not in particular cases.

Subtracting reflected downfield signals from upfield metabolite range of interest is done according to the present embodiments principally based upon the presumed principles that that downfield signal is in fact artifact which is mirrored into the upfield range at the place where reflected downfield is aligned for subtraction. Accordingly if minoring of the input spectrum for downfield correction is not appropriately aligned to where real artifact is the subtraction will inappropriately adjust the upfield signal by newly induced artifact by the inappropriately conducted subtraction. Accordingly the mirrored reflection approach can be validated for proper alignment as intended which is a useful approach to take as mis alignment could confound results as stated. To validate this function a further aspect of the present disclosure provides validation approach that comprises a simple test vector that is submitted to the operation for its mirror image to be examined. The test vector is designed to simulate an input signal and which may be for example the real part of a complex spectrum.

One particular example of such a validation is provided herein as follows. For simplicity of illustration this example simulates a 16 point real spectrum. With this signal DC is at bin 16 2 1 and there are 7 16 2 1 bins upfield from DC and 8 16 2 bins downfield from DC. As there is not the same number of upfield and downfield bins there is one odd bin the furthest downfield without a corresponding upfield bin. One issue thus presented by this approach is how to handle the odd bin. If the input vector were truly mirrored then the mirrored vector would have 7 bins downfield and 8 bins upfield of DC. This would put DC at bin . The signals would be mirrored but the DC locations would be different. Alignment of the DC points could be forced by prefixing the mirrored sequence with one bin with amplitude zero but then the test and its minor would be different lengths. The other option and the method implemented is to mirror the entire spectrum except the odd bin. The leaves the DC bins aligned and the vectors are the same length.

Another aspect of the present disclosure provides certain enhancements to an MRS pulse sequence protocol for optimally acquiring robust spectra in clinical applications and considered to be particularly beneficial in single voxel spectroscopy SVS though also applicable to multi voxel and in particular to MRS acquisitions in relatively small voxels and still more particularly in musculoskeletal joints. This is especially beneficial with respect to MRS performed in intervertebral discs and furthermore in particular in such discs of discogenic low back pain patients where MRS may be deployed for Dx purposes to help identify painful versus non painful discs.

Water varies dramatically in intervertebral discs in particular between normal healthy discs and degenerated discs. Accordingly in discogenic low back pain patients in particular a wide range of water signal power may be found including between discs of the same patients. As water is used in certain MRS analysis and processing this water variance between discs and water suppression approaches that may be uniformly appropriate can be an issue. More specifically in highly hydrated discs such as normal discs water content is obviously high. No water suppression used in MRS pulse sequence studies of such discs may result in water signal that is too strong and may overshadow the metabolite ranges of interest via tails of the water signal. In highly desiccated dehydrated degenerated discs water content is obviously low. Water suppression may remove any water signal that may exist thereby to the detriment of any processing or analysis approaches relying on water signal.

Accordingly one aspect of this disclosure provides an MRS pulse sequence exam configuration and protocol that comprises a degree of water suppression that is set to moderate suppression e.g. between full suppression and no suppression . This may be achieved for example for a third flip angle in a CHESS PRESS MRS pulse sequence of about 60 to about 120 degrees and in particular about 85 10 degrees. It is to be appreciated though that the appropriate exact settings may vary between MR system and from different vendors per different considerations in their overall operation and also specific water suppressions approaches employed. However in general such moderate suppression has been observed to be appropriate in the most cases. Nonetheless even this has been observed to be inappropriate in other cases as either too strong or too weak per the situations noted above .

According to another aspect water suppression is controlled to meet a given case. In one embodiment a disc is evaluated as to its degree of hydration. This may be done for example via review of T2 weighted imaging T2 mapping or T1rho imaging and or mapping of the disc. Based upon the degree of hydration a degree of water suppression is selected. For highly hydrated discs more aggressive suppression is selected and for less hydrated discs lower suppression is selected and set for the MRS exam configuration and protocol customized to that disc. This may be done automatically such as via a look up table correlating hydration metric to water suppression level or manually either by the same process or otherwise .

Another issue observed with water suppression is the range upon which it is applied. This may be for example 50 Hz e.g. in case of 3 T or 25 Hz e.g. in the case of 1.5 T . While such range is typically provided in default setting around an expected zero center line for water about 4.7 ppm in the CS spectrum this does not always function as intended. In particular water side lobes may result outside of that range post suppression giving rise to issues noted above with respect to such lobes providing additive artifact in other metabolite ranges of interest outside of the water suppression band. This is in particular the case where there is a wide water line resulting from an inadequate shim. A combination of a broad shim and narrow water suppression band has been observed to produce compromised spectra believed to be due to this phenomena. Many MRS pulse sequence protocols are configured and conducted using only automatic shimming. However this is based upon certain defaults that are not always sufficient in particular in the high susceptibility area of the lumbar spine for example. Observation of this in the clinical environment has been further observed to result in the issues noted above.

Another detrimental effect of the relatively narrow water suppression pulse is that it can introduce a bias error in the frequency shift estimator. The spectral shape of the water suppression pulse is typically Gaussian the spectral shape of the residual water shape is similar. When the water signal falls on the slope of the water suppression signal the spectral shape of the water is distorted and its apparent peak as sensed by the frequency shift estimator will not be its true energy peak. This effect is mitigated by the more gentle slope of a wider water suppression pulse.

According to another aspect of this disclosure an MRS pulse sequence acquisition configuration and protocol provides for a manual shim which may be a default approach for the pulse sequence or override in settings where autoshim is insufficient. This has been observed to overcome the shortcomings of the default autoshim in many lumbar disc acquisitions providing more robust results and often avoiding the interrelated issues noted with respect to wider water peaks and a fixed water suppression band.

Another aspect of this disclosure is an MRS pulse sequence acquisition configuration and protocol which provides for wider water suppression. As opposed to the typical bands noted above increasing these is believed and has been observed in certain clinical cases to provide improved results with respect to reducing water suppression side lobe artifacts though while not compromising metabolite regions of interest. According to one embodiment the water suppression band is set to more than about 50 Hz for 3 T and more than about 25 Hz for 1.5 T . In one further variation of this embodiment the band is set to no more than about 100 Hz for 3 T and no more than about 50 Hz for 1.5 T . In still a further variation it is set to about 75 Hz for 3 T or about 37.5 Hz for 1.5 T . These values are considered reached within about 10 Hz. Specifically settings of 75 Hz and 100 Hz are both expected and have both been observed in limited cases tested to provide robust resulting spectra for highly hydrated discs with strong water signal and without compromising spectral ranges of interest including preserving robust carbohydrate signal which is particularly exposed as closer to water e.g. up to about 3.5 ppm and without appreciable side lobe artifact of note.

Notwithstanding these ranges as potential limits however even these ranges can expand in certain circumstances. For example where metabolites further outside of water are not necessary for a particular measurement purpose the bandwidth can expand to ensure no water artifact while still preserving other spectral peaks further away. For example if NAA e.g. proteoglycan and or metabolites to its right e.g. hypoxia metabolites e.g. lactic acid and or alanine or lipids etc. are of interest and other data between the NAA peak region around 2 ppm and water around 4.7 ppm are not needed water suppression bandwidth can extend much wider than these limits up to a span that would compromise the NAA signal region.

While this aspect of increased water suppression band is believed to provide a robust solution in particular for disc MRS and especially lumbar a further embodiment of the present disclosure provides for an adjustable water suppression band in custom manner to accommodate a given test case. According to one further more specific embodiment the band is adjusted based upon the value of at least one parameter of the water signal such as for example peak amplitude and or FWHM of the shim result. According to another more detailed embodiment a default water suppression band setting is used for an initial acquisition sufficient to evaluate the result and determine an appropriate adjustment for the setting. This may relate to a trial and error approach around certain desired result. In still another more particular embodiment the downstream field of the spectrum is analyzed for peaks considered to be side lobe artifacts of suppression. The suppression is adjusted to a value to reduce this artifact. Other metrics such as upfield effects may also be used either alone or in combination .

Other aspects of the present disclosure provide certain new and improved systems and methods for diagnostic interpretive processing of MRS spectral information from MRS spectra that are post processed such as for example according to one or more or all of the various signal processing aspects disclosed herein from MRS pulse sequence applications and induced signal acquisitions in and from intervertebral discs respectively.

One such aspect measures one or more parameters e.g. peak height area under the curve or AUC FWHM etc. for n acetyl NAA and carbohydrate CA peak regions and computes a ratio therebetween. According to one mode of this aspect this ratio is combined with at least one additional ratio comprising such measurements for at least one of these regions and a second measurement comprising the lactic acid region LA . In one embodiment of this mode the second measurement comprises the combined lactic acid and alanine AL together LAAL region. The multiple relative ratios between these several peak regions are provided in relative context which is expected to provide diagnostic value in certain cases such as for example in diagnosing degenerative disc disease and or discogenic low back pain based there upon and via the uniquely induced MRS pulse sequence signals acquired post processed and measured such as according to the various other embodiments herein disclosed .

Another aspect of this disclosure calculates a peakiness value for the carbohydrate region which is believed to relate to degree of complex carbohydrate breakdown into constituent component molecules. This is done according to one mode by curve fitting the region and calculating a correlation coefficient therefrom. This calculated measurement may also be used either alone or in combination with other metrics in a manner useful for assisting in diagnosing disc disease or pain.

It is also appreciated that each such measured spectral feature may provide valuable information on its own and without necessarily being required to be taken in combination with other features such as per the illustrative embodiments described herein . Moreover other chemical regions may be of diagnostic interest in certain applications also either alone or in various combinations as would be apparent to one of ordinary skill.

The following reference is herein incorporated in its entirety by reference thereto Bolan Patrick J. et al. 4 Magnetic Resonance in Medicine 52 000 000 2004 .

Additional embodiments including phase step cycling of MRS serial frame data acquisition and related processing and certain combinations of various embodiments herein described are further disclosed as follows. An MRS system is configured to perform an MRS spectral acquisition with phase changes stepped along a cycle corresponding to a sub set of sequential FID frames. This is typically repeated over the course of the acquisition such that the total number F of FID frames in the acquisition divided by the number of steps S in the cycle will typically be equal to a whole number. A post processor is then configured to post process FID frames comprising similar phase steps within groups though the result of which processing may be later combined for further processing.

MRS systems will frequently employ phase cycling wherein serial acquisition frames are stepped through different phases. These are typically done by even numbers of phase groups across the acquisition series. Certain additional present embodiments that are considered advantageous although not necessary in all cases integrate frequency shift estimation subsequent correction and frame selection with phase group processing. The broad scope of the present disclosure contemplates a variety of approaches for this beneficial processing method and related systems and processors as would be apparent to one of ordinary skill.

One particular example embodiment however integrates a spectral cross correlation based frequency estimator with phase group processing and frame selection. These are integrated according to this embodiment for two primary reasons.

 1 The frames from each phase group contain artifact with different phasing. This artifact can introduce a phase group dependent bias in our frequency shift estimator. For example if one is 2 Hz and the other is 2 Hz and the correction is applied with this bias then when the frames are combined the composite spectrum will be the combination of the two shifted spectra and split peaks mat result. This is avoided by frequency adjusting the groups separately then performing an absolute frequency correction on each before combining.

 2 Frame selection can adversely interact with phase grouping. The basis of achieving artifact cancellation via phase cycling is that an equal number of frames from each phase group be combined. Frame selection can upset that balance by upsetting that equality and introducing a bias. This is avoided by having the last step be forming the mean of each phase group and then the mean of those means. A test must be performed to verify that each group is adequately represented otherwise phase groups are not processed individually and all the frames are treated as if from a single phase group.

The following describes integrating a spectral cross correlation based frequency estimator with phase group processing and frame selection. These are integrated for two primary reasons.

The frames from each phase group contain artifact with different phasing. This artifact can introduce a phase group dependent bias in our frequency shift estimator. For example if one is 2 Hz and the other is 2 Hz and the correction is applied with this bias then when the frames are combined the composite spectrum will be the combination of the two shifted spectra and split peaks mat result. This is avoided by frequency adjusting the groups separately then performing an absolute frequency correction on each before combining.

One step the first step of this illustrative embodiment is represented in the first column of and is to form the reference spectra for each phase group. Within this process a first sub step comprises frequency correcting each qualified frame by aligning the spectral peak to zero in the complex frequency domain and to form the TD and FD means for each group. The next sub step is to perform interpolated spectral peak frequency shift estimation to determine the residual frequency error. This is done using cubic spline interpolation to increase the precision of the estimate by a factor of 10 for example. This frequency error estimate is then used to correct the frequency of the TD mean for each group. Because the preceding operations may have resulted in a small phase shift a final fine grain phase adjustment is performed in the TD. The final FD reference data is formed and both the TD and DF references for each phase group are available for spectral cross correlation based frequency correction. Invoking the function makePhGrpRef.m in MATLAB the commercially available processing utility by MathWorks teaches how this is mechanized.

Another step and which is step 2 of the particular illustrative embodiment shown is represented in the second column of performs frequency correction using the spectral cross correlation method on all frames. The first sub step is to compute the complex spectral cross correlation coefficient function between each frame and its corresponding group reference. This is done for a specified number of lags which may be typically for example about 200 for data from about a 3 Tesla system sufficient to accommodate the largest frequency for example about 50 Hz shifts anticipated. Next the correlation data is evaluated to locate the peak of the real part of the complex correlation function. Cubic spline interpolation is employed to increase the precision by a factor of about 10 and the interpolated lag of the peak is expressed as a frequency shift in Hz. Next the frequency shift estimation just determined is used in performing frequency correction on the corresponding TD frame. The final step is to form the FD data for each frame in each phase group. The MATLAB functions freqAdjSC.m spectCorr.m spectCorrInterp.m and cmnFreqAdjTD.m teach how these operations are mechanized.

Another step which is step 3 in the illustrative embodiment shown is represented in the third column of and comprises forming the final spectrum by first combining the qualified frames by group in a manner to avoid introducing phase group cancellation bias due to the frame selection process. The mathematical means or averages of qualified TD frames for each phase group are formed and then the mean of these means is computed. This provides the final unless further steps are desired composite TD data from which the final chemical shift spectrum is formed by applying appropriate apodization and transforming to the FD.

To form the reference spectra for each phase group the first step according to the current illustrative embodiment is to frequency correct each qualified frame frames which have passed frame editing as selected vs. excluded frames using the peak grabbing location estimation method such as for example but not limited according to other embodiments herein disclosed . That is used to form the TD and FD means e.g. averages for each phase group. The next step is to perform interpolated spectral peak frequency shift estimation to determine the residual frequency error. This is done using cubic spline interpolation to increase the precision of the estimate by a factor of 10. This frequency error estimate is then used to correct the frequency of the TD mean for each group . Because the preceding operations may have resulted in a small phase shift a final fine grain phase adjustment is performed in the TD. The final FD reference data is formed and both the TD and DF references for each phase group are available for spectral cross correlation based frequency correction. The MATLAB function makePhGrpRef.m teaches how this is mechanized.

Frequency correction using the spectral cross correlation method is now performed on all frames. The first step is to compute the complex spectral cross correlation coefficient function between each frame and its corresponding group reference . This is done for a specified number of lags typically 200 for data from a 3 Tesla system sufficient to accommodate the largest frequency shifts anticipated. Next the correlation data is evaluated to locate the peak of the real part of the complex correlation function . Cubic spline interpolation is employed to increase the precision by a factor of 10 and the interpolated lag of the peak is expressed as a frequency shift in Hz. Next the frequency shift estimation just determined is used in performing frequency correction on the corresponding TD frame . The final step is to form the FD data for each frame in each phase group . The MATLAB functions freqAdjSC.m spectCorr.m spectCorrInterp.m and cmnFreqAdjTD.m teach how these operations are mechanized.

The final spectrum is formed by combing the qualified frames by group in a manner to avoid introducing phase group cancellation bias due to the frame selection process. The means averages of qualified TD frames for each phase group are formed and then the mean of these means is computed. This is the final composite TD data from which the final chemical shift spectrum is formed by applying appropriate apodization and transforming to the FD.

Baseline correction removes variations in the final spectral due to large macromolecules in the acquisition. Various approaches to baseline correction are contemplated as applicable with other embodiments of this disclosure though they may not be expressly herein shown or described as would be apparent to one of ordinary skill One particular beneficial embodiment however is described by reference to the following baseline correction steps.

According to one step the baseline is estimated using a ranked order filter ROF method. According to one further embodiment the ranked order filter is designed to find the local minimums of the spectra. However other settings may be used to modify the portions or features of the spectrum tracked by or impacting the ROF results.

According to another step outliers are removed from the ROF output. The output of the ROF varies slowly and is influenced by large amplitude metabolites. Adjacent points in the output of the ROF with relatively high derivatives indicate large and abrupt changes. These will often represent real chemical peak regions vs. baseline bias artifact. Accordingly to distinguish baseline offset trends from real target chemical peak offsets from baseline and thus avoid correcting to flatten and thus artificially reduce or lose real peak regions to be redrawn along a baseline objective points bounded by large amplitude metabolites and points with high derivatives are considered outliers and are removed from the ROF output. This allows the next polynomial fit step to track only on non peak offsets from a rolling baseline and thus correct only for the baseline variances while preserving the peaks rising above it. A polynomial is fit to the ROF output without the outliers. A polynomial is fit to the remaining points in the ROF. In another step the polynomial is used to compute the baseline estimate. The baseline estimate is subtracted from the pre baseline corrected spectrum to derive the final baseline corrected spectrum.

For further illustration an example is provided by reference to as follows. shows a post processed spectrum from an MRS acquisition from a lumbar disc baseline corrected using polynomial fit to an ROF incorporating all spectral data in the range including outliers .

Additional examples that illustrate various of the foregoing aspects in various combinations are provided as follows 

While certain embodiments of the disclosure have been described these embodiments have been presented by way of example only and are not intended to limit the scope of the broader aspects of the disclosure. Indeed the novel methods systems and devices described herein may be embodied in a variety of other forms. For example embodiments of one illustrated or described MRS system post processing component may be combined with embodiments of one or more illustrated or described MRS system processing components. Moreover the MRS system components described herein e.g. pulse sequence signal processor or diagnostic processor may be deployed for particular beneficial use for intervertebral discs or utilized for other purposes. For example an MRS system or component sequence signal processor or diagnostic processor useful therewith or therein may be configured and used in manners consistent with one or more broad aspects of this disclosure for diagnosing other tissue environments or conditions than pain within an intervertebral disc. Or such may be usefully employed for diagnosing pain or other tissue environments or conditions in other regions of interest within the body. Such further applications are considered within the broad scope of disclosure contemplated herein with or without further modifications omissions or additions that may be made by one of ordinary skill for a particular purpose. Furthermore various omissions substitutions and changes in the form of the methods systems and devices described herein may be made without departing from the spirit of the disclosure. Components and elements may be altered added removed or rearranged. Additionally processing steps may be altered added removed or reordered. While certain embodiments have been explicitly described other embodiments will also be apparent to those of ordinary skill in the art based on this disclosure.

In one further embodiment contemplated a computing system comprising one or more microprocessors receiving at least one signal responsive to data collected in an MR scanner is configured to implement a magnetic resonance spectroscopy MRS processing system configured to process a repetitive multi frame MRS spectral acquisition series generated and acquired for a voxel principally located within an intervertebral disc via an MRS pulse sequence and acquired at multiple parallel acquisition channels of a multi coil spine detector assembly in order to provide diagnostic information associated with the disc. According to one still further embodiment this comprises an MRS signal processor comprising a channel selector a phase shift corrector a frequency shift corrector a frame editor and a channel combiner. The system of this embodiment is configured to receive and process the MRS spectral acquisition series for the disc and to generate a processed MRS spectrum for the series with sufficient signal to noise ratio SNR to acquire information associated with identifiable features along MRS spectral regions associated with unique chemical constituents in the disc. An MRS diagnostic processor is configured to extract data from identifiable chemical regions in the processed MRS spectrum in a manner that provides diagnostic information for diagnosing a medical condition or chemical environment associated with the disc.

In another embodiment a non transitory physical computer readable medium encoded with a computer executable computer program or code is operable by a processor to run the computer program or code to cause a computing system to implement a magnetic resonance spectroscopy MRS processing system configured to process a repetitive multi frame MRS spectral acquisition series generated and acquired for a voxel prescribed to correspond with a tissue region of interest in the body of a patient. The computer program or code comprises one or more in various combinations of the processing embodiments disclosed hereunder. According to a further embodiment the voxel is principally located within an intervertebral disc via an MRS pulse sequence and acquired at multiple parallel acquisition channels of a multi coil spine detector assembly in order to provide diagnostic information associated with the disc. According to still another further embodiment the computer program or code comprises an MRS signal processor that further comprises one or more in combination of the following a channel selector a phase shift corrector a frequency shift corrector a frame editor and a channel combiner. This is configured to receive and process the MRS spectral acquisition series for the disc and to generate a processed MRS spectrum for the series with sufficient signal to noise ratio SNR to acquire information associated with identifiable features along MRS spectral regions associated with unique chemical constituents in the disc. An MRS diagnostic processor is provided under still another further embodiment and is configured to extract data from identifiable chemical regions in the processed MRS spectrum in a manner that provides diagnostic information for diagnosing a medical condition or chemical environment associated with the disc.

In another further embodiment a magnetic resonance spectroscopy MRS processing method is used for processing a repetitive multi frame MRS spectral acquisition series generated and acquired for a voxel principally located within an intervertebral disc via an MRS pulse sequence and acquired at multiple acquisition channels of a multi coil spine detector assembly and for providing diagnostic information associated with the disc. According to certain further embodiments the MRS processing method comprises one or more in combination of the other processing component embodiments disclosed hereunder. The method according to another particular embodiment comprises receiving the MRS spectral acquisition series from the multiple acquisition channels and signal processing the MRS acquisition series. The signal processing component of this method comprises selecting one or more channels among the multiple channels based upon a predetermined criteria estimating and correcting phase shift error among multiple frames within the series of a channel acquisition estimating and correcting a frequency shift error between multiple frames within the series of the channel acquisition flagging and editing out sub optimal frames from the series based upon a predetermined criteria frame selection criteria combining selected and corrected channels for a combined average processed MRS spectrum. Another method embodiment comprises adjusting spectral signal upfield of water signal by subtracting artifact derived from downfield signal components generally mirrored opposite about a water peak center line. Still further method embodiments comprise diagnostically processing the processed MRS spectrum by extracting data from identifiable chemical regions in the processed MRS spectrum and processing the extracted data in a manner that provides MRS based diagnostic information for diagnosing a medical condition or chemical environment associated with the disc.

It is further contemplated that other processing approaches known in the art may be also combined with the aspects modes and embodiments expressly shown and described hereunder such as for example eddy current correction other apodization techniques etc. Moreover other types of MRS acquisitions such as multi voxel for example may be used. Still further the processors and related methods disclosed may be embedded into the controller or processing environments of the MR systems themselves used in the acquisitions or may be stored operated and conducted remotely. For example such may be stored and or operated via a separate server either co located or remote from the MR acquisition system such as via data received electronically via the internet PACS FTP uploading or tangible physical media such as mobile hard drives or CDs DVDs. It is further contemplated that notebook computers PDAs mobile phones etc. may also provide at least in part the processing communicating and or display functions according to the present aspects modes and embodiments of this disclosure.

