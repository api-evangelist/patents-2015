---

title: Phase-optimized constant envelope transmission (POCET) method, apparatus and system
abstract: An apparatus and method for generating a composite signal includes electronics configured to modulate a carrier utilizing a finite set of composite signal phases to generate a composite signal, the finite set of composite signal phases being determined through an optimization process that minimizes a constant envelope for the phase modulated carrier, subject to constraints on desired signal power levels of the signals to be combined and either zero or one or more relative phase relationships between the signals. The apparatus and method can be extended to generating an optimized composite signal of different frequencies.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09413419&OS=09413419&RS=09413419
owner: The Aerospace Corporation
number: 09413419
owner_city: El Segundo
owner_country: US
publication_date: 20151008
---
This application is a continuation of U.S. patent application Ser. No. 14 325 159 entitled Phase Optimized Constant Envelope Transmission POCET Method Apparatus And System filed on Jul. 7 2014 now U.S. Pat. No. 9 197 282 issued on Nov. 24 2015 which is a continuation of U.S. patent application Ser. No. 12 547 383 entitled Phase Optimized Constant Envelope Transmission POCET Method Apparatus And System filed on Aug. 25 2009 now U.S. Pat. No. 8 774 315 issued on Jul. 8 2014 all of which are hereby incorporated by reference.

The invention was made with Government support under contract No. FA8802 04 C 0001 by the Department of the Air Force. The Government has certain rights in the invention.

The invention relates generally to constant envelope transmissions and in particular to a Phase Optimized Constant Envelope Transmission POCET technique for generating a composite signal through phase modulation of a finite set of composite signal phases determined through optimization minimization of an objective function of the composite signal envelope subject to a plurality of intra signal constraints for the component signals and either zero or one or more inter signal constraints between component signals of the composite signal.

In prior art constant envelope transmission methods such as Interplex modulation Coherent Adaptive Subcarrier Modulation CASM majority vote modulation or inter vote modulation the best case power efficiency is dependent on the relative phase relationships between component signals and equality or disparity in component signal power levels. As discussed below it would be helpful to be able to improve the efficiency of constant envelope transmission methods.

In mathematics the general field of optimization or mathematical programming refers to the study of problems in which one seeks to minimize or maximize a function known in the art as an objective function sometimes called a cost function f x subject to a set of inequality and or equality constraint equations which can be expressed as 0 Inequality Constraints 0 Equality Constaints for the jth constraint of M total constraint equations. S. S. Rao Optimization theory and Applications December 1977.

There are a large number of sub disciplines in mathematical programming including linear programming nonlinear programming quadratic programming convex programming integer programming etc. depending on the form of the objective function. Mordecai Avriel 2003 Nonlinear Programming Analysis and Methods Dover Publishing ISBN 0 486 43227 0 . Other subdisciplines known in the art describe techniques that optimize the objective function over time such as dynamic programming or optimal control theory. Techniques within these fields have not previously been applied to the generation of a constant envelope modulation. For example nonlinear programming is a field of optimization techniques in which the objective function or the constraints or both contain nonlinear parts. One example of an optimization method from nonlinear programming is known as the penalty function method. In this method an unconstrained minimization i.e. in which the constraint is introduced indirectly is used to solve a constrained minimization problem i.e. where the constraint is introduced directly by introducing a penalty factor 0 and a penalty function p x 0 such that a penalized objective function is minimized iteratively e.g. for penalty factor 1 in the first iteration 5 in the 2iteration 10 in the 3iteration so that the penalty for violating the constraint grows after each iteration. By the end of the process the minimization is conducted with a large penalty if the constraint is violated consequently the result approaches the true minimum for introducing the constraints directly. David G. Luenberger 1973 Introduction to Linear and Nonlinear Programming Addison Wesley Publishing Company. The form of the objective function including the penalty functions and penalty factors is given below.

In order to maximize efficiency of a nonlinear high power amplifier it is preferable to operate such amplifiers at or near saturation of their nonlinear region. Unfortunately such operation leads to amplitude modulation to amplitude modulation AM AM and amplitude modulation to phase modulation AM PM distortions when the amplitude or envelope of the composite signal is not constant.

To reduce such distortions in space and ground based communication and navigation transmission systems employing nonlinear amplifiers two approaches have been undertaken. The first approach is to operate the amplifier in a linear region through output power backoff. This approach mitigates the effect of AM AM and AM PM distortions due to operation in the nonlinear region but is undesirable because it results in a loss of nonlinear amplifier efficiency as a result of not operating the amplifier at its maximum output power level i.e. at saturation .

The second approach is to operate the amplifier in saturation while minimizing the variation in amplitude of the composite signal or AM because such variation produces undesirable AM AM and AM PM distortions when the signal is passed through a nonlinear amplifier as is the case in a typical space based communication or navigation system . Several approaches have been previously proposed to maintain a constant envelope of the composite signal.

These approaches have been applied to modulate signals in Global Navigation Satellite Systems GNSS including the Global Positioning System GPS and the European Galileo navigation satellite system. These approaches maintain a constant carrier envelope according to a specific signal multiplexing combining technique. The approaches include Coherent Adaptive Subcarrier Modulation CASM U.S. Pat. No. 6 430 213 to Dafesh Quadrature Product Subcarrier Modulation QPSM U.S. Pat. No. 7 120 198 to Dafesh et al. Interplex modulation U.S. Pat. No. 6 335 951 to Cangiani et al. weighted majority vote U.S. Pat. No. 7 035 245 to Orr et al. or hybrids such as the inter vote technique U.S. Pat. No. 7 154 962 to Cangiani et al. See also J. Spilker et al. Code Multiplexing via Majority Logic for GPS Modernization Proceedings of the Institute of Navigation ION GPS 98 Sep. 15 18 1998 P. A. Dafesh T. M. Nguyen and S. Lazar Coherent Adaptive Subcarrier Modulation CASM for GPS Modernization Proceedings of the ION National Technical Meeting January 1999 and P. A. Dafesh Quadrature Product Subcarrier Modulation Proceedings of the IEEE Aerospace Conference March 1999.

For these previous approaches their efficiency is critically dependent on maintaining certain carrier phases and there is little flexibility to optimize the phase between different signal components while minimizing the output power producing a best case power efficiency required to transmit all of the signal components and pre specified power levels. Maintaining phase relationships between signals is a desirable feature to meet legacy system requirements such as the 90 degree phase relationship between P Y and C A codes in the GPS system or to minimize interference between signals that overlap in spectrum.

In the case of GPS or GNSS systems in general the number of signals that must be simultaneously transmitted in the future has increased from 2 to at least 5. This has resulted in a need to efficiently transmit these signals the preferred method of which has been to employ some type of combining method that maintains a constant envelope composite signal amplitude to eliminate AM to AM and AM to PM distortions as described above. This combining approach should provide a composite signal without deleteriously impacting the power efficiency defined by the following equation as the ratio of the sum of the component signal powers divided by the power of the composite signal 

Here P corr is the desired value of the n th component signal power as measured by a correlation receiver matched to the component signal and P Ais the total power of the composite transmitted signal where A is the envelope amplitude of the composite signal. Corris the expected complex correlation level for the n th component signal of N signals in the composite signal.

Additional requirements such as the desire to maintain certain signal phase relationships allow for adaptive signal power levels and the possibility of increasing the number of signals in the future has led to increased signal losses and potentially severe self interference effects resulting from inter modulation products inherent in these prior art combining modulation methods. The methods also become increasingly difficult to optimize as the number of signals increases and are not well suited to combining other than BPSK signals. For example the desire to broadcast composite signal envelope including Code Division Multiple Access CDMA waveforms composed of multiple orthogonal pseudorandom noise code signals and Orthogonal Frequency Division Multiplexing OFDM waveforms composed of multiple orthogonal component signals at different frequencies using nonlinear high power amplifiers operating near saturation makes it desirable to develop an efficient modulation method that may be applied to the optimization of a wide range of signal types signal levels phase relationships and number of signals. Such methods may be used to efficiently transmit signals for application to both terrestrial wireless and space based communication and navigation systems.

Embodiments described herein relate to a Phase Optimized Constant Envelope Transmission POCET modulation methodology that optimizes the combining of several signal components subject to a plurality of intra signal constraints for the component signals such as component signal power level and either zero or one or more inter signal constraints between component signals such as the phase relationships between any two component signals. In an example embodiment the receiver for each component of the signal is assumed to correlate with its corresponding pseudorandom noise PRN spreading code without knowledge of the other codes. This is possible because the component signals being combined are orthogonal in nature or approximately orthogonal . In another example embodiment different PRN codes are separated in frequency i.e. on different carriers such that the composite signal maintains a constant envelope. In alternative embodiments other means of orthogonality may be used to separate component signals such as matched filtering of orthogonal frequency components. This embodiment would apply for example to generation of OFDM in a constant envelope manner. Many variations of this approach may also be possible including detection of power in individual signals through separation in time phase and polarization as well as approximately orthogonal patterns in these quantities as is the case in frequency hopped spread spectrum signaling. Such component signal separations allow one to mathematically formulate different power constraint equations that relate the complex voltage V jV ReCorr j ImCorr or power V jV of a given signal component to the envelope and carrier phase of the composite signal.

In an example CDMA satellite transmitter implementation a fixed table of transmitted phase values one for each combination of bits of binary PRN spreading codes is computed. By way of example the carrier is phase modulated by a complex rotation obtained by table lookup as a function of the code bits. The table of phase values is obtained through the above mentioned optimization scheme to minimize the constant envelope transmit power subject to intra signal constraints of the specified component signal power levels. Alternative embodiments may also constrain the relative signal phase relationships to provide one or more inter signal constraints. For example the phase difference between one or more signals may be constrained to 90 degrees.

The techniques described herein are applicable to efficiently combining both spread and unspread signals and can be used to generate a composite signal having a best case power efficiency for any arbitrary set of desired component signal power levels independent of the equality or disparity in component signal power levels. The techniques described herein produce a constant envelope modulation which is desirable for transmission of signals through a nonlinear amplifier such as those used in space based communication systems in order to avoid deleterious effects of amplitude modulation to amplitude modulation AM AM and amplitude modulation to phase modulation AM PM distortions when the composite signal is passed through an amplifier operating in its nonlinear region.

In an example embodiment an apparatus for generating a composite signal includes electronics configured to modulate a carrier utilizing a finite set of composite signal phases to generate a composite signal the finite set of composite signal phases being determined through an optimization process that minimizes a constant envelope for the phase modulated carrier subject to intra signal constraints for the component signals e.g. on desired signal power levels of the signals to be combined . In various embodiments the optimization process is further subject to one or more inter signal constraints between the component signals e.g. defining the relative phase relationships between the component signals .

In an example embodiment an apparatus for generating a composite signal from a plurality of component signals includes electronics configured to modulate a carrier utilizing a finite set of composite signal phases to generate a composite signal the finite set of composite signal phases being determined through an optimization process that minimizes a constant envelope of a phase modulated carrier subject to a plurality of constraints on desired signal power levels for the component signals. In an example embodiment the optimization process is further subject to one or more constraints on phase relationships between the component signals.

In an example embodiment a method for generating a composite signal from a plurality of component signals includes the step of modulating a carrier utilizing a finite set of composite signal phases to generate a composite signal the finite set of composite signal phases being determined through an optimization process that minimizes a constant envelope of a phase modulated carrier subject to a plurality of constraints on desired signal power levels for the component signals and either zero or one or more constraints on phase relationships between the component signals.

A generalized embodiment for the case of PRN spreading signals is the case where the spreading code is an M ary modulation with M 2. For example for QPSK spread spectrum M 4 for BPSK spread spectrum M 2. In this case a method for forming a composite signal from M ary modulated component signals includes the steps of enumerating Mphase states for combining N signals with M possible signal phases formulating N intra signal constraint equations each as a function of the Mphase states to provide intra signal constraints on the signals formulating K

The invention described herein involves a methodology of multiplexing several binary signals using a number of intra signal e.g. signal power and either zero or one or more inter signal e.g. phase difference between any two signals constraints to produce a constant envelope composite signal with optimized signal phase relationships and minimum required composite signal power. This approach is called the Phase Optimized Constant Envelope Transmission POCET method. The advantage of this scheme is that it minimizes the required composite signal power to transmit the selected component signals at the specified intra signal constraints for each component signal and either zero or one or more inter signal constraints between component signals. The receiver for any selected signal may operate without knowledge of the other signals or signal phase relationships. In general component signal power is one of many possible intra signal constraints. The method is applicable to both spread and unspread signals having a finite number of phase values and any number of component signals can be combined at arbitrary specified power levels and with any number of phase relationships.

Referring to in an example embodiment a POCET system includes a RF synthesizer a quadrature modulator an optimized lookup table sin cos generator a high power amplifier and an antenna configured as shown. The RF synthesizer generates complex carrier signals which are provided to the quadrature modulator . As described herein outputs of the binary signal generators S S . . . SN are inputs to the optimized lookup table . The sin cos generator in turn uses outputs from the optimized lookup table to generate the Q t and I t inputs to the quadrature modulator . The quadrature modulator outputs the composite signal s t which is provided as an input to the high power amplifier . An alternative implementation directly phase modulates the carrier by the phase . For example in a digital implementation a digital direct synthesizer DDS is configured to directly phase modulate the carrier by the stored phase value as an implementation alternative to performing the mathematically equivalent QAM modulation shown in .

In an example embodiment the POCET modulator is configured such that four Binary Phase Shift Keying BPSK spread signals are combined. The POCET modulator can also be extended to a larger number of signals. For example consider the combining of GPS civilian coarse acquisition C A Modernized L civilian signal data and pilot codes signals LCd and LCp respectively and the military precision P Y and Military M code signals. These signals may be combined using the herein described POCET invention to combine the 5 binary PRN code signals LCd LCp C A P Y and M code. POCET may be compared to the prior art Intervote approach. In the Intervote approach assume that LCd C A LCp are majority voted with M and P Y in phase quadrature according to the methods of U.S. Pat. No. 7 154 962. The Intervote technique is known to be an efficient means of combining 5 signals. Using the POCET modulation method an efficiency improvement reduction of total power of roughly 10 0.4 dB is achieved as compared to the Intervote technique. Moreover for the case of three signals POCET is found to provide the same efficiency of three signal Interplex which is known to be the most efficient technique to combine three signals but without the ability to optimize the phase relationships between signals. This is important for example in the case of the legacy GPS P Y code and C A code ranging signals that must retain a 90 degree phase relationship.

The POCET techniques described herein involve multiplexing several digital signals and provide an optimized combination of any finite number of component signals with desired intra signal constraints e.g. desired power levels for a finite number of phase states subject to zero or one or more desired inter signal constraints e.g. specified phase differences between selected pairs of signals while maintaining a constant envelope composite amplitude and minimizing the envelope of the composite signal and thereby maximizing the transmitter efficiency. In the above mentioned example embodiment combining 5 bi phase spreading signals a fixed storage table of phase values is precomputed to phase modulate the carrier as a deterministic function of the bits of the baseband signal components e.g. 2phase values with N binary signals phase changes when a chip switches polarity . Thus in an example embodiment a result of POCET combining is a deterministic table of phase values.

In the present example embodiment binary spreading codes are assumed. Assuming all N combinations are equally likely which is valid for approximately random PRN spreading codes the average complex correlation for signal n by definition the quantitative measure of performance of the correlation receiver for binary signaling is 

Note that the phase values k 1 . . . 2N 1 are determined as a result of the optimization process and take on different values in time depending upon the pseudorandom combination of bits b k for n 1 . . . N. The implementation of the satellite transmitter causes the carrier to be phase modulated by rotating the carrier phase according to eor equivalently by quadrature amplitude modulation of the in phase and quadrature form cos j sin yielding a transmitted signal of s t given by 

The lookup table of phase values is determined from an optimization algorithm to minimize the constant envelope A while maintaining the constraints of the specified power levels and phase relationships of the average correlations. illustrates an example of an optimized phase table for four signals which enumerates the possible values of b k . In this example N 4 and the columns are numbered from left to right n 1 2 3 4. The transmitted phase angles are listed in the rightmost column from k 0 1 2 . . . 15 and corresponding to each possible combination of the 4 bit values from the binary PRN code signals C A P Y LCp and LCd. A new phase table is produced for each set of inter signal and intra signal constraints.

In an example embodiment an algorithm that performs the constrained optimization is based on an unconstrained optimization search of the objective function that incorporates the constraints according to the penalty function technique where the penalty function is zero when the constraints are satisfied and positive otherwise. A quasi Newton search algorithm can be used to minimize the objective function of several variables without requiring explicit computation of the gradient of the function. Other optimization approaches can also be used. In this case the variables are the phase angles of the look up table and the envelope A to be minimized. The phase angle values are significant modulo 360 but are unconstrained for the search. A common problem with the minimization search is that the algorithm may converge to a local minimum rather than the desired global minimum. An approach to circumvent this difficulty is to perform a multiplicity of searches starting from different starting points where each starting point initializes the phase values to random values in the range 0 to 360 . With N binary codes the number of independent variables for the optimization search is 2 1 because the phase values occur in symmetrical pairs differing by 180 and one phase value can be arbitrarily set to zero as is evident from table 2. The total number of phase values in the lookup table is 2. In the example above the optimization is performed over 7 independent phase angles.

An example multiplexing scheme to combine GPS navigation signals provides an efficient method of optimally combining three or more digital signals into a composite signal of constant envelope with minimum total power and with arbitrary power and phase constraints such as requiring the GPS C A code signal to be in phase quadrature 90 degrees out of phase with the P Y code. The features of this method are not specific to its application to GPS or a fixed number of signals.

In an example embodiment a constrained optimization nonlinear programming problem is performed as set forth below 

t t tis the duration of the shortest PRN chip of the N PRN codes to be combined where the conventional definition of a chip is used corresponding to the smallest interval of time over which the signal transmitted component signal is constant. It should be noted that an alternative embodiment minimizes Ainstead of A.

In an example embodiment it is desirable to combine 4 GPS PRN code signals including C A code P Y code LCp code and the LCd code. For this case the intra signal power constraints are specified by 

In the example embodiments methods of combining three or more component signals have applicability to global navigational satellite systems GNSS and to other spread spectrum signaling in which more than two signals are combined with inter signal phase constraints in a constant envelope composite signal having minimum power. In example embodiments the methods of signal combining described herein are applicable to modulation of multiple wireless communication signals in a constant envelope composite signal including Orthogonal Frequency Division Multiplexing OFDM or Code Division Multiple Access CDMA systems and signaling standards or other standards that would be apparent to one skilled in the art.

In an alternative embodiment the average component signal correlation for a composite signal comprising N M ary spreading signals Mphase states is determined as follows 

For component signals employing binary signaling M 2. For signals employing QPSK spreading codes M 4. Here C k jC k is the complex representation of an M ary spreading code. The data bit values have been excluded from the above expression because correlation is performed over a time period which is coherent with the data bit and therefore only affects the polarity of the complex correlation but not its magnitude which is used to determine the intra signal power constraint equations .

In an example embodiment 5 spread spectrum signals are combined into a composite CDMA signal however the general method applies to a combination of forms of multiplexed signals e.g. Frequency Division Multiple Access or FDMA or any other plurality of component signals. In this 5 signal binary example the average component signal correlation for a composite signal is determined as follows 

Further with respect to the optimization e.g. minimization of an objective function in an example embodiment an objective function f x is subject to a set of inequality and or equality constraint equations which can be expressed as 0 Inequality Constraints 0 Equality Constraints wherein j 1 2 . . . N.

Various optimization sub disciplines including nonlinear programming can be used where the objective function is nonlinear. In an example embodiment a penalty function method is employed as the optimization approach. By way of example 

Example applications of the methodologies described herein include but are not limited to the modulation of N different spreading signals such as is the case for the modernized GPS system the European Galileo navigation or other future foreign navigation systems such as China s Compass system. The methodologies described herein are generally applicable to the generation of a constant envelope composite signal for any spread spectrum CDMA system including wireless CDMA signaling standards employed in 2.5G and 3G wireless standards. The methodologies described herein can also be applied to OFDM a technology expected to be used in 4G and LTE wireless or similar systems cell phones wireless routers etc. as well as transmissions of these signals from space through a nonlinear amplifier .

Referring to in an example embodiment a method of forming a composite signal from N component signals is represented in the form of a flow diagram. At all Mpossible phase states for combining N signals each having M possible signal phases e.g. binary M 2 are enumerated. At N intra signal constraint equations are formed from intra signal e.g. desired power constraints each as a function of the Mpossible phase states. At K

As previously described POCET enables combining of several binary signals into a constant envelope while maintaining desired intra signal and inter signal constraints. To combine several binary signals POCET as previously described stores a pre computed phase table that is a function of the values of the binary chips of the signals to be combined. For example with four binary signals the phase table has 2 16 entries each entry specifying the transmitted phase corresponding to one of the possible set of values of the four binary chips. Presuming random chip values a computational optimization technique minimizes the required constant envelope power A while maintaining the specified intra signal and intra signal constraints. In an example embodiment the intra signal constraints are the desired component signal powers and intra signal constraints are the desired phase difference constraints between signals relative phase constraints . As previously developed POCET assumed that these constraints do not vary in time. In a generalization of the POCET scheme the constraints may also be time varying. For the example of inter signal phase constraints between signals this generalization may be used to combine component PRN spreading code signals at different frequencies to produce a constant envelope signal. In such a variation additional optimizations or phase tables are generated corresponding to the number of phase steps used to represent a frequency difference between component signals. The following describes a technique to combine signals at different carrier frequencies onto a constant envelope carrier suitable for efficient high power transmission from a satellite.

The capability of POCET to maintain one or more phase constraints is necessary to enable the extension of this technique described below. While the following descriptive example refers to combining chips of binary PN spread spectrum signals typically used for navigation and communication it should be understood that the technique can be generalized to higher order modulations.

The process of combining two or more signals of different carrier frequencies into a constant envelope takes into consideration the fact that the phase relation between the signals is continually changing at a rate equal to the difference of the carrier frequencies. Therefore the phase difference constraint takes on V different values . . . where P is the number of phase steps used to determine the carrier frequency difference between component signals and one optimized POCET composite carrier phase table is needed for each phase step.

In an example embodiment the POCET technique is extended to this signal combining problem by quantizing the continuous phase rotation into finite phase steps and then performing a POCET optimization of the combining for the fixed phase relation between the signals at each phase step. Because this requires multiple POCET solutions for the different phase relations in an example embodiment relatively coarse phase steps can be used. For example quantizing the phase rotation to steps of 10 ensures a negligible correlation loss calculated to be 0.01 dB presuming a uniform distribution of phase error with respect to the continuous phase rotation. Taking the example of two carrier frequencies to be combined using a phase step of 10 18 phase tables are computed and stored for one cycle of phase rotation noting that when the phase rotation increases by 180 the binary chip values are complemented. For implementation convenience in an example embodiment the number of phase tables can be a power of 2 as discussed below.

An example of combining signals at different frequencies for a satellite implementation is now described. More specifically in this example the satellite implementation is configured to simultaneously transmit both the LC navigation signal and the Global Navigation Satellite System GLONASS FDMA signal via a constant envelope combined signal which maximizes the efficiency of the high power transmitter. The carrier frequency of the LC signal is 1575.42 MHz. The chip rate of the LC binary modulation is 1.023 Mchips sec with BOC 1 1 chip modulations on the LCp signal and the LCd signal. The LCp signal also has a time multiplex of BOC 6 1 . The carrier frequency of GLONASS FDMA is one of 14 values spaced by 0.5625 MHz in a band centered at about 1602 MHz. The highest GLONASS FDMA carrier frequency is 1605.375 MHz. The GLONASS FDMA signal combines two binary modulations a civil signal with BPSK chip modulation at 0.511 Mchips sec and a military signal with BPSK chip modulation at 5.11 Mchips sec.

In this example there are four signals to be combined. The LCd and LCp signals can be either at a relative phase shift of 0 or 90 . The relative phase shift between the civil and military GLONASS FDMA signals is assumed to be 90 . The GLONASS FDMA carrier must be represented with a minimum of two samples per cycle of phase rotation. A phase stepping rate of 98.208 MHz 1.023 MHz 6 16 gives 3.28 samples per cycle and is a convenient multiple of the switching rate of the BOC 6 1 chip modulation. This sampling rate can be selected to combine the signals.

In this example the specified powers are of 158.25 dBW for LCp 163 dBW for LCd 158.5 dBW for GLONASS FDMA civil and 161.5 dBW for GLONASS FDMA military. In this example a more efficient combining result for POCET is obtained specifying a phase shift of 0 between LCp and LCd rather than 90 . A POCET optimization was performed for each of 18 phase steps from 0 to 170 for the phase rotation of the GLONASS FDMA carrier relative to the LC carrier. In the previously described POCET optimization the first phase value in the phase table was set to zero however this is arbitrary. In this example embodiment after obtaining the optimization solution at each phase step the solution is phase shifted by adding a constant to all of the phase values stored in the phase table so that the average correlation of LCp is maintained at a phase of 0 as the GLONASS FDMA carrier rotates.

The signal combining of this example was simulated at the sampling rate of 98.208 MHz. The assumed GLONASS FDMA carrier frequency 1605.375 MHz which is the maximum offset from the L carrier of 1575.42 MHz and therefore the most stringent for the digital implementation. The simulation incorporated 18 POCET phase tables one table for each quantized step of the phase rotation between the two carriers. Assuming random binary codes the average correlation was computed for each of the four signals summing at the sampling rate. The simulation computed the GLONASS FDMA correlations assuming a continuously rotating phase of the replica carrier in the receiver at each sample rather than the quantized phase shift used for table lookup in the modulator. The switching times of the LC binary modulations were synchronous with the sampling rate. The switching times of the GLONASS FDMA binary modulations were slightly displaced as necessary to synchronize with the sampling rate. The effect of this quantization of the chip switching time was ignored when computing the GLONASS FDMA correlations. The power spectral density of the combined signal was computed using a FFT of size 8192 which gave a frequency bin resolution of 98.208 MHz 8192 11.99 KHz. The power from many successive FFT computations was averaged over a long simulation run.

Referenced to the constant envelope transmitted power of the combined signal the simulation produced correlation powers of 5.67 dB for LCp 10.41 dB for LCd 5.93 dB for GLONASS FDMA civil and 8.94 dB for GLONASS FDMA military. As desired the phase shift between the LCp and the LCd average correlations is almost exactly 0 and the phase shift between the GLONASS FDMA civil and the GLONASS FDMA military average correlations is almost exactly 90 . Because ideal linear combining of the four signals would produce a correlation power of 4.40 dB for LCp the combining loss is 1.27 dB.

In this example the L carrier frequency and the code rate clock to drive the LC code generators can be synthesized from a frequency standard at 10.23 MHz. This frequency standard can be divided down to 1.023 MHz to drive the LC code generators multiplied by 2 to provide BOC 1 1 subcarrier switching further multiplied by 6 to provide BOC 6 1 subcarrier switching and additionally multiplied by 8 to provide the sampling rate of 98.208 MHz. The frequency standard can be divided down to 1 KHz multiplied to 0.511 MHz and further multiplied to 5.11 MHz to produce the code clocks to drive the GLONASS FDMA code generators. In an example embodiment the GLONASS FDMA carrier frequency does not physically exist separate from the POCET modulator circuitry rather its instantaneous phase is digitally represented in a carrier numerically controlled oscillator NCO accumulating at the sampling rate of 98.208 MHz. This approach results in a composite signal that contains a digitally generated FDMA carrier modulated by the composite FDMA spreading signals. In an example embodiment the number of bits in the phase accumulator of the NCO must be sufficiently high to obtain the requisite frequency accuracy for example 36 bits enables a GLONASS FDMA carrier frequency accuracy of 10. To maintain coherence between carrier and code the GLONASS FDMA code rate clock can be derived from a NCO accumulating at the sampling rate of 98.208 MHz instead of using the synthesis scheme described above.

In an example embodiment the GLONASS FDMA carrier phase in the carrier NCO is used to select the correct POCET phase table. If the number of POCET tables is a power of 2 the selection can be done from the MSBs of the digital phase representation in the NCO e.g. 5 MSBs will pick one of 32 phase tables. In the simulation the GLONASS FDMA carrier NCO and code rate NCO phase were computed by incrementing double precision variables thus providing 51 bits of accuracy for these frequencies.

The POCET extension to the problem of combining a multiplicity of signals at different carrier frequencies into a constant envelope carrier is illustrated by studying the afore described example of combining the LC signal and a GLONASS FDMA signal which have carrier frequencies differing by a maximum of about 30 MHz. In this example the POCET optimization was performed at a finite number of quantized phase shifts between the carriers as an approximation to continuous phase rotation. The combining result for this example had a combining loss of 1.27 dB and produced spurious components that were reasonably low. The implementation for this example used a sampling rate of 98.208 MHz. Frequency synthesis was from a 10.23 MHz standard to generate the LC carrier and code rates. The GLONASS FDMA carrier and code rates were generated by NCOs accumulating at the sampling rate.

Although the present invention has been described in terms of the example embodiments above numerous modifications and or additions to the above described embodiments would be readily apparent to one skilled in the art. It is intended that the scope of the present invention extend to all such modifications and or additions.

