---

title: Decoupled magnetoquasistatic non-line-of-sight position and orientation sensing for arbitrary distances
abstract: Methods and systems for non-line-of-sight positioning are disclosed for arbitrarily short to long ranges, where positioning is achieved using a single anchor not requiring tri-/multi-lateration or tri-/multi-angulation. Magnetoquasistatic fields can be used to determine position and orientation of a device in two or three dimensions. Two or three axis coils can be used in receivers and transmitters. The magnetoquasistatic equations are solved in different scenarios, taking into consideration the image signals originating from the interaction between the fields and ground/earth.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09638521&OS=09638521&RS=09638521
owner: CALIFORNIA INSTITUTE OF TECHNOLOGY
number: 09638521
owner_city: Pasadena
owner_country: US
publication_date: 20151006
---
The present application claims priority to U.S. Provisional Patent Application No. 62 060 714 filed on Oct. 7 2014 US Provisional Patent Application No. 62 079 738 filed on Nov. 14 2014 and U.S. Provisional Patent Application No. 62 160 129 filed on May 12 2015 and is related to U.S. patent application Ser. No. 12 824 894 filed on Jun. 28 2010 the disclosure of each of which is incorporated herein by reference in its entirety.

The invention described herein was made in the performance of work under a NASA contract and is subject to the provisions of Public Law 96 517 35 USC 202 in which the Contractor has elected to retain title.

The present disclosure relates to non line of sight positioning. More particularly it relates to magnetoquasistatic non line of sight positioning.

In a first aspect of the disclosure a method is described the method comprising providing a receiver the receiver comprising a first and second receiver coils configured to receive quasistatic magnetic fields in a first and second mutually orthogonal directions transmitted by a transmitter the transmitter comprising a first and second transmitter coils and configured to transmit the quasistatic magnetic fields in a third and fourth mutually orthogonal directions receiving the quasistatic magnetic fields through the receiver measuring with the receiver a first voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the first receiver coil measuring with the receiver a second voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the first receiver coil measuring with the receiver a third voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the second receiver coil measuring with the receiver a fourth voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the second receiver coil based on the first second third and fourth voltages calculating a distance between the receiver and the transmitter wherein the measuring of each of the first second third and fourth voltages is independent from the remaining voltages.

In a second aspect of the disclosure a method is described the method comprising providing a receiver the receiver comprising a first and second receiver coils configured to receive quasistatic magnetic fields in a first and second mutually orthogonal directions providing a transmitter the transmitter comprising a first and second transmitter coils and configured to transmit the quasistatic magnetic fields in a third and fourth mutually orthogonal directions transmitting the quasistatic magnetic fields through the transmitter receiving the quasistatic magnetic fields through the receiver measuring with the receiver a first voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the first receiver coil measuring with the receiver a second voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the second receiver coil measuring with the receiver a third voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the first receiver coil measuring with the receiver a fourth voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the second receiver coil based on the first second third and fourth voltages calculating a distance between the receiver and the transmitter wherein the measuring of each of the first second third and fourth voltages is independent from the remaining voltages.

In a third aspect of the disclosure a method is described the method comprising providing a receiver the receiver comprising a first second and third receiver coils configured to receive quasistatic magnetic fields in a first second and third mutually orthogonal directions transmitted by a transmitter the transmitter comprising a first second and third transmitter coils and configured to transmit the quasistatic magnetic fields in a fourth fifth and sixth mutually orthogonal directions receiving the quasistatic magnetic fields through the receiver measuring with the receiver a first voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the first receiver coil measuring with the receiver a second voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the second receiver coil measuring with the receiver a third voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the third receiver coil measuring with the receiver a fourth voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the first receiver coil measuring with the receiver a fifth voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the second receiver coil measuring with the receiver a sixth voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the third receiver coil measuring with the receiver a seventh voltage originating from the quasistatic magnetic fields due to coupling between the third transmitter coil and the first receiver coil measuring with the receiver an eighth voltage originating from the quasistatic magnetic fields due to coupling between the third transmitter coil and the second receiver coil measuring with the receiver a ninth voltage originating from the quasistatic magnetic fields due to coupling between the third transmitter coil and the third receiver coil based on the first second third fourth fifth sixth seventh eighth and ninth voltages calculating a distance between the receiver and the transmitter wherein the measuring of each of the first second third fourth fifth sixth seventh eighth and ninth voltages is independent from the remaining voltages.

In a fourth aspect of the disclosure a method is described the method comprising providing a receiver the receiver comprising a first second and third receiver coils configured to receive quasistatic magnetic fields in a first second and third mutually orthogonal directions providing a transmitter the transmitter comprising a first second and third transmitter coils and configured to transmit the quasistatic magnetic fields in a fourth fifth and sixth mutually orthogonal directions receiving the quasistatic magnetic fields through the receiver measuring with the receiver a first voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the first receiver coil measuring with the receiver a second voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the second receiver coil measuring with the receiver a third voltage originating from the quasistatic magnetic fields due to coupling between the first transmitter coil and the third receiver coil measuring with the receiver a fourth voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the first receiver coil measuring with the receiver a fifth voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the second receiver coil measuring with the receiver a sixth voltage originating from the quasistatic magnetic fields due to coupling between the second transmitter coil and the third receiver coil measuring with the receiver a seventh voltage originating from the quasistatic magnetic fields due to coupling between the third transmitter coil and the first receiver coil measuring with the receiver an eighth voltage originating from the quasistatic magnetic fields due to coupling between the third transmitter coil and the second receiver coil measuring with the receiver a ninth voltage originating from the quasistatic magnetic fields due to coupling between the third transmitter coil and the third receiver coil based on the first second third fourth fifth sixth seventh eighth and ninth voltages calculating a distance between the receiver and the transmitter wherein the measuring of each of the first second third fourth fifth sixth seventh eighth and ninth voltages is independent from the remaining voltages.

Existing radiolocation systems such as the Global Positioning System GPS Radio Frequency Identification RFID systems and Ultra Wide Band UWB systems are based on propagating electromagnetic EM waves. These systems have reduced accuracy in non line of sight NLoS environments due to propagation losses delays or multi path effects see for example Refs. 4 6 7 . In contrast magnetoquasistatic MQS fields are not significantly disturbed and can offer accurate radiolocation in NLoS environments see Ref. 3 . Magnetoquasistatic fields are a class of electromagnetic fields in which a slowly oscillating magnetic field is dominant. A magnetoquasistatic field is typically generated by low frequency induction from a magnetic dipole or a current loop or coil. In the past MQS systems using frequencies of up to a few kiloHertz were developed for above ground positioning see Ref. 8 9 . These techniques did not account for induced eddy currents in the ground which limited the range of operation to a few meters above the ground. However this simplification in the technology did permit a decoupled solution for position and orientation see Ref. 9 . The decoupling of position and orientation sensing is important in magnetoquasistatic systems to provide linear unambiguous solutions and also for low latency or fast solution times.

The solutions are decoupled when both the position and orientation of an object can be determined through equations that are not coupled and can be solved separately and independently. Long range MQS positioning above ground was recently demonstrated using frequencies of a few hundred kiloHertz and by accounting for the induced eddy currents in the ground see Ref 3 . However the strong ground effects did not permit a decoupled solution for range and orientation of the device to be radiolocated and instead required solution of non linear coupling equations. Due to use of the non linear field coupling equations see Ref. 3 previous attempts to extend the long range MQS technique to 2D and 3D have resulted in solutions that exhibit large errors 1 3 m which are strongly varying as a function of the orientation and position of the transmitter and receivers see Ref. 2 . Furthermore the complexity in the non linear solution space impedes the ability to converge to a correct solution or to solve in real time. Attempts to use orthogonal fields to aid the non linear convergence has resulted in slight improvements in accuracies at the expense of significantly more complicated algorithms with high computational complexity see Ref 1 .

The present disclosure describes a long range MQS technique to accurately determine the orientation invariant range and range invariant orientation of a device above ground. To achieve this the non linear field equations describing the coupling which includes ground effects are decoupled into range and orientation field equations that can be directly inverted.

where right arrow over r rcircumflex over r is the range vector centered at the origin of the coil right arrow over m is the vector magnetic moment of the transmitter and where the moment is assumed unity i.e. right arrow over m 1 Am. The voltage measured by a receiving coil within the quasistatic region is given by V j right arrow over B circumflex over n a where a is the surface area of the receive coil and 11 is the receiver s surface normal unit vector. Induced eddy currents in the ground generate secondary fields detected by the receiver which can be modeled using complex image theory as indicated in see Ref. 3 . The total voltage measured at the receiver is given by V V V where Vis the voltage induced in the receiver due to the transmit direct fields Vis the voltage induced in the receiver due to the image fields of right arrow over m . The total voltage is therefore given by 

Of concern are the radial ranging near the 2D xy plane and the orientation of the transmitter about the circumflex over z axis. Horizontal magnetic moments are chosen for the transmit and receive vertical coils and cylindrical coordinates are used to describe the problem. In the cylindrical system circumflex over r r circumflex over p z r circumflex over z where r z and circumflex over r r circumflex over z H r circumflex over z where r z H and H 2h . Here 1 j where is the skin depth of penetration in the ground. Due to the use of horizontal magnetic moments or vertical coils that implies 90 circumflex over m circumflex over z circumflex over m circumflex over z circumflex over n circumflex over z circumflex over n circumflex over z 0 and circumflex over circumflex over m circumflex over m which substantially simplifies the total voltage due to the transmitter and ground to 

Due to operation close to the 2D xy plane it is assumed that z 0 and hence r 1. The asymptotic convergence from the source field at near ranges to the complex image contribution at far ranges is understood in the context of complex image theory see Ref 3 . At short ranges 1 r so that the source field significantly dominates the sensed voltage. On the other hand at long ranges H it is found that r 1 and 1 r 1 r so that both source and image fields contribute to the sensed voltage but the scaling of the dot product in the numerator of the image contributions are not significant. In summary at short ranges only the source field is significant but r 1 whereas at long ranges both source and image fields are important but r 1. The total voltage can now be approximately re written as 

where the r and rare kept in the denominator since the cubic dependence offers high sensitivity to z or H. The term on the right 1 r 1 r is the geometric distance function from complex image theory see Ref. 3 and can be replaced by using higher order discrete complex images see Ref. 5 when slightly higher accuracy is needed at H. However the higher order images provide diminished returns due to further depths.

The description of the voltage sensed at the receiver given in Eq. 4 is simpler than that used in previous documents see Refs. 2 3 . However it is still non linear as the orientation of the transmitter orientation of the receiver and range functions are strongly coupled. Previous attempts to extend Eq. 2 to 2D and 3D see Ref 2 have resulted in large errors 1 3 m which are also strongly dependent on the orientation and position of the devices. The non linear solution space is also complex and often prevents convergence to a correct solution or any real time solution.

To solve this problem it can be noted that Eq. 4 has a similar form to the traditional free space magnetoquasistatic MQS coupling equation and thus can be decoupled in a related manner to that in short range MQS techniques see Ref. 9 . A 2 axis transmit and receiver concept as shown in is used where each axis circumflex over m circumflex over m of the transmitter system and similarly each axis circumflex over n circumflex over n of the receiver system are horizontal and orthogonal to each other. The orientations of the transmitter and receiver systems are arbitrary with respect to each other. Due to this 2 2 configuration there is a total of four field equations generated. These four equations can be considered by first focusing on the contributions at both receivers due to transmitter . At receiver taking note that circumflex over circumflex over m cos circumflex over circumflex over n cos and circumflex over m circumflex over n cos cos sin sin it is possible to re write the total voltage for this case as 

For receiver similar steps can be carried while noting that 2 which allows a re write of the total voltage 

Now upon taking the squares of the voltage descriptions and summing both receiver contributions it can be found that 

where c j 4 is a constant. A point to be noted here is that regardless of the orientation of circumflex over m the orientation of the receivers do not have an effect in Eq. 7 . By taking similar steps the counterpart to Eq. 7 that describes the case of the transmitter circumflex over m can be found 

where the change 2 was made so that both Eqs. 7 and 8 have the same variables. Finally by taking the direct sum of Eqs. 7 and 8 a function can be found that is only range dependent and invariant of the orientation of the transmitter or receiver 

where b 5cis a constant determined through calibrations. In practice Fis obtained by summing the signal power measured at both receivers due to both transmitters. The model for inverting range involves an optimization for ground conductivity as described in Ref. 3 to obtain a model of the range dependence of the geometric distance function 1 r 1 r which can be numerically inverted. Practical implementation will be described in the following sections.

where the range dependence is automatically removed through cancellation. Solving Eq. 10 for the orientation of the transmitter as a function of F it is possible to obtain 

where can be easily obtained if needed by noting that 2. In practice Fis obtained by first summing the power of both tones in one receiver and dividing this value by the sum of power of both tones in the second receiver. This implementation will be described in the following sections.

To study the accuracy of the decoupled range and orientation solutions both transmitter and receiver were developed to have two orthogonal axes and the range and orientation of the mobile transmitter was varied relative to the fixed receiver system. The experiment was conducted on the rooftop of a long building at the Jet Propulsion Laboratory campus. The setup is shown in . A tape measure and orientation table were used to provide range and orientation ground truth for error analysis. In this exemplary system each axis of the transmitter and receiver consisted of about 50 turns of 28 AWG magnet wire wound in a closely spaced configuration around a square outline with a side of about 20 cm. Both transmit and receive coils were co located at a height of about 1.5 m. The inserts of shows the transmitter and receiver block diagrams. Two direct digital synthesized DDS sources are used to generate tones at 198 kHz and 232 kHz each. The output tone of each DDS is amplified using a class AB amplifier design consisting of a LM386 audio amplifier chip set from Texas Instruments TI . The output of each amplifier drives a resonant capacitor network and coil designed to resonate at the center frequency of the tones. The emitted magnetic field of transmitter coil 1 at about 198 kHz and of coil 2 at about 232 kHz induces a current in both coils of the receiver. To permit detection of both tones in each coil and to maintain simplicity in the RF design a digitally controlled switch circuitry was used to switch between coils of the receiver. The output of the switch was amplified using a two stage Norton amplifier Z10043A and Z10047A from Clifton Laboratories. The amplified signals were digitized using a 0.1 V 16 bit 2MS s analog to digital convertor ADC within the USB 6361 X Series Data Acquisition system from National Instruments. The USB 6361 X Series Data Acquisition was also used to set the digital state of the RF switch. Data was streamed to a PC and processed in Matlab by Mathworks. Unknown gain losses in each channel of the transmitter and receiver were measured through coupling measurements at very short ranges of about 2 m to reduce effects of secondary fields that would distort the calibrations.

The digital time domain signals of about 0.1 s in length captured by the ADC were sent to the PC and converted using a Fast Fourier Transform FFT algorithm into the frequency domain. The peak power found close to 198 kHz and 232 kHz were captured and calibrated using gain measurements described previously. By selecting the switch digitally the tones were captured in alternating fashion between both receive coils. The measurements during one round contained power of each tone at both receiver coils. The captured data from the two receiver coils were distinguished by digital switch selection. Since power varies linearly with the voltage squared all 2 2 or 4 power measurements were summed within each round. The total summed power has the form of Fin Eq. 9 but requires a calibration to remove the unknown gain b. This is done through a measurement at 18.3 m 60 ft . To solve for the ground conductivity and a within r a measurement of Fwas repeated at 10 m and used to minimize for a from which a ground conductivity of 0.45 S m was found for the rooftop. Next a model of the geometric range function squared 1 r 1 r was obtained numerically as a function of radial distance . The measured total power after calibrating Fwas then inverted based on this model to obtain the radial range between the transmitter and receiver.

To obtain the orientation of the transmitter the total summed power of both tones at one receiver was divided by the total summed power of both tones at the second receiver. This ratio had the exact form of Fin Eq. 10 and did not require any further calibration. Using Eq. 11 the ratio given by Fwas converted into the orientation of the transmitter.

The above system and methodology are intended as an example. Other systems with different configurations may also be employed.

To study the orientation invariant ranging accuracy the radial range of the transmitter was varied from 12.2 m 40 ft to 42.7 m 140 ft at steps of 10 ft 3.048 m while attempting to maintain an orientation of 90 . The total power of the orientation invariant range function F is shown in to match well with the geometric range function squared 1 r 1 r from complex image theory. The solution is numerically inverted to obtain the range which is compared to the expected ground truth range in .

Range error and orientation inversion for measurements with variation in range but with fixed orientation are illustrated in . The error in range estimation shown in was below 0.2 m for distances up to about over 40 m. The orientation solutions for the range measurements described here varied by about 7 from the expected value of 90 as visible in .

From the experiment and calculations described above a long range magnetoquasistatic positioning concept was developed that permits the decoupling of range and orientation in the coupling theory. Therefore the technique described above using magnetoquasistatic fields has been shown to enable accurate ranging in non line of sight environments. The system in the embodiments above was optimized for measurements close to the 2D xy plane. Measurements showed peak orientation invariant ranging errors of 0.2 0.4 m for a range of up to over 40 m. The peak range invariant orientation errors found were 1 7 .

In the following the technique described above using magnetoquasistatic fields is expanded to include decoupling of azimuthal direction of a mobile device. The results are azimuthal direction sensing for long range magnetoquasistatic systems with a peak error of about 6 independent and invariant of the range or orientation of the mobile device. In the following two dimensional 2D positioning is demonstrated by combining the decoupled range and azimuth direction solutions.

As discussed above the non line of sight NLoS positioning problem is important in both civilian and military applications. Existing techniques that utilize high frequency propagating radio waves suffer in NLoS use for example see Refs. 4 6 7 .

Magnetoquasistatic MQS fields are weakly perturbed by lossy dielectrics and thus beneficial when used in NLoS positioning. Direction finding systems require to be progressively moved closer to the transmitter and therefore cannot provide long range positioning see Ref. 10 . Short range MQS systems use a frequency of a few kilohertz to avoid ground effects see Refs. 8 9 . However the use of very low frequency and increased ground effects with range limits their maximum operation range to a few meters. To enable long range NLoS sensing a MQS technique was developed to account for ground effects and by using a higher frequency 300 400 kHz to obtain a range of up to about 50 m see Ref. 3 . The long range MQS technique enabled ranging with errors of 0.12 0.7 m for ranges up to 40 m see Ref 3 and was not sensitive to the LoS blockage see Ref. 1 . However due to the non linear position orientation coupling and ground effects the technique can have some limitations when extended to 2D or 3D resulting in errors which are dependent on positions orientations and the non linear solution convergence see Ref. 2 .

As described above in the present disclosure and as seen from Ref 11 a long range MQS technique has been described to decouple the range and orientation of the device to be located. The technique can account for ground effects obtaining decoupled solutions with low error over long ranges. This section extends the technique to provide decoupled azimuth direction sensing which enables 2D decoupled positioning of the MQS mobile device using a single receiver system with orthogonal co located coils.

As described above and in Ref. 11 the voltage measured at a receiving coil due to a quasistatic magnetic source above ground is due to the source right arrow over B and image right arrow over B fields as shown in and is given by Eq. 2 . In the system comprises a mobile transmit coil and a fixed receive coil .

As detailed above the total voltage expression of Eq. 2 can be simplified to give Eq. 4 where z is the receiver height above the xy plane formed at the origin of the transmitter is the cylindrical radial range and is the skin depth of penetration in the ground. The key assumption required to derive 2 is that at short ranges only the source field is significant but r 1 whereas at long ranges both source and image fields are important but r 1.

To enable 2D positioning using a single receiver and transmitter system a two axis orthogonal transmit and receive system are employed as shown in . illustrates a top and side view illustration the two axis transmitter and receiver system. The transmitter is permitted to have an arbitrary azimuth direction relative to a reference azimuth angle. The two axis transmitter has horizontal magnetic moments denoted by circumflex over m and circumflex over m whereas the two axis receiver has horizontal magnetic moments denoted by circumflex over n and circumflex over n . The orientation of the transmitter is noted to be relative to the radial vector direction circumflex over . The azimuth direction of the transmitter is defined relative to the azimuth angle of the receiver circumflex over n and the angle is given by as shown in .

It can be noted that Eq. 4 exhibits a symmetry between the transmitter and receiver moments circumflex over m and circumflex over n . To derive the decoupled transmitter orientation as described above and in Ref. 11 a transmitter centric approach was used where the transmitter orientation was found from the ratio of F F F 

Here the squared voltage from transmitter measured at both receivers k 1 2 is summed to give F V V and divided by similar contributions from transmitter F V V.

To approach a solution for the azimuth direction of the transmitter a receiver centric solution is derived instead. Simplifying Eq. 4 for circumflex over circumflex over m cos circumflex over circumflex over n cos and circumflex over m circumflex over n cos cos cos sin the voltage at receiver is found due to contributions from transmitter and by using similar steps from transmitter 

where 2 was used to derive Vto keep in both equations. Taking the sum of squares of Eq. 13 the receiver centric version of the solutions at receiver can be found 

where c j 4 is a constant. In contrast to Fin Ref 11 and in the previous embodiment described above in the present disclosure Fis only a function of receiver s orientation and is invariant of the transmitter orientations. Following similar steps the contributions at receiver can be found 

The solutions in Eqs. 14 and 15 are the receiver centric coupled equations which are invariant of the transmitter orientations but dependent on range. To further remove range dependence we take the ratio of Eq. 15 to Eq. 14 to find the receiver centric counterpart to Fdescribed above for a previous embodiment as well as in Ref. 11 

Through a direct inversion of Eq. 16 it is possible to find the orientation of receiver which is the azimuth direction of the transmitter if the receiver is in a fixed non rotating configuration 

To solve for the azimuth direction of the transmitter using Eq. 17 it is necessary to compute F F F. In practice Fand Fis obtained by summing the calibrated power due to both transmitters at receiver and respectively.

Once the decoupled azimuth direction of the transmitter is found its 2D location is known in cylindrical coordinates from the azimuth direction combined with the decoupled range solutions as described above in the present disclosure and in Ref. 11 . The inverted location of the transmitter relative to the receiver location can also be readily converted into Cartesian coordinates using the coordinate conversions x cos and y sin .

To study the accuracy of the decoupled azimuth direction sensing a two axis orthogonal transmit and receive system was developed as shown in with rotation tables at their bases to allow for rotations. At the transmitter two direct digital synthesized DDS sources were used with amplifiers and fed to resonant coils for increased signal to noise. The field transmitted by each axis of the transmitter was a tone at 198 kHz and 232 kHz respectively. Both tones are detected at each receiver coil. A switch is used to selectively sense the signal at the receiver coils which is then amplified and digitized. The setup is described more in details in the present disclosure above.

To simplify the experiments for azimuth direction sensing of the transmitter the transmitter s orientation its radial range and its location a are fixed and the orientation of the receiver is varied. As described previously and illustrated in the orientation describes the angle between circumflex over and circumflex over n which also describes the azimuth direction of the transmitter relative to the azimuth reference circumflex over when aligned to circumflex over n direction if the receiver s position and orientation is fixed. To characterize the technique and inversion results some measurements were taken and compared to the theoretical predictions.

First the azimuth direction sensing accuracy for the transmitter at a fix range and orientation were studied. The transmitter was placed at a radial range of 10 m from the receiver system. The locations of both the transmitter and receiver were fixed and the transmitter s orientation was set to 0 . To simulate the azimuth direction the receiver s orientation was rotated from 0 to 90 at steps of 10 . The measured Fat each measurement step is obtained by summing the calibrated measured power from both transmitters at receiver and dividing this by the summed powers of both transmitters measured at receiver as described by Eqs. 14 16 . The measured result for Fis compared to the expected theoretical value in . illustrates measurements of the azimuth direction function compared to theory for variation in azimuth direction of the transmitter . The inverted azimuth direction is also compared to the ground truth with the related error .

Inverting the measured Ffor azimuth direction resulted in close agreement with the expected direction referenced through the receiver rotation table . The difference between the expected azimuth direction from the rotation table and the inverted solution is the apparent azimuth direction error. This is shown in as a function of the azimuth direction where the error is typically less than 2 except when close to the 0 azimuth direction.

For this first experiment the decoupled range inversion was also examined using the technique described above in the present disclosure as well as in Ref 11 to confirm that it remains invariant of the azimuth direction. This azimuth direction invariant ranging is important to permit a fully decoupled 2D solution. From the same data collected the range function F can be calculated as described in the present disclosure as well as in Ref 11 . A single calibration measurement was taken at 60 ft. 18.29 m to remove unknown gains in the system as described in the present disclosure as well as in Ref. 11 . The result for the measured Fcompared to theory is shown in as a function of the variation in azimuth direction. The inverted range using the technique described above in the present disclosure as well as in Ref. 11 is found and shown in while gives the error in range. The range error is found to be less than about 14 cm.

For the second experiment the accuracy of the technique at a few different ranges was studied by locating the fixed orientation fixed transmitter at distances of 10 m 20 m and 30 m. The azimuth direction is varied from 0 to 90 at steps of 10 for a transmitter range of 10 m 20 m and 30 m. shows the resulting azimuth direction error found using the same approach described above. The invariance of the ranging solution was also examined at the various ranges. The result for this range error is shown in . The peak azimuth direction error found was approximately 6 whereas the peak range error found was about 17 cm.

For the third experiment the inversions due to various transmitter orientations was studied instead. In this experiment the transmitter range was fixed at 20 m but the experiment was repeated for transmit orientations of 0 30 45 60 and 90 . At each transmit orientation the azimuth direction was varied from 0 to 90 at steps of 10 . shows the result for azimuth direction error as a function of azimuth direction for the various transmitter orientations. The azimuth direction error is shown to be below about 6 in all cases measured. shows the result for range error as a function of azimuth direction for the various transmitter orientations at 20 m. The peak range error was about 0.3 m.

To provide a summary of the experimental results described above with application to 2D location sensing shows the experimental results summarized in Cartesian coordinates. The receiver is located at the origin of the coordinate system. Circles denote the ground truth of the measurements. For measurements conducted at a range of 10 m and 30 m the transmitter orientation was fixed at 0 . Measurements conducted at a range of 20 m included transmitter orientations of 0 30 45 60 and 90 as previously described.

As described above in some embodiments the long range MQS positioning technique is extended to provide decoupled azimuth direction sensing that is invariant of the range or orientation of the transmitter with a peak error of 6 . The range inversions were invariant of the azimuth direction and orientation of the transmitter with a peak error of 0.3 m. The technique enables decoupled 2D MQS positioning.

In the following section measurements of the magnetoquasistatic coupling between a co polarized vertical emitting and receiving coil both located above earth are compared to calculations using complex image theory and the exact integral solutions along a direction perpendicular to the surface normal axes of the loops. Inverting the theoretical expressions of the exact integral solution to estimate distance from measured fields resulted in an root mean square RMS error of 0.089 m and 0.079 m for distances between 1.3 29.4 m and 1.3 13.5 m which corresponds to a 21.9 and 28.4 reduction in RMS distance error respectively over complex image theory.

In the following the accuracy of the magnetoquasistatic technique described above is studied using the exact integral solution to describe the exact fields of a finite loop above the earth. The magnetic field of the emitting current loop in proximity to a conducting earth can be decomposed into the primary fields of the loop and the secondary fields of the induced eddy currents in the earth see Ref. 3 . The total field outside the ground can be approximated by 1 18 

where c denotes the total fields due to use of complex image theory square root over 2 is the skin depth is the permeability of free space a is the bulk conductivity of the earth near the source and co is the angular frequency of the field emitted by the source.

Due to the use of a vertical emitting loop depicted in the primary source fields and the secondary eddy current fields are co polarized in Eq. 18 and thus summed. is the field of the loop which contains the lowest order dipole field and higher order loop fields quadrupole et cetera and can be written in spherical coordinates using spherical harmonics 

where I is the driven current in the emitting loop l is the radius of the emitting loop r square root over x y z is the absolute distance from the loop to the observation point m is the number of loop terms with m 0 representing dipole fields P is the Legendre polynomial cos and is the angle that the surface normal of the loop makes from the x axis. The function F is given by

Eq. 19 is valid for r l i.e. outside the loop which is the region of interest. For r l only the m 0 term is important and the fields are that of a magnetic dipole as seen Ref 3 . The theoretical description of the voltage at the terminals of the receiver shown in is found using Faraday s law and is given by 21 

where circumflex over n is the unit vector normal to the receive loop and a is the surface area of the receive loop. Due to the use of vertical emitting and receiving loops which are co polarized with surface normals perpendicular to the circumflex over r direction the radial component of the field in Eq. 19 does not contribute to circumflex over n right arrow over H or the theoretical description of the voltage V.

The exact integral solutions for the fields of a finite loop above earth accounts for all higher order loop terms all m and the exact induced eddy currents. Because complex image theory only approximately models the fields of the exact induced eddy currents it is expected that there will be some improvements in distance measurement using the exact integral solutions. The magnetic fields using the exact integral solution of a finite circular current carrying loop located above earth is given in Cartesian coordinate by see Ref. 13 

where the subscript e denotes the exact fields of the emitting loop above earth and are integration variables which operate on each integrand from 0 to square root over T tan and Fis given by 

where Iis the modified Bessel function of the first kind square root over j and square root over 2 . The theoretical description of the voltage at the terminals of the receiving loop is found using Faraday s law circumflex over right arrow over H 24 

Due to the use of vertical loops with surface normals perpendicular to the circumflex over x direction the circumflex over x and circumflex over z component of the exact field in Eq. 22 does not contribute to circumflex over n right arrow over H or the theoretical description of the exact voltage V.

Only the one dimensional 1D case shown in is studied in the following where distance is varied along a direction perpendicular to the surface normal axes of the loops i.e. x coordinate is varied. The experiment was conducted above earth on an open field and has been previously described in Ref 3 . The result for the measured voltage is plotted in as measured power in dB 10 log V R. The complex image theory description in Eq. 21 for dipole fields m 0 and the exact integral description in Eq. 24 are also plotted in where a fixed offset was used to calibrate out the measurement gain and to make both theories agree with the measurements at a distance of 20.2 m. shows the difference between the complex image and exact descriptions from the measurements.

The closed form field equations in Eq. 19 describing complex image theory allows a direct numerical inversion for the distance. Here the emitter s x coordinate can be found using a non linear least square optimization algorithm to minimize V V where Vis the measured voltage at the terminals of the receiving loop see Ref. 3 . shows the result of this optimization where the distance error is estimated by finding the difference between the x coordinate solutions and the actual x coordinate. The black line m 0 denotes the distance error due to use of complex image theory with dipole fields whereas the blue line m 0 1 2 includes the next two higher order fields of the finite sized loop see Ref. 12 .

Use of the exact integral solution which does not have a closed form precludes the possibility of inversion as done with complex image theory. Instead by using the exact integral solutions in Eq. 24 of a finite sized vertical loop a 1D look up table was created with the exact theoretical induced voltage values and interpolated to minimize V V and find an estimated x coordinate. also shows the result of this interpolation and minimization where the distance error is again estimated by finding the difference between the x coordinate solutions and the actual x coordinate. The line denotes the distance error due to use of the exact integral solutions. provides an analysis of the RMS distance error using complex image theory and the exact integral solutions. The exact integral solution gives an RMS error of 0.089 m and 0.079 m for distances between 1.3 29.4 m and 1.3 13.5 m respectively. This is compared to the result of 0.114 m and 0.110 m for the same distances from use of complex image theory and spherical harmonics to model a finite sized loop with m 0 . . . 4.

As discussed above the magnetoquasistatic field equations can be decoupled into position and orientation in the two dimensional 2D space of the fixed sensor or mobile device plane even over long ranges see Ref. 11 . This approach is possible due to a few mathematical approximations made possible by the physical nature of magnetoquasistatic coupling near a conducting ground as described above and in Ref. 11 . The device to be tracked can be the transmitter or the receiver with the fixed sensor being the receiver or the transmitter. In addition to the 2D position and orientation of the device the theory can be further extended to enable 2D azimuth direction sensing of the device as discussed above and in Ref 14 . A remaining problem of importance is the case of z location tracking in the cartesian 3D coordinate frame. Under this translation it is important to know if the magnetoquasistatic field equations can be decoupled meaningfully for 3D position sensing.

In the following section the 3D problem in magnetoquasistatics is discussed and it is shown that the field equations can be decoupled to enable linear 3D position sensing of the device by extending the framework presented above. The closed form solutions derived here permit full 3D position sensing of the mobile device using a single fixed device and do not require trilateration or triangulation.

In the previous embodiments two axis coils were used. However in other embodiments three axis coils can be used permitting 3D instead of 2D positioning.

For 3D position sensing in MQS over long ranges ground effects due to induced eddy currents in the ground cannot be neglected. Following the framework described above and in Ref. 11 it is required that the transmitting and receiving device have 3 axis coils. The system is described in where each transmitter coil and its corresponding complex image is described using magnetic moments to simplify the mathematical discussion. This approximation is sufficiently accurate for any appreciable range greater than a few diameters from the coils .

To understand the effect of 3 axis magnetic moments it is necessary to study the coupling at the receiver due to an arbitrarily oriented transmitter magnetic moment. Due to the boundary condition made by the air ground interface it is helpful to decompose the arbitrary transmitter moment into its vertical and horizontal components circumflex over m mcircumflex over mcircumflex over z where the magnitude of the moment in the horizontal plane is given by m while the magnitude of the moment in the vertical plane is given by m. Following this convention it is also helpful to decompose the receiver s moment into its vertical and horizontal components circumflex over n ncircumflex over ncircumflex over z . The voltage measured at the terminals of the receiver coil with the surface normal circumflex over n is given by Eq. 25 where c j 4 .

The terms in Eq. 25 for the horizontal and vertical moments do not act on perpendicular circumflex over r unit vectors therefore Eq. 25 can be significantly simplified. Additionally since the vertical magnetic moments of mcircumflex over z interact in a destructive manner with its complex image mcircumflex over m it is useful to gather these terms separately from all other terms. Finally to simplify the analysis two separable cases are studied below the total voltage at the horizontal moment sensor ncircumflex over and at the vertical moment sensor n . With these voltages the total voltage sensed at the horizontal II is given by 

The third term in Eq. 26 is negligible for medium to long ranges or distances such that r r 1 if the height is approximately less than the radial distances such that z

The goal as discussed in Ref. 11 is to approximately decouple the range terms from the orientation elevation and azimuth terms in Eq. 27 . To this order Eq. 27 can be rewritten by a simple factorization as 

where it follows that C r is a good approximation for short to long ranges. In the following the remaining vertical equations are discussed.

Following similar considerations and as can be seen in Ref 14 it can be noticed that under any appreciably long ranges the third term becomes negligible. The second term can also be neglected for appreciable ranges since it will be much weaker than the second term in Eq. 27 . With these approximations the total voltage sensed at the vertical circumflex over n can be simplified to give 

where it follows that C z ris a good approximation for short to long ranges. The above concludes the derivations for the MQS field theory. The solutions derived in Eqs. 28 and 32 are the foundations of the following section where the positioning framework is presented.

The orthogonality relations of the transmitter moments are always preserved under any arbitrary rotations due to the use of orthogonal coils on the transmitter orthogonal magnetic moments circumflex over m circumflex over m and circumflex over m and field magnitude only sensing of in the receive coils. As discussed above it can be assumed that m fil and inare all mathematically similar or in other words that these quantities have the same gains or calibrated gains as well as close center frequencies. With this condition the preservation of orthogonality implies that under any arbitrary rotation there will be two horizontal magnetic moments which are orthogonal to each other and parallel to the horizontal plane and one vertical magnetic moment parallel to the vertical plane. It is then possible to obtain the solutions to the elevation angle direction of the transmitter and then the azimuth angle direction of the transmitter. In a first step the transmitter and receiver centric F equations are defined for the 3D case which is related to the 2D case as described above and in Refs. 11 14 where x 1 2 3 referring to each transmitter moment 24 .

For 3D positioning in some embodiments it is possible to focus on the receiver centric F. Under any rotations as described above there will be two orthogonal horizontal transmitter magnetic moments. These moments can be denoted as located along circumflex over m and circumflex over m which are orthogonal to each other but can assume any arbitrary orientation from P. Some orientations for this problem can be defined as follows and also as in 

Based on this definition we find the voltage due to transmitter circumflex over m at receiver circumflex over n as 

Since the vertical transmitter moment does not contribute to the horizontal receiver moments as indicated by Eq. 28 V 0. It is then possible to find through the same simplification approach shown above and in Refs. 11 14 the receiver 1 centric equations F.

The final equation needed is that for F which is the vertical receiver 3 centric equation and can be found using Eq. 32 . To obtain F V V and Vare calculated 

Having found all three receiver centric equations F F and F all critical equations are available to solve for the 3D positions in MQS for short to long ranges.

In a next step the method continues by solving for the elevation direction angle of the transmitter. To accomplish this the ratio between the vertical to horizontal Fis used. In particular from Eqs. 39 41 and 44 it can be found that 

and as previously found C z rand C r . Now defining the azimuth direction angle as cos r it can be found find that z r sin from which it can be obtained C cos sin C cos 

The next step in the method is to find the azimuth direction angle of the transmitter. This can be found by again looking at the receiver centric Fequations. In particular as described above and in Ref. 11 it is known that the ratio of F Fgives a solution for the azimuth direction angle in 2D. For the 3D case the ratio of Eqs. 39 to 41 can be calculated to find 

which can be directly inverted in a similar fashion to the 2D case as described above and in Ref. II to give 

and where it can also be noted that when 0 the azimuth direction angle solution in Eq. 50 becomes precisely that derived in the 2D case as described above and in Ref 11 .

The above equations give the solutions for the elevation direction angle and the azimuth direction angle of the transmitter. The only remaining item to obtain the full 3D location is the range. Following the approach described above and in Ref. 11 it is possible to sum the contributions from all combinations of the transmitter moments to the receiver moments. This can be obtained by summing the contributions from all receiver centric functions F F F 

For 0 Freduces to exactly the solutions derived in the 2D case as described above and in Ref 11 . This completes the solutions for the 3D position of the transmitter.

The algorithm to determine the 3D positions is as follows By numerically solving Eq. 48 a solution is obtained for the elevation direction angle . Once 0 is known A is also known from which the inverted form in Eq. 50 can be used to solve directly for the azimuth direction angle and Eq. 54 can be used to solve for the range to the transmitter through the same numerical inversion technique described above and in Ref 11 for the 2D range.

In the above section a new decoupled theory in magnetoquasistatics was described showing that the 3D positions of a mobile magnetoquasistatic device can be found using linear closed form equations. The linear closed form solutions can be used to find the 3D location of a mobile device over short to long ranges above a half space such as earth.

In the following the 3D orientation sensing problem of the mobile device is discussed. In the section above the decoupled magnetoquasistatic coupling between an arbitrarily oriented mobile magnetic dipole or an excited electrically small coil and an arbitrary receiving coil was derived. Due to the use of a 3 axis receiver architecture the problem was simplified by assuming that the receiving coils were either horizontal vertical moment or vertical horizontal moment . The purpose was to decompose the problem in relation to the boundary condition to enable a simplification in the analysis.

The coupling from the transmitter moment to the horizontal receiver moment is given by as seen above and in Ref. 15 

where c j 4 and the factor C r . The coupling from the transmitter moment to the vertical receiver moment is given by 

where the factor C z r. Eqs. 55 and 56 are general to arbitrary orientations of the transmitting magnetic moment. To enable closed form solutions for 3D position sensing it was shown that both the transmit and receive system required 3 axis coils. To simplify the analysis it was chosen to constrain the 3 axis transmitter system such that its moments were aligned along the x y and z axis respectively. This resulted in circumflex over m circumflex over cos and circumflex over m circumflex over n cos for the magnetic moment of the transmitter moment m. To remove this restriction the dot product is redefined as follows 

where the factor cosOdescribes the elevation of the transmitting magnetic dipole from the horizontal plane.

Due to Eq. 57 the explicit coupling equations need to be updated. To obtain range invariant orientation sensing the transmitter centric coupling equations need to be studied see Ref. 11 . The coupling of mto the each of the 3 axis coils is studied now with the assumption that mcan obtain an arbitrary 3D orientation based on Eq. 57 . The voltage measured due to mat receiver nis given by 

The solutions above describe the coupling to each receiver moment due to an arbitrarily located and orientated transmitting magnetic moment. Therefore the solutions for the remaining magnetic moment m can be found by using instead of and instead of and similarly the solutions for m can be found by using instead of and instead of 

The new solutions in Eqs. 58 60 are different compared with those in Ref. 15 . It is expected that the position and ranging functions are still invariant under arbitrary rotations of the 3 axis transmitter system due to the orthonormal basis used. It is valuable to show that this is indeed the case with Eqs. 58 60 . The total power due to mis first found where upon some mathematical manipulations and simplifications it is obtained 

where C cos and C cos sin . The range solutions that are derived from Fin Eq. 63 see Ref. 15 are only a function of the elevation direction angle of the transmitter and not a function of the transmitters orientations or . A similar analysis can be done to show that Fin Ref. 15 and hence the azimuth direction and elevation direction angles remains invariant of the transmitters orientations or .

To emphasize the azimuth orientation of the transmitter and based on the form of Eqs. 55 and 56 it is possible to analyze the ratio of V Vto find 

Which is dependent on along with and . To remove the dependence on it is possible to use the summation of the power of ratios between the horizontal and vertical coupling equations V V V V 

which is no longer dependent on . Eq. 66 can be directly inverted to find the azimuth orientation of the transmitter moment m 

To emphasize the elevation orientation of the transmitter and based on the form of Eqs. 55 and 56 it is possible to investigate the ratio of V Fto find 

where we find dependence on cos and sin . Since it is possible to solve for cos using Eq. 67 it is possible in turn to invert for the elevation angle of the transmitter moment m by inverting Eq. 68 

The derivations given in Eqs. 67 and 69 are straightforward and elegant but present a problem. Firstly Eq. 67 is not sensitive to Fwhen C 0 which is the case on the 2D x y plane that is of importance in long range ground based positioning. Secondly Eq. 69 is not sensitive to Fwhen C 0 or cos 0 which is also on the 2D x y plane or for 2. The reason for this difficulty is that the 1 is used which becomes a null field on the 2D x y plane for long distances due to multiplication with C z r caused by the boundary conditions. In addition it is not possible to use the ratio conventions used in Ref 11 because the magnetic moment is no longer on a fixed 2D plane. To avoid these problems it is possible to take the ratio between the field seen at receiver coil 1 to receiver coil 2 since both have horizontal moments to find 

which is now a function of and C. In Eq. 70 C is not present and does not reduce the sensitivity of Fin the inverted solutions. The un approximated solution for is then given by 

The closed form solution given in Eq. 71 is always valid and sensitive to Funder any C C and for all . Once is known it is possible to find the elevation angle of the transmitter moment by instead studying the ratio of V V Vto the total power found through Fin Ref. 15 

The algorithm is straightforward. By solving Eqs. 71 and then Eq. 73 it is possible to find the azimuth orientation and elevation orientation the transmitter moment m. It is possible to repeat similar calculations to obtain Fand Ffor transmitter moment m from which it is possible to solve for and and then Fand Ffor transmitter moment m. In turn it is then possible to solve for and . With these solutions the full arbitrary 3D orientation of the mobile transmitter system is known.

The current closed form solutions for 3D orientation sensing used with the closed form solutions for 3D position sensing derived in Ref. 15 completes the problem of 3D position and orientation sensing using magnetoquasistatic fields for short to long ranges using complex image theory. The forms derived allow use of complex image theory or higher order corrections to complex image theory as noted in Ref 11 and permit closed form solutions for 3D position and orientation sensing of a mobile device using a single fixed sensor with 3 axis orthogonal coils.

In some embodiments of the present disclosure an advantage of the methods described herein is the ability to use a single sensor instead of multiple sensors to carry out the positioning through quasistatic magnetic fields. Another advantage is the decoupling of the equations for the orientation and the position therefore having decoupled errors in orientation and position. In some embodiments the methods of the present disclosure can be carried out by having a receiver or a transmitter with a known location. This can mean that the receiver or transmitter have a fixed location or they may be moving in a known way therefore still having a known location. In embodiments with two or three axis implemented for example with two or three orthogonal coils each coil can sense a signal from the two or three coils in the transmitter. In other words a first receiver coil can independently sense two or three independent signals from each of the two or three transmitting coils. Several methods can be employed to maintain the independence between the two or three signals. For example a different frequency may be used for each of the three orthogonal coils or multiplexing may be used. Multiplexing can comprise sending signals for each direction at a different time according to a specified sequence. Other methods to differentiate between the three signals can also be implemented as understood by the person of ordinary skill in the art. In some embodiments the methods described in the present disclosure decouple the horizontal and vertical components of the ground fields.

The methods and systems described in the present disclosure may be implemented in hardware software firmware or any combination thereof. Features described as blocks modules or components may be implemented together e.g. in a logic device such as an integrated logic device or separately e.g. as separate connected logic devices . The software portion of the methods of the present disclosure may comprise a computer readable medium which comprises instructions that when executed perform at least in part the described methods. The computer readable medium may comprise for example a random access memory RAM and or a read only memory ROM . The instructions may be executed by a processor e.g. a digital signal processor DSP an application specific integrated circuit ASIC a field programmable logic array FPGA a graphic processing unit GPU or a general purpose GPU .

A number of embodiments of the disclosure have been described. Nevertheless it will be understood that various modifications may be made without departing from the spirit and scope of the present disclosure. Accordingly other embodiments are within the scope of the following claims.

The examples set forth above are provided to those of ordinary skill in the art as a complete disclosure and description of how to make and use the embodiments of the disclosure and are not intended to limit the scope of what the inventor inventors regard as their disclosure.

Modifications of the above described modes for carrying out the methods and systems herein disclosed that are obvious to persons of skill in the art are intended to be within the scope of the following claims. All patents and publications mentioned in the specification are indicative of the levels of skill of those skilled in the art to which the disclosure pertains. All references cited in this disclosure are incorporated by reference to the same extent as if each reference had been incorporated by reference in its entirety individually.

It is to be understood that the disclosure is not limited to particular methods or systems which can of course vary. It is also to be understood that the terminology used herein is for the purpose of describing particular embodiments only and is not intended to be limiting. As used in this specification and the appended claims the singular forms a an and the include plural referents unless the content clearly dictates otherwise. The term plurality includes two or more referents unless the content clearly dictates otherwise. Unless defined otherwise all technical and scientific terms used herein have the same meaning as commonly understood by one of ordinary skill in the art to which the disclosure pertains.

The references in the present application shown in the reference list below are incorporated herein by reference in their entirety.

