---

title: Mobile communication device with public transportation detection for determining hands free mode settings
abstract: A mobile communication device includes wireless local area network (WLAN) baseband hardware with at least one WLAN transceiver; non-volatile, non-transitory memory that stores a transportation model based on aggregated basic service set identification (BSSID) information collected from a plurality of WLAN access points; at least one sensor that is operative to detect motion of the mobile communication device; and at least one processor, operatively coupled to the WLAN baseband hardware, the memory and to the at least one sensor. The at least one processor is operative to determine that the mobile communication device is located on public transportation using the transportation model in response to a motion detection signal received from the at least one sensor.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09571627&OS=09571627&RS=09571627
owner: Motorola Mobility LLC
number: 09571627
owner_city: Chicago
owner_country: US
publication_date: 20150624
---
The present disclosure relates generally to mobile communications devices such as mobile telephones that incorporate hands free operation using text to voice capability and speaker phone capability.

Mobile communication devices are increasingly being integrated with additional sensors. These sensors provide a variety of functionality such that mobile communication devices are becoming more powerful in determining a user s context and providing meaningful actions based on the determined context.

One such context determination is in vehicle usage. A mobile communication device can determine whether a user is in a moving vehicle or not by using sensor data from one or more of an accelerometer and audio sensor and location data. After the mobile communication device makes a determination that the user is in a vehicle it can adjust settings for hands free mode and to facilitate the user focusing on the road while driving.

For example some existing mobile communication devices can announce a caller s name and read out a text message for the user if the determined context is that the user is in a vehicle. This context detection response is desirable if the user is driving a car because it facilitates the driver keeping her eyes on the road rather than being tempted to look at the mobile communication device. However if the user is on public transportation such as a bus or train the same response would be awkward because the user may not want her caller s name or text message to be read out in front of other people around her. Unfortunately current in vehicle context detection methods fail to distinguish between when the user is driving a car and riding on public transportation. This is because the data used for this purpose appears similar with respect to a private car and public transportation vehicles.

One known system for in vehicle context detection in a mobile communication device is Google s activity recognition system available at http developer.android.com training location activity recognition.html . This system which is based on the Android operating system can recognize various user activities and includes determining when the mobile communication device is in vehicle. However the system cannot distinguish whether a user is in a personal car or is riding on public transportation.

Another known system for in vehicle context detection in a mobile communication device is described by Zheng et al in Understanding Mobility Based on GPS Data ACM International Joint Conference on Pervasive and Ubiquitous Computing 2008 hereinafter Zheng . Zheng describes an approach for distinguishing among four classes that include walking driving bicycling and riding a bus and uses GPS logs to make an inference of the class. However Zheng does not provide any way to discriminate between a car and a bus which is a form of public transportation because the mobility patterns exhibited by GPS data are similar for a car and public transportation.

Another known system for in vehicle context detection in a mobile communication device is described by Stenneth et al in Transportation Mode Detection using Mobile Phones and GIS Information Proceedings of the 19th ACM SIGSPATIAL International Conference on Advances in Geographic Information Systems 2011 hereinafter Stenneth . Stenneth describes an approach to detect different transportation modes including car train bus etc. by using accelerometer data in addition to GPS data and also using specific transportation network information. Stenneth requires the transportation network information noting that the GPS and accelerometer readings are similar for cars trains and buses.

The present disclosure provides a mobile communication device and methods for determining whether a user is riding in a personal car or on public transportation such as a bus or train. Among other advantages the methods of the present disclosure do not require knowledge of the underlying transportation network such as knowledge of real time bus locations and spatial bus stop information which are time consuming to obtain in advance.

One aspect of the present disclosure is a mobile communication device that includes wireless local area network WLAN baseband hardware with at least one WLAN transceiver non volatile non transitory memory that stores a transportation model based on aggregated basic service set identification BSSID information collected from a plurality of WLAN access points at least one sensor that is operative to detect motion of the mobile communication device and at least one processor operatively coupled to the WLAN baseband hardware the memory and to the at least one sensor. The at least one processor is operative to determine that the mobile communication device is located on public transportation using the transportation model in response to a motion detection signal received from the at least one sensor.

The transportation model may include a histogram for BSSIDs collected and aggregated from the plurality of WLAN access points. The at least one processor is further operative to determine that the mobile communication device is located on public transportation using the transportation model by identifying persistent BSSIDs using the histogram. The at least one processor is also operative to determine that the mobile communication device is located in private transportation using the transportation model by identifying a lack of persistent BSSIDs using the histogram. The at least one processor may also adjust settings of the mobile communication device in response to determining that the mobile communication device is located on public transportation.

Another aspect of the present disclosure is a method of operating a mobile communication device. The method includes determining that the mobile communication device is in motion based on mobile communication device sensor data scanning for wireless local area network WLAN access points accessing a transportation model based on aggregated BSSID information collected from a plurality of WLAN access points and determining that the mobile communication device is located on public transportation using the transportation model.

Another aspect of the present disclosure is a method of generating a transportation model. The method includes collecting WLAN BSSID information from a plurality of mobile devices determining a number of occurrences of each detected BSSID performing a classification operation on the number of occurrences and generating a transportation model using the classification operation for predicting that a mobile communication device is on public transportation or private transportation. The transportation model may then be stored in non volatile non transitory memory on a mobile communication device. In some embodiments the step of performing a classification operation includes applying the Random Forest algorithm to the number of occurrences.

Turning now to the drawings illustrates a private or personal car and a public transportation vehicle i.e. a bus traveling on a road . As the two types of vehicles progressed down the road mobile communication devices within the vehicles will encounter various WLAN access points assuming that their respective WLAN radio hardware is turned on and scanning for networks. A mobile communication device that is owned and operated by the driver of the car will obtain WLAN information from the various WLAN access points over a WLAN wireless link . Similarly a passenger on the bus may operate a mobile communication device which also scans the various WLAN access points and also receives WLAN information . In accordance with the embodiments the mobile communication device will be able to determine that it is located in a car while the mobile communication device will be able to determine that it is on a bus .

The mobile communication device establishes an Internet Protocol IP connection with the server on the Internet and sends histogram information to the server . The histogram information is created by the mobile communication device from the collected WLAN information and includes WLAN BSSID basic service set identification information for detected WLAN access points . The IP connection may be established over a WLAN wireless link or over a wireless wide area network WAN such as a wireless telephone network. The server includes or can access a transportation model database which contains one or more transportation models.

In some embodiments a transportation model may be pre stored in the mobile communication device based a location related to the mobile communication device network service area. Alternatively a transportation model may be downloaded or pushed to the mobile communication device by the server as a transportation model update . Additionally transportation model updates may be occasionally sent to the mobile communication device by the server as the mobile communication device travels through routes having different WLAN access points .

The mobile communication device includes an application or component that performs the data collection of WLAN information . More specifically the mobile communication device is operative to collect labeled training data from WLAN scans. The user is prompted by the application to designate whether the user is in a car on a bus or on a train prior to the WLAN information collection process. The server is operative to collect the data from a group of mobile communication devices and to perform feature extraction using machine learning. The server extracts discriminative features from collected WLAN information.

The features are calculated based on a histogram of the WLAN BSSID basic service set identification duration in a monitoring window. The value of the k th feature is assigned as the total number of BSSIDs which appear exactly k times. The server aggregates all collected mobile communication device data and applies feature extraction. The extracted discriminative features are determined using a histogram of the BSSID occurrences during the scans. In one example embodiment a time window of 30 seconds may be used with WLAN BSSID collection every 5 seconds such that 6 WLAN scans are conducted during the time window. In other words the server looks for how many unique BSSIDs appear in these scans and then the total number of BSSIDs. A classification algorithm is then applied for example Random Forest to build a transportation model using the feature values obtained above. The transportation model created is then provided to the mobile communication devices for use in real time public transportation detection.

Further details of an embodiment are provided in which is a block diagram of an example mobile communication device . The mobile communication device includes one or more processors a display which is used to show a prompt to the user to provide a transportation type user interface audio equipment one or more wide area network transceivers such as but not limited to CDMA UMTS GSM etc. WLAN baseband hardware camera equipment GPS hardware and memory . All of the components shown are operatively coupled to the one or more processors by one or more internal communication buses . In some embodiments a separate sensor processor monitors sensor data from various sensors including a gyroscope and an accelerometer as well as other sensors . The gyroscope and accelerometer may be separate or may be combined into a single integrated unit. The audio equipment may include among other things at least one microphone at least one speaker signal amplification analog to digital conversion digital audio sampling echo cancellation and other audio processing components etc. which may be applied to one or more microphones and or one or more speakers of the mobile communication device .

The memory is non volatile and non transitory and stores executable code for an operating system that when executed by the one or more processors provides an application layer or user space libraries also referred to herein as application programming interfaces or APIs and a kernel . The memory also stores executable code for various applications training data and a transportation model . The memory may be operatively coupled to the one or more processors via the internal communications buses as shown may be integrated with the one or more processors or may be some combination of operatively coupled memory and integrated memory.

The one or more processors are operative to launch and execute the applications including a motion detection determination module and an application in accordance with the embodiments. The example application may include a data collection module and a classification module . However it is to be understood that the application can be implemented in other ways that are contemplated by the present disclosure and that the example shown in is only one possible implementation. For example the data collection module and the classification module may be separate applications or components or may be integrated together in some embodiments etc.

The classification module is operatively coupled to a hands free module and is operative to change settings that impact operation of the mobile communication device . The classification module may provide control signals and make settings changes to various components of the mobile communication device and the hands free module is only one example of a component that may receive control signals or commands. The control signals or commands may be sent over operative coupling that may be implemented via hardware connectivity in some embodiments or by appropriate APIs in embodiments where one or more components are implemented as software. In the example of the hands free module is operative to control when the mobile communication device provides audible notifications and text to voice playback features and when it can receive voice commands from the user among other settings.

Obtaining and sending the WLAN information to the server as shown in is handled by the data collection module which can communicate with the WLAN baseband hardware over the internal communication buses . In some embodiments when the application is launched the data collection module may control the WLAN baseband hardware to scan for networks and obtain WLAN information including BSSID information. The application may also access the GPS hardware to obtain location information in some embodiments. Location information obtained over the WLAN may be an alternative in situations where GPS location information may not be available such as when indoors or other locations where GPS satellite data cannot be accessed. The location information may be used to geotag the WLAN information .

After obtaining WLAN information using the WLAN baseband hardware the application may proceed as shown in and may send histogram information to the server over an IP connection . In some embodiments the transportation model may be pre stored in memory as part of the application installation. Otherwise the mobile communication device may obtain the transportation model or a transportation model update over an IP connection the server described with respect to . The transportation model or update may be obtained by a downloading operation a server push operation or any other appropriate mechanism.

The application is operative to obtain the transportation model or a transportation model update from the server and to store them in the memory . The transportation model provides information used by the classification module to make predictions of whether the mobile communication device is in a car i.e. private transportation or is on a bus or train i.e. public transportation such that mobile communication device settings may be adjusted in response to the determination accordingly. For example if the mobile communication device is determined to be in private transportation the classification module will control the hands free module such that a caller s name text messages and notifications may be read out loud to the user using a text to voice application within applications . Likewise if motion is detected by the motion detection determination module which would under default conditions also set the hands free module as described above and the classification module determines that the mobile communication device is on public transportation the above mode settings would be prevented. In other words the classification module prevents the user s private information from being read aloud by text to voice over the audio equipment speakers if the user is determined to be in a public setting.

Any of the components shown in including without limitation the application motion detection determination module data collection module classification module and or the hands free module may be implemented as executable instructions executed by the one or more processors or may be implemented as hardware or as a combination of hardware and software firmware. In embodiments in which one or more of these components is implemented as software or partially in software firmware the executable instructions may be stored in the operatively coupled non volatile non transitory memory that may be accessed by the one or more processors as needed.

It is to be understood that any of the above described example components in the example mobile communication device may be implemented as software i.e. executable instructions or executable code or firmware or a combination of software and firmware executing on one or more processors or using ASICs application specific integrated circuits DSPs digital signal processors hardwired circuitry logic circuitry state machines FPGAs field programmable gate arrays or combinations thereof. Therefore the mobile communication device illustrated in and described herein provides just one example embodiment and is not to be construed as a limitation on the various other possible implementations that may be used in accordance with the various embodiments.

More particularly the data collection module and or the classification module may be a single component or may be implemented as any combination of DSPs ASICs FPGAs CPUs running executable instructions hardwired circuitry state machines etc. without limitation. Therefore as one example the data collection module and the classification module may be integrated together and may be implemented using an ASIC or an FPGA that may be operatively coupled to a separate motion detection determination module and to the hands free module . Likewise the hands free module may be executed as code or may be implemented using an ASIC or an FPGA operatively coupled to the classification module where the classification module is also implemented using an ASIC or an FPGA. These example embodiments and other embodiments are contemplated by the present disclosure.

The various operations of the example mobile communication device shown in are best understood in conjunction with the flowcharts of . Turning to in operation block the motion detection determination module monitors the sensor processor for a motion trigger. The motion trigger may occur in response to sensor data received by the gyroscope the accelerometer the other sensors or various combinations of sensor data that may be used to determine that the mobile communication device is in motion and is likely within a vehicle. In decision block if a motion trigger is not detected then the motion detection determination module will continue to monitor for the motion trigger in operation block . However if the motion trigger is detected in decision block the motion detection determination module will invoke the data collection module using an appropriate API from the libraries . The data collection module will access any needed APIs from libraries and communicate with the kernel to determine if the WLAN baseband hardware is turned on or not. If in decision block the WLAN baseband hardware is off the data collection module will send a command to activate the WLAN baseband hardware and turn on the radio equipment as shown in operation block . Otherwise if the WLAN baseband hardware is already turned on in decision block the data collection module will begin to collect WLAN scan results as shown in operation block . Also in operation block the data collection module builds a histogram of any detected unique BSSIDs. The WLAN scan results contain the WLAN information discussed with respect to . The data collection module will pass information as necessary to the classification module . More particularly the data collection module will send the histogram representation to the classification module . In operation block the classification module will use the transportation model contained in memory and will assess the WLAN scan results histogram using the transportation model .

As shown in decision block the classification module performs analysis of the WLAN scan results and predicts the transportation type using the transportation model . The prediction that the transportation model provides will depend on the classification algorithm utilized. For example if Random Forest is used to build the transportation model then the final prediction will be based on a majority vote of the predictions from each individual decision tree. Depending on whether the transportation type is determined to be public transportation or private transportation the classification module will access an appropriate API and will communicate with a hands free module and or other components of the mobile communication device and will change the settings accordingly. For example if the transportation type is determined to be public transportation in decision block the process will proceed to operation block and adjust the settings for public transportation. Similarly if the transportation type in decision block is determined to be private transportation such as a car the process will proceed to operation block and will adjust settings for private transportation. The process then ends as shown.

It is to be understood that although the classification module in is shown communicating with the hands free module the classification module and the application may control any settings of the mobile communication device including notification settings. For example in some embodiments the classification module may determine that the transportation type is public transportation. The settings adjusted in operation block may include notification settings such that the user may be notified when an appropriate public transportation stop such as bus stop has been reached. Therefore if the mobile communication device user is daydreaming or sleeping and not paying attention to the location of the bus the mobile communication device may produce an audible notification such that the user does not miss their bus stop.

For the presently discussed application of the data collection module the data collection module may interact with the display to show a prompt to the user such that the user may indicate by providing input to the user interface whether they are riding in a car a bus or a train. In the present disclosure a car is considered to be private transportation while a bus or a train are considered to be public transportation. A taxicab which is typically also a car is considered to be private transportation for purposes of the present disclosure even though more than one passenger may be present in the taxicab.

In operation block the server receives histogram information from one or more mobile communication devices and aggregates the collected WLAN data. In operation block the server determines the unique number of BSSID occurrences in each of the scans and develops further data records and aggregation. In operation block the server runs a classification algorithm on the data. The classification algorithm may be for example Random Forest which provides a way of averaging multiple deep decision trees which in this case are trained on different parts of the same WLAN BSSID training data with the purpose of among other things reducing the variance obtained on these multiple identical training data sets.

In operation block the server generates transportation model and stores it to the transportation model database . After the transportation model database has been developed the server may send transportation model updates to any of the participating mobile communication devices such as mobile communication device . The mobile communication devices may therefore use the transportation model updates to update the local transportation model that each of the mobile communication devices maintains stored in memory .

An example histogram for an example set of wireless local area network scans in accordance with various embodiments is illustrated in . The histogram bins along the horizontal axis represent the number of times a BSSID appears in a scan set and the vertical axis value is the number of unique BSSIDs per each bin i.e. bin six is related to the number of BSSIDs detected six times etc. For example if six scans are conducted for a given scan interval and using a simplified BSSID format aN for purposes of this example the example scan results are as follows scan detected a a a and a scan detected a a and a scan detected a and a scan detected a and a scan detected a a and a and scan detected a a and a. Counting the number of times each detected BSSID appeared in the total six scans a appeared six times a appeared three times a appeared four times and a a a and a each appeared only one time.

In bin one the number of BSSIDs that were detected only once is four i.e. a a a and a therefore the vertical axis value for bin six is four. For the second bin the number of BSSIDs that appeared twice is zero therefore the vertical axis value for bin two is zero. For bin three only a appeared three times and for bin four only a appeared four times therefore bins three and four have a vertical axis value of one. There were no BSSIDs appearing five times so the vertical axis value for bin five is zero. For the sixth bin BSSID a was the only BSSID detected six times therefore the vertical axis value for bin six is one. Accordingly the histogram is generated for the six scans of the example.

While various embodiments have been illustrated and described it is to be understood that the invention is not so limited. Numerous modifications changes variations substitutions and equivalents will occur to those skilled in the art without departing from the scope of the present invention as defined by the appended claims.

