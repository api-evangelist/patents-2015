---

title: System and method of encrypted transmission of web pages
abstract: Disclosed are systems and method for encrypted transmission of web pages. One exemplary method comprises: receiving, by a proxy server, a web page requested by a user device; analyzing, by a hardware processor of the proxy server, the received web page to identify code of elements of the web page; selecting one or more identified elements of the web page for encryption; encrypting, by the hardware processor, the code of the one or more selected elements; generating, by the hardware processor, a script containing the encrypted code of the one or more selected elements; modifying the web page, by the hardware processor, by replacing in the web page the code of the one or more selected elements with the script containing the encrypted code of said one or more selected elements; and transmitting, by the proxy server, the modified web page to the user device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09571471&OS=09571471&RS=09571471
owner: AO Kaspersky Lab
number: 09571471
owner_city: Moscow
owner_country: RU
publication_date: 20151110
---
The present invention relates generally to the field of computer security and more specifically to systems and methods for encrypted transmission of web pages.

Due to the ever growing number of computer threats such as malware hacker attacks etc electronic payment systems Internet banking services and other Internet services working with confidential data require an increased level of protection for data during transmission between a user s application and a network server. Encrypted communication protocols such as the protocols HTTPS SSL TLS are traditionally used to provide protection for the data being transmitted such as web pages over telecommunication networks.

However some malicious software which is installed on a user s computer is able to intercept the user s data prior to its transmission by the protected communication protocol. For example the banking Trojan horses Zeus and SpyEye analyze the content of a web page received from a server and modify it immediately prior to its display in the browser with the help of mechanisms for intercepting of API application programming interface calls.

Current data protection techniques are often ineffective in combating such malware. Therefore there is a need to improve security of web pages transmitted to user devices.

Disclosed are systems and method for encrypted transmission of web pages to user devices. An exemplary method for secure transmission of web pages comprises receiving by a proxy server a web page requested by a user device analyzing by a hardware processor of the proxy server the received web page to identify code of elements of the web page selecting one or more identified elements of the web page for encryption encrypting by the hardware processor the code of the one or more selected elements generating by the hardware processor a script containing the encrypted code of the one or more selected elements modifying the web page by the hardware processor by replacing in the web page the code of the one or more selected elements with the script containing the encrypted code of said one or more selected elements and transmitting by the proxy server the modified web page to the user device.

In one exemplary aspect modifying the web page includes modifying a Document Object Model DOM of the web page.

In one exemplary aspect encrypting the code of one or more selected elements of the web page includes using an asymmetric encryption method.

In one exemplary aspect encrypting the code of one or more selected elements of the web page using an asymmetric encryption method includes encrypting the code of the one or more selected elements of web page using a public key of an application of the user device.

In one exemplary aspect encrypting the code of one or more selected elements of the web page includes using a symmetric encryption method.

In one exemplary aspect selecting one or more identified elements of the web page for encryption includes selecting one or more of i user input elements and ii output elements containing confidential user data.

In one exemplary aspect the method further includes transmitting by the proxy server to the user device a public key of a remote web server for use by the user device to encrypt user input data on the web page.

An exemplary system for secure transmission of web pages comprises a proxy server having a hardware processor configured to receive a web page requested by a user device analyze the received web page to identify code of elements of the web page select one or more identified elements of the web page for encryption encrypt the code of the one or more selected elements generate a script containing the encrypted code of the one or more selected elements modify the web page by replacing in the web page the code of the one or more selected elements with the script containing the encrypted code of said one or more selected elements and transmit the modified web page to the user device.

Another exemplary method for secure transmission of web pages comprises receiving by a user device a public key of a remote web server encrypting by a hardware processor of the user device using the received public key a request to the web server to provide a web page to an application of the user device transmitting by the user device the encrypted request to the web server receiving by the user device the requested web page containing a script containing encrypted code of one or more elements of the web page executing the script and decrypting by the hardware processor using a private key of the application of the user device the encrypted code of one or more elements of the web page and modifying the web page by the hardware processor by replacing the script containing encrypted code of one or more elements of the web page with the decrypted code of said one or more elements.

In one exemplary aspect receiving a public key of a remote web server includes receiving by the user device a script containing a public key of the web server and executing by the hardware processor the script to retrieve the public key.

In one exemplary aspect the encrypted code of one or more elements of the web page is encrypted using public key of the application of the user device.

In one exemplary aspect the method further comprises displaying the modified web page on a display of the user device.

Another exemplary system for secure transmission of web pages comprises a user device having a hardware processor configured to receive a public key of a remote web server encrypt using the received public key a request to the web server to provide a web page to an application of the user device transmit the encrypted request to the web server receive the requested web page containing a script containing encrypted code of one or more elements of the web page execute the script and decrypting using a private key of the application of the user device the encrypted code of one or more elements of the web page and modify the web page by replacing the script containing encrypted code of one or more elements of the web page with the decrypted code of said one or more elements.

The above simplified summary of example aspects of the invention serves to provide a basic understanding of the invention. This summary is not an extensive overview of all contemplated aspects and is intended to neither identify key or critical elements of all aspects nor delineate the scope of any or all aspects of the invention. Its sole purpose is to present one or more aspects in a simplified form as a prelude to the more detailed description of the invention that follows. To the accomplishment of the foregoing the one or more aspects of the present invention include the features described and particularly pointed out in the claims.

Example aspects of the present invention are described herein in the context of a system method and computer program product for encrypted transmission of web pages to user devices. Those of ordinary skill in the art will realize that the following description is illustrative only and is not intended to be in any way limiting. Other aspects will readily suggest themselves to those skilled in the art having the benefit of this disclosure. Reference will now be made in detail to implementations of the example aspects as illustrated in the accompanying drawings. The same reference indicators will be used to the extent possible throughout the drawings and the following description to refer to the same or like items.

In one exemplary aspect the proxy server includes an encryption module configured to identify elements of the web page and encrypt the program code of one or more selected web page elements. The web page elements may include but not limited to the text field the button field the data entry field the link to a file audio video graphics the hyperlink and other known HTML XML or other elements of web pages.

In one exemplary aspect the proxy server also includes a scripting module configured to create a script e.g. JavaScript code or the like modify the web page by adding the script thereto and delete the code of the web page elements which have been encrypted. The script may contain the following code a code of the elements of the web page encrypted by the encryption module and a code enabling decryption of the encrypted code of the web page elements when executed on the user device .

In one exemplary aspect the proxy server may contain a template of the script containing the code for decryption of the encrypted data contained in the script. Thus when creating the script the proxy server can make use of the template adding to it the encrypted code of the received web page elements.

The web page may be a document in HTML format which can contain links to files in different formats text graphics audio video scripts etc. databases and so on.

In one exemplary aspect the encryption module may contain a list of web page elements needing to be encrypted. The list of elements may be formulated in advance by an administrator or created automatically on the basis of statistics about the web page elements contained in the majority of web pages or also by using various techniques of DLP data leak prevention . In one exemplary aspect the list of elements contains web page elements which must be protected against possible theft by malicious software. For example the list may contain five text fields two links to graphics and also a link to a database.

In one exemplary aspect the encryption of the code of elements from the list of elements may be done using asymmetrical encryption methods such as the RSA algorithm . In this case the remote server previously creates a public and a private key of the remote server while the application creates a public and a private key of the application . Next the remote server and the application exchange their public keys. The public keys are needed to encrypt the data being transmitted while the private keys are needed to decrypt the data by the receiving party. In one exemplary aspect the proxy server may be configured to transmit the public encryption key needed by the application to encrypt a message sent to the proxy server . The decryption of the data the encrypted code of the web page elements may be done using the private encryption key of the application by executing the script containing the program code enabling decryption of the data.

In yet another exemplary aspect the encryption of the code of the web page elements may be done using symmetrical encryption such as the AES algorithm which is generally faster than asymmetrical encryption. In this case a secret encryption key is used designed for both encryption and decryption of data. In one exemplary aspect the secret encryption key can be created by the remote server and transmitted to the application using asymmetrical encryption. In another exemplary aspect the secret key can be changed periodically for example once a day or when a new browser session is opened .

In one exemplary aspect in step the encryption of the code of the web page elements from the list of elements may be done using asymmetrical encryption methods. In another exemplary aspect in step the proxy server may additionally send to the application the public key of the remote server needed by the application to encrypt the message of the application sent to the proxy server and also to encrypt the data being entered by the user in the web page elements.

In another exemplary aspect the encryption in step may be done using the public encryption key of the application while the application performs the decryption of the modified web page using its private key. The public encryption key of the application may be send to the proxy server in advance. In another exemplary aspect the encryption in step may be done using symmetrical encryption algorithm. In this case a single secret key is used both for data encryption and decryption. This secret key may be setup in advance between the application and the proxy server .

As an example the proxy server may receive a web page of an Internet banking website whose fields contain confidential data such as bank card data user s full name etc. . The encryption module may select for example web page elements used for data entry and those containing confidential data and encrypt the code of the selected elements. The code of the encrypted elements will be removed from the original web page and added to the script in an encrypted form which in turn will be included in the modified web page . Finally the modified web page will be sent to the application .

The encryption module is configured to encrypt a message intended for the application using the public encryption key of the application . The remote server then sends the encrypted message to the application .

The application receives the script from the remote server containing the public encryption key of the remote server as well as a message from the remote server encrypted with the public encryption key of the application which contains the web page elements of the web page . The application uses public encryption key of the remote server to encrypt the messages being sent to the remote server .

The application executes the script and sends a request to the remote server encrypted with the public encryption key of the remote server to receive a web page . The encryption of this request may be done by executing a script. The application also sends to the remote server the user s request to receive the code of elements of the web page encrypted with the public key of the remote server .

In one exemplary aspect the system may additionally have a second remote server on which resides a web page . In this case the remote server will act as a proxy server between the application and the second remote server.

In yet another exemplary aspect when the remote server performs the functions of the proxy server it receives a web page from the remote server based on request of the application in step . Next the proxy server executes the steps of . Finally in step the application receives the script from the proxy server having sent to it in step the modified web page for the application .

The personal computer in turn includes a hard disk for reading and writing of data a magnetic disk drive for reading and writing on removable magnetic disks and an optical drive for reading and writing on removable optical disks such as CD ROM DVD ROM and other optical information media. The hard disk the magnetic disk drive and the optical drive are connected to the system bus across the hard disk interface the magnetic disk interface and the optical drive interface respectively. The drives and the corresponding computer information media are power independent modules for storage of computer instructions data structures program modules and other data of the personal computer .

The present disclosure provides the implementation of a system that uses a hard disk a removable magnetic disk and a removable optical disk but it should be understood that it is possible to employ other types of computer information media which are able to store data in a form readable by a computer solid state drives flash memory cards digital disks random access memory RAM and so on which are connected to the system bus via the controller .

The computer has a file system where the recorded operating system is kept and also additional program applications other program modules and program data . The user is able to enter commands and information into the personal computer by using input devices keyboard mouse . Other input devices not shown can be used microphone joystick game controller scanner and so on. Such input devices usually plug into the computer system through a serial port which in turn is connected to the system bus but they can be connected in other ways for example with the aid of a parallel port a game port or a universal serial bus USB . A monitor or other type of display device is also connected to the system bus across an interface such as a video adapter . In addition to the monitor the personal computer can be equipped with other peripheral output devices not shown such as loudspeakers a printer and so on.

The personal computer is able to operate in a network environment using a network connection to one or more remote computers . The remote computer or computers are also personal computers or servers having the majority or all of the aforementioned elements in describing the nature of a personal computer . Other devices can also be present in the computer network such as routers network stations peer devices or other network nodes.

Network connections can form a local area computer network LAN and a wide area computer network WAN . Such networks are used in corporate computer networks and internal company networks and they generally have access to the Internet. In LAN or WAN networks the personal computer is connected to the local area network across a network adapter or network interface . When networks are used the personal computer can employ a modem or other modules for providing communications with a wide area computer network such as the Internet. The modem which is an internal or external device is connected to the system bus by a serial port . It should be noted that the network connections are only examples and need not depict the exact configuration of the network i.e. in reality there are other ways of establishing a connection of one computer to another by technical communication modules.

In various aspects the systems and methods described herein may be implemented in hardware software firmware or any combination thereof. If implemented in software the methods may be stored as one or more instructions or code on a non transitory computer readable medium. Computer readable medium includes data storage. By way of example and not limitation such computer readable medium can comprise RAM ROM EEPROM CD ROM Flash memory or other types of electric magnetic or optical storage medium or any other medium that can be used to carry or store desired program code in the form of instructions or data structures and that can be accessed by a processor of a general purpose computer.

In various aspects the systems and methods described in the present disclosure can be addressed in terms of modules. The term module as used herein refers to a real world device component or arrangement of components implemented using hardware such as by an application specific integrated circuit ASIC or field programmable gate array FPGA for example or as a combination of hardware and software such as by a microprocessor system and a set of instructions to implement the module s functionality which while being executed transform the microprocessor system into a special purpose device. A module can also be implemented as a combination of the two with certain functions facilitated by hardware alone and other functions facilitated by a combination of hardware and software. In certain implementations at least a portion and in some cases all of a module can be executed on the processor of a general purpose computer such as the one described in greater detail in above . Accordingly each module can be realized in a variety of suitable configurations and should not be limited to any particular implementation exemplified herein.

In the interest of clarity not all of the routine features of the aspects are disclosed herein. It would be appreciated that in the development of any actual implementation of the present disclosure numerous implementation specific decisions must be made in order to achieve the developer s specific goals and these specific goals will vary for different implementations and different developers. It is understood that such a development effort might be complex and time consuming but would nevertheless be a routine undertaking of engineering for those of ordinary skill in the art having the benefit of this disclosure.

Furthermore it is to be understood that the phraseology or terminology used herein is for the purpose of description and not of restriction such that the terminology or phraseology of the present specification is to be interpreted by the skilled in the art in light of the teachings and guidance presented herein in combination with the knowledge of the skilled in the relevant art s . Moreover it is not intended for any term in the specification or claims to be ascribed an uncommon or special meaning unless explicitly set forth as such.

The various aspects disclosed herein encompass present and future known equivalents to the known modules referred to herein by way of illustration. Moreover while aspects and applications have been shown and described it would be apparent to those skilled in the art having the benefit of this disclosure that many more modifications than mentioned above are possible without departing from the inventive concepts disclosed herein.

