---

title: Method and system for providing enhanced location based service (ELBS) trilateration using a single device
abstract: Methods, devices and systems for generating enhanced location information on or about a mobile device may include receiving (via a processor of the mobile device) location information from one or more of a sensor of the mobile device and an external system, generating (via the processor) a first waypoint based on the received location information, receiving network provided location information, generating a second waypoint based on the received network provided location information, retrieving dead reckoning location information, generating a third waypoint based on the received network provided location information, applying the first, second and third waypoints to a kalman filter to generate precise location information, and using the precise location information to provide the enhanced location based service.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09568585&OS=09568585&RS=09568585
owner: RIVADA RESEARCH, LLC
number: 09568585
owner_city: Colorado Springs
owner_country: US
publication_date: 20151207
---
This application is a continuation in part of U.S. patent application Ser. No. 14 834 758 entitled Method and System for Providing Enhanced Location Based Information for Wireless Handsets filed on Aug. 25 2015 which is a continuation of U.S. patent application Ser. No. 14 690 713 entitled Method and System for Providing Enhanced Location Based Information for Wireless Handsets filed on Apr. 20 2015 which is a continuation in part of U.S. patent application Ser. No. 14 293 056 entitled Method and System for Providing Enhanced Location Based Information for Wireless Handsets filed on Jun. 2 2014 which is a continuation of U.S. patent application Ser. No. 13 585 125 entitled Method and System for Providing Enhanced Location Based Information for Wireless Handsets filed Aug. 14 2012 and which claims the benefit of priority of U.S. Provisional Application No. 61 575 300 entitled Method and System for Providing Enhanced Location Based Information for Wireless Handsets filed Aug. 18 2011 and U.S. Provisional Application No. 61 573 636 entitled Method and System for Providing Enhanced Location Based Information for Wireless Handsets filed Sep. 9 2011 the entire contents of all of which are hereby incorporated by reference.

The present application relates generally to a wireless mobile communication system and more particularly to methods and systems that provide enhanced location information for wireless mobile devices.

Wireless communication technologies and mobile electronic devices e.g. cellular phones tablets laptops etc. have grown in popularity and use over the past several years. To keep pace with increased consumer demands mobile electronic devices have become more powerful and feature rich and now commonly include global positioning system GPS receivers sensors and many other components for connecting users to friends work leisure activities and entertainment. However despite these advancements mobile devices remain lacking in their ability to provide effective location based services information or communications. As mobile devices and technologies continue to grow in popularity and use generating enhanced location information for mobile devices is expected to become an important and challenging design criterion for mobile device manufactures and network engineers.

The methods and apparatuses of various embodiments provide devices circuits and methods for precise location determination in multi technology communications devices. Embodiment methods may include determining by a processor of the mobile device an initial position generating by the processor at least one set of local position information based on locally determined location information receiving by an antenna of the mobile device location information from one or more external location tracking systems generating by the processor at least one set of external position information based on the received location information from the one or more external location tracking systems receiving by the antenna distance information from multiple mobile devices in a communication group generating by the processor at least one set of proximity position information based on the received location information from the multiple mobile devices in the communication group generating by the processor a final location estimation set comprising a position velocity and acceleration based on the set of local position information the set of external position information the set of proximity position information and the initial position and utilizing by the processor the final location estimation set to provide a location based service.

In some embodiments the position velocity and acceleration each have a latitude component a longitude component and an altitude component. In such embodiments generating any of the set of local position information the set of external position information or the set of proximity position information may further include separating by the processor location information into a set of latitude components a set of longitude components and a set of altitude components and executing by the processor a kalman filter on each of the set of latitude components the set of longitude components and the set of altitude components to produce position information. Such embodiments may include determining an error associated with generation of the position information.

Some embodiments may include updating by the processor the set of local position information after a predetermined time interval to produce updated local position information updating by the processor the set of external position information after a predetermined time interval to produce updated external position information and updating by the processor the set of proximity position information after a predetermined time interval to produce updated proximity position information. Such embodiments may include updating by the processor the final location estimation set based on the updated set of local position information the updated set of external position information the updated set of proximity position information and the final location estimation set to produce an updated final location estimation set. Alternatively in such embodiments updating any of the local position information external position information or proximity position information may comprise determining by the processor if updated location information or distance information is available combining by the processor current location information or distance information with an error value in response to determining that updated location information or updated distance information is not available. In another alternative of such embodiments the predetermined interval may be a time interval between successive determinations of the locally determined location information.

In some embodiments the distance information may comprise a distance from the mobile device to a respective wireless communications device.

In some embodiments locally determined location information may be obtained using combination of local sensor outputs.

In some embodiments the one or more external tracking systems may comprise a global positioning GPS .

Further embodiments include methods of providing an enhanced location based service via a mobile device including receiving via a processor of the mobile device location information from one or more of a sensor of the mobile device and an external system generating via the processor a first waypoint based on the received location information receiving network provided location information generating a second waypoint based on the received network provided location information retrieving dead reckoning location information generating a third waypoint based on the received network provided location information applying the first second and third waypoints to a kalman filter to generate precise location information and using the precise location information to provide the enhanced location based service.

In an embodiment receiving the location information from one or more of a sensor of the mobile device and an external system includes receiving one or more of global positioning system GPS data Loran C data Cellular identifier Cell ID data WiFi data beacon data and radio frequency identification RFID data and receiving the network provided location information includes receiving the network provided location information from one of a network server and an eNodeB. In an embodiment the method may include sending the precise location information to a network server receiving on the mobile device location information from the network server in response to sending the precise location information and generating more precise location information based on the location information received from the network server.

In a further embodiment sending the precise location information to a network server includes sending one of a final waypoint and a final location estimation set to the network server and generating more precise location information based on the location information received from the network server includes generating one of an updated final waypoint and an updated final location estimation set based on the location information received from the network server. In an embodiment the method may include grouping the mobile device with a wireless transceiver in proximity to the mobile device to form a communication group sending the precise location information to the wireless transceiver receiving on the mobile device location information from the wireless transceiver in response to sending the precise location information and generating more precise location information based on the location information received from the wireless transceiver.

In an embodiment the method may include determining whether the location information from one or more of the sensor and the external system has been reported and generating the first waypoint based on the received location information includes generating a new waypoint and selecting the new waypoint as the first waypoint in response to determining that the location information from one or more of the sensor and the external system has been reported and selecting as the first waypoint one of a plurality of previously generated waypoints in response determining that the location information from one or more of the sensor and the external system has not been reported.

In a further embodiment generating the first waypoint based on the received location information includes further includes determining whether a memory of the mobile device stores previously generated waypoints and generating the first waypoint to include a null value in response to determining that the memory does not store previously generated waypoints and in which selecting as the first waypoint one of a plurality of previously generated waypoints in response determining that the location information from one or more of the sensor and the external system has not been reported includes selecting as the first waypoint one of the plurality of previously generated waypoints in response determining that memory of the mobile device stores previously generated waypoints.

In an embodiment the method may include determining whether the network provided location information has been reported and generating the second waypoint based on the network provided location information includes generating a new waypoint and selecting the new waypoint as the second waypoint in response to determining that the network provided location information has been reported and selecting as the second waypoint one of a plurality of previously generated waypoints in response determining that the network provided location information has not been reported.

In an embodiment the method may include determining whether the dead reckoning location information is available and determining whether the dead reckoning location information has been reported in response to determining that the dead reckoning location information is available and generating the third waypoint based on the dead reckoning location information includes generating the third waypoint to include a null value in response to determining that dead reckoning location information is available generating a new waypoint and selecting the new waypoint as the third waypoint in response to determining that the dead reckoning location information has been reported and selecting as the third waypoint one of a plurality of previously generated waypoints in response determining that the dead reckoning location information has not been reported.

In a further embodiment generating a third waypoint based on the received network provided location information includes generating a location estimation set that includes a position value a velocity value and an acceleration value based on the network provided location information. In a further embodiment generating a third waypoint based on the received network provided location information includes generating a location estimation set that includes latitude value a longitude value and an altitude value based on the network provided location information. In a further embodiment applying the first second and third waypoints to the kalman filter to generate precise location information includes applying the first second and third waypoints to the kalman filter to generate a final location estimation set including position information velocity information and acceleration information. In a further embodiment the position information velocity information and acceleration information each include a latitude value a longitude value and an altitude value.

Further embodiments include a non transitory computer readable storage medium having stored thereon processor executable software instructions configured to cause a processor of a mobile device to perform operations including receiving location information from one or more of a sensor of the mobile device and an external system generating a first waypoint based on the received location information receiving network provided location information generating a second waypoint based on the received network provided location information retrieving dead reckoning location information generating a third waypoint based on the received network provided location information applying the first second and third waypoints to a kalman filter to generate precise location information and using the precise location information to provide the enhanced location based service.

In an embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that receiving the location information from one or more of a sensor of the mobile device and an external system includes receiving one or more of global positioning system GPS data Loran C data Cellular identifier Cell ID data WiFi data beacon data and radio frequency identification RFID data and receiving the network provided location information includes receiving the network provided location information from one of a network server and an eNodeB.

In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations further including sending the precise location information to a network server receiving on the mobile device location information from the network server in response to sending the precise location information and generating more precise location information based on the location information received from the network server. In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that sending the precise location information to a network server includes sending one of a final waypoint and a final location estimation set to the network server and generating more precise location information based on the location information received from the network server includes generating one of an updated final waypoint and an updated final location estimation set based on the location information received from the network server.

In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations further including grouping the mobile device with a wireless transceiver in proximity to the mobile device to form a communication group sending the precise location information to the wireless transceiver receiving on the mobile device location information from the wireless transceiver in response to sending the precise location information and generating more precise location information based on the location information received from the wireless transceiver.

In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations further including determining whether the location information from one or more of the sensor and the external system has been reported and the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that generating the first waypoint based on the received location information includes generating a new waypoint and selecting the new waypoint as the first waypoint in response to determining that the location information from one or more of the sensor and the external system has been reported and selecting as the first waypoint one of a plurality of previously generated waypoints in response determining that the location information from one or more of the sensor and the external system has not been reported.

In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that generating the first waypoint based on the received location information includes further includes determining whether a memory of the mobile device stores previously generated waypoints and generating the first waypoint to include a null value in response to determining that the memory does not store previously generated waypoints and the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that selecting as the first waypoint one of a plurality of previously generated waypoints in response determining that the location information from one or more of the sensor and the external system has not been reported includes selecting as the first waypoint one of the plurality of previously generated waypoints in response determining that memory of the mobile device stores previously generated waypoints.

In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations further including determining whether the network provided location information has been reported and the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that generating the second waypoint based on the network provided location information includes generating a new waypoint and selecting the new waypoint as the second waypoint in response to determining that the network provided location information has been reported and selecting as the second waypoint one of a plurality of previously generated waypoints in response determining that the network provided location information has not been reported.

In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations further including determining whether the dead reckoning location information is available and determining whether the dead reckoning location information has been reported in response to determining that the dead reckoning location information is available and the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that generating the third waypoint based on the dead reckoning location information includes generating the third waypoint to include a null value in response to determining that dead reckoning location information is available generating a new waypoint and selecting the new waypoint as the third waypoint in response to determining that the dead reckoning location information has been reported and selecting as the third waypoint one of a plurality of previously generated waypoints in response determining that the dead reckoning location information has not been reported.

In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that generating a third waypoint based on the received network provided location information includes generating a location estimation set that includes a position value a velocity value and an acceleration value based on the network provided location information. In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that generating a third waypoint based on the received network provided location information includes generating a location estimation set that includes latitude value a longitude value and an altitude value based on the network provided location information.

In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that applying the first second and third waypoints to the kalman filter to generate precise location information includes applying the first second and third waypoints to the kalman filter to generate a final location estimation set including position information velocity information and acceleration information. In a further embodiment the stored processor executable software instructions may be configured to cause a processor of a mobile device to perform operations such that the position information velocity information and acceleration information each include a latitude value a longitude value and an altitude value.

Further embodiments include a mobile device including a memory and a processor coupled to the memory and the processor is configured with processor executable instructions to perform operations including receiving location information from one or more of a sensor of the mobile device and an external system generating a first waypoint based on the received location information receiving network provided location information generating a second waypoint based on the received network provided location information retrieving dead reckoning location information generating a third waypoint based on the received network provided location information applying the first second and third waypoints to a kalman filter to generate precise location information and using the precise location information to provide the enhanced location based service.

In an embodiment the processor may be configured with processor executable instructions to perform operations such that receiving the location information from one or more of a sensor of the mobile device and an external system includes receiving one or more of global positioning system GPS data Loran C data Cellular identifier Cell ID data WiFi data beacon data and radio frequency identification RFID data and receiving the network provided location information includes receiving the network provided location information from one of a network server and an eNodeB.

In a further embodiment the processor may be configured with processor executable instructions to perform operations further including sending the precise location information to a network server receiving on the mobile device location information from the network server in response to sending the precise location information and generating more precise location information based on the location information received from the network server. In a further embodiment the processor may be configured with processor executable instructions to perform operations such that sending the precise location information to a network server includes sending one of a final waypoint and a final location estimation set to the network server and generating more precise location information based on the location information received from the network server includes generating one of an updated final waypoint and an updated final location estimation set based on the location information received from the network server.

In a further embodiment the processor may be configured with processor executable instructions to perform operations further including grouping the mobile device with a wireless transceiver in proximity to the mobile device to form a communication group sending the precise location information to the wireless transceiver receiving on the mobile device location information from the wireless transceiver in response to sending the precise location information and generating more precise location information based on the location information received from the wireless transceiver.

In a further embodiment the processor may be configured with processor executable instructions to perform operations further including determining whether the location information from one or more of the sensor and the external system has been reported and the processor may be configured with processor executable instructions to perform operations such that generating the first waypoint based on the received location information includes generating a new waypoint and selecting the new waypoint as the first waypoint in response to determining that the location information from one or more of the sensor and the external system has been reported and selecting as the first waypoint one of a plurality of previously generated waypoints in response determining that the location information from one or more of the sensor and the external system has not been reported. In a further embodiment the processor may be configured with processor executable instructions to perform operations such that generating the first waypoint based on the received location information includes further includes determining whether a memory of the mobile device stores previously generated waypoints and generating the first waypoint to include a null value in response to determining that the memory does not store previously generated waypoints and the processor may be configured with processor executable instructions to perform operations such that selecting as the first waypoint one of a plurality of previously generated waypoints in response determining that the location information from one or more of the sensor and the external system has not been reported includes selecting as the first waypoint one of the plurality of previously generated waypoints in response determining that memory of the mobile device stores previously generated waypoints.

In a further embodiment the processor may be configured with processor executable instructions to perform operations further including determining whether the network provided location information has been reported and the processor may be configured with processor executable instructions to perform operations such that generating the second waypoint based on the network provided location information includes generating a new waypoint and selecting the new waypoint as the second waypoint in response to determining that the network provided location information has been reported and selecting as the second waypoint one of a plurality of previously generated waypoints in response determining that the network provided location information has not been reported.

In a further embodiment the processor may be configured with processor executable instructions to perform operations further including determining whether the dead reckoning location information is available and determining whether the dead reckoning location information has been reported in response to determining that the dead reckoning location information is available and the processor may be configured with processor executable instructions to perform operations such that generating the third waypoint based on the dead reckoning location information includes generating the third waypoint to include a null value in response to determining that dead reckoning location information is available generating a new waypoint and selecting the new waypoint as the third waypoint in response to determining that the dead reckoning location information has been reported and selecting as the third waypoint one of a plurality of previously generated waypoints in response determining that the dead reckoning location information has not been reported.

In a further embodiment the processor may be configured with processor executable instructions to perform operations such that generating a third waypoint based on the received network provided location information includes generating a location estimation set that includes a position value a velocity value and an acceleration value based on the network provided location information. In a further embodiment the processor may be configured with processor executable instructions to perform operations such that generating a third waypoint based on the received network provided location information includes generating a location estimation set that includes latitude value a longitude value and an altitude value based on the network provided location information.

In a further embodiment the processor may be configured with processor executable instructions to perform operations such that applying the first second and third waypoints to the kalman filter to generate precise location information includes applying the first second and third waypoints to the kalman filter to generate a final location estimation set including position information velocity information and acceleration information. In a further embodiment the processor may be configured with processor executable instructions to perform operations such that the position information velocity information and acceleration information each include a latitude value a longitude value and an altitude value.

Embodiments include a multi technology communication device having one or more processors or processor cores configured with processor executable instructions to perform operations of one or more of the embodiment methods described above.

Embodiments include a non transitory processor readable medium having stored thereon processor executable software instructions to cause a processor to perform operations of one or more of the embodiment methods described above or herein.

The various embodiments will be described in detail with reference to the accompanying drawings. Wherever possible the same reference numbers will be used throughout the drawings to refer to the same or like parts. References made to particular examples and implementations are for illustrative purposes and are not intended to limit the scope of the invention or the claims.

The word exemplary is used herein to mean serving as an example instance or illustration. Any implementation described herein as exemplary is not necessarily to be construed as preferred or advantageous over other implementations.

The terms mobile device cellular telephone and cell phone are used interchangeably herein to refer to any one or all of cellular telephones smartphones personal data assistants PDA s laptop computers tablet computers ultrabooks palm top computers wireless electronic mail receivers multimedia Internet enabled cellular telephones wireless gaming controllers and similar personal electronic devices which include a programmable processor a memory and circuitry for sending and or receiving wireless communication signals. While the various embodiments are particularly useful in mobile devices such as cellular telephones which have limited battery life the embodiments are generally useful in any computing device that may be used to wirelessly communicate information.

The terms wireless network network cellular System cell tower and radio access point may used generically and interchangeably to refer to any one of various wireless mobile systems. In an embodiment wireless network may be a radio access point e.g. a cell tower which provides the radio link to the mobile device so that the mobile device can communicate with the core network.

A number of different cellular and mobile communication services and standards are available or contemplated in the future all of which may implement and benefit from the various embodiments. Such services and standards include e.g. third generation partnership project 3GPP long term evolution LTE systems third generation wireless mobile communication technology 3G fourth generation wireless mobile communication technology 4G global system for mobile communications GSM universal mobile telecommunications system UMTS 3GSM general packet radio service GPRS code division multiple access CDMA systems e.g. cdmaOne CDMA2000 enhanced data rates for GSM evolution EDGE advanced mobile phone system AMPS digital AMPS IS 136 TDMA evolution data optimized EV DO digital enhanced cordless telecommunications DECT Worldwide Interoperability for Microwave Access WiMAX wireless local area network WLAN public switched telephone network PSTN Wi Fi Protected Access I II WPA WPA2 Bluetooth integrated digital enhanced network iden and land mobile radio LMR . Each of these technologies involves for example the transmission and reception of voice data signaling and or content messages. It should be understood that any references to terminology and or technical details related to an individual telecommunication standard or technology are for illustrative purposes only and are not intended to limit the scope of the claims to a particular communication system or technology unless specifically recited in the claim language.

A number of different methods technologies solutions and or techniques herein collectively solutions are currently available for determining the location of mobile device any or all of which may be implemented by included in and or used by the various embodiments. Such solutions include e.g. global positioning system GPS based solutions assisted GPS A GPS solutions and cell based positioning solutions such as cell of origin COO time of arrival TOA observed time difference of arrival OTDOA advanced forward link trilateration AFLT and angle of arrival AOA . In various embodiments such solutions may implemented in conjunction with one or more wireless communication technologies and or networks including wireless wide area networks WWANs wireless local area networks WLANs wireless personal area networks WPANs and other similar networks or technologies. By way of example a WWAN may be a Code Division Multiple Access CDMA network a Frequency Division Multiple Access FDMA network an OFDMA network a 3GPP LTE network a WiMAX IEEE 802.16 network and so on. The WPAN may be a Bluetooth network an IEEE 802.15x network and so on. A WLAN may be an IEEE 802.11x network and so on. A CDMA network may implement one or more radio access technologies RATs such as CDMA2000 Wideband CDMA W CDMA and so on.

Various embodiments discussed herein may generate compute and or make use of location information pertaining to one or more mobile devices. Such location information may be useful for providing and or implementing a variety of location based services including emergency location services commercial location services internal location services and lawful intercept location services. By way of example emergency location services may include services relating to the provision of location and or identification information to emergency service personal and or emergency systems e.g. to 911 system commercial location services may include any general or value added service e.g. asset tracking services navigation services location based advertising services etc internal location services may include services pertaining to the management of the wireless service provider network e.g. radio resource management services message delivery services paging services call delivery services services for providing position location network enhancements etc. and lawful intercept location services may include any service that provides public safety and or law enforcement agencies with identification and or location information pertaining to a mobile device or a mobile device user. While the various embodiments are particularly useful in applications that fall within one or more of the categories types of location based services discussed above the embodiments are generally useful in any application or service that benefits from location information.

Modern mobile electronic devices e.g. mobile phones typically include one or more geospatial positioning systems components for determining the geographic location of the mobile device. Location information obtained by these geospatial systems may be used by location aware mobile software applications e.g. Google Maps Yelp Twitter Places Find my Friends on Apple etc. to provide users with information regarding the mobile device s physical location at a given point in time. In recent years such location based services and software applications have increased in popularity and use and now enable mobile device users to navigate cities read reviews of nearby restaurants and services track assets or friends obtain location based safety advice and or take advantage of many other location based services on their mobile devices.

Consumers of modern mobile devices now demand more advanced robust and feature rich location based services than that which is currently available on their mobile devices. However despite many recent advances in mobile and wireless technologies mobile devices remain lacking in their ability to provide their users consumers with location based services that are accurate or powerful enough to meet the demands of these consumers. For example while existing location aware mobile software applications e.g. Find my Friends on Apple Google Latitude etc. enable a mobile device user to view the approximate geographical position of other mobile devices on a two dimensional map they lack the capability to accurately efficiently and consistently pin point the precise location and or position of the other mobile devices in all three dimensions and or within a wireless communication network. The various embodiments overcome these and other limitations of existing solutions by collecting information from multiple mobile devices generating more precise location information on or about one or more mobile devices generating advanced three dimensional location and position information on or about one or more mobile devices and using the generated location information to provide mobile device users with more accurate more powerful and more reliable location based services.

One of the challenges associated with using geo spatial positioning technology on a mobile device is that the mobile device s ability to acquire satellite signals and navigation data to calculate its geospatial location called performing a fix may be hindered when the mobile device is indoors below grade and or when the satellites are obstructed e.g. by tall buildings etc. . The presence of physical obstacles such as metal beams or walls may cause multipath interference and signal degradation of the wireless communication signals when the mobile device is indoors or in urban environments that include tall buildings or skyscrapers. In rural environments the mobile device may not have sufficient access to satellite communications e.g. to a global positioning system satellite to effectively ascertain the mobile device s current location. These and other factors often cause existing geo spatial technologies to function inaccurately and or inconsistently on mobile devices and hinder the mobile device user s ability to fully utilize location aware mobile software applications and or other location based services and applications on his her mobile device.

Another problem with using existing geo spatial positioning technologies is that position accuracy afforded by existing technologies is not sufficient for use in emergency services due to the relatively high level of position accuracy required by these services.

The various embodiments include improved location determination solutions that determine the location of a mobile device at the level of position accuracy which is suitable for use in emergency location services commercial location services internal location services and lawful intercept location services.

Generally there are three basic approaches for determining the location of mobile devices in a communication network a mobile device centric approach a network centric approach and a hybrid approach that may include aspects of both the mobile device centric approach and the network centric approach.

In an embodiment the communication network may be a cellular telephone network. A typical cellular telephone network includes a plurality of cellular base stations coupled to a network operations center which operates to connect voice and data calls between mobile devices e.g. mobile phones and other network destinations such as via telephone land lines e.g. a POTS network not shown and the Internet . Communications between the mobile devices and the cellular telephone network may be accomplished via two way wireless communication links such as 4G 3G CDMA TDMA and other cellular telephone communication technologies. The network may also include one or more servers coupled to or within the network operations center that provide connections to the Internet .

In various embodiments the mobile device may be configured to communicate with a radio access node which can include any wireless base station or radio access point such as LTE CDMA2000 EVDO WCDMA HSPA IS 136 GSM WiMax WiFi AMPS DECT TD SCDMA or TD CDMA and switch Land Mobile Radio LMR interoperability equipment a satellite Fixed Service Satellite FSS for remote interconnection to the Internet and PSTN.

In an embodiment the radio access points may be configured to determine the location of the mobile device relative to a known location of a network component such as the illustrated radio access point . In this manner the additional radio equipment installed on the radio access points provides the communication system with similar functionality as is provided by a GPS receiver for signals received from the mobile device. For example the radio equipment on one or more of the radio access points may measure how long it takes for the radio signal to travel from the mobile device to another radio access point and using trilateration techniques e.g. time of arrival angle of arrival or a combination thereof the mobile device or a network server may estimate the location of the mobile device to within an accuracy of to meters. Once the network has estimated the latitude and longitude coordinates of the mobile device this information may be used to determine the geo spatial location of the mobile device which may be communicated to other systems servers or components via the Internet .

Various embodiments may implement and or make use of a hybrid approach for determining the location of mobile devices in a communication network which may include aspects of both the device centric and the network centric approaches discussed above with reference to . For example an embodiment system mobile device or network component e.g. severs radio access points etc. may be configured to implement a hybrid approach in which dead reckoning also known as deduced reckoning techniques GPS capabilities of the mobile device and mobile to mobile i.e. mobile device to mobile device trilateration are used to produce position estimates of increased accuracy. In another embodiment the system devices and or components may be configured to implement a hybrid approach in which the GPS capabilities of mobile devices the measured signal strengths and or radio energy of radio signals transmitted from the mobile devices and known locations of network components may be used in combination to estimate the locations of one or more mobile devices in the network. In a further embodiment system devices and or components may be configured to dynamically determine the factors e.g. radio signal strength GPS etc. to measure and or use in determining the location of the mobile devices.

The phone may also include one or more sensors for monitoring physical conditions e.g. location motion acceleration orientation altitude etc. . The sensors may include any or all of a gyroscope an accelerometer a magnetometer a magnetic compass an altimeter an odometer and a pressure sensor. The sensors may also include various bio sensors e.g. heart rate monitor body temperature sensor carbon sensor oxygen sensor etc. for collecting information pertaining to environment and or user conditions. The sensors may also be external to the mobile device and paired or grouped to the mobile device via a wired or wireless connection e.g. Bluetooth etc. . In embodiment the mobile device may include two or more of the same type of sensor e.g. two accelerometers etc. .

The phone may also include a GPS receiver configured to receive GPS signals from GPS satellites to determine the geographic location of the phone. The phone may also include circuitry for transmitting wireless signals to radio access points and or other network components. The phone may further include other components sensors for determining the geographic position location of the phone such as components for determining the radio signal delays e.g. with respect to cell phone towers and or cell sites performing trilateration and or multilateration operations identifying proximity to known networks e.g. Bluetooth networks WLAN networks WiFi etc. and or for implementing other known geographic location technologies.

The phone may also include a system acquisition function configured to access and use information contained in a subscriber identity module SIM universal subscriber identity module USIM and or preferred roaming list PRL to for example determine the order in which listed frequencies or channels will be attempted when the phone is to acquire connect to a wireless network or system. In various embodiments the phone may be configured to attempt to acquire network access i.e. attempt to locate a channel or frequency with which it can access the wireless communication network at initial power on and or when a current channel or frequency is lost which may occur for a variety of reasons .

The phone may include pre built in USIM SIM PRL or access point information. In an embodiment the mobile device may be configured for first responders and or public safety network by for example setting the incident radio system as the default and or preferred communication system.

As mentioned above despite recent advances in mobile and wireless communication technologies determining the specific location of a mobile device in a wireless network remains a challenging task for a variety of reasons including the variability of environmental conditions in which mobile devices are often used by consumers deficiencies in existing technologies for computing and or measuring location information on mobile devices and the lack of uniform standards. For example there is currently no universally accepted standard for implementing or providing location based services. As a result mobile device designers and wireless network operators in conjunction with local public safety and third party providers are using a variety of inefficient incoherent and sometimes incompatible methods technologies solutions and or techniques to determine the location of a mobile device and or to provide location based services.

While there are no universally accepted standards for implementing or providing location based services there are certain requirements or standards associated with determining the location of a mobile device that may be of use in various embodiments. The U.S. Congress has mandated that cellular service providers configure their networks communication systems and or mobile devices so that the locations of mobile devices can be determined when a 911 call is placed. To implement Congress s mandate the Federal Communications Commission FCC requested cellular service providers upgrade their systems in two phases herein Phase I and Phase II respectively . While the level of precision accuracy provided by these Phase I and II upgrades are generally inadequate for providing effective location based services that meet the demands of modern users of mobile devices these upgrades provide a foundation from which more effective location based solutions may be built.

As mentioned above the FCC requested cellular service providers upgrade their systems in two phases. In the first phase Phase I cellular service providers were to upgrade their systems so that emergency calls e.g. 911 calls are routed to the public service answering point PSAP closest to the cell tower antenna with which the mobile device is connected and so that PSAP call takers can view the phone number of the mobile device and the location of the connecting cell tower. The location of the connecting cell tower may be used to identify the general location of the mobile device within a 3 6 mile radius.

In the second phase Phase II cellular service providers were to upgrade their systems so that PSAP call takers could identify the location of the mobile device to within 300 meters. To meet these Phase II requirements wireless service providers have implemented a variety of technologies and depending on the technology used can generally identify the location of the mobile device to within 50 300 meters. For example on systems that have implemented a network based solution e.g. triangulation of nearby cell towers etc. the location of a mobile device can be determined within an accuracy of 100 meters 67 of the time and to within an accuracy of 300 meters 95 of the time. On systems that have adopted a mobile device based solution e.g. embedded global positioning system receivers etc. the location of the mobile device may be determined to within 50 meters 67 of the time and to within 150 meters 95 of the time.

Existing phase I and II solutions alone are not adequate for generating location information having sufficient accuracy or detail for use in providing accurate powerful and reliable location based services. Various embodiments may use some or all of the capabilities built into existing systems e.g. as part of phase I and II upgrades device centric systems network centric systems etc. in conjunction with more advanced location determination techniques to compute location information suitable for the advanced location based services demanded by today s consumers.

In addition to the three basic approaches discussed above a number of different solutions are currently available for determining the location of mobile device any or all of which may be implemented by and or included in the various embodiments.

Most conventional location determination solutions use distance estimation techniques that are based on single carrier signals and one of the fundamental operations in ground based or network centric location determination solutions is timing estimation of a first arrival path of a signal. That is a single carrier signal transmitted between a transceiver and a mobile device can be received via multiple paths i.e. multipath and the multiple paths of the signal can have different received powers and arrival times. The received signal may be cross correlated to distinguish the multiple paths of the received signal. In this method it is generally assumed that the first arrival path e.g. first detected signal strongest signal etc. is associated with the path traveling the shortest distance and hence is the right value to use in estimating distance between the mobile device and the transceiver. Often this first arrival path is the strongest path due to zero or fewer reflections relative to the other paths between the transceiver and the mobile device.

In various embodiments the first arrival time of the identified first arrival path may be used in addition to other parameters e.g. an estimated signal transmission time and or a time offset between clocks of the transceiver and the mobile device etc. to estimate distance between a mobile device and a network component e.g. another mobile device a transceiver an access point a base station etc. . The first arrival time may be estimated by the mobile device e.g. based on the downlink received signal or by the network component e.g. based on an uplink received signal .

The location of the mobile device may also be determined by estimating the distance between the mobile device and a network component or other signal sources e.g. a transceiver ground or satellite based signal sources etc. . For example the location of the mobile device may be determined by performing trilateration using estimated distances between multiple e.g. three or more transceivers and the mobile device.

Another location determination solution may include computing an observed time difference of arrival OTDOA value by measuring the timing of signals received from three network components e.g. mobile devices transceivers access points etc. . For example a mobile device may be configured to compute two hyperbolas based on a time difference of arrival between a reference transceiver signal and signals of two neighbor transceivers. The intersection of the computed hyperbolas may define a position on the surface of the earth that may be used by various embodiments to determine the location of the mobile device.

The accuracy of such OTDOA solutions may be a function of the resolution of the time difference measurements and the geometry of the neighboring transceivers. As such implementing an OTDOA solution may require determining the precise timing relationship between the neighboring transceivers. However in existing asynchronous networks this precise timing relationship may be difficult to ascertain.

In various embodiments location measurement units LMUs may be added throughout a deployment region of an asynchronous network to measure compute timing information for one or more network components e.g. transceivers relative to a high quality timing reference signal. For example a mobile device or an LMU may determine the observed time difference between frame timing of transceiver signals and the observed time difference may be sent to the transceiver or a radio network controller of the communication network to determine the location of the mobile device. The location of the mobile device may also be determined based on the observed time difference and assistance data e.g. position of the reference and neighbor transceivers received from the communication network.

Another location determination solution may include computing an uplink time difference of arrival U TDOA based on network measurements of the time of arrival of a known signal sent from the mobile device and received at multiple e.g. four or more LMUs. For example LMUs may be positioned in the geographic vicinity of the mobile device to accurately measure the time of arrival of known signal bursts and the location of the mobile device may be determined using hyperbolic trilateration based on the known geographical coordinates of the LMUs and the measured time of arrival values.

As discussed above conventional location determination solutions are typically based on single carrier signals. The various embodiments include a ground based location determination solution based on multi carrier signals. A location determination solution based on multi carrier signals may improve the accuracy of the computed location information by for example improving the accuracy of the timing estimation e.g. by expanding the bandwidth of cellular signals . Location determination solutions based on multiple carriers may be used in both the device centric e.g. mobile device based and network centric e.g. base station based approaches and may be applied to both 3GPP and 3GPP2 wireless communication technologies.

In various embodiments a mobile device may be configured to determine its geospatial location based on information collected from mobile device sensors e.g. gyroscope accelerometer magnetometer pressure sensor etc. information received from other mobile devices and information received from network components in a communication system.

The MME may request user and subscription information from a home subscriber server HSS perform various administrative tasks e.g. user authentication enforcement of roaming restrictions etc. and send various user and control information to the S GW . The S GW may receive and store the information sent by the MME e.g. parameters of the IP bearer service network internal routing information etc. generate data packets and forward the data packets to a packet data network gateway P GW . The P GW may process and forward the packets to a policy and control enforcement function PCEF which receives the packets and requests charging control policies for the connection from a policy and charging rules function PCRF . The PCRF provides the PCEF with policy rules that it enforces to control the bandwidth the quality of service QoS and the characteristics of the data and services being communicated between the network e.g. Internet service network etc. and the mobile device . In an embodiment the PCEF may be a part of or perform operations typically associated with the P GW . Detailed information about policy and charging enforcement function operations may be found in 3rd Generation Partnership Project Technical Specification Group Services and System Aspects Policy and Charging Control Architecture TS 23.203 the entire contents of which are incorporated herein by reference.

In an embodiment the network may also include an Evolved Serving Mobile Location Center E SMLC . Generally the E SMLC collects and maintains tracking information about the mobile device . The E SMLC may be configured to provide location services via a lightweight presentation protocol LLP which supports the provision of application services on top of TCP IP networks. The E SMLC may send or receive e.g. via LPP almanac and or assistance data to and from the MME and or eNB . The E SMLC may also forward external or network initiated location service requests to the MME .

In addition the mobile device may receive information from the serving eNodeB via System Information Blocks that includes the neighbor cells to scan that are on the same system using the same frequencies or different frequencies Home eNB HeNB in addition to CDMA GERAN and UTRA cells.

In various embodiments the mobile device may be configured to determine its geospatial location based on information collected from mobile device sensors e.g. gyroscope accelerometer magnetometer pressure sensor etc. information received from other mobile devices and information received from network components in a communication system. In an embodiment the collection and reporting of sensor information may be controlled performed by the sensor data module . For example the application module may retrieve receive sensor information from the sensor data module and send the sensor information to the position calculation module to compute the location of the mobile device locally for position updates and or position augmentation. The application module may also send the computed location information to the network location based system and or other mobile devices.

As mentioned above in various embodiments the mobile device may be configured to determine its geospatial location based on information collected from other mobile devices. In these embodiments two or more mobile devices may be organized into groups. Each mobile device may also share its location information with the other mobile devices with which the mobile device is grouped. For example mobile devices may be configured to share their current location and or position information e.g. latitude longitude altitude velocity etc. and an estimate of a distance between themselves and a target mobile device with other mobile devices in their group.

In an embodiment the grouping of mobile devices may be controlled by the wireless grouping module . For example the application module may retrieve wireless group information e.g. information pertaining to the locations of other mobile devices from the wireless grouping module and send the group information to the position calculation module to perform local calculations for position updates and or position augmentation. In an embodiment the position calculation module may perform the local calculations based on both sensor information received from the sensor data module and group information received from the wireless grouping module .

In an embodiment the mobile device may be configured to automatically share its location information with other mobile devices upon discovery of the other mobile devices. Mobile devices may augment their location information e.g. position coordinates with information received from other mobile devices within same geographic location and in a controlled pseudo ad hoc environment. Since the shared location information e.g. latitude longitude altitude velocity etc. involves a relatively small amount of data in an embodiment the mobile devices may receive such information from a network server by in band and or out of band signaling.

When implemented in a 3GPP LTE network the various embodiments may include an E SMLC component configured to send and receive location information e.g. latitude longitude altitude velocity etc. to and from the mobile devices which may be achieved both on net and off net. The location information may be delivered in standard formats such as those for cell based or geographical co ordinates together with the estimated errors uncertainty of the location position altitude and velocity of a mobile device and if available the positioning method or the list of the methods used to obtain the position estimate

To aid in the determination of the locations of mobile devices 3GPP LTE networks have standardized several reference signals. Various embodiments may use these reference signals for timing based location and positioning solutions. Such reference signals may include the primary and secondary synchronization signals and the cell specific reference signals.

As mentioned above two or more mobile devices may be organized into groups. Mobile devices within the same group may be part of the same network or may be associated with different networks and or network technologies. The mobile devices within the same group may also operate on different network operating systems NOSs and or radio access networks RANs .

The mobile device may also begin acquiring GPS signals while scanning the airwaves for radio frequency carriers and or systems. If the mobile device cannot acquire GPS signals a network component not illustrated may help determine the relative position of the mobile device based on one or more of the location determination solutions discussed herein e.g. based on the antenna used for the radio access point the time delay angle of arrival etc. .

The mobile device may acquire i.e. connect to an appropriate radio access system radio frequency carrier and or system via the mobile device s system acquisition system. In the examples illustrated in the mobile device establishes a connection to a network via an eNodeB . However it should be understood that any or all of the communication technologies discussed above are contemplated and within the scope of the various embodiments.

After the mobile device acquires the radio access system the network i.e. a component in the network such as a server will know the approximate location of the mobile device e.g. via one or more of the location determination solutions discussed above such as proximity to base towers . In addition the mobile device may compute its current location e.g. via GPS and or the location determination solutions discussed above store the computations in a memory of the mobile device and report its current location to the network .

In addition to knowing the approximate location of the mobile device the network may also be informed of the locations of other mobile devices and the proximity of the other mobile devices to the recently acquired mobile device .

In an embodiment a mobile device may be configured to report sensor information in response to determining that there is a high likelihood that there has been change in a location of the mobile device e.g. in response to detecting motion . The mobile devices may also be configured collect and report sensor information to the network in response to receiving an instruction command from the network i.e. a component in the network such as a server or E SLMC illustrated in . The network i.e. a component in the network may be configured receive the sensor and location information from the mobile devices and compute and store information about the distances e.g. in time delay and angle of arrival with respect to the mobile devices .

In an embodiment the reporting of sensor information may be based on local parameter settings. For example the mobile devices may be configured to transmit sensor information when any of the measured parameters e.g. x y z and velocity information meet or exceed a threshold value e.g. exceed a rate of change meet a timeout limit which may be identified by local parameter settings stored in a memory of the mobile devices . In an embodiment the mobile devices may be configured to re compute and or update their location information in response to determining that the measured parameters e.g. x y and z coordinates and velocity information meet or exceed a threshold value.

In an embodiment a mobile device and or the network i.e. a component in the network may be configured to compare collected sensor information to computed latitude and longitude coordinates relative altitude information and other available information to determine if there is a discrepancy between the collected measured values and the expected values. When it is determined that there exists a discrepancy between the expected and measured values the mobile device and or network may perform additional measurements to improve the location accuracy of the measurements location information.

In block the mobile device may compute its current location e.g. via GPS and or the location determination solutions discussed above store the computations in a memory and report its current location to the network. In block the mobile device may group with other mobile devices in response to receiving instructions commands from a network component and or in response to detecting that the other mobile devices are within a predefined proximity to the mobile device i.e. within a threshold distance . In block the mobile device may share its current location information as well as information collected from sensors with the grouped mobile devices. In block the mobile device may receive location and or sensor information from the grouped mobile devices. The sensor information may include x y z coordinate information bearing and velocity information.

In block the mobile device may identify the relative positions of the other mobile devices which may be achieve by evaluating the location and sensor information received from the other mobile devices and or via any or all of the location determination solutions discussed herein. In block the mobile device may send the relative location information its current location information and or sensor information to a network component and or the other mobile devices which may receive the sensor and location information and compute updated location information e.g. based on distance in time delay and angle of arrival relative altitude information etc. . In block the mobile device may receive updated location information from the network component and or the other grouped mobile devices. In block the mobile device may update its current location calculation and or information based on the information received from the network component and or the other grouped mobile devices. The operations of blocks may be repeated until the desired level of precision is achieved for the location information.

The operations discussed above with respect to may be repeated so that the mobile devices recursively continuously and or periodically re compute refine and or update their current location calculations and or location information based on updated information received from the other mobile devices and or the network until the desired level of precision is achieved for the location information.

In block the first and or second mobile devices may re compute refine and or update their current location calculations and or location information based on information received from the other mobile devices and or the network. In block the first and or second mobile devices may send their updated current location calculations and or location information to the network component which may receive the calculations information and compute updated location information e.g. based on distance in time delay and angle of arrival relative altitude information etc. . In block the first and or second mobile devices may receive updated location information from the network. The operations in blocks may be repeated until the desired level of precision is achieved for the location information.

It should be understood that the methods and operations discussed above with reference to may also be performed such that they include more than two devices. For example in an embodiment the mobile devices may be grouped into units of four such that each mobile device may triangulate its position relative to the other mobile devices in the same group.

In an embodiment a mobile device and or a network component may store relative location information for all the mobile devices within each group based on the type of grouping. For example a network component may store relative location information for all the mobile devices grouped paired by an incident command system ICS commander. Likewise the network component may store relative location information for all the mobile devices grouped paired based on their proximity to each another.

In an embodiment the mobile device may be configured to detect a low battery condition and initiate operations to conserve battery. For example a mobile device may be configured to turn off its radio and or terminate or reduce its participation in the group pairing information exchange. As another example a mobile device may be flagged or identified as having a low battery condition and the other grouped paired mobiles devices may be informed of the low battery situation so that update intervals may be adjusted to reduce battery consumption.

As discussed above grouped mobile devices may share various types of information to improve the accuracy of the location determination calculations. For the information shared between grouped paired mobile devices a comparison may be made for the path range between the mobile devices using any or all of the information available to the mobile devices e.g. location coordinates sensor information proximity information etc. . If the two mobile devices report relative positional information that is within a user or network defined range tolerance as being acceptable this is information may be forwarded to the network. If the relative positional information is not within the user or network defined range tolerance additional polling operations may be performed to improve the accuracy of the measurements or location information. The above mentioned operations may be repeated until the desired level of accuracy is achieved. In an embodiment the number of times the above mentioned operations are repeated may determined based on a user definable values which can be set by the network user or algorithm used.

As mentioned above a mobile device may include two or more of the same type of sensor. In the embodiments in which the mobile device includes more than one of the same type of sensor e.g. includes two accelerometers one of the sensors e.g. one the two accelerometers may be identified as a master sensor. The values measures by each sensor may be compared and if the difference between the values falls within a tolerance range the values measured by the master sensor may be used to compute the sensor parameters e.g. x y z and velocity parameters . If the difference between the values falls outside a tolerance range the mobile device may use information collected from other sensors of the same or different types to determine if the values measured by the master sensor are consistent with expected values. For example the mobile device may use information collected from various other types of sensors to compute sensor parameters e.g. x y z and velocity parameters and compare the computed sensor parameters to similar sensor parameters computed based on the values measured on the master sensor to determine if the master sensor is functioning correctly. Values measured on the master sensor may also be compared to information stored in the network or other mobile devices to determine if the master sensor is functioning correctly. If it is determined that the master sensor is not functioning correctly a secondary sensor may be designated as the master sensor. The previous master sensor may be demoted to standby status i.e. for use if the primary sensor has a failure and not used for immediate positional calculations.

As mobile devices move into an area the mobile devices may be asked to group pair with more devices. The number devices that a mobile device can group pair with may be restricted by user configuration through the system and or user intervention so as to conserve battery and computational efforts e.g. when the mobile device detects a low battery condition .

In an embodiment proximity grouping may be used in the x y and z coordinates fields and or for velocity and acceleration information.

In the event that a mobile device is unable to group with another mobile device with which it is instructed to group pair with e.g. due to a RF path problems the mobile device may group with yet another mobile device in an ad hoc fashion. If no mobile device is pairable with the mobile device it may rely on its own geographic and or and sensor information to report to the network.

When a mobile device is undetected as being within a given proximity of a grouping radius other mobile devices in the same group as the mobile device may be informed of the decision to degroup depair them from the mobile device . In an embodiment the system may be configured so that an approval from the incident commander or user is required before the mobile is degrouped depaired. In an embodiment this may be achieved may transmitting a signal to a mobile device of the incident commander or user requesting approval to which the incident commander or user may send a reply approving or disapproving of the request to degroup depair. In an embodiment the degrouping depairing process may be transparent to the mobile device users.

In the event that a mobile device is unable to communicate with the network the mobile device may send telemetry information pertaining to location services and other telemetry information to a grouped mobile device for relaying to the network.

In an embodiment polling for information may be performed once the network has lost communication with the mobile device. Mobile devices that and known to be grouped to the mobile device may be instructed to communicate with the disconnected mobile even when it is trying to reacquire the network. A logical sequence based on proximity signal quality to the network and or battery strength may be used to determine which mobile device will be used as a relay for communicating with the network.

The relayed telemetry information may include more than just positional information. For example the telemetry information may also include bio sensor and user bio information reporting on the environment and user conditions including heart rate and temperature CO O and other sensor information.

In an embodiment the network may continuously measure monitor the connected mobile devices. Knowing their location and relative location to each of the other mobile devices enables the network to continuously measure the uplink and downlink communication paths. If a communication path degradation occurs and begins to fall within a defined system quality range which may be user defined a mobile device may be instructed to either handover to another radio access node for the same network and or network technology or be instructed to initiate to perform relay operations to relay communications though a defined mobile device as a secondary signal path.

In the event that a communication link is lost with the network the mobile device may attempt to acquire itself on another network. While the acquisition process is underway a mobile device may act as a mesh device. Other mobile devices in the proximity group may also connect as a mesh network.

In an embodiment the mobile devices may utilize dead reckoning techniques to compute location information. Mobile devices may store the information for use in calculating more accurate location information and may eventually relay to another mobile device which has network access or until one of the mobile devices or both devices have access to the initial network or another network and granted access to whether it is public or a private network.

Once synched with the access point the mobile device may determine the timing difference and other requisite information to help determine its relative location and distance from the access point. This information may be related to the location system used by the mobile device to help refine its current location calculations.

Additionally the mobile device may be configured to compare each cell read to its own coordinate and using bearing and time difference for all the cells it reads. The mobile device may then triangulate on its own position.

During a 911 call a software application on the distressed mobile device may be executed. The software application may access an active neighbor list read the overhead of each cell and use that information to triangulates on the mobile device s own positions. The mobile device may also read the time offset for each of the cells.

In this case the system begins to try and locate the distressed mobiles position with more precision an accuracy to assist First Responders with triangulating on the distressed mobiles position and sending the information to the incident commander and or public service answering point PSAP with a relative distance to target indication that is updated on pre defined intervals. If the mobile device has lost contact with the 911 center PSAP then the last location is continuously display and any velocity information is also relayed to assist the first responders.

In an emergency the mobile device may be configured to send its location information to the network. The mobile device may be configured to automatically send its location information in response to detecting the emergency or may provide the user with an option to send the location information. In an embodiment the mobile device may be configured to send its location information in response to a network initiated command.

Each mobile device may become an access point AP . The decision to be the access point may be periodically updated while still in communication with the network or when no network is found. Upon powering up each mobile device may act as a client and on a pseudo random time interval the mobile devices may become an access point and then a client.

The location based methodology may be the same for a frequency division duplexing FDD and a time division duplexing TDD system. However in the event that the communication link between the mobile device and the network is lost the mobile device may be configured to relay its telemetry information through another mobile device having network access.

In an embodiment all information sent via wireless communication links may be digital. In an embodiment the information may be encrypted to a requisite advanced encryption standard AES standards level or the appropriate encryption level needed for the requisite communication system and access method used.

Generally the location based systems LBS may utilize reactive or proactive based methods. In a reactive location based system the mobile devices may synchronously interact with each other on a time basis or some other predetermined update method. In a proactive location based system the mobile devices may update their location information based on a set of predetermined event conditions using an algorithm. The various embodiments may include both reactive and proactive aspects taking the best of both approaches to enhance location accuracy and precision.

Various embodiments may include location determination solutions that utilize horizontal data i.e. a set of reference points on the Earth s surface against which position measurements are made and or vertical data. Horizontal data define the origin and orientation of the coordinate system and are prerequisites for referring a position relative to the Earth s surface. Vertical data are based on geoids which primarily serves as a basis to determine the height of a position relative to means sea level for which the geoids act as a benchmark for origin and orientation. Various embodiments may utilize horizontal and vertical data to provide generate enhanced three dimensional location information. The horizontal and vertical data can be global national local or custom depending on the locality and positioning reference system utilized.

Traditionally global data are used for position location as compared to a local datum. Global data are used for initial position fixing if possible and are based on GPS coordinates. Local data are based on a particular position on the surface of the earth which allows for a non GPS based location based services to take place. The various embodiments may use global data local data or both. In an embodiment GPS may be used to help identify the initial positional fix and may be augmented by dead reckoning and a hybrid trilateration solution that utilizes both network and terminal based positioning In this embodiment both local and global data may be used. If GPS determined position information is unavailable then the initial position may be set to the same position as that of the reporting mobile or a distance that is estimated using received signal strength indication RSSI and or time of flight such that 0.5 of the estimated distance is applied to the horizontal component and vertical component of the reporting mobile device and the altitude which may also be reported by the additional mobile devices.

Generally a hybrid lateration and trilateration solution includes a mobile device performing a measurement and sending it to the network and a network component performing the location determination calculations. The various embodiments include a hybrid lateration and trilateration solution in which the mobile device performs the location determination calculations with and without the support of the network components.

Various embodiments may include sensor fusion operations in which a collaborative approach is used so that the sensors do not act as individual sensors but as a collective team. As discussed above the mobile device may include various sensors e.g. accelerometer gyros magnetic compass altimeters odometers etc. capable of generating heading orientation distance traveled and velocity as part of the sensor information collected on the mobile device. In various embodiments information collected from any or all the internal sensors may be used for improving location or positioning accuracy and or confidence improvements. Various embodiments may compute location information based on information from multiple sensors with or without the aid of radio frequency propagation information.

The sensor fusion operations may include the sharing of telemetry including sensor data indicating relative movement of the individual mobile device which enables temporal readings to assist in the location estimate either with external assistance or dead reckoning

Dead reckoning may provide the needed positional corrections as a local datum method for positioning when GPS or other network related positioning solutions are not available. Additionally dead reckoning may enhance the location position accuracy and precision calculations by providing and additional horizontal and vertical datum comparisons.

With dead reckoning the current position may be deduced or extrapolated from the last known position. The dead reckoning accuracy requires a known starting point which either can be provided by the network GPS near field communication link RF beacon a predetermined zero position or via another mobile device. For example if GPS initial position information is available then the initial position may be set to zero or a distance that is estimated using RSSI or time of flight between another mobile device such that 0.5 of the estimated distance between the mobile device and a measurement location e.g. another mobile device is applied to the horizontal component and vertical component of the reporting mobile device and the altitude which may be reported by the additional mobile device

A dead reckoning system may be dependent upon the accuracy of measured distance and heading and the accuracy of the known origin. However the problem with relying on dead reckoning alone to assist in positional improvement is error accumulation caused by sensor drift i.e. differences or errors in values computed collected from one or more sensors . In particular magnetic accelerometers and gyroscopes are susceptible to sensor drift. The error accumulation for any of the sensors may increase over undulating terrain as compared to flat terrain. Bias error and step size error are leading contributors to dead reckoning errors.

Various embodiments may tightly couple the mobile device sensors and continuously recalibrate the sensors to reduce any drift problems caused by unaided dead reckoning Additionally as part of the tightly coupling the sensors any bias drift associated with the sensors e.g. a gyroscope may be address by utilizing a kalman filter to reduce the errors from the primary and or secondary sensors e.g. gyroscopes .

In various embodiments the mobile device may be configured to include velocity computations as part of the location determination computations to account for position changes that occur. When a GPS signal is available the step size via velocity computation and compass bias errors may be estimated by an Enhanced Kalman Filter EKF . Additionally if GPS is available the compass may also be able to identify slow motion changes due to changes in magnetic inclination. The compass may be relied upon for motion computations in addition to that of accelerometers and gyroscopes with and without the availability of GPS.

Dead reckoning accuracy degrades with time requiring regular position updates or positional corrections. Therefore the mobile device may be configured to not only use its own internal sensors to compute the location positional information but may also communicate with other mobile devices to leverage their location positional information to enhance its own location positional information. In essence the mobile devices may act as RF base stations proving the lateration capability to improve the positional accuracy of other mobile devices.

In an embodiment a mobile device may be configured to poll one or more other mobile devices to gain a better positional fix on its location.

Mobile devices may be grouped together either through assignment by the network or through the mobile device acquiring detecting connecting to other mobile devices which may or may not be in the same network as part of a discovery method for sharing location information.

Location information may be shared via the use of a near field communications system e.g. Bluetooth ultrawideband peanut radios etc. infrared ultrasonic and other similar technologies such as via the use of WiFi. The wireless communications may also be ad hoc or infrastructure based or based on a TDD system such as LTE SD CDMA TD CDMA or any other TDD methods.

In an embodiment the mobile device may be configured to initiate the sharing of location information in response to receiving a network driven grouping request from a network component.

In an embodiment when the mobile device has lost contact with the network it may attempt to find a suitable mobile device to help in its location determination computations and for possible connection to the network e.g. via a relay .

In an embodiment the mobile device may be configured to send a request for location information to another mobile device. The request may be sent after the authentication process between mobile devices and may include a time stamp which may be sub seconds in size milliseconds . Another mobile device may respond with a message that also has its time stamp and when it received the time stamp from the initiating mobile device.

Several messages e.g. three messages may be exchanged quickly between the mobile devices to establish time synchronization and share location positional information that includes horizontal vertical and altitude coordinates e.g. x y and z coordinates a velocity and acceleration component in each message. The time differences along with the x y and z coordinates may be compared with possible pulses or pings to establish an estimated distance vector between the devices.

When the distance vector and the x y z coordinates of two mobile devices are known a point to point fix may be established. This process may be repeated for all the mobile devices in a group that has been assigned or created by the mobile device itself. Having multiple distance vectors from other points to the mobile will enhance the positioning accuracy.

A mobile device may be configured to report back to the network location server the distance vectors it has found between different mobiles. The other mobile devices also involved with the positioning enhancement may also report their distance vectors to the network to have their overall position accuracy improved as well.

The positional accuracy is meant to be done in incremental steps and the process will continue until no more positional improvements will be achievable. The positional accuracy improvement threshold may be operator defined and may be stored in a mobile device memory.

When collecting the distance vectors and other positional information if the error in position is greater than x for a lower positional confidence level then no update may be required. As the mobile device receives other sensor data and more than a pre described distance in any direction or a combined distance vector than the positional update process begins again. However if the x of positional confidence level is less than desired additional positional updates may be made with the mobile devices grouped together in an interactive process to improve the confidence level of the positional information.

It is important to note that typical positional location methods that are used currently by the network are not necessarily replaced with above described positional lateration. Instead the hybrid lateration method may be used in various embodiments to augment the positioning accuracy and confidence for network based position request due to boundary changes or paging requests or other position location triggered events.

As illustrated in the mobile devices and may establish a distance vector between themselves and mobile device . The same process may occur with respect to mobile devices and or in which positional and sensor information is exchanged. Where mobile device undergoes the same process as that done with mobile device as part of the hybrid trilateration process mobile device may use mobiles to enhance it positional information and mobile device may use mobiles and to enhance its positional information and so forth for all the mobile devices that are grouped together.

The three circles or ellipses and illustrated in and the three circles or ellipses and illustrated in do not intersect at a given point but span an area of a particular size depending on the range involved.

For each axis x y or z a similar process occurs where the error area is a combination of determining the range between the other mobile devices and mobile device . The hyperbolic lateration is a typical calculation method used in location based systems and is based on the principal that the range between two locations is the same. However the range determined for the points may not be constant since both can be moving toward away or together at a similar velocity and trajectory.

With the hybrid lateration method proposed a corrective distance vector x y z is used that can be used to apply to the estimated position.

The three circles or ellipses and illustrated in and the three circles or ellipses and illustrated in do not intersect at a given point but span an area of a particular size depending on the range involved. Therefore range is r and is denoted by the subscript representing the distance vector involved. Thus error

The pseudo range pdeviated from the actual range in any axis due to the inaccuracy in synchronization or propagation in a multipath environment or due to sensor induced errors. Where the distance vector accounting for change in direction is 

Three range calculations are then averaged to determine the distance vector that is used. If the previous range calculation ras compared to that of the current calculation has an error in excess of a user defined or variant then the new measurement is disregarded. Included with the distance vector validation may be the fusion sensor information where expected position verse calculated may be included for the confidence interval. Range difference d r

An iterative process may be used for position improvement which may include the use of a least squares calculation fit to approximate the position solution in a step wise basis. The process may continue until the range difference measured does not produce any noticeable accuracy improvement which may be user defined either at the mobile device or network or both.

The multi lateration calculations may include estimating a location of a mobile device based upon estimated distances to three or more measurement locations i.e. locations of three other mobile devices or wireless transceivers . In these calculations the estimated distance from a measurement location location of another mobile device to the mobile device may be derived from the measured signal strength. Since signal strength roughly decreases as the inverse square of the separation distance and the transmission power of the mobile device can be presumed the distance dcan be simply calculated as where 

Alternatively the signal strength readings may be translated into distances using a path loss model such as the following RSSI where 

The lateration operations may include performing a least squares computation which may accomplished by a processor calculating the following formula min x y where 

In various embodiments the velocity and acceleration of the mobile device with respect to the three or more reference locations i.e. locations of three other mobile devices or wireless transceivers may be determined along with the estimated distance from each reference location to the mobile device. The estimated distances to three or more measurement locations i.e. locations of three other mobile devices or wireless transceivers velocities and acceleration calculations may have their components separated into a horizontal component set a vertical component set and an altitude component set respectively. As will be discussed in greater detail below each of the component sets main contain the distance component velocity component and acceleration component for each of the reference locations. For example an x component set may contain the distance x components velocity x components and acceleration x components associated with all reference locations. Some embodiments may include executing a kalman filtering procedure on the component sets individually to produce an estimated position of the mobile device.

Mobile device may send a request for position information to mobile device . The information may be sent after the authentication process between mobile devices and may include a time stamp. The time stamp may be sub seconds in size e.g. milliseconds . The mobile device may respond with a message that also has a time stamp and timing information pertaining to when the mobile device received the time stamp from mobile device . Three messages may be transferred quickly to establish time synchronization. The time differences may then be compared along with possible pulses or pings to establish an estimated distance vector between the mobile devices. Knowing the distance vector and the x y and z coordinates of both and a point to point fix may be established. In various embodiments the position fix may be extrapolated to synchronize the trilateration time stamp with a time stamp of a dead reckoning calculation. Similarly the time interval adopted for dead reckoning calculation updates may be adopted as the time interval between trilateration recalculations.

The mobile device may then initiate communication with mobile devices and repeat the operations discussed above with respect to mobile device for each of mobile device . After obtaining two or more distance vectors along with positional information the mobile device may compare the new coordinates to its previously computed current location and adjust the location computations accordingly.

The positional information distance vectors may be sent to the network for positional processing with other network positional information. Based on the position calculated for the mobile device the network i.e. a component in the network such as a network server or E SMLC may instruct the mobile device to adjust its positional information.

Additionally the mobile device may also make a positional correction if the network either does not respond in time which may result in a message update time out. Alternatively when the network cannot make the necessary correction and the positional information may used by another component and or other mobile devices to perform the necessary corrections.

If the error is greater than x for a lower positional confidence level then no update is required. As the mobile receives other sensor data and more than a pre described distance in any direction or a combined distance vector than the positional update process begins again. If the x of positional confidence level is less than desired additional positional updates may be made with the grouped mobile devices e.g. iteratively to improve the confidence level of the positional information. Additionally if the positional information from one of the mobile devices that is being attempted to obtain a distance vector appears to be in error then that mobile devices data may be selected to not be used for this iterative step of performing positional updates with other grouped mobile devices. However it will continue to be queried as part of the process since its position location could be corrected in one of the steps it is taking to improve its position location as well.

Additionally in the event that one or more mobile devices lose communication with the core network it will still be possible to maintain position accuracy through one of the other grouped mobile devices. In some embodiments the last position of the mobile device may be re used and the amount of error increased. It will also be possible to continue to maintain a communication link by establishing a network relay connection with another of the mobile devices in the same group which still has communication with the network itself.

In the example illustrated in mobile device establishes a near field LAN inviting other mobile devices in proximity to communicate with it. Positional information can then be shared and the mobile device can have its location improved and the positional information can be relayed back to the core network via another mobile device.

The mobile device may also communicate its positional information and establish near field communication link with a mobile device that is not part of the home network associated with mobile device .

The mobile devices may have the USIM SIM PRL or access point information pre built in. The mobile device for first responders may have the incident radio system set as their preferred system or in the case that the radio access system being used as a public safety network.

For first responders to utilize a wireless mobile network e.g. LTE the position location information accuracy needs to improved for in building environments in addition to providing more accurate location information about where the mobile devices are actually located. Whether the mobile device is used by a first responder commercial cellular user or a combination of both.

The positional location improvement for first responders may be helpful to improve situation awareness improved telemetry and overall communication with the incident commander. Since all incidents for first responders tend to be fluid the ability to account for a dynamic environment of mobile devices will come into and out of the incident area. In addition the mobile devices proximity location to other mobile devices can and will change as the incident situation changes where resources are added and or reassigned as the need arises for operational requirements.

The use of network and terminal driven position enhancement techniques previously discussed may be exploited. The grouping of mobile devices may be done either as part of pre plan with intervention by the incident commander or driven from the commercial wireless network public safety wireless network or local incident communication system ICS based on reported proximity of the mobile devices.

For first responders when a situation arises that requires finding a man down or responding to an emergency call 911 the location based process can be used to help in the search and rescue of the person.

Once the mobile device has been grouped or is still connected to the network the relative location of the mobile device will be sent to all the mobile devices that are in active search for that mobile device. The selection of which mobile devices will be searched may be determined by operator intervention and selection.

As discussed above the various embodiments include methods and mobile devices configured to implement the methods of determining a location of a mobile device which may include determining an approximate location of the mobile device grouping the mobile device with a wireless transceiver e.g. a second mobile device etc. that is in proximity to the mobile device to form a communication group sending the determined approximate location of the mobile device to the wireless transceiver receiving on the mobile device location information e.g. a latitude coordinate a longitude coordinate an altitude coordinate etc. from the wireless transceiver and determining a more precise location of the mobile device based on the location information received from the wireless transceiver. In an embodiment the method may include grouping the mobile device with a plurality of wireless transceivers in proximity to the mobile device to form the communication group and receiving location information from the plurality of wireless transceivers in the communication group. In some embodiments the method may also include sending information relating to the determined more precise location of the mobile device and the received location information to a server receiving updated location information from the server and re computing the more precise location of the mobile device based on the updated location information i.e. the information received from the server .

As also discussed above e.g. with reference to a mobile device may be configured determine its current location using any of a number location determination solutions to produce a final location estimate share its location information i.e. the final location estimate with other grouped mobile devices and or receive location information from other grouped mobile devices compute and send a final location estimate and updated distance vector and sensor information to a network component for an improved positional fix receive updated location information from the network component and perform its own positional fix based on mobile data information received from the network. The mobile device may then update its location information and or confirm its location information using dead reckoning to enhance its positional accuracy.

Further embodiments may include methods and mobile computing devices configured to implement the methods of providing enhanced location based services. In these embodiments the mobile computing device may be configured to determine an initial position generate at least one set of local position information based on locally determined location information receive location information from one or more external location tracking systems generate at least one set of external position information based on the location information received from the external location tracking systems receive distance information from multiple mobile devices in a communication group generate proximity position information based on the location information received from the multiple mobile devices in the communication group and generate a final location estimation set a position velocity and acceleration value based on the local position information the external position information the proximity position information and the initial position. That is the mobile computing device may use a combination of the determined initial position the generated local position information the generated external position information and the generated proximity position information to determine or compute a final location estimation set. The mobile computing device may then use the final location estimation set to provide a location based service e.g. an emergency location service commercial location service internal location service lawful intercept location service etc. .

The initial position value may be an information structure that includes one or more information fields component vectors location information position information coordinate information etc. Similarly the mobile device may include generate compute determine or use a dead reckoning position estimate value a combined sensor position estimate value a trilateration position estimate value a final location estimate value and various temporary position and error values any or all of which may be information structures that each include one or more information fields component vectors location information such as coordinates and or other similar information. In some embodiments the mobile device may include a dead reckoning module that is configured to determine whether a dead reckoning position estimate value is available as well as to generate time stamps use dead reckoning techniques to compute location information set the dead reckoning position estimate value and or perform other similar operations.

In some embodiments as part of the operations in block the mobile device may determine whether GPS data e.g. GPS coordinates or GPS determined position information is available in the device. The mobile device may also determine generate or compute an temporary position value in response to determining that GPS data is not available and set the initial position value to the determined temporary position value e.g. by performing a deep or shallow copy of the temporary position value information structure . In various embodiments the mobile device may determine or compute the temporary position value and or set the initial position value to zero 0 to the last known location stored in memory or to the RSSI or time of flight with between another mobile device such that 0.5 of the estimated distance is applied to the horizontal component and vertical component of the reporting mobile device. In some embodiments the mobile device may also derive determine or compute an initial altitude value or generate initial altitude information based on information reported by other or additional mobile devices and use this initial altitude value to compute the temporary position value and or to set the initial position value.

In determination block the mobile device may determine whether a dead reckoning position estimate value is available which may include determining whether the device may utilize one or more dead reckoning techniques to compute or generate location information for the mobile device based on information that is stored in its memory or based on information that may be collected from its components e.g. sensors etc. . In response to determining that a dead reckoning position estimate value is not available i.e. determination block No the mobile device may wait for a predetermined amount of time or for the occurrence of an event a trigger notification collection of data etc. and repeat the operations of determination block . Said another way the mobile device may wait until it determines that it has access to sufficient information to use dead reckoning techniques methods to compute its current location and set the dead reckoning position estimate value or until it times out a timer expires etc.

In response to determining that a dead reckoning position estimate value is available i.e. determination block Yes the mobile device may determine compute or calculate an error value e.g. in the form of a variance etc. that identifies the error associated with the determined local position or dead reckoning estimate value in block . In determination block the mobile device may determine whether a combined sensor position estimate value is available e.g. is determinable from information collect from sensors or stored in memory etc. for the current time. In some embodiments the mobile device may be configured to calculate determine the inputs for computing or determining the combined sensor position estimate value by filtering the output of environmental sensors such as the accelerometer barometer gyro magnetometer and or thermometer and using the filtered sensor outputs as the inputs to an algorithm or method for computing the combined sensor position estimate value. In some embodiments in block the mobile device may execute or perform a single variable kalman filter using the combined or fused sensor outputs to obtain determine or compute the combined sensor position estimate value. The single variable kalman filter may be a procedure algorithm method technique or sequence of operations for accomplishing the function of a kalman filter.

In response to determining that combined sensor position estimate is not available for the current time i.e. determination block equals or evaluates to No the mobile device may determine compute or calculate an error value e.g. in the form of a variance value etc. that identifies an error variance associated with the external position estimate in block . For example in block the mobile device may extrapolate the last available combined sensor position estimate value to fit a time stamp established or determined by the dead reckoning module of the mobile device. In some embodiments the mobile device may be configured to increase or increment the error variance value associated with the combined sensor position estimate value so as to compensate for a potential inaccuracy of the calculation. Said another way the mobile device may be configured to update the combined sensor position estimate error value in block to better account for potential inaccuracies in its computations or location position determinations.

In response to determining that combined sensor position estimate value is available for the current time i.e. determination block equals or evaluates to Yes the mobile device may determine an error variance value for the external position estimate value in block . Said another way in block the mobile device may determine compute or calculate an external position estimate error value in response to determining that a combined sensor position estimate value is available.

In determination block the mobile device may determine whether a trilateration position estimate value for a current time is available. As described above the mobile device may obtain more accurate position information by calculating its own location based on the distance between the mobile device and three or more reference locations. Some embodiments may include obtaining distance information from several reference locations and executing a kalman filter on the obtained coordinates to produce a single estimate of position velocity and acceleration in block . In response to determining that a trilateration position estimate value for the current time is not available i.e. determination block equals or evaluates to No in block the mobile device may extrapolate the last available trilateration location information to a current time stamp established by the dead reckoning module. In response to determining that the trilateration position estimate value for the current time is available i.e. determination block equals or evaluates to Yes the mobile device may determine the error variance associated with the trilateration position estimate value in block .

In block the mobile device may compute calculate or determine a final location estimate value based on the dead reckoning position estimate value the combined sensor position estimate value the trilateration position estimate value and the location information received from external systems e.g. GPS coordinates etc. . In various embodiments the mobile device may set the values of one or more fields in the final location estimate value to be equal to the product of executing a kalman filter on the sets of location information values which may include or may be based on a position information estimate value velocity information estimate value and an acceleration information estimate value. In block the mobile device may update the a final location estimate value with the calculated estimate values and or calculate or determine a gain value.

In block the mobile device may wait for a pre determined amount of time or wait until a time interval lapses return to block to repeat the operations of method to begin updating the location information for the current time. In some embodiments the time interval may be synched to the time of the dead reckoning module. Thus each subsequent updating of the dead reckoning location information may represent the beginning of another final location information recalculation.

With reference to an embodiment method for implementing a trilateration technique may include the execution of a kalman filter on distance information to produce a more accurate location velocity and acceleration estimate. In block the mobile device may initialize a starting point in the same manner as described with reference to block of . In block the mobile device may receive distance location information from three or more reference locations e.g. other mobile devices access points etc. and may calculate a distance between the mobile device and each of the reference locations. The mobile device may further calculate a velocity and acceleration of the mobile device with respect to each of the reference locations. In block the mobile device may check for the presence of received inputs from at least three separate reference locations. If the mobile device has received location information from at least three reference locations then the process may proceed to block . If the mobile device has not received a sufficient number of inputs from the reference locations it may in block wait to receive further input. In some embodiments while the mobile device waits for additional reference location information it may update previous trilateration information according to the embodiment method described below with reference to .

In block the mobile device may calculate an error or variance associated with the distance calculation. In block the calculated distance information along with the associated velocities and acceleration calculations may be separated into their directional components and grouped into vectors with like components from each reference location. For example the calculations may be separated into Cartesian or radial coordinate components and a z component vector may contain the z components of the distance velocity and acceleration information for all location information received from the at least three reference locations. In blocks and a kalman filter may be executed on each of the component vectors. In block the component vectors of all the kalman filter functions may be combined to calculate a three dimensional position estimate in the manner described with reference to embodiment method and .

In block the processor of the mobile device may update the trilateration position information with the estimate calculated in block and may further calculate a process gain. In block the mobile device may wait a predetermined interval of time as established by the time stamp of the dead reckoning module and may then return to block to begin updating the trilateration location information.

During the filter process the state estimate L may be considered to be current for a time k or predicted for a time k . The state or location estimate may be a nine element vector including an estimated position velocity and acceleration for each coordinate component of a coordinate system. For example a location estimate for a Cartesian coordinate system may be represented by the expression. L x y z v v v a a a 

In various embodiments the vector may be separated into multiple smaller vectors including all elements associated with a coordinate component thereby enabling easy isolation of position velocity and acceleration information with respect to a single axis of translation. Thus L may e represented by the series of expression L x v a L y v a L z v a 

The current state L may depend only on the predicted state for the previous time interval new input measurements G e.g. a new location information input a transition matrix H and the kalman gain K. Thus the current location estimate may be represented by the function 

To begin location estimate calculation a starting position L and associated covariance P may be initialized using GPS coordinates or local sensor output for a position velocity and acceleration. The estimated covariance matrix P may comprise the variance of an Lvector along the diagonal and the off diagonal elements set to zero. If no sensor output location information or externally provided starting coordinates are available the initial values may be set at either 0 or an estimated distance using RSSI and or Time of Flight TOF from a reference location e.g. another mobile device such that 0.5 of the estimated distance will be applied to the X and Y component of the reporting reference location and the altitude Z will use as that reported by the other reference locations.

In block an error or covariance P may be determined along with weight factors. Block may be the end of the prediction phase of the kalman filter process and may pass a predicted location covariance and weights to block the beginning of the updating phase. Once the starting point is initialized the starting position may be used as a predicted measurement and may be represented by the function 

Where A and B are state transition matrices that may map a state from a time k 1 to k. The parameter w1 is a vector of elements representing the uncertainty in the noise for each of the parameters in the state vector L and u is a parameter nulled out during calculation. The mean noise w along with a standard deviation of the noise v may enable convergence of location and sensor input datum which are non Gaussian. Current measurements G may be expressed as a function of the standard deviation by G HL v and alternatively as G H.L R where R is a matrix representing the variance of the measurements. The estimated covariance may be represented in terms of a previous covariance estimate the transition matrix A and a covariance matrix Q and expressed by the function 

In block updating phase may begin and the location estimate L may be updated. This phase ay begin by computing the Kalman gain K for the current time interval. The gain may be a product of the estimated covariance and the measurement variance R and may thus be represented by the expression . 

The current location estimate may be updated using the current location estimate expression. Kalman gain depends on the current state estimate and the accuracy of the measurements. As the accuracy of the measurements increase the Kalman gain will be high placing higher weight on the measurements. In some embodiments the time k may be larger thus decreasing the accuracy of the measurements due to staleness of the measurement resulting in a low Kalman gain placing more weight on prediction than on the measurements. With a high gain more weight will be placed on measurements than on the predicted value. In block the current covariance P may be computed. Over multiple iterations of the filter the off diagonal elements of the covariance matrix may become non zero elements. The current process covariance may be expressed by the function 1 .

The current location L and a current process covariance matrix P may be the outputs of the updating phase and may be passed as input to the beginning of the prediction phase in block for the next iteration of the filter. In block the mobile device may predict the location matrix matrices and process covariance P matrix for a time k 1 may and pass them as input to the second step of the predicting phase in block . The current location estimate may also be used as current position velocity and acceleration information for location based services and may be passed to the network in accordance with various embodiments. In some embodiments the current location estimate may be passed as input to a second kalman filter and combined with other location inputs to produce a final location estimate.

In various embodiments the systems methods and devices may execute a kalman filter in three separate instances within the embodiment method described with reference to . These instances may include execution of a kalman filter on the combined sensor location information the trilateration location information and the final location estimate which combines the sensor location information trilateration location information and all other location input sources. For each instance the inputs must be synchronized with the time stamp used by the dead reckoning module and may be extrapolated to fit a current dead reckoning time.

In various embodiments the mobile device may utilize a kalman filter process to determine accurate location information for a mobile device. Multiple kalman filters may be executed on location information from varied sources. The output of filtering location information from multiple sources may be input for a final stage kalman filter process that may reduce the noise of inaccurate location information by recursively combining and estimating the combination of location information from different sources to produce a final location estimate.

The various embodiments may be implemented on a variety of mobile computing devices an example of which is illustrated in . Specifically FIG. is a system block diagram of a mobile transceiver device in the form of a smartphone cell phone suitable for use with any of the embodiments. The cell phone may include a processor coupled to internal memory a display and to a speaker . Additionally the cell phone may include an antenna for sending and receiving electromagnetic radiation that may be connected to a wireless data link and or cellular telephone transceiver coupled to the processor . Cell phones typically also include menu selection buttons or rocker switches for receiving user inputs.

A typical cell phone also includes a sound encoding decoding CODEC circuit which digitizes sound received from a microphone into data packets suitable for wireless transmission and decodes received sound data packets to generate analog signals that are provided to the speaker to generate sound. Also one or more of the processor wireless transceiver and CODEC may include a digital signal processor DSP circuit not shown separately . The cell phone may further include a peanut or a ZigBee transceiver i.e. an IEEE 802.15.4 transceiver for low power short range communications between wireless devices or other similar communication circuitry e.g. circuitry implementing the Bluetooth or WiFi protocols etc. .

Various embodiments may be implemented on any of a variety of commercially available server devices such as the server illustrated in . Such a server typically includes one or more processors coupled to volatile memory and a large capacity nonvolatile memory such as a disk drive . The server may also include a floppy disc drive compact disc CD or DVD disc drive coupled to the processor . The server may also include network access ports coupled to the processor for establishing data connections with a network such as a local area network coupled to other communication system computers and servers.

The processors and may be any programmable microprocessor microcomputer or multiple processor chip or chips that can be configured by software instructions applications to perform a variety of functions including the functions of the various embodiments described below. In some mobile devices multicore processors may be provided such as one processor core dedicated to wireless communication functions and one processor core dedicated to running other applications. Typically software applications may be stored in the internal memory and before they are accessed and loaded into the processor and . The processor and may include internal memory sufficient to store the application software instructions.

The wireless device location determination techniques described herein may be implemented in conjunction with various wireless communication networks such as a wireless wide area network WWAN a wireless local area network WLAN a wireless personal area network WPAN and so on. The term network and system are often used interchangeably. A WWAN may be a Code Division Multiple Access CDMA network a Frequency Division Multiple Access FDMA network a Time Division Multiple Access TDMA network an OFDMA network a 3GPP LTE network a WiMAX IEEE 802.16 network and so on. A CDMA network may implement one or more radio access technologies RATs such as CDMA2000 Wideband CDMA W CDMA and so on. CDMA2000 includes IS 95 IS 2000 and IS 856 standards. W CDMA is described in documents from a consortium named rd Generation Partnership Project 3GPP . CDMA2000 is described in documents from a consortium named 3rd Generation Partnership Project 2 3GPP2 . 3GPP and 3GPP2 documents are publicly available. A WLAN may be an IEEE 802.11x network and a WPAN may be a Bluetooth network an IEEE 802.15x or some other type of network. The techniques may also be implemented in conjunction with any combination of WWAN WLAN and or WPAN.

The various embodiments may include enhancements to the current location based service methodologies used for wireless mobile communications. Determining the location of the mobile device in a wireless network is becoming more and more important in recent years both for commercial and public safety positioning applications. Services and applications based on accurate knowledge of the location of a mobile device are becoming more prevalent in the current and future wireless communication systems Additionally Public Safety is also embarking on the use of commercial cellular technology LTE as a communication protocol of choice. Of specific importance is the need for improved situation awareness at an incident with first responders.

Presently GPS provides a good estimate of the mobile devices current location under optimum conditions. However in many situations and especially in building and urban environments the ability to utilize GPS for position location determination is hampered and many times is not usable. The network based solutions for determining the mobile devices location while good has many problems with locating the mobile device within buildings and in urban areas. The introduction of wireless network systems such as the third generation partnership project 3GPP long term evolution LTE present new capabilities has the ability in the public safety band to provide excellent coverage in urban and indoor environments. Although the wireless mobile networks can provide coverage in urban and in building environments the location information position accuracy has limitations.

Better positional location accuracy and confidence has many advantages for use in emergency location services commercial location services internal location services and lawful intercept location services. The various embodiments provide the ability to improve the positional location information for both new and existing wireless networks.

For commercial applications the ability to have the mobile device improve location specific information within a multiple story building in an urban environment or within a mall provides both network radio resource improvements and has unique advertising targeting capabilities as well as applications for improved fleet management asset tracking and various machine to machine communications applications where positional determination is required to be highly accurate. For commercial users the need for improves position location information accuracy is most needed for in building environments where the location of the mobile device can be more accurately pin pointed for location based services

The advantage of law enforcement with improved positional information will enable the tracking of mobile devices inside a building to enable determination of what floor or part of the building the device is being used is located without the need for replacing radio beacons or location aware access points.

For emergency services the advantage comes to better positional location of the part in need of assistance especially in an urban environment where the positional information is most problematic with existing techniques.

For first responders this enhancement enables mobile devices which are in the same scene to help augment their position coordinates with each other in a controlled ad hoc environment. The positional information shared not only includes latitude and longitude but also altitude and velocity. Since this information involves a small amount of data the mobile devices can have the E SMLC in the case of LTE share the information both on net and off net.

The use of sensors including accelerometers gyroscopes magnetometers and pressure sensors along with GPS receivers with mobile devices is becoming more prevalent. Therefore the enhancements for positional location will give the E SMLC in the case of LTE the ability to not only utilize GPS or Network derived coordinate information but also to have an augmentation with sensors associated the mobile device which can include accelerometers gyroscopes magnetometer and pressure sensors for refining and reducing some of the positional uncertainties that are in inherent to wireless positional determination.

Wireless mobile network like LTE the position location information accuracy needs to be improved for in building environments in addition to providing more accurate location information about where the mobile devices are actually located. Whether the mobile device is used by a first responder commercial cellular user or a combination of both.

Positional location improvement enable improved situation awareness improved telemetry and improved overall communication with the incident commander. In addition the mobile devices proximity location to other mobile devices can and will change dynamically allowing for resources to be added and or reassigned as the need arises for operational requirements.

As discussed above the various embodiments include methods and mobile devices configured to implement the methods of determining the location of a mobile device and providing improved location based services via the mobile device. A mobile device may be configured to perform operations that include determining an approximate location e.g. latitude longitude and altitude coordinates etc. of the mobile device grouping the mobile device with a wireless transceiver in proximity to the mobile device to form a communication group sending the determined approximate location to the wireless transceiver receiving location information from the wireless transceiver and using the received location information to determine or compute more precise location information for the mobile device and or to provide an enhanced location based service via the device. The operations may also include collecting information e.g. distance velocity geospatial coordinates etc. from other devices in a communication group computing the more precise location information based on the collected location information and using the computed information e.g. the more precise location information or location estimation set to provide the enhanced location based service.

In an embodiment the mobile device may be configured to establish communication links connections to a plurality of other devices and or to form a communication group in response to determining that it is not currently connected to the communications network. The device may then receive distance and or velocity information from the other devices in the group e.g. via the communication links connections use the received information to generate the more precise location information or a location estimation set e.g. an information structure that includes latitude longitude and altitude coordinates etc. and use the generated information to provide an enhanced location based service. In some embodiments the device may transmit the generated information to the other devices in the communication group. These other devices may be configured to receive and forward the information to other network resources and or to use the received information to compute or update their location information e.g. compute an new location estimation set etc. .

Some of the embodiments described above e.g. those described with reference to through may include require and or benefit from the performance of sensor fusion operations which generally include using information collected from internal sensors e.g. accelerometer gyros magnetic compass altimeters odometers etc. of the devices to compute the more precise location or position information. For example a device may be configured to locally collect information from its internal sensors use the collected sensor data to compute movement data or a movement estimate value e.g. for its own movement etc. share its movement or sensor data with other devices in the communication group receive telemetry sensor and or movement data from other devices in the group and use any combination of the locally collected computed or received information to determine the relative movements of the devices in the group. The device may then use a combination of temporal data relative movements of the devices in the group and triangulation techniques to determine or compute its location such as by computing generating a location estimation value set or more precise location information that is used to provide an enhanced location based service.

The above described sensor fusion operations are generally every effective for computing or determining the location and position of a mobile device with sufficient precision and with a sufficiently high degree of confidence in the accuracy of the computation e.g. 90 confidence 95 confidence 99 confidence etc. . However previous existing solutions may require that the communication group include a plurality often a multitude of devices and or that a significant number of devices collect and report their sensor movement or telemetry data. However mobile devices do not always have access to a communication group yet alone a sufficiently large communication group and or to the robust volume of data that could be required by these solutions. As such it may be challenging for mobile devices to accurately determine their three dimensional locations and positions with a sufficiently high degree of confidence e.g. 95 confidence 99 confidence etc. accuracy and or precision using previous existing solutions. Various embodiments overcome these limitations of previous existing solutions by configuring mobile devices to perform single device trilateration operations that allow the mobile devices to accurately determine their three dimensional locations and positions with sufficiently high degrees of confidence e.g. for its accuracy correctness etc. and precision without requiring a large number of devices be included in their communication group and without requiring that a large number of devices report their sensor movement or telemetry data.

The various embodiments allow mobile devices to determine their three dimensional locations and positions e.g. via a location estimation set etc. with a sufficiently high degree of confidence e.g. 95 confidence in accuracy etc. and precision e.g. is highly repeatable etc. without requiring the devices to have access to a large communication group or a large amount of data.

A mobile device may be configured to perform advanced location based operations e.g. advanced sensor fusion operations to generate location information e.g. a location estimate set value use a differential RMSmethod or any other method known in the art compute confidence values and compare the computed confidence values to one or more threshold values to determine whether there is a sufficiently high degree of confidence in the accuracy of the generated location information e.g. location estimate set value . In some embodiments the mobile device may be configured to compute a confidence value between 0.0 and 1.0 that identifies a confidence level in the accuracy of the measurement for each data field in the location estimation set e.g. a confidence value for each of the latitude longitude and altitude data fields etc. . For example confidence values of 0.90 0.95 and 0.91 may indicate that the x y and z coordinates are accurate within 30 meters between 90 and 95 percent of the time.

In some embodiments the mobile device may be configured to also compute a precision value that identifies or which is indicative of the repeatability factor of the computation measurements over multiple measurements. The precision value may be used to determine how often the device reports the same position location i.e. based on evaluating multiple reports indicating that the device has not moved more than X meters etc. which may be used to determine the precision of the measurement e.g. within 1 meter etc. . The precision value may also be used to determine the likelihood that repeating the computation e.g. using the same inputs or input sources will result in substantially the same values.

In block a processor of the mobile device may receive information that is suitable for use as may be used to generate or which includes location information such as GPS data a Cell ID a WiFi ID Beacon data a RFID Loran C data OS Library Function etc. In some embodiments the mobile device may receive location information from active or passive external devices systems. For example the mobile device may communicate with an active external device such as location based server from a fleet management company to receive location information. As part of these operations the mobile device may perform various operations e.g. interrogation etc. to establish communication links and receive information from the active external devices. Alternatively or in addition the mobile device may receive location information from a passive external device such an RFID chip that scans for the presence of device and or which broadcasts location information periodically. In addition the mobile device may generate location information locally in the device based on information received from an external system in block . For example the mobile device may generate GPS data e.g. GPS coordinates or GPS determined position information in a local GPS receiver based on GPS information received from an external GPS system. As another example the mobile device may use received WiFi ID information to determine or compute its proximity to known networks and generate location information based on the determined proximity to these known networks.

In block the mobile device may generate and or receive updated dead reckoning DR position information or dead reckoning position estimate value . As mentioned above the mobile device may be equipped with sensors e.g. accelerometer gyros magnetic compass altimeters odometers etc. that allow it to estimate the distance it has traveled or moved over a period of time in any dimension e.g. x y or z latitude longitude or altitude etc. . The mobile device may use information collected from these sensors in block to perform any or all of the dead reckoning operations discussed in this application and generate DR position information. For example the mobile device may use information from the sensors e.g. accelerometer gyros magnetic compass altimeters odometers etc. to determine the distance it has traveled or been moved since the last time it was able to ascertain its location with a sufficiently high degree of confidence e.g. Cx Cy and Cz are all greater than . etc. determine its current location based on the determined distance e.g. distance it has traveled etc. and generate updated DR position information that identifies its current location. In some embodiments the mobile device may also compute confidence values and or a precision value for the generated DR position information in block .

In block the mobile device may receive and process location based service information LBS information from other devices such as from transceiver or other mobile devices in the communication group. Since the LBS information may be received from devices that are being moved and or which are not stationary the LBS information may include or may be used to generate or establish multiple waypoints at discrete times and or for discrete durations or periods of time. In some embodiments the LBS information may include estimated distances between multiple e.g. three or more devices transceivers and the mobile device. Each waypoint may be an information structure that includes one or more information fields component vectors location information position information coordinate information etc.

Thus the location information module of the mobile device may be configured to receive process and or generate standard location information or a first data set estimate value etc. in block updated DR position information or a second data set estimate value etc. in block and LBS information a third data set estimate value etc. in block . In operation the location information module may send any or all such information e.g. first second and third values sets to the trilateration module as input data.

In blocks the mobile device trilateration module may use the received input data to perform trilateration operations e.g. trilateration API location operations etc. determine the geographical coordinates e.g. latitude longitude and altitude coordinates of the mobile device generate a trilateration position estimate value generate a final position set e.g. a final location estimate value generate an updated final position set e.g. x y and z coordinates an updated position estimate value more precise information etc. and send the updated final position set to the output storage module . The trilateration operations may include operations for implementing any or all of the techniques discussed in this application including time of arrival angle of arrival mobile to mobile trilateration lateration multilateration triangulation etc.

In the example illustrated in in block the mobile device generates computes receives trilateration location values X Y Z a time value trilateration location delta values X Y Z confidence values C C C and one or more precision values the combination of which may be stored or used as a waypoint or a data set or estimate value . In block the mobile device may rank or assign weights to the current or historical waypoints i.e. previously computed waypoints . In block the mobile device may generate two or three dimensional vectors using the waypoints current and or historic . In an embodiment the mobile device may generate the vectors based on their rank weights e.g. by including using only waypoints having a rank that exceeds a threshold value .

As mentioned above the trilateration module may send the computed updated final position set to the output storage module . The output storage module may store the updated final position set in a location buffer or the illustrated updated final position datastore . In block the output storage module may use the updated final position set more precise location information to provide a location based service. In block the output storage module may send the updated final position set to other devices such as to a network server or the other mobile devices in the communication group.

In order to accurately compute determine the updated final position set the mobile device system may be required to communicate with other devices in a communication group e.g. in block . However mobile devices do not always have access to a communication group yet alone a sufficiently large communication group and or to the robust data that could be required to accurately determine the location of the device. As such in the example illustrated in in block the mobile device may receive LBS information from a server computing device e.g. a network provided location service . In operation the mobile device may send the standard location information or first data set estimate value etc. updated DR position information or second data set estimate value etc. and the LBS information received from the server or third data set estimate value etc. to the trilateration module as input data. The trilateration module may receive and use the input data to compute generate a final position set and or an updated final position set and send the generated position set to the output storage module for storage and or use.

In block the mobile device may perform trilateration operations e.g. trilateration API location operations etc. determine the geographical coordinates of the mobile device and generate a third data set e.g. x y and z coordinates third estimate value etc. based on the determined geographical coordinates. In block the mobile device may pass the first second and third data sets or estimate values etc. through a second kalman filter Kalman Filter to generate a position set e.g. final position set final location estimate value updated final location estimate value etc. . In block the mobile device may use the position set to determine compute the current location of the device. As part of these operations the mobile device may generate a waypoint information structure or estimate value that includes trilateration location values X Y Z a time value trilateration location delta values X Y Z confidence values C C C and one or more precision values and use the generated way point to set the current location of the device. In an embodiment the mobile device may be configured to store the waypoint in a list or other information structure in conjunction with a timestamp.

In determination block the processor may determine whether the updated location set is valid. In response to determining that the updated location set is not valid i.e. determination block No the processor may discard the measurement e.g. the updated location set and or the received information or mark it as invalid in block . In response to determining that the updated location set is valid i.e. determination block Yes in block the processor may insert the updated location set or updated final location estimate value etc. into a sorted list of coordinates under a position source with a confidence interval and reporting time. In addition the processor may retain past location determinations e.g. previously computed waypoints estimate values etc. by for example marking or otherwise designating them as historical waypoints. In block the processor may update a position location table to include the computed updated location set. In addition in some embodiments the processor may set the current location of the device to be equal to the updated location set and repeat the operations described above to continuously or repeated update its current location and generate more precise location information.

In some embodiments e.g. the embodiments discussed with reference to the mobile device may be configured to report location information e.g. GPS location position updates etc. . The mobile device may report location information by generating and sending data location estimate values location sets waypoints and other location related information and or information structures units to a server and or other mobile devices such as in response to receiving location information and or in response to determining that the received retrieved location information may be used to obtain an adequate positional fix. As such the reporting of location information by the mobile device may be indicative of its ability to acquire obtain an adequate positional fix.

As mentioned above the mobile device may be configured to generate and use waypoints. A waypoint may be an information structure that includes one or more information fields component vectors location information position information coordinate information etc. For example a waypoint may be an information structure that includes latitude longitude and altitude coordinates as well as a confidence value precision value rank a time stamp and an information type identifier e.g. GPS Loran C sensor combined etc. . A waypoint may also be or may include a location estimate value a location set or any other similar location information suitable for adequately conveying or communicating location information.

A waypoint list may be a an information structure that includes one or more waypoints. A waypoint list may be ordered list in which a waypoint s position in the list indicates each waypoint s rank when its corresponding location information was received when the information was reported etc. In some embodiments the waypoint list may be a stack. In some embodiments the waypoint list may include waypoints of a single information type. In some embodiments the system may include multiple waypoint lists GPS waypoint list Loran C waypoint list reported waypoint list reported GPS waypoint list final location waypoint list updated final location waypoint list etc. .

With reference to in block the processor may poll or monitor sensors communications circuitry data ports buses etc. to receive or retrieve location information such as GPS data Loran C Cell ID etc. In the example illustrated in in block the processor monitors GPS circuitry to receive GPS data from a GPS system. In some embodiments the processor may use the received information to generate a working or current waypoint in block .

In determination block the processor may determine whether the device is reporting location information so as to determine whether the system was able to obtain an adequate positional fix using the received GPS data. The processor may determine whether the mobile device is reporting location information by retrieving obtaining examining or accessing a list of reported locations waypoints. For example the processor may compare or evaluate timestamps that are associated with recently reported GPS waypoints e.g. reported waypoints having an information type identifier of GPS that are stored in a list of reported GPS waypoints reported GPS waypoint list location list etc. to determine whether the device s location was reported after the GPS data was received in which case the device is reporting the location . Similarly the processor may determine whether the device s location was reported within a certain time period e.g. within the past 2 seconds 10 seconds 1 minute 10 minutes etc. which may be a variable or preset value that is determined selected dynamically based on the location based service s being provided by the device.

In response to determining that the device is not reporting location information i.e. determination block No the processor may discard or disregarded the received GPS data or the working current waypoint and select a location waypoint or location set location estimate value etc. from memory in block . This may be accomplished by selecting a waypoint from a reported waypoint list e.g. a list of reported trusted or historical waypoints etc. that is stored in the local memory of the device. In some embodiments in block the processor may select a prior reported waypoint e.g. t 1 or t 2 where t 0 is the current location in time having the highest confidence rank and update or correct the range of the selected waypoint to more accurately represent the current location and position of the device. That is the processor may update the selected waypoint for t 0 where t 0 is the current location in time which may be accomplished using any or all of the location update methods procedures or solutions discussed in this application. If there are no previously reported waypoints stored in the memory or if the processor determines that the stored waypoints have low confidence values i.e. a value that is less than a threshold value in block the processor may select a null value so as to indicate that an adequate location position is not available.

In response to determining that the device is reporting location information i.e. determination block Yes in determination block the processor may determine whether the confidence or rank of the current working waypoint e.g. last GPS waypoint that was generated and reported which represents the received GPS data is greater than or equal to the confidence rank of one or more of the other previously reported waypoints. For example the processor may traverse a list of reported GPS waypoints and determine whether a confidence value associated with the current working waypoint or the most recently reported GPS waypoint or the t 0 waypoint is greater than or equal to the confidence value associated with the second most recently reported GPS waypoint e.g. the t 1 waypoint . As another example the processor may determine whether the confidence value associated with the working current waypoint is greater than or equal to the confidence values associated with the second and third most recently reported GPS waypoints e.g. the t 1 or t 2 waypoints etc. is greater than or equal to the confidence values of the GPS waypoints that were reported within a period of time e.g. within the past 10 min etc.

In response to determining that the confidence rank of the current working waypoint is less than i.e. is not greater than or equal to the confidence rank of the previously reported locations waypoints i.e. determination block No the processor may select one of the previously reported locations waypoints e.g. t 1 or t 2 waypoints etc. from memory in block . On the other hand in response to determining that the confidence or rank of the current working waypoint is greater than or equal to the confidence or rank of the previously reported locations waypoints i.e. determination block Yes in block the processor may select the current working waypoint.

In block the processor may perform a GPS location update based on the selected waypoint e.g. the current working waypoint a previously reported location waypoint etc. and or store the selected waypoint in memory. For example the processor may generate a final GPS position estimate value and or final updated GPS waypoint based on the selected waypoint. In some embodiments the processor may generate and set a temporary GPS waypoint based on or to be equal to the final updated waypoint or final GPS position estimate value. The temporary GPS waypoint may be used as an estimate of the device current location. In block the processor may synchronize the stored or temporary GPS waypoint of the device with a time stamp e.g. for t 0 and or extrapolate the information to fit a current time and update or set the temporary GPS waypoint based on the results of the synchronizing extrapolating operations. After the completion of the operations of block the memory stores a temporary GPS waypoint that is representative of the device s current location based on GPS data .

With reference to in block the processor may receive location information in the form of Loran C data similar to the operations in block and generate a current or working waypoint. In determination block the processor may determine whether the mobile device is reporting location information e.g. by accessing a list of reported locations a Loran C waypoint list etc. so as to determine whether the system was able to obtain an adequate location positional fix based on the Loran C data. In response to determining that the device is not reporting location information i.e. determination block No the processor may discard disregard the working current waypoint and thus the received Loran C data and select a location waypoint from memory in block . For example the processor may select a stored waypoint a previously reported location waypoint having the highest confidence rank t 1 or t 2 . In addition in block the processor may update the selected waypoint for t 0 i.e. the current location in time to more accurately represent the current location and position of the device. Also in block if there are no previous locations waypoints stored in the memory or the stored locations waypoints have low confidence values the processor may select a null value to indicate that an adequate location position is not available based on the Loran C data .

In response to determining that the device is reporting location information i.e. determination block Yes in determination block the processor may determine whether the confidence rank of the working current waypoint is greater than or equal to the confidence rank of a previously reported location waypoint similar to block . In response to determining that the confidence or rank of the working current waypoint i.e. last reported location waypoint is less than the confidence or rank of the previously reported location waypoint i.e. determination block No in block the processor may discard disregard the working current waypoint and thus the received Loran C data and select a previously computed location waypoint e.g. a Loran C waypoint which is a waypoint having an information type identifier of Loran C from memory.

In response to determining that the confidence or rank of the working current waypoint or last reported location waypoint is greater than or equal to the confidence or rank of the previously reported location waypoint i.e. determination block Yes in block the processor may select the working current waypoint or most recently reported location waypoint . In block the processor may perform a loran C location update and generate a final position estimate value or an updated final waypoint based on the selected waypoint. The processor may also generate update or set the temporary Loran C waypoint based on the final position estimate value or updated final waypoint. In block the processor may synchronize the temporary Loran C waypoint with a time stamp e.g. for t 0 and or extrapolate the information to fit the current time. As such after the completion of the operations of block the memory stores an updated temporary Loran C waypoint which represents a current location of the device based on Loran C data.

In some embodiments the operations illustrated in may be performed in conjunction with the operations illustrated in . For example the system could be configured to generate a temporary GPS waypoint and a temporary Loran C waypoint each of which represents a current location of the device. As is discussed further below with reference to the mobile device processor may use each of these waypoints as inputs to kalman filter the output of which may be used to generate a single final waypoint or an updated final position estimate value more precise location information etc. that identifies the precise location of the device.

With reference to in block the processor may receive location information in the form of Cell IDs and generate a working current waypoint. In determination block the processor may determine whether it is reporting the location information. In response to determining that the device is not reporting location information i.e. determination block No in block the processor may select location waypoint having the highest confidence rank t 1 or t 2 from memory and update or correct the selected location waypoint to more accurately represent the current location and position of the device similar to the operations in blocks and discussed above . If there are no previous locations waypoints stored in the memory or the stored locations waypoints have a low confidence value i.e. a value that is less than a threshold value the processor may select a null value to indicate that an adequate location position is not available in block . In addition in block the processor may obtain bearing and DR distance information for from the available sensors if such information is available .

In response to determining that the device is reporting location information i.e. determination block Yes in determination block the processor may determine whether the confidence or rank of the working current waypoint or last reported location waypoint is greater than or equal to the confidence rank of a previously reported location waypoint similar to block . In response to determining that the confidence rank of the working current waypoint is not greater than or equal to the confidence or rank of the previously reported location waypoint i.e. determination block No the processor may select a previously computed location waypoint from memory in block similar to block . In response to determining that the confidence or rank of the working current waypoint is greater than or equal to the confidence or rank of the previously reported location waypoint i.e. determination block Yes in block the processor may select the working current waypoint most recently reported location waypoint .

In block the processor may perform a Cell ID update based on the selected waypoint. For example the processor may generate a final position estimate value or an updated Cell ID waypoint based on the selected waypoint value location e.g. the current working waypoint previously reported locations waypoints etc. . In some embodiments the processor may generate and set a temporary Cell ID waypoint based on or to be equal to the updated Cell ID waypoint or final position estimate value. The temporary Cell ID waypoint may be used as an estimate of the device current location. In block the processor may synchronize the temporary Cell ID waypoint with a time stamp e.g. for t 0 and or extrapolate the information to fit a current time. As such after the completion of the operations of block the memory stores a temporary Cell ID waypoint that is representative of the device s current location.

Thus the processor may determine that the device is not able to obtain a positional fix and therefore it is not reporting the positional information and therefore no CellID position update or positional information has been obtained. When there is no CellID positional data being reported previous CellID positional locations that were stored may be used in place of the expected CellID positional location data. The highest rank confidence location position may be used and this historic position may be position corrected for the t 0 where t 0 is the device s current location in time. If there are no previous positions stored in memory or the positions stored are below a defined confidence value then a null value no position available may be indicated. If the CellID position location reported has a lower confidence than the previous position location reported i.e. determination block No then the current position location data is passed to block and or a previously computed waypoint is selected. If the CellID position location reported is at the same or higher confidence than the previous position location i.e. determination block Yes then this position is listed as position t 0 in block and sent to process for the CellID location update The position location update may also be stored in a database used for potential use in block for future position updates.

In some embodiments the operations illustrated in may be performed in conjunction with the operations illustrated in . For example the system could be configured to generate a temporary Cell ID waypoint a temporary Loran C waypoint and a temporary GPS waypoint serially or in parlledl and each of these waypoints may independently represent the current location of the device.

With reference to in block the processor may poll or monitor sensors or communications circuitry to receive location information in the form of WIFI IDs and generate a working current waypoint. In determination block the processor may determine whether it is reporting location information i.e. to determine whether a WIFI ID position update or positional information is obtained . In response to determining that the device is not reporting location information i.e. determination block No the processor may select a location waypoint having the highest confidence rank t 1 or t 2 from memory and update or correct the range of the selected location waypoint to more accurately represent the current location and position of the device in block . Also in block if there are no previous locations waypoints stored in the memory or the stored locations waypoints have low confidence values i.e. a value that is less than a threshold value the processor may select a null value to indicate that an adequate location position is not available. In addition in block the processor may obtain bearing and DR distance information for sensors if available .

Thus in block the processor may determine that WIFI ID is not able to obtain a positional fix and therefore it is not reporting the positional information and therefore no WIFI ID position update or positional information is obtained. In block when there is no WIFI ID positional data being reported previous WIFI ID positional locations that were stored are used in place of the expected WIFI ID positional location data. The highest rank confidence location position waypoint may be used and it historic position may be position corrected for the t 0 where t 0 is the current location in time . If there are no previous positions waypoints are stored or the positions waypoints stored are below a defined confidence value then a null value or no position available may be indicated.

In response to determining that the device is reporting location information i.e. determination block Yes in determination block the processor may determine whether the confidence rank of the working current waypoint last reported location waypoint is greater than or equal to the confidence rank of a previously reported location waypoint similar to blocks etc. . In response to determining that the confidence or rank of the working current waypoint is not greater than or equal to the confidence or rank of the previously reported location waypoint i.e. determination block No in block the processor may select a previously computed location waypoint from memory. In response to determining that the confidence or rank of the working current waypoint is greater than or equal to the confidence or rank of the previously reported locations waypoints i.e. determination block Yes in block the processor may select the working current waypoint the most recently reported location waypoint .

In block the processor may perform a WIFI ID location update based on the selected waypoint. For example the processor may generate a final position estimate value or an updated WIFI ID waypoint based on the selected value waypoint e.g. the current working waypoint previously reported locations waypoints etc. . In some embodiments the processor may generate and set a temporary WIFI ID waypoint based on or to be equal to the updated WIFI ID waypoint or final position estimate value. The temporary WIFI ID waypoint may be used as an estimate of the device current location. In block the processor may synchronize the temporary WIFI ID waypoint with a time stamp e.g. for t 0 and or extrapolate the information to fit a current time. As such after the completion of the operations of block the memory stores a temporary WIFI ID waypoint that is representative of the device s current location. working current waypoint

Thus in block if the WiFiID position location reported has a lower confidence than the previous position location reported then the current position location data may be passed to block . If the WiFiID position location reported is at the same or higher confidence than the previous position location then this position is listed as position t 0 in block and sent to block for the WiFiID location update The position location update is also stored in the database used for potential use in block for future position updates.

In some embodiments the operations illustrated in may be performed in conjunction with the operations illustrated in . For example the system could be configured to generate a temporary WiFiID waypoint temporary CellID waypoint a temporary Loran C waypoint and a temporary GPS waypoint each of which represents a current location of the device.

With reference to in block the processor may poll or monitor sensors or communications circuitry to receive location information in the form of Beacons RFIDs or other similar information from other similar location devices and generate a current working waypoint similar to block . In determination block the processor may determine whether it is reporting location information similar to block . In response to determining that the device is not reporting location information i.e. determination block No the processor may select a location waypoint having the highest confidence rank t or t 2 and update or correct the range of the selected location waypoint to more accurately represent the current location and position of the device in block . Also in block if there are no previous waypoints stored in the memory or the stored waypoints have a low confidence value i.e. a value that is less than a threshold value the processor may select a null value to indicate that an adequate location position is not available. In addition in block the processor may obtain bearing and DR distance information for sensors if available .

In response to determining that it is reporting location information i.e. determination block Yes in determination block the processor may determine whether the confidence or rank of the current working waypoint is greater than or equal to the confidence rank of a previously reported waypoint similar to block . In response to determining that the confidence or rank of the current working waypoint is not greater than or equal to the confidence or rank of the previously reported waypoint i.e. determination block No in block the processor may select a previously computed waypoint from memory. In response to determining that the confidence or rank of the current working waypoint is greater than or equal to the confidence or rank of the previously reported waypoint i.e. determination block Yes in block the processor may select the current working waypoint. In block the processor may perform a Beacon RFID etc. location update and generate a final position estimate value or an updated final position estimate value based on the selected waypoint. In block the processor may synchronize the current working waypoint similar to block . After the completion of the operations of block the memory stores a temporary waypoint temporary Beacon waypoint temporary RFID waypoint etc. that is representative of the device s current location.

Said another way in block the processor determines that Beacon RFID is not able to obtain a positional fix and therefore it is not reporting the positional information and therefore no Beacon RFID position update or positional information is obtained. In block when there is no Beacon RFID positional data being reported previous Beacon RFID positional locations that were stored are used in place of the expected Beacon RFID positional location data. The highest rank ie confidence location position is used and this historic position is position corrected for the t 0 where t 0 is the current location in time. If there are no previous positions stored or the positions stored are below a defined confidence value then a null value no position available indicated. In block if the Beacon RFID position location reported has a lower confidence than the previous position location reported then the current position location data is passed to bock . If the Beacon RFID position location reported is at the same or higher confidence than the previous position location then this position is listed as position t 0 in block and sent to process for the Beacon RFID location update. The position location update is also stored in the database used for potential use in block for future position updates.

In some embodiments the operations illustrated in may be performed in conjunction with the operations illustrated in . For example the system could be configured to generate a temporary RFID waypoint a temporary WiFiID waypoint temporary CeID waypoint a temporary Loran C waypoint and a temporary GPS waypoint each of which independently represents a current location of the device.

With reference to in determination block the processor may determine whether dead reckoning is available on this device. In response to determining that dead reckoning is available i.e. determination block Yes the processor may determine whether it is reporting the information in determination block . In response to determining that the device is not reporting information i.e. determination block No the processor may select a location waypoint having the highest confidence rank t 1 or t 2 and update or correct the range of the selected location waypoint to more accurately represent the current location and position of the device in block . Also in block if there are no previous locations waypoints stored in the memory or the stored locations waypoints have a low confidence value i.e. a value that is less than a threshold value the processor may select a null value to indicate that an adequate location position is not available.

In response to determining that the mobile device is reporting location information i.e. determination block Yes in determination block the processor may determine whether the confidence or rank of the last reported location waypoint or a working current waypoint is greater than or equal to the confidence rank of a previously reported location waypoint similar to block . In response to determining that the confidence or rank of the last reported location waypoint is not greater than or equal to the confidence or rank of the previously reported location waypoint i.e. determination block No in block the processor may select a previously computed location waypoint from memory. In response to determining that the confidence or rank of the last reported waypoint is greater than or equal to the confidence or rank of the previously reported waypoint i.e. determination block Yes in block the processor may select the reported waypoint similar to block . In block the processor may perform a dead reckoning position update based on the selected waypoint value location. For example the processor may generate a final position estimate value or an updated waypoint based on the last reported location waypoint current working waypoint previously reported locations waypoints etc. The processor may also set the temporary current location of the device based on the final position estimate value or updated waypoint and generate a temporary DR waypoint that is representative of the device s current location based on DR information .

Said another way in block the processor may determine whether dead reckoning is available on this device. If dead reckoning is not available in block the processor provides a null value for the dead reckoning update e.g. by sending the null value to the dead reckoning module of the device . However if dead reckoning is available with the device in block the processor determines if the dead reckoning capability is being reported. Dead reckoning may not be reported if there is a sensor problem on the handset. If there is a dead reckoning position reporting problem in block the processor selects a previous dead reckoning position which is corrected for the current time based on previous trajectory calculations for an axis or two or three axes that is are available. In block when there is no read reckoning positional data being reported previous dead reckoning positional locations that were previously determined and stored in memory may be used in place of the expected dead reckoning positional location data. The highest rank confidence location position waypoint is used and this historic position is position corrected for the t 0 where t 0 is the current location in time. If there are no previous positions stored or the positions stored are below a defined confidence value then a null value no position available indicated. In block if the dead reckoning position location reported has a lower confidence than the previous position location reported then the current position location data may be passed to block . If the dead reckoning position location reported is at the same or higher confidence than the previous position location then this position is listed as position t 0 in block and sent to block for the dead reckoning location update. The position location update is also stored in the database used for potential use in block for future position updates.

In some embodiments the operations illustrated in may be performed in conjunction with the operations illustrated in . For example the system could be configured to generate a temporary DR waypoint temporary RFID waypoint a temporary WiFiID waypoint a temporary CellID waypoint a temporary Loran C waypoint and a temporary GPS waypoint each of which independently represents a current location of the device.

With reference to in block the processor may receive network provided location information from a server computing device and generate a working current waypoint based on this information. In determination block the processor may determine whether it is reporting location information in response to receiving the network provided location information from the server computing device. In response to determining that the device is not reporting location information i.e. determination block No the processor may select a location waypoint having the highest confidence rank t 1 or t 2 from memory and update or correct the range of the selected waypoint to more accurately represent the current location and position of the device in block . Also in block if there are no previous waypoints stored in the memory or the stored waypoints have a low confidence value i.e. a value that is less than a threshold value the processor may select a null value to indicate that an adequate location position is not available. In addition in block the processor may obtain bearing and DR distance information for sensors if available .

In response to determining that it is reporting location information i.e. determination block Yes in determination block the processor may determine whether the confidence or rank of the working current waypoint or last reported waypoint is greater than or equal to the confidence rank of a previously reported waypoint. In response to determining that the confidence or rank of the working current waypoint is not greater than or equal to the confidence or rank of the previously reported waypoint i.e. determination block No in block the processor may select a previously computed waypoint from memory. In response to determining that the confidence or rank of the working current waypoint is greater than or equal to the confidence or rank of the previously reported waypoint i.e. determination block Yes in block the processor may select the working current waypoint.

In block the processor may perform a location update based on the selected waypoint generate a final position estimate value or an updated network location waypoint generate and set a temporary network location based waypoint based on or to be equal to the updated network location waypoint or final position estimate value etc. The processor may also set the temporary current location of the device based on the updated waypoint or generated final position estimate value . In block the processor may synchronize the current location position of the device and or extrapolate the information to fit a current time. After the completion of the operations of block the memory stores a temporary network location based waypoint that is representative of the device s current location.

Thus for the network provided location position update the device s position location information is calculated in a server and reported back to the device. In block the processor determines that it is not able to obtain a positional fix based on this network provided location position information because it is not reporting the positional information and thus no network provided location position update or positional information is obtained. In block when there is no network provided location position positional data being reported previous network provided location position positional locations that were stored are used in place of the expected network provided location position positional location data. The highest rank ie confidence location position is used and this historic position is position corrected for the t 0 where t 0 is the current location in time. If there are no previous positions stored or the positions stored are below a defined confidence value then a null value no position available indicated. In block if the network provided location position reported has a lower confidence than the previous position location reported then the current position location data is passed to block . If the network provided location position reported is at the same or higher confidence than the previous position location then this position is listed as position t 0 block and sent to block for the Network Provided Location Position location update The position location update is also stored in the database used for potential use in block for future position updates.

In some embodiments the operations illustrated in may be performed in conjunction with the operations illustrated in . For example the system could be configured to generate a temporary network location based waypoint a temporary DR waypoint temporary RFID waypoint a temporary WiFiID waypoint a temporary CellID waypoint a temporary Loran C waypoint and a temporary GPS waypoint each of which may independently represent a current location of the device.

With reference to in blocks to the processor may receive any or all of the updated location position information discussed above e.g. temporary network location based waypoint a temporary DR waypoint temporary RFID waypoint a temporary WiFiID waypoint a temporary CellID waypoint a temporary Loran C waypoint and a temporary GPS waypoint and perform various operations to identify and select the best available information. The processor may also use the selected information to compute more precise location information e.g. an updated final waypoint updated final position estimate value etc. . For example the processor may select the top three or four positions waypoints that are reported. If there are not enough inputs available the processor may select and use the best of what is reported available until it determines or identifies three or four valid inputs. A further update may not occur until the position of the device has changed either by a difference in the current position verse the last position update or a time has expired or if there was a change in dead reckoning or with one of the externally provided position sources.

In particular in block the processor may determine the number of valid values available e.g. based on the reported information temporary current locations waypoints final position estimate values etc. . For example the processor may select one waypoint from each of a plurality of waypoint lists e.g. a temporary GPS waypoint list a temporary network location based waypoint list a temporary DR waypoint list etc. evaluate each of the selected waypoints to determine whether they store a valid location value e.g. are not equal to null were recently reported etc. and increment a counter for each waypoint that is determined to store a valid location.

In determination block the processor may determine whether the number of valid location positions counter value is less than a threshold value three in the example illustrated in . In response to determining that the number of valid location positions available counter value is less than the threshold value i.e. determination block Yes in block the processor may select from memory a location or waypoint having the highest rank or confidence value and generate a final waypoint based on the selected location waypoint. For example the processor may select a waypoint from a list of previously reported final waypoints stored in memory. In response to determining that the number of valid location positions is not less than the threshold i.e. determination block No in block the processor may select the two or more waypoints having the highest confidence values as filter input. In block the processor may apply the selected filter input to the kalman filer e.g. a module that implements a procedure algorithm method technique or sequence of operations for accomplishing the function of a kalman filter to generate output identifying a single location position e.g. a single estimate of position velocity and acceleration etc. use the output to generate a final waypoint.

In block the processor may obtain compute or generate a revised or updated position location e.g. by generating an updated final position estimate value etc. based on the final waypoint generated in block or generate an updated final waypoint and store the updated final waypoint in memory as the current location e.g. at t 0 . In determination block the processor may compare the updated final waypoint to previously computed stored updated final waypoint which may be stored in an updated final waypoint list to determine whether the location of the device has changed in any axis by an amount that exceeds e.g. is greater than or equal a threshold amount. Said another way the processor may determine whether the updated location information differs from the previously computed location information by x or more in any axis in determination block .

In response to determining that the location of the device has changed in any axis by an amount that exceeds the threshold amount i.e. determination block Yes the processor may recalculate or recomputed the location position of the device in block such as by performing any or all of the operations in . In response to determining the location of the device has not changed in any axis by an amount that exceeds the threshold amount i.e. determination block No in block the processor may wait for an X amount of time or until changes are reported by external LBS inputs network LBS or Dead Reckoning before repeating any or all of the operations discussed above with reference to . That is if the location of the device has not changed in any axis by an amount that exceeds the threshold amount then no further updates are initiated until either a configurable time has expired or there has been an change in LoranC GPS WiFi ID Beacons Cell ID Dead Reckoning etc.

The various enhanced location based service eLBS methods discussed in this application e.g. method etc. may be implemented in a mobile computing device as part of a eLBS module which may be used by client applications of the device to provide location based services. The mobile device may include a High Level Operating System HLOS and the eLBS module may be implemented on the device such that it may use or access the other sensor and communications modules in that device as via system or function calls to the HLOS. For example the eLBS module may utilize the HLOS and or the features that are available or accessible via the HLOS to collect information e.g. location based information sensor information etc. and use this information to perform its various eLBS operations.

In this example illustrated in the eLBS module receives collects information from the compass magnetometer gyroscope altimeter or barometer low power Bluetooth module NFC module GPS module and modem module via the operating system . The eLBS module may use any all of this information to determine the location of the device determine a more precise location of the device and send the information to the software applications e.g. App eLBS etc. .

In this example illustrated in the eLBS module receives collects information from the compass magnetometer gyroscope altimeter or barometer low power Bluetooth module NFC module GPS module and modem module via the sensor hub . The eLBS module may use any all of this information to determine the location of the device determine a more precise location of the device and send the information to the software applications e.g. App eLBS etc. executing operating on the operating system via the sensor hub .

In the various embodiments the eLBS module may be configured to perform an eLBS algorithm procedure. The eLBS algorithm may be implemented as an application running in an Operating System OS of a mobile device. The eLBS algorithm may be such that the sensor and communication modules that are used for eLBS are under the control of the OS and the eLBS algorithm utilizes the OS of the mobile device to collect information. For instance sensors may be controlled by the OS and the eLBS algorithm may use the OS of the mobile device to obtain the sensor data to perform particular functions like dead reckoning The eLBS algorithm may also use the OS of the mobile device to obtain GPS data from the GPS module to establish communication with the other devices by instructing the OS to establish communication either by low power Bluetooth LTE TDD FDD WiFi Near Field Communications Ultrawideband etc.

The eLBS algorithm may also be implemented via a sensor hub of a mobile device. The use of a sensor hub may improve battery life of the mobile device. The sensor hub may be configured to establish and control the sensors and peripheral devices freeing the OS from having to control these devices. This in effect allows the OS to focus its operations on executing the software applications. When the applications require additional inputs or outputs with peripheral hardware devices it is accomplished via the sensor hub. The eLBS algorithm can be installed or imbedded in the sensor hub or some similar device. Embedding the eLBS algorithm in the sensor hub may allow the mobile device to implement and use a more efficient power management scheme and continuously improve the mobile device s position without increasing the power consumption requirements of the OS.

In operation block the mobile device eNodeB EPC system component and E SMLC system component may communicate and perform various administrative tasks such as initiation and authentication by exchanging data and control information. In operation the GPS system component may send GPS data to the mobile device . In operation the WiFi system component may send WiFi data to the mobile device . In operation the Beacon RFID system component may send Beacon RFID data to the mobile device . In operation the eNodeB component may send network provided location information to the mobile device . In operation block the mobile device may receive and use the GPS data WiFi data Beacon RFID data and network provided location information to determine the location of the mobile device e.g. by performing any or all of the operations illustrated in etc. and generate a final waypoint or final location estimate value .

As discussed above e.g. with reference to etc. the E SMLC system component may be configured to perform various operations such as collecting and maintaining tracking information about the mobile device providing location services e.g. via LLP forwarding external or network initiated location service requests exchanging almanac and or assistance data with the eNodeB component etc. The eNodeB component may communicate with the E SMLC system component and the mobile device e.g. via System Information Blocks to send and receive location information. In the various embodiments the E SMLC system component eNodeB component and mobile device may be configured to communicate any or all of the location information discussed in this application such as network provided location information positional location information updated position information final waypoint updated final waypoint more precise location information location estimation set previously computed location information initial position value dead reckoning position estimate value set combined sensor position estimate value trilateration position estimate value final location estimate value temporary position and error values etc. 

Returning to in operation the E SMLC system component may send a request for location information to the eNodeB component . In operation the eNodeB component may send a response to the request for location information to the E SMLC system component . The response may include the network provided location information a time stamp cell of origin COO information time of arrival TOA information observed time difference of arrival OTDOA information advanced forward link trilateration AFLT information and angle of arrival AOA information etc.

In operation the E SMLC system component may send a request for updated location information to the mobile device . In operation the mobile device may a communication message that includes location information e.g. the final waypoint generated in operation block to the E SMLC system component. In operation block the E SMLC system component may use the location information included in the received communication message to update its location position information update its tracking information provide location services and or generate updated network derived location information. In operation the E SMLC system component may send the updated network derived location information to the mobile device .

In operation block the eNodeB the EPC system component and or the E SMLC system component may determine that a timer has expired e.g. which may be set each time location information is received from the mobile device etc. or that another event has occurred that indicates there is a high probability that the mobile device has moved a significant distance. In response to determining that the timer has expired or another event has occurred the system may repeat operations through so as to synchronize their information and or so that each component maintains or has access to updated and precise location information.

In some embodiments in block the processor may determine whether the location information has been reported in which case generating the first waypoint may include generating a new waypoint and selecting the new waypoint as the first waypoint i.e. in response to determining that the location information has been reported and or selecting as the first waypoint one of a plurality of previously generated waypoints i.e. in response determining that the location information has not been reported . Alternatively or in addition in block the processor may perform any or all of the operations discussed above and illustrated in .

In block the processor may receive network provided location information from an eNodeB E SMLC or another network server etc. In block the processor may generate a second waypoint based on the received network provided location information. In block the processor may retrieve dead reckoning location information. In block the processor may generate a third waypoint based on the received network provided location information.

In block the processor may apply the first second and third waypoints to a kalman filter to generate precise location information e.g. a final waypoint a final location estimation set etc. . In some embodiment the precise location information may be a final location estimation set that includes position information velocity information and acceleration information. The position information may include latitude value a longitude value and an altitude value. Similarly velocity information may include latitude value a longitude value and an altitude value. The acceleration information may also include a latitude value a longitude value and an altitude value. In block the processor may use the precise location information to provide an enhanced location based service e.g. an emergency location service commercial location service internal location service lawful intercept location service etc. .

In optional block the processor may send the precise location information to a network server or eNodeB E SMLC etc. In optional block the processor may receive location information from the network server in response to sending the precise location information. In optional block the processor may generate more precise location information e.g. updated final waypoint updated final location estimation set etc. based on the received location information.

In an embodiment the method may further include grouping the mobile device with a wireless transceiver in proximity to the mobile device to form a communication group sending the precise location information to the wireless transceiver receiving on the mobile device location information from the wireless transceiver in response to sending the precise location information and generating the more precise location information based on the location information received from the wireless transceiver.

The foregoing method descriptions and the process flow diagrams are provided merely as illustrative examples and are not intended to require or imply that the blocks of the various embodiments must be performed in the order presented. As will be appreciated by one of skill in the art the order of blocks in the foregoing embodiments may be performed in any order. Words such as thereafter then next etc. are not intended to limit the order of the blocks these words are simply used to guide the reader through the description of the methods. Further any reference to claim elements in the singular for example using the articles a an or the is not to be construed as limiting the element to the singular.

The various illustrative logical blocks modules circuits and algorithm blocks described in connection with the embodiments disclosed herein may be implemented as electronic hardware computer software or combinations of both. To clearly illustrate this interchangeability of hardware and software various illustrative components blocks modules circuits and blocks have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system. Skilled artisans may implement the described functionality in varying ways for each particular application but such implementation decisions should not be interpreted as causing a departure from the scope of the present invention.

The hardware used to implement the various illustrative logics logical blocks modules and circuits described in connection with the embodiments disclosed herein may be implemented or performed with a general purpose processor a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but in the alternative the processor may be any conventional processor controller microcontroller or state machine A processor may also be implemented as a combination of computing devices e.g. a combination of a DSP and a microprocessor a plurality of microprocessors one or more microprocessors in conjunction with a DSP core or any other such configuration. Alternatively some blocks or methods may be performed by circuitry that is specific to a given function.

In one or more exemplary aspects the functions described may be implemented in hardware software firmware or any combination thereof. If implemented in software the functions may be stored as one or more instructions or code on a non transitory computer readable medium or non transitory processor readable medium. The steps of a method or algorithm disclosed herein may be embodied in a processor executable software module which may reside on a non transitory computer readable or processor readable storage medium. Non transitory computer readable or processor readable storage media may be any storage media that may be accessed by a computer or a processor. By way of example but not limitation such non transitory computer readable or processor readable media may include RAM ROM EEPROM FLASH memory CD ROM or other optical disk storage magnetic disk storage or other magnetic storage devices or any other medium that may be used to store desired program code in the form of instructions or data structures and that may be accessed by a computer. Disk and disc as used herein includes compact disc CD laser disc optical disc digital versatile disc DVD floppy disk and blu ray disc where disks usually reproduce data magnetically while discs reproduce data optically with lasers. Combinations of the above are also included within the scope of non transitory computer readable and processor readable media. Additionally the operations of a method or algorithm may reside as one or any combination or set of codes and or instructions on a non transitory processor readable medium and or computer readable medium which may be incorporated into a computer program product.

The preceding description of the disclosed embodiments is provided to enable any person skilled in the art to make or use the present invention. Various modifications to these embodiments will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other embodiments without departing from the spirit or scope of the invention. Thus the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the following claims and the principles and novel features disclosed herein.

