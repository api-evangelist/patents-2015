---

title: Communication apparatus, information processing apparatus, and control method for the same
abstract: A communication apparatus comprising: a first communication unit; a second communication unit that is different from the first communication unit; and a control unit configured to control processing in which the first and second communication units are used, wherein the control unit performs control such that information regarding an application needed for processing performed using the second communication unit is sent to a first apparatus using the first communication unit, a signal based on the information regarding the application is received from the first apparatus or a second apparatus connected with the first apparatus using the second communication unit and the application is launched in accordance with the signal, and processing performed using the second communication unit is executed using the launched application.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09380626&OS=09380626&RS=09380626
owner: Canon Kabushiki Kaisha
number: 09380626
owner_city: Tokyo
owner_country: JP
publication_date: 20150209
---
The present invention relates to a communication apparatus an information processing apparatus and a control method for the same and in particular relates to a communication apparatus an information processing apparatus and a control method for the same according to which multiple types of wireless communication are possible.

In recent years various communication interfaces have been mounted in mobile terminals such as mobile phones and smartphones. Examples of wireless communication interfaces include wireless LANs Local Area Networks and the like which can be used over a relatively wide range and NFC Near Field Communication and the like which has a short communication distance. Different communication interfaces can be used according to their respective communication properties. For example communication can be performed using a wireless LAN interface in the case of accessing a server on a network and communication can be performed using an NFC interface in the case of communicating with a processing terminal installed at a specific location.

As an example in which multiple communication methods with different properties such as those described above are used in combination with each other Japanese Patent Laid Open No. 2012 138074 discloses a system that executes printing processing for document data using a wireless LAN and near field communication. After the document data is uploaded to a server from a mobile terminal by a user using a wireless LAN the system causes the mobile terminal and a processing terminal multifunction printer installed at a specific location to perform near field communication based on the multifunction printer whereupon the multifunction printer executes printing processing of the document data.

In the system disclosed in Japanese Patent Laid Open No. 2012 138074 a device identifier for the mobile terminal is sent from the mobile terminal to the multifunction printer when near field communication is performed. The multifunction printer uses the device identifier to perform authentication of the mobile terminal and processing for acquiring the document data with the server and remote printing of document data uploaded by the mobile terminal to the server is realized.

If a predetermined function is thus realized using multiple types of communication methods it is necessary to launch a specific application to perform the processing that is to be executed using the communication methods. For example there are cases in which the mobile terminal uses a specific application to perform processing for sending an order to the server and it is desired that payment processing therefor is realized using near field communication. In this case in order to realize payment processing between the mobile terminal and the processing terminal via near field communication it is sometimes necessary to execute a specific application such as an application used for order processing or an application that performs payment processing. In such a case after ordering the mobile terminal is moved to the location at which a processing terminal is installed and if the necessary application is not launched at this time payment processing cannot be executed even if the mobile terminal is brought near the processing terminal.

The present invention has been made in consideration of the aforementioned problems and realizes a technique according to which it is possible to launch and execute an appropriate application for realizing a function using multiple types of communication methods.

In order to solve the aforementioned problems the present invention provides a communication apparatus comprising a first communication unit a second communication unit that is different from the first communication unit and a control unit configured to control processing in which the first and second communication units are used wherein the control unit performs control such that information regarding an application needed for processing performed using the second communication unit is sent to a first apparatus using the first communication unit a signal based on the information regarding the application is received from the first apparatus or a second apparatus connected with the first apparatus using the second communication unit and the application is launched in accordance with the signal and processing performed using the second communication unit is executed using the launched application.

In order to solve the aforementioned problems the present invention provides a control method for a communication apparatus the communication apparatus comprising a first communication unit a second communication unit that is different from the first communication unit and a control unit configured to control processing in which the first and the second communication units are used the control method comprising a sending step of sending information regarding an application needed for processing performed using the second communication unit to a first apparatus using the first communication unit a launching step of receiving a signal based on the information regarding the application from the first apparatus or a second apparatus connected with the first apparatus using the second communication unit and launching the application in accordance with the signal and an execution step of executing using the launched application processing performed using the second communication unit.

In order to solve the aforementioned problems the present invention provides an information processing apparatus comprising a reception unit configured to receive information including identification information for a communication apparatus and application information sent by the communication apparatus a determination unit configured to determine whether or not the communication apparatus exists within a communicable range based on the identification information and a sending unit configured to if it is determined by the determination unit that the communication apparatus exists within the communicable range send the application information to the communication apparatus.

In order to solve the aforementioned problems the present invention provides a control method for an information processing apparatus comprising a reception step of receiving information including identification information for a communication apparatus and application information sent by the communication apparatus a determination step of determining whether or not the communication apparatus exists within a communicable range based on the identification information and a sending step of sending the application information to the communication apparatus if it is determined in the determination step that the communication apparatus exists within the communicable range.

According to the present invention it is possible to launch and execute an appropriate application that realizes a function using multiple types of communication methods.

Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings.

Embodiments of the present invention will be described in detail below. The following embodiments are merely examples for practicing the present invention. The embodiments should be properly modified or changed depending on various conditions and the structure of an apparatus to which the present invention is applied. The present invention should not be limited to the following embodiments. Also parts of the embodiments to be described later may be properly combined.

Hereinafter a mobile phone including wireless LAN and NFC communication functions will be described as an example of a communication apparatus to which the present invention can be applied. Also a reader writer including LAN and NFC communication functions will be described as an example of an information processing apparatus to which the present invention can be applied. However the present invention can be applied to any electronic device including multiple communication interfaces. Examples of electronic devices in this context include game devices tablet terminals personal computers and the like but these are merely examples.

An example of a system according to the present embodiment will be described below with reference to . The communication system according to the present embodiment is constituted by a mobile phone a reader writer and a server . The mobile phone can establish wireless communication such as a wireless LAN and near field communication such as NFC and perform communication via these communication methods. Also the reader writer can establish wireless and wired communication such as a wireless LAN and a wired LAN and near field communication such as NFC and perform communication via these communication methods. The server can communicate via wireless communication such as a wireless LAN and the communication which includes wireless communication such as a wireless LAN and wired communication such as a wired LAN.

By communicating with the server using the wireless communication the mobile phone can access the server and send and receive predetermined data. For example if the user launches an application of the mobile phone and orders a certain article the mobile phone accesses the server and sends an order request. Information sent to the server includes information regarding the application launched in the mobile phone when connected to the reader writer a unique identifier and process content although this will be described in detail later. In response to the received request the server sends a response including the necessary data to the mobile phone .

The reader writer and the server can communicate using the communication which is wireless communication or wired communication. The server stores the data received from the mobile phone and the reader writer in internal storage and responds by reading out the stored data according to various inquiries. The server sends data corresponding to the above described order received from the mobile phone to the reader writer .

The mobile phone can send and receive data that is needed for processing via the reader writer and near field communication such as the NFC. With the mobile phone upon authentication being performed with the reader writer the application designated in advance during ordering is launched automatically without a user operation and processing of the data exchanged with the reader writer is executed. Accordingly a predetermined function is realized between the mobile phone and the reader writer . For example the user goes to a store which is the ordering location at which the reader writer is located to obtain an article and the near field communication is used to perform authentication of the fact that the mobile phone was used to make the order. Also after authentication the mobile phone can use the launched application to perform payment processing for the ordered item. Thus by launching the application designated in advance during ordering it is possible to execute a predetermined function with the mobile phone and the reader writer even if the application has not been launched in advance.

A control unit is a programmable processor such as a CPU or an MPU that by executing a program stored in non volatile memory controls the functional blocks of the mobile phone and realizes the function of the mobile phone. A RAM is memory used mainly as a work area for the control unit and a temporary buffer region for data. An OS Operating System and programs such as an application are expanded to the RAM and executed by the control unit . The application launches and ends according to instructions from the OS and performs processing for realizing a predetermined function by accessing data received by an NFC communication unit and the like via various APIs Application Programming Interfaces provided by the OS. Similarly the application can use the various APIs provided by the OS to send data via the NFC communication unit and write data in a storage unit . The control unit causes the application for payment to be executed and realizes the payment processing with the reader writer for example. When the payment processing by means of the application for payment ends the control unit may perform control so that another application for displaying a balance or managing a household account is launched. An internal bus is a bus for connecting the processing blocks in the mobile phone to one another.

An image capturing unit is a processing block that includes an optical lens a CMOS sensor a digital image processing unit and the like and acquires a captured image by converting an analog signal input via the optical lens into digital data. The captured image acquired by the image capturing unit is temporarily stored in the RAM and is processed based on control performed by the control unit . For example this processing includes being stored in a storage medium by the storage unit being sent to an external device by a wireless communication unit and the like. Also the image capturing unit includes a lens control unit as well and performs control of zooming focusing diaphragm adjustment and the like based on instructions from the control unit .

A display unit is constituted by a liquid crystal panel an organic EL panel or the like and performs display of an operation screen a captured image or the like based on instructions from the control unit . According to instructions from the control unit the display unit displays information regarding an ordering service the information having been received from the server via the wireless communication unit which will be described later. An operation unit is constituted by buttons a numeric pad a touch panel a remote control or the like and receives operation instructions from a user. The operation unit receives user instructions with respect to information regarding the ordering service displayed by the display unit . The operation information input from the operation unit is sent to the control unit and the control unit sends predetermined information to the server via the wireless communication unit based on the operation information.

The storage unit is constituted by a high capacity storage medium and writes and reads out various kinds of data in and from the storage medium based on instructions from the control unit . The storage medium is constituted by a built in flash memory a built in hard disk a removable memory card or the like.

The wireless communication unit is a processing block that includes processing hardware and the like for performing communication by means of a wireless LAN or the like and performs wireless LAN communication using an IEEE 802.11n a g b method for example. The wireless communication unit is connected to an external access point by a wireless LAN and communicates with the server via the access point.

The NFC communication unit includes hardware for performing communication with a short communication distance such as NFC. The NFC communication unit is constituted by an antenna or the like and has communication functions for various modes namely an NFC reader writer mode initiator and target for Peer mode and a card emulation mode. In the case of the NFC reader writer mode or the initiator for the Peer mode near field communication is performed without contact between the antenna and NFC tags or the like by outputting an RF signal from the antenna and data is written and read out in and from the memory built into the NFC tags. In the case of the target for the NFC Peer mode or the card emulation mode a modulated RF signal is received from the antenna and stored in the RAM . The NFC communication unit sends the response signal by performing load modulation on the received RF signal. The NFC communication unit sends and receives data according to a format described by a later described NDEF NFC Data Exchange Format when performing near field communication with the reader writer . The NFC communication unit receives commands such as requests for processing IDs and information such as the later described application launch information from the reader writer and sends the received data to the control unit .

Next the functional configuration of the reader writer according to the present embodiment will be described with reference to . A control unit is a programmable processor such as a CPU or an MPU that by executing a program stored on a non volatile memory controls the functional blocks of the reader writer and realizes the function of the reader writer. A RAM is memory used mainly as a work area for the control unit and a temporary buffer region for data.

A display unit is constituted by a liquid crystal panel an organic EL panel or the like and performs display of an operation screen or the like based on instructions from the control unit . The state of connection to the mobile phone by means of an NFC communication unit or authentication results may be displayed as needed. An internal bus is a bus for connecting the processing blocks in the reader writer to one another. An operation unit is constituted by buttons a numeric pad a touch panel a remote control or the like and receives operation instructions from a user. The operation information input from the operation unit is sent to the control unit and the control unit executes control of the processing blocks based on the operation information.

The storage unit is constituted by a high capacity storage medium and writes and reads out various kinds of data in and from the storage medium based on instructions from the control unit . The storage medium is constituted by a built in flash memory a built in hard disk a removable memory card or the like. Various types of data received from the server via the communication unit are stored in the storage unit according to instructions from the control unit and are read out as needed according to instructions from the control unit .

The communication unit includes hardware and the like for performing communication by means of a wireless LAN and a wired LAN. With the wireless LAN the communication unit is a processing block using an IEEE 802.11n a g b method for example. The communication unit is connected to an external access point by a wireless LAN and performs wireless LAN communication with another wireless communication device via the access point. Also with the wired LAN the communication unit performs communication via an external router or a switching hub. The communication unit receives data from the server according to instructions from the control unit and sends the received data to the control unit .

The NFC communication unit is constituted by an antenna and a resonance circuit and has communication functions for the above described modes. In addition to sending information such as the later described application launch information to the mobile phone the NFC communication unit sends commands such as a processing ID request.

Furthermore the functional configuration of the server according to the present embodiment will be described with reference to . A control unit is a programmable processor such as a CPU or an MPU that by executing a program stored on a non volatile memory controls the functional blocks of the server and realizes the function of the server. A RAM is memory used mainly as a work area for the control unit and a temporary buffer region for data.

The display unit is constituted by a liquid crystal panel or the like performs display of an operation screen or the like based on instructions from the control unit although this is not necessary and may send display data to another device via the communication unit . An internal bus is a bus for connecting the processing blocks in the server to one another. The operation unit receives an operation instruction from the user although this is not necessary and the control unit may receive remote operation via the communication unit .

The storage unit is constituted by a high capacity storage medium and writes and reads out various kinds of data in and from the storage medium based on instructions from the control unit . The storage medium is constituted by a built in flash memory a built in hard disk a removable memory card or the like. Various types of data received from the mobile phone via the communication unit are stored in the storage unit according to instructions from the control unit and are read out as needed according to instructions from the control unit .

The communication unit may have a configuration similar to that of the communication unit of the above described reader writer . The communication unit receives data from the mobile phone according to instructions from the control unit and sends the received data to the control unit . Also data received from the mobile phone is sent to the reader writer according to instructions from the control unit .

The mobile phones A and B have target functions which are for receiving commands in the NFC card emulation mode or the Peer mode. With the above described mode of the reader writer when notification of data is performed based on the initiator function which is for sending commands the mobile phone receives the data and launches the corresponding application.

Next an example of a configuration of communication data including device identification information according to the present embodiment will be described with reference to . The communication data defined by the format is sent to the server via the wireless communication unit by the mobile phone and is subsequently sent from the server to the reader writer . From the received data the server reads out NFCID process content and launch information as will be described later and executes server processing. Also the server uses the present format to store the processing ID process content NFCID and launch information which are sent to the reader writer .

The format of the communication data is such that it is constituted by a length a command a destination an NFCID a device identification ID a processing ID a manufacturer ID process content and a Payload . The length indicates the overall length of the communication data. The command defines the command type of the communication data. The destination stores address information indicating the communication apparatus to which the communication data is addressed. The NFCID is further constituted by the device identification ID the processing ID and the manufacturer ID . The device identification ID indicates ID information for identifying the mobile phone and it may be a randomly generated number and it may be unique identification information. The processing ID is identification information for identifying a process. The manufacturer ID indicates a unique identifier for identifying the manufacturer of the mobile phone . The process content is the processing designated by the user in the application executed by the mobile phone and is order processing for example. In the present embodiment processing relating to the process content is executed in the reader writer . The payload is used for storing data to be sent to a sending destination and stores application launch information which will be described later with reference to . Note that the format of the communication data is not limited to the above description and another format may be used as long as the necessary information is included.

An example of a configuration of the application launch information according to the present embodiment will be described below with reference to . The application launch information is stored in the payload of the communication format shown in above and is sent by the mobile phone to the reader writer via the server . The reader writer reads out the application launch information by referencing the payload and sends it to the mobile phone via the NFC communication unit .

The application launch information is defined using the format of the data received and sent using NFC. The data received and sent using NFC is defined as having an NDEF NFC Data Exchange Format by the NFC forum. The first two bytes of an NDEF file are defined as an NLEN field and indicate the NDEF message length following the NLEN field.

The NDEF message is constituted by multiple NDEF records as with NDEF records to for example. The NDEF records are each further constituted by an NDEF header type and payload. Note that E104h indicates an example of an initial address in which the NDEF records are stored. The NDEF header stores data such as a flag indicating the beginning or end of a message payload length and the like. For example as shown in the NDEF record the type of the NDEF record stores an ASCII character string OS1.com LaunchApp and thereby the corresponding OS information is designated. The payload of the NDEF record stores an ASCII character string CameraApp and thereby the name of the application that is to be launched is designated. An ASCII character string indicating an application package OS2.com pkg designates and defines the OS in the type of the NDEF record . The payload of the NDEF record stores the ASCII character string CameraApp Ver3 and indicates version information along with the name of the application to be launched. With the NDEF record and the NDEF record it is indicated that application version information different from that of the NDEF record is stored in the payloads of the NDEF records.

Note that the types and payloads of the NDEF records described in the present embodiment are examples and the present invention is not limited thereto. For example information regarding the service access point SAP defined by the NFC forum may be included in the type and payload of the NDEF record. See the Logical Link Control Protocol Technical Specification for more information about the SAP. Also the launch information is expressed using an RTD format defined in the NFC Record Type Definition RTD Technical Specification defined by the NFC forum but the present invention is not limited thereto. Information indicating a detailed application path may be furthermore included in the payload of the NDEF record. For example the RTD record type is defined as android.com pkg and the schema to the application that is to be launched may be defined as any record indicating the application path.

An example of wireless communication processing for the mobile phone according to the present embodiment will be described below with reference to . The wireless communication is communication that is performed first among multiple communication processes and is for example communication for accessing the server on the Internet and ordering an article. The processing corresponding to the present flowchart is realized by a program stored in the storage unit by the control unit being expanded to the RAM and executed in response to an instruction given by the user to the mobile phone to execute the application.

In step S the control unit determines whether or not a command wireless processing command for which communication using the wireless communication unit serving as a first communication unit is needed has been received. Here the wireless processing command is input according to an ordering operation or the like performed via the operation unit by the user with respect to the application. If a command for which communication with the server is necessary has been input the control unit determines that the wireless processing command has been received.

If the wireless processing command has been received the control unit moves to the processing of step S and if the wireless processing command has not been received the control unit returns to the processing of step S and waits again for input of the wireless processing command.

In step S the control unit determines whether or not the wireless processing command received in step S is a command for which processing here authentication processing is used as an example using another communication unit NFC communication unit serving as a second communication unit is necessary. For example this determination can be performed by referencing a pre set table in which wireless processing commands are associated with whether or not authentication by means of NFC is needed or by analyzing the content of the wireless processing command. For example if the application provides a service for receiving at a store an article ordered on a specific server on the Internet the command for performing ordering of the article with respect to the server is a wireless processing command for which authentication using the NFC communication unit at a store is necessary. If it is determined that the wireless processing command is a command for which authentication by means of the NFC communication unit is necessary the control unit moves to the processing of step S and if it is determined that the wireless processing command is a command for which authentication by means of the NFC communication unit is not necessary the control unit moves to the processing of step S.

In step S the control unit performs the predetermined wireless communication processing and ends the present flowchart. Examples of commands for which authentication using the NFC communication unit is not necessary include commands requesting display data to the server .

In step S the control unit sends data including the NFCID and the process content shown in to the server via the wireless communication unit and moves to the processing of step S. Here information specifying the ordered article the number ordered and the like may be included in the process content .

In step S if the response signal received from the server via the wireless communication unit indicates a normal state the control unit moves to the processing of step S and if the response signal indicates an abnormal state or if the response signal cannot be received within a predetermined amount of time the control unit stops the continuation of processing and ends the processing.

In step S the control unit sends to the server launch information for an application that needs to be launched by the mobile phone at the time of processing using the NFC communication unit which is to be performed at a later time. Thus by sending the NFCID the process content and the launch information for the application that needs to be launched it is possible to automatically launch an application needed for processing that is to be performed using communication by means of the NFC communication unit . The control unit uses the pre set information for the application that is to be launched to generate launch information having the format described with reference to sends the data stored in the payload shown in to the server via the wireless communication unit and moves to the processing of step S.

In step S if the response signal received from the server via the wireless communication unit indicates a normal state the control unit moves to the processing of step S and if the response signal indicates an abnormal state or if the response signal cannot be received within a predetermined amount of time the control unit stops the continuation of processing and ends the processing.

In step S the control unit determines whether or not the processing ID is included in the response signal received in step S. If it is confirmed that the processing ID is included in the received response signal and has an identifier in accordance with a predetermined description format for example the control unit moves to the processing of step S and in other cases the control unit determines that the processing ID was not received and the processing ends.

In step S the control unit stores the NFCID and the processing ID in association with each other in the storage unit and the processing of the present flowchart ends. Note that starting with the processing shown in the specific processing using NFC is realized by the control unit executing an application that runs on the OS. Accordingly the application needs to be running in order to use the NFCID and the processing ID stored in the storage unit in step S. However there is a difference in the amount of time in the period from when the processing of is performed until when the processing using the NFCID and the processing ID or more specifically until when the processing using the NFC communication unit is performed and therefore there is a possibility that the application will end during that period. In view of this in the present embodiment the launch information and the NFCID are sent to the server and are transferred from the server to the reader writer . Then after authentication processing is performed using the NFC communication unit the launch information is acquired from the reader writer and after the application of the type based on the launch information is launched it is possible to continue the processing using the processing ID stored in the storage unit . Hereinafter operations of the server and the reader writer for realizing this kind of processing will be described.

An example of processing for the server according to the present embodiment will be described below with reference to . The series of processes shown in are processes of the server that correspond to the processes of the mobile phone described with reference to . That is to say they are a series of processes of the server during communication that is first performed by the mobile phone for realizing a service provided by the application. The processing corresponding to the present flowchart is realized by a program stored in the storage unit being expanded to the RAM and executed by the control unit when the server has been launched. The present processing is started when for example the control unit has launched the server application and is waiting for reception of the data sent from the mobile phone .

In step S the control unit determines whether or not the process content and the NFCID sent from the mobile phone have been received. The control unit references the process content and the NFCID from the received data based on the format shown in and if they have been written in accordance with the predetermined format the control unit determines that the process content and the NFCID have been received and moves to the processing of step S. If it is determined that the process content and the NFCID have not been received the control unit continues the processing of step S. In step S the control unit sends a response to the effect that the above described process content and NFCID have been received to the mobile phone and moves to the processing of step S.

In step S the control unit determines whether or not the application launch information sent from the mobile phone has been received. The control unit references the launch information based on the format shown in from the received data and if it has been written in accordance with the predetermined format the control unit determines that the launch information has been received and moves to the processing of step S. If it is determined that the application launch information has not been received the control unit continues the processing of step S. In step S the control unit sends a response to the effect that the launch information has been received to the mobile phone and moves to the processing of step S.

In step S the control unit generates the processing ID. The control unit generates an identifiable processing ID in association with the NFCID and process content received in step S and the application launch information received in step S and moves to the processing of step S. The processing ID is an identifier in accordance with the predetermined description format and may be any kind of number as long as the associated data can be uniquely specified and for example it may be a number that sequentially increases by 1 starting from a predetermined value. In step S the control unit sends the processing ID generated in step S to the mobile phone . Thereafter the control unit moves to the processing of step S.

In step S the control unit sends the process content NFCID and application launch information received in steps S and S and the processing ID generated in step S to the reader writer that is appropriate according to the process content. The server may specify the reader writer by for example referencing the process content and reading out a table recorded in advance in the reader writer corresponding to the process content. Upon ending the processing of step S the control unit ends the processing of the present flowchart.

An example of communication processing performed by the reader writer with the server according to the present embodiment will be described below with reference to . The present processing is for enabling sending of the launch information from the reader writer when information such as the launch information sent from the mobile phone to the server has been accumulated in the reader writer and thereafter near field communication is to be performed between the mobile phone and the reader writer . The processing corresponding to the present flowchart is realized by a program stored in the storage unit being expanded to the RAM and executed by the control unit when the power source of the reader writer is on. The present processing is started in a state of waiting for the reception of data sent from the server .

In step S the control unit serving as a reception unit determines whether or not a request to acquire the process content NFCID application launch information and processing ID has been received from the server via the communication unit . If it is determined that the process content NFCID application launch information and processing ID have been received in the aforementioned predetermined format the control unit moves to the processing of step S. On the other hand if it is determined that the above data has not been received the control unit continues the processing of step S.

In step S the control unit stores the process content NFCID application launch information and processing ID that were received in step S in the storage unit . The stored data is read out when communication with the mobile phone is performed using later described near field communication and the stored data is used for authentication of the mobile phone and confirmation of the processing ID of the mobile phone. Thereafter the control unit ends the processing of the present flowchart.

Next an example of processing performed by the reader writer with the mobile phone using near field communication according to the present embodiment will be described with reference to . The present near field communication is second communication performed by the mobile phone for realizing the service provided by the application of the present embodiment. According to the processing of the present flowchart the reader writer can launch the application that is to be launched with respect to the appropriate mobile phone that was authenticated and execute a desired function with the mobile phone . Similarly to the series of processes of the reader writer described with reference to the processing of the present flowchart is executed by the control unit executing a program expanded to the RAM . Also the processing of the present flowchart starts when the user after having ordered using the mobile phone brings the mobile phone near to the reader writer . The processing may be performed in parallel with the flowchart shown in although this is based on the premise that the application launch information and the like that was described with reference to has been stored in the storage unit of the reader writer .

In step S the control unit serving as a determination unit sends a predetermined device detection signal determined for use in NFC in order to detect the mobile phone . In step S the control unit determines whether or not the mobile phone that has the NFC function and exists within a communicable range has been detected by the NFC communication unit . The detection of the mobile phone is determined according to whether or not the response from the mobile phone to the predetermined device detection signal has been received. If the response to the device detection command from the mobile phone has been received the control unit moves to the processing of step S. If it is determined that the mobile phone has not been detected the processing returns to step S and detection of a device having the NFC function is continued.

In step S the control unit determines whether or not the mobile phone is a known device. That is to say using the processing of the present step and step S it is possible to specify the mobile phone that is to execute the predetermined function with the reader writer . The determination of whether or not the mobile phone is a known device is determined based on whether or not the NFCID is known. If an NFCID that matches the NFCID of the mobile phone has been stored in the storage unit the control unit determines that the NFCID of the mobile phone is a known ID and moves to the processing of step S. If the NFCID of the mobile phone is not a known ID the control unit returns to the processing of step S. In step S the control unit performs predetermined device authentication processing determined by the mobile phone and NFC via the NFC communication unit and moves to the processing of step S.

In step S among the information received from the server and accumulated in the storage unit the control unit serving as a sending unit sends the launch information associated with the NFCID of the authenticated mobile phone to the mobile phone via the NFC communication unit . The mobile phone can launch the application by receiving the launch information and the remaining data that is exchanged with the reader writer can be processed by the application. Thereafter the control unit moves to the processing of step S.

In step S if the response signal received from the mobile phone via the NFC communication unit is normal the control unit moves to the processing of step S. On the other hand if the response signal is abnormal or if the response signal cannot be received within the predetermined amount of time continuation of the processing is stopped and the processing ends.

In step S the control unit sends a signal requesting the processing ID to the mobile phone via the NFC communication unit and moves to the processing of step S. The application launched on the mobile phone responds to the request by reading out the processing ID from the storage unit .

In step S if the received processing ID and the processing ID stored in the storage unit match the control unit moves to the processing of step S. If the processing ID cannot be received from the mobile phone in the predetermined amount of time or if the received processing ID does not match the processing ID stored in the storage unit the control unit ends the processing of the present flowchart.

In step S the control unit serving as an execution unit executes the process content corresponding to the processing ID while communicating with the mobile phone as needed. Here payment processing with respect to the order written in the process content and delivery processing for the ordered article are executed and the processing in the present flowchart ends in step S.

An example of processing using near field communication performed by the mobile phone with the reader writer according to the present embodiment will be described below with reference to . Note that similarly to the series of processes for the mobile phone shown in the processing corresponding to the present flowchart is executed by the control unit by expanding a program stored in the storage unit to the RAM .

In step S the control unit determines whether or not the device detection signal transmitted periodically from the reader writer has been received. If the device detection signal has been received the control unit moves to the processing of step S. If the device detection signal has not been received the control unit continues the reception processing in step S. In step S the control unit sends a response to the device detection signal to the reader writer via the NFC communication unit and moves to the processing of step S. In step S the control unit performs predetermined device authentication processing determined by the reader writer and NFC via the NFC communication unit and specifies that the reader writer is the reader writer with which subsequent data can be exchanged.

Next in step S the control unit determines whether or not the application launch information has been received via the NFC communication unit . The control unit references the application launch information from the NDEF format data received via the NFC communication unit and reads out the data needed to launch the application such as the name of the application that is to be executed the application package version and the like. The control unit may determine whether or not the launch information written in the record is a script that can launch the application. If it is determined that normal launch information has been received the control unit moves to the processing of step S. If the application launch information is not received within a predetermined amount of time or if the received launch information cannot be executed the control unit ends the processing of the present flowchart. For example if an OS that is different from the OS of the device is written as the launch information it is determined that the launch information cannot be executed.

In step S the control unit responds to the application launch information received from the reader writer via the NFC communication unit and moves to the processing of step S. Furthermore in step S the control unit launches the application in accordance with the application launch information received in step S and upon completing the launch of the application moves to the processing of step S. The control unit executes the processing of the subsequent steps by executing the application. Accordingly the specific processing with respect to the data managed by the application such as the NDEF data sent and received via the NFC communication unit for the processing ID is possible.

In step S the control unit determines whether or not a request to send the processing ID has been received from the reader writer . If a signal requesting the processing ID received via the NFC communication unit is received by the reader writer the control unit moves to the processing of step S. If the request for the processing ID is not received within a predetermined amount of time the control unit ends the processing for the present flowchart. In step S the control unit reads out the processing ID stored in the storage unit by executing the application and sends the read out processing ID to the reader writer via the NFC communication unit . The processing of the present flowchart moves from step S to step S.

In step S the control unit executes predetermined control such as payment processing by executing the launched application and when the predetermined control ends the processing of the present flowchart ends. The control unit performs data exchange with the reader writer via an NFC communication unit as needed during execution of the application.

By launching the appropriate application of the mobile phone at an appropriate timing using the processing above it is possible to realize functions needed between the mobile phone and the reader writer via near field communication. In particular the desired function is realized by launching the predetermined application also in the case where the application is closed when near the reader writer .

Note that the present embodiment has been described as an embodiment in which the server is used but it is possible to allow the processing of the server and the reader writer to be performed by the same device so that processing is executed directly between the mobile phone and the reader writer without using the server . Also in the present embodiment the mobile phone may be the NFC reader writer or the Peer mode initiator and perform communication by periodically polling the reader writer . Also the mobile phone the reader writer and the server according to the present invention can also be realized using a system constituted by multiple apparatuses.

According to the present embodiment by performing notification of the application launch method in advance from the mobile phone to the reader writer by means of wireless communication it is possible to launch and execute the application when NFC communication is performed.

As described above according to the present invention it is possible to launch and execute an appropriate application for realizing a function using multiple types of communication methods.

Embodiments of the present invention can also be realized by a computer of a system or apparatus that reads out and executes computer executable instructions e.g. one or more programs recorded on a storage medium which may also be referred to more fully as a non transitory computer readable storage medium to perform the functions of one or more of the above described embodiments and or that includes one or more circuits e.g. application specific integrated circuit ASIC for performing the functions of one or more of the above described embodiments and by a method performed by the computer of the system or apparatus by for example reading out and executing the computer executable instructions from the storage medium to perform the functions of one or more of the above described embodiments and or controlling the one or more circuits to perform the functions of one or more of the above described embodiments. The computer may comprise one or more processors e.g. central processing unit CPU micro processing unit MPU and may include a network of separate computers or separate processors to read out and execute the computer executable instructions. The computer executable instructions may be provided to the computer for example from a network or the storage medium. The storage medium may include for example one or more of a hard disk a random access memory RAM a read only memory ROM a storage of distributed computing systems an optical disk such as a compact disc CD digital versatile disc DVD or Blu ray Disc BD a flash memory device a memory card and the like.

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.

This application claims the benefit of Japanese Patent Application No. 2014 029964 filed Feb. 19 2014 which is hereby incorporated by reference herein in its entirety.

