---

title: System and method for responding to aggressive behavior associated with wireless devices
abstract: An embodiment of the invention describes a wireless device comprising a Subscriber Identity Module (SIM) further comprising a memory for storing program code for performing a plurality of operations, and a processor for processing the program code to execute the plurality of operations, the operations including receiving over-the-air instructions via a wireless network from a control center to create a rules set in the SIM, wherein the rules set defines an acceptable behavior of the wireless device, monitoring requests from a wireless modem of the wireless device for access files stored in the SIM, detecting an aggressive behavior of the wireless device based on the rules set, and blocking the wireless modem from generating traffic in the wireless network.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09100851&OS=09100851&RS=09100851
owner: Jasper Technologies, Inc.
number: 09100851
owner_city: Santa Clara
owner_country: US
publication_date: 20150123
---
The present application is a continuation of U.S. patent application Ser. No. 14 320 319 filed on Jun. 30 2014 which is a continuation of U.S. patent application Ser. No. 14 189 847 filed Feb. 25 2014 and issued as U.S. Pat. No. 8 767 630 on Jun. 26 2014 which is a continuation of U.S. patent application Ser. No. 13 948 916 filed Jul. 23 2013 which claims the benefit of priority for prior U.S. Provisional Patent Application No. 61 746 468 filed on Dec. 27 2012. U.S. patent application Ser. No. 13 948 916 filed Jul. 23 2013 is a continuation in part of U.S. patent application Ser. No. 13 766 622 filed on Feb. 13 2013 and issued as U.S. Pat. No. 8 565 101 on Oct. 22 2013 which is a continuation of U.S. patent application Ser. No. 12 387 962 filed on May 7 2009 and issued as U.S. Pat. No. 8 391 161 on Mar. 5 2013. U.S. patent application Ser. No. 13 948 916 is also a continuation in part of U.S. patent application Ser. No. 13 544 497 filed on Jul. 9 2012 which is the non provisional filing of 61 505 951 filed Jul. 8 2011. U.S. patent application Ser. No. 13 948 916 is a continuation in part of U.S. patent application Ser. No. 13 670 191 filed on Nov. 6 2012 issued as U.S. Pat. No. 8 531 972 on Sep. 10 2013 which is a continuation of U.S. patent application Ser. No. 12 652 694 filed on Jan. 5 2010 issued as U.S. Pat. No. 8 325 614 on Dec. 4 2012.

Embodiments of the invention relate to services provided to consumers and operators of wireless networks.

The deployment of wireless networks is a very expensive proposition. There is a direct correlation between economics and network planning. One cannot have wireless networks of infinite capacity and bandwidth. Wireless networks are designed for the pre determined capacity and performance depending upon many factors such as geography economics demography etc. All wireless networks have planned redundant or idle capacity in advance to counter any bursts or unprecedented traffic. This planning allows the operator to meet sudden demand without impacting the user experience. Alongside many network nodes can be running licensed software which is directly proportional to planned network capacity and performance. In a nutshell wireless network resources are planned based upon expected device behavior patterns.

If a wireless network observes step changes in utilization of network nodes by a handful of rogue or aggressive devices negative network performance may manifest itself in various forms such as service degradation performance impact network nodes running over planned capacity service outage etc. An example of such a rogue device is an aggressive mobile device. A mobile device shows aggressive behaviors when it is constantly trying to connect to a wireless network even though its service requests are repeatedly denied by the wireless network. A wireless network can deny or may be unable to cater to the service requests due to any number of valid or invalid reasons. For example the wireless network may be under maintenance the user of the mobile device has not paid the bill certain network nodes in the wireless network are overwhelmed with service requests the user has not subscribed for a particular service that he is trying to access etc.

Instead of looking into the reasons for service denial an aggressive mobile device may act unintelligently by perpetually retrying to connect. Such device behavior consumes excessive power in the mobile device can cause an excessive signaling load on the wireless network degrade the capacity and performance of the wireless network and cause service outages. Aggressive behaviors can trigger a chain reaction among the network nodes in wireless networks. As a result certain network services may be degraded or even fail. Restoring the network services is a challenging and daunting task.

Aggressive behavior may be caused by any mobile device e.g. smartphone Machine to Machine M2M device etc. including any hardware software firmware modules in the mobile device e.g. a wireless modem application and modem modules driver script. For example an M2M device may generally be considered a black box which may be programmed once to run forever and does not require user intervention for its operation. It has been observed that a certain portion of M2M devices are implemented with a very aggressive service acquisition retry mechanism which may result in network abusive behavior. With continuous repetitive attempts to acquire specific service these devices are occupying and wasting a large portion of network resources of the serving networks and the backend infrastructure.

In the following description numerous specific details are set forth. However it is understood that embodiments of the invention may be practiced without these specific details. In other instances well known circuits structures and techniques have not been shown in detail in order not to obscure the understanding of this description. It will be appreciated however by one skilled in the art that the invention may be practiced without such specific details. Those of ordinary skill in the art with the included descriptions will be able to implement appropriate functionality without undue experimentation.

The system and method described herein provide an immediate global solution for the aggressive behavior problems caused by mobile wireless devices. In one embodiment a cloud based control center CC utilizes software agents strategically placed within a Subscriber Identity Module SIM to monitor and or control aggressive behavior of a mobile wireless device. In an alternative embodiment software agents may be strategically placed at Signal Transfer Points STP to monitor and or control aggressive behavior of mobile devices. An example of an STP includes a Cisco IP Transfer Point ITP . The Cisco IP Transfer Point ITP is a product for transporting Signaling System 7 SS7 traffic over IP SS7oIP networks. The software agent at an STP monitors the SS7 traffic on a per device basis based on for example device International Mobile Subscriber Identity IMSI number. In yet another embodiment the aggressive behavior of mobile devices can be detected and managed by the control center e.g. the control center of and which maintains 24 7 running records of device behavior in log files.

In either of the first two embodiments the SIM software agent or the STP software agent collectively referred to as a software agent reports aggressive behavior to the cloud based control center server.

In one embodiment the software agent is able to compare known signature behavior of a mobile device to current data traffic patterns per IMSI to determine if the mobile device is acting aggressively. The signature behavior or patterns may be developed using a fully automated self certification process that is tailored to each type category of a wide range of mobile devices including smartphones M2M devices etc. . The known device signatures are then compared to current data traffic patterns per IMSI utilizing a sliding window concept taking into account the most recent data transmissions and expected future data transmissions.

In one embodiment after the software agent determines that a mobile device may be acting aggressively the software agent communicates with the control center and control center diagnostic processors diagnose and determine a proper course of action to mitigate the effects of the aggressive behavior. The control center then implements a solution by actively controlling various network nodes elements STP Home Location Register HLR GPRS Support Node GGSN RADIUS Short Message Service Center SMSC etc. or the aggressive mobile device itself if needed.

In one embodiment if the control center diagnostic processors determine that the aggressive device must be controlled directly the control center can send over the air OTA instructions to a SIM applet operating on the aggressive device to actively modify the aggressive behavior. Alternatively the control center can send over the air OTA instructions to the STP software agent to actively modify the aggressive behavior transmissions emanating from the aggressive device.

Aggressive behaviors of mobile devices impact at least two broad areas of an operator s network 1 GSM SS7 signaling and 2 IP capacity IP plane. Typically the GSM SS7 signaling impact is due to one or more of the following factors purged or retired SIMs e.g. SIMs removed from the HLR database frequent power cycling of mobile devices or SIMs including M2M devices the SIM is in a location in which it is barred for service chatty devices e.g. smartphone applications request for radio resources asynchronously jail broken devices e.g. a mobile device unlocked without operator s authorization a mobile device that runs uncertified applications etc. and application specific behaviors.

Any of the above factors may cause an excessive number of SAI Send Authentication Information Requests from the Mobile Switching Center MSC to the HLR Location Update LU Triplet Requests and or other types of network traffic. The areas of impact with respect to the GSM SS7 signaling include HLR capacity and licensing STP capacity SS7 cost and other areas of the network system. For example HLR licensing is based on volume of active devices per day. If a mobile device with a purged SIM still tries to attach to the network and consumes capacity of the network node this mobile device will be counted as one active device for the purpose of HLR licensing even though the mobile device cannot function properly with the purged SIM.

With respect to the impact on IP capacity IP plane the cause of such impact may include one or more of the following factors wrong Access Point Name APN Domain Name Server DNS issues APN context resolve APN no traffic e.g. device data does not reach the destination server due to IP routing issues in the Internet frequent tearing down of a session at the device level e.g. miscalculated device behavior to save battery life or medical devices that try to conserve radio capacity GGSN licensed for a given number of active sessions etc. frequent tearing down of accounting record by GGSN or RADIUS. The areas of impact with respect to the IP capacity IP plane include an excessive number of allowed Packet Data Protocol PDP context an excessive number of denied PDP context backlog in processing of billing records due to capacity constraints and other areas of the network system.

The following description provides the details of a system and method for detecting and resolving aggressive behaviors of mobile devices. The mobile device described herein can be a cellular telephone a smartphone with data transfer and messaging capability a tablet computer a personal digital assistant PDA a video camera a gaming device a global positioning system GPS an e Reader an M2M device i.e. an application specific telemetry device that collects data using sensors and transmits the data to a destination such as a server over a network a hybrid device with a combination of any of the above functionalities or any other wireless mobile devices capable of sending and receiving voice data and or text messages.

In one embodiment base station includes a radio transmitter and receiver for communicating with cellular devices e.g. mobile device and a communications system for communicating with base station controller . Base station controller controls base station and enables communication with operator network . In various embodiments base station controller can control any number of base stations.

Network switching subsystem controls voice network switching maintains a register of cellular device locations and connects operator network with an external voice network such as a public switched telephone network a private voice telephony network or any other appropriate voice telephony network. In one embodiment network switching subsystem includes a mobile switching center MSC a home location register HLR and a visitor location register VLR . MSC controls sets up and releases a voice connection using signaling protocols such as signaling system No. 7 SS7 . In some embodiments MSC additionally tracks the time of a voice connection for the purposes of charging cellular devices decrementing available usage tracking monetary balance monitoring battery status and other purposes. In one embodiment operator network may include any number of MSCs. Each of these MSCs serves cellular devices within a network area which may include one or more base stations and one or more base station controllers. Some of the cellular devices may be registered to use this network area as their home network and some of the other cellular devices may be registered to use other network areas as their home networks. HLR maintains a list of cellular devices whose home network is served by MSC . VLR maintains a list of cellular devices that have roamed into the area served by MSC . When a cellular device leaves its home network e.g. the network area served by MSC the VLR target VLR of the network target network to which the device has roamed communicates with HLR in the home network of the device. When HLR has confirmed to the target VLR that it can allow the device to use the target network the device is added to the target VLR and the MSC in the target network sets up the communication for the roaming cellular device.

SGSN and GGSN are two of the main components in the core data network of operator network . SGSN is responsible for the delivery of data packets from and to the cellular devices within its geographical service area. The tasks of SGSN include packet routing and transfer mobility management attach detach and location management logical link management authentication and charging functions. GGSN controls data communications switching and connects operator network with an external data network such as a local area network a wide area network a wired network a wireless network the Internet a fiber network a storage area network or any other appropriate networks. In some embodiments GGSN is one of the core components in the core data network of operator network . Although not shown in the core data network of operator network may also include various other network switching components. GGSN serves as an interface between operator network and external data networks and translates data packets into the appropriate formats for the devices on each side. In the embodiment shown GGSN also performs policy and charging enforcement and control via the functionalities of Policy and Charging Enforcement Function PCEF Policy and Charging Rules Function PCRF and Online Charging System OCS . PCRF performs policy control and flow based charging control. To that end PCRF authorizes Quality of Service QoS resources and operations e.g. service redirection and other policy based actions. Ultimately PCRF resembles a collection controller in that it collects the subscriber s subscription data and allows PCEF to enforce the policies and the charging. OCS facilitates the online charging process by collecting charging information about network resource usage concurrently with that resource usage. OCS also approves authorization for the network resource usage prior to the actual commencement of that usage. The approval may be limited in terms of data volume or in terms of duration. PCEF performs policy enforcement service data flow detection and flow based charging functionalities. The policy control indicated by the PCRF is enforced by PCEF . To that end the PCEF will permit the service data flow to pass through PCEF only if there is a corresponding active Policy and Charging Control PCC rule and if OCS has authorized credit for the charging key used for online charging. Ultimately PCEF ensures that service is provided with the appropriate QoS and that the subscriber is charged in accordance with the charging rate set for the subscriber.

Messaging gateway provides short messages transit between cellular devices and other communication devices. Messaging gateway can be a Short Message Service Center SMSC a multi media messaging center MMSC or a network node coupled to the SMSC or MMSC. Messaging gateway delivers text messages through operator network to from external networks via standard protocols such as Short Message Peer to Peer Protocol SMPP or Universal Computer Protocol UCP .

In some embodiments operator network is coupled to a hosted service platform via a Core Service Platform CSP network and a number of network nodes. Hosted service platform serves as a service management platform for wireless communication devices such as mobile device . Hosted service platform may include multiple data centers in multiple geographical locations with each data center including multiple server computers. Hosted service platform includes a number of server computers e.g. CSP engines that provide a suite of functions to automate both the sales and support processes towards wireless users. Hosted service platform and CSP network as well as software hosted thereon form a CSP system.

CSP network provides connections between the data centers in the hosted service platform and operator network . In one embodiment CSP network includes a GGSN that implements PCRF and OCS . Depending on the agreements between the operator owner of operator network and operator owner of CSP network both sets of PCRF OCS and PCRF OCS can be active at the same time or at different stages of service deployment. In some alternative embodiments CSP network does not implement PCRF and OCS . Instead host service platform collects subscription data policy and charging information from operator network .

The network nodes between operator network and CSP network are represented in as operator network node network node A and network node B . These network nodes and can include switches routers bridges and other network components. There can be any number of network nodes between operator network and CSP network . In the embodiment shown operator network node communicates with network node A via an integrated connection while it communicates with network node B via three separate connections for voice data and text messaging.

In some embodiments an operator IT system is coupled to operator network via operator network node . Operator IT system receives subscribers data and usage from operator network and provides the functions of Customer Relationship Management CRM care provisioning order entry billing mediation or payments and reporting data warehouse DWH or business intelligence . Operator IT system also provides a user interface such as a desktop interface or a Web interface for a system administrator to monitor and manage these functions. In one embodiment operator IT system hosts CSP operator Web applications . CSP operator Web applications allow an operator to manage its marketing campaign offers equivalently rate plans pricing billing and customer care in an integrated environment.

A CSP system including hosted service platform CSP network and the software hosted thereon interacts with operator network operator IT system and mobile device in real time. Through CSP device application CDA and CSP operator Web applications the CSP system provides or enables the functions of on device application self care diagnostics store front alert management policy control payment handling offer management campaign management analytics reporting engine and data rating.

Although the wireless network system hereinafter is described in the context of 2 3G Global System for Mobile Communication GSM network technology it is understood that other network technologies such as Code Division Multiple Access 2000 CDMA2000 4G Long Term Evolution LTE LTE Advanced etc. can be used to support the techniques described herein. It is also understood that embodiments of the invention can be adapted to work with future versions of the network protocols technologies and standards as these protocols technologies and standards develop.

The wireless network system of may be deployed globally to provide services to multiple network operators. In the embodiment to be described below in connection with a control center may include and perform the functions of the hosted service platform of . The control center is coupled to a global platform provider network which may include and perform the functions of the CSP network . The global platform provider network is further coupled to one or more operator networks operated by one or more network operators also referred to as network carriers .

Referring to a global platform provider operates to provide network services to mobile devices e.g. the mobile device of that may roam from one partner carrier network to another partner carrier network. The global platform provider is allocated with a set of multiple subscriber identifiers such as the international mobile subscriber identifier IMSIs . Although IMSI is used in the following description it is understood that other subscriber identifier types can be used instead of IMSI.

The mobile device having one of these IMSIs programmed in its SIM can avoid or reduce its roaming charges in regions that are operated by network carriers partnered with the global platform provider. The mobile device may incur temporary roaming charges after leaving its home network and entering a partner carrier network e.g. partner carrier network or . However at some point in time when one or more pre determined allocation rules are satisfied the mobile device can be provisioned with a new IMSI that is local to the partner carrier network or an IMSI that is predetermined by the global platform provider to be preferred for that visited country. With this new IMSI the mobile device can transmit and receive wireless packets in the partner carrier network without incurring roaming charges and without having the transmissions routed through its home network.

The determination of whether the mobile device can switch to a local or otherwise preferred IMSI can be made by a control center based on a set of allocation rules. The control center is coupled to a global platform provider network and includes at least a provisioning server and an over the air OTA server . Both the control center and the global platform provider network are operated by the global platform provider.

The control center and the global platform provider network can include multiple servers multiple storage devices and multiple network nodes distributed across multiple geographical areas.

In one embodiment the global platform provider network includes a HLR that includes one or more servers and databases for managing and storing mobile subscriber information. The mobile subscriber information includes the IMSI the MSISDN location information e.g. the identity of the currently serving Visitor Location Register VLR to enable the routing of mobile terminated calls and service subscription and restrictions. The HLR is coupled to an authentication center AuC for performing authentication of a mobile device that requests a network connection.

The HLR is operated and updated by the global platform provider. The HLR communicates with the partner carrier networks via Signaling System 7 SS7 messages through Signal Transfer Points STPs or via Internet Protocol IP messages through Mobility Management Entities MMEs . The SS7 IP messages can be sent via dedicated SS7 IP connections and or SS7 IP inter carrier networks . In some embodiments the HLR shown herein is a logical representation. Physically the HLR can be distributed across multiple geographical areas. In some embodiments the HLR can include distributed segments of the HLRs owned by multiple partner carriers. Thus in these embodiments the HLR can be the sum of multiple HLR segments with each HLR segment owned by a different partner carrier. For example a partner carrier may own and operate an HLR and a segment of the HLR can be read and updated by the global platform provider. The updates performed by the global platform provider can include adding provisioning and removing purging IMSIs and setting and editing subscriber wireless service permissions. The IMSIs that can be added and removed by the global platform provider are within a set of IMSIs that are allocated to the global platform provider. That is to say the HLR stores and manages the IMSIs that belong to the set of IMSIs allocated to the global platform provider. In one embodiment when a new IMSI is provisioned to a subscriber the subscriber may also be changed to a new billing account owner. That is the contractual ownership for the subscriber s wireless service may change with the provision of a new IMSI. After the provision of a new IMSI the subscriber may receive a billing statement from a new partner carrier in addition to or instead of the original carrier.

In the embodiment of each of the partner carrier networks includes one or more MSCs and one or more SGSNs . The MSCs are responsible for routing circuit switched voice calls fax data and short message service SMS . The MSCs can forward outgoing circuit switched signals from a mobile device to a circuit switched network not shown and can forward outgoing short messages to an SMS center SMSC . The circuit switched network and the SMSC then deliver the signals messages to their intended destinations. In addition the MSCs are responsible for requesting the HLR AuC to authenticate a mobile device when the mobile device requests for a network connection.

The SGSNs are responsible for routing data packets. Each SGSN is identified by an Access Point Name APN which can be used in a Domain Name Server DNS query to resolve the IP address of a GGSN e.g. GGSN that serves the SGSN . The APN resolution function is shown as the APN DNS . The GGSN then delivers outgoing data packets from the mobile device to their destination s via a packet switched network e.g. the Internet . Before granting access to the packet switched network the GGSN can use Remote Authentication Dial In User Service RADIUS protocol to provide Authentication Authorization and Accounting AAA management shown as RADIUS . For incoming data packets destined for the mobile device the GGSN resolves the IP address of the destination SGSN using the SGSN s APN in a DNS query shown as the APN DNS . The communication between the SGSN and the GGSN can be provided by a GPRS roaming exchange GRX network for inter carrier connections. In some embodiments the communication between the SGSN and its associated GGSN can be provided by an intra carrier connection.

In the embodiment of the HLR the SMSC the GGSNs and the RADIUS are within the global platform provider network . In alternative embodiments one or more of the HLR the SMSC the GGSNs and the RADIUS can be located within and operated by one or more of partner carrier networks . Regardless of their locations and ownership the control center has access to each of the HLR the SMSC the GGSNs and the RADIUS to manage the information of the mobile subscribers who directly or indirectly e.g. through a partner carrier or through a customer organization having a contract with a partner carrier or with the global platform provider subscribes to the service of the global platform provider.

Having described the network environments in which a mobile device may operate the following discussion describes systems and methods for detecting and handling aggressive behaviors of mobile devices according to embodiments of the invention. In order to acquire specific network services a mobile device interacts with the wireless network infrastructure on various network events. If any of these network events is occurring in excessive numbers the mobile device will be consuming network resources above the amounts dimensioned according to best practices and may bring the network to resource exhaustion and cause widespread service impacts. The network nodes or resources that may be impacted by the aggressive behaviors of a mobile device include but are not limited to STP HLR GGSN RADIUS SMS and GRX as well as the storage and CPU of the network processors in these network nodes.

The types of network events and event frequencies that are considered to be aggressive behaviors may depend on the purpose of the mobile device. Although some behaviors cannot be tolerated no matter what the business purpose of the mobile device is it is noted that mobile devices aimed for different purposes are typically expected to have different behaviors. What may be considered an aggressive behavior for a mobile device with one business purpose e.g. a smartphone may not be aggressive for another mobile device e.g. M2M device . Thus the criteria or rules for detecting aggressive behaviors need to be tailored to the purpose of the mobile device. In order to determine these criteria or rules appropriate for a given type or category of a mobile device the mobile device may need to undergo a self certification process such that its signature behavior can be determined.

Network events triggered by aggressive behaviors may occur either while a service request is made i.e. before the service is rendered or after the service is granted. Those network events that occur while a service request is made include but are not limited to a mobile device which is GSM barred i.e. disallowed to access the GSM service on a network and is trying to perform GSM registration a mobile device which is GPRS barred on a network and is trying to attach to GPRS data service a mobile device is in a barred location of a network and is trying to perform GSM or GPRS registration a mobile device is trying to register to a wireless network against the recommended Public Land Mobile Network PLMN order on its SIM etc.

Those network events that occur after the service is granted include but are not limited to a mobile device that sets up and tears down a voice data session very frequently synchronized activities such as a large number of mobile devices programmed to generate traffic at the same or substantially the same time a mobile device that sends bursts of mobile originated MO SMS messages in a short period of time bursty Internet Protocol IP traffic a mobile device application that tries to steer the traffic against a network preference etc.

To detect the occurrence of the aggressive behavior of a mobile device the mobile device s signature behavior may need to be qualified first. During field operation when the behavior of the mobile device deviates from the signature behavior a trigger is generated to signal the detection of an aggressive behavior. The trigger may be generated by the mobile device by one of the network nodes e.g. STP or by the control center processors servers. In one embodiment the signature behavior of a mobile device may be qualified by an automated self certification process. The self certification process is a process in which a customer runs field scenarios on his mobile device. The customer can be an end user alternatively the customer can be a provider of mobile devices.

To start the self certification process a customer logs onto a web portal provided by the control center. The customer connects his mobile device to the wireless network such that the mobile device s behavior on the wireless network can be tested. The results of the test can be visualized on the web portal.

A system architecture for supporting the certification process according to one embodiment is illustrated in . In this embodiment the control center is communicatively coupled to a test computer over a wireless network operated by a wireless service provider. The control center may also be coupled to the test computer through an Internet connection if one is available. This Internet connection is sometimes referred to as a direct channel between the test computer and the control center . The control center includes a plurality of servers for implementing the various functional modules and illustrated in e.g. by executing program code designed to perform the various functions . The control center also includes a plurality of databases and for storing data related to users and wireless devices.

In operation a prospective wireless data customer visits a web portal hosted by the web server and requests a trial SIM for a mobile device under test through a web based graphical user interface. An example of the mobile device is the mobile device of and . Via the user interface the customer selects a wireless module to be tested enters contact information e.g. user name address etc. account information for specifying a user name and password for a new user account a referral code payment information e.g. credit card data billing information and shipping information. In one embodiment the web portal includes data verification logic to ensure that the data entered in the various data fields is in the correct data format. In addition in one embodiment the web portal includes a connection to a credit card issuer system to verify the credit card payment information entered by the customer. While various different platforms may be used to implement the web portal and other Web based user interface features described herein in one embodiment the web portal is provided by an Apache Tomcat web server running on Linux with software programmed in Java using an Oracle database.

Upon entering all requested information the web portal verifies the transaction and transmits the user and device data to a registration system . In one embodiment the registration system exposes an Application Programming Interface API to the web portal and the web portal communicates data to the registration system using the API. The interactions between the web portal and the registration system may be formatted as a Web services based transaction with user data embedded in one or more Extensible Markup Language XML files using the SOAP protocol. However various other data communication protocols may be employed while still complying with the underlying principles of the invention.

In response to receipt of the user data the registration system establishes a new user account and executes a series of database operations to open new record s in a user database and an accounts database . For example the user s name and contact information may be stored in the user database and a new account may be opened for the user in the accounts database including an account number wireless device profile wireless device identification codes etc. . In one embodiment the various databases shown in are not actually separate databases but rather separate data structures e.g. tables within a single relational database.

In one embodiment a device management system automatically provisions SIMs on behalf of the user within a wireless device database . As part of the provisioning process an identification code for each SIM is automatically associated with data services offered by the wireless service provider. Each SIM includes a unique serial number international unique number of the mobile user e.g. IMSI security authentication and ciphering information temporary information related to the local network a list of services to which the user is provided access and password data. In one embodiment the SIMs are initially provisioned with limited functionality for application development and testing purposes. For example in one embodiment data transmission thresholds are set to limit the amount of data which the SIMs may utilize during the testing period. In addition in one embodiment the SIMs are provisioned to operate only for a specified time period. At the end of the time period the SIMs are automatically disabled and or de provisioned and will no longer be permitted access to the wireless service provider network. In an alternative embodiment the SIMs are provisioned with full functionalities ready for field use.

As part of the provisioning process the SIMs are automatically registered with the HLR of the wireless service provider . An HLR is a central database containing details of each mobile data subscriber authorized to use the wireless network. While the HLR is illustrated in within the domain of the control center in one embodiment the HLR communicates with a central HLR maintained by the wireless service provider. Alternatively in one embodiment the entire HLR is maintained by the service provider and the service provider is provided access to the data stored within the wireless device database during the provisioning process. The underlying principles of the invention are not limited to any particular HLR database configuration.

Following the automatic provisioning of the SIMs and registration of the user the owner operator of the control center sends a wireless development kit to the user containing one or more SIMs with application software referred to as testing and monitoring program code and instructions for testing configuration and certification. After the customer receives the SIMs he can log into the web portal to start the self certification process. In one embodiment the testing and monitoring software may be installed on the test computer alternatively the testing and monitoring software may be installed on the mobile device .

The self certification process includes testing one or more of the following certification scenarios purge the SIM from the HLR place a restriction on the SIM such that all operators are blocked place a restriction on the HLR with respect to which operators are allowed or not allowed for the SIM change the network access mode of the SIM sometimes referred to as NAM the SIM with GSM not allowed change the network access mode of the SIM with GPRS not allowed cause the SIM to establish connection with the wrong APN and cause the mobile device to perform one or more of the following send traffic to a destination server whose IP is blocked by the control center operator s firewall send traffic to a destination server which has either crashed or gone down be unable to identify the destination server IP address using the DNS send the content to a destination server when the server is overloaded or the response is delayed send the content to a wrong server port send a mobile originated MO SMS and expect an acknowledgement in mobile terminated MT SMS which is not working send an MO message to a Short Message Peer to Peer SMPP client s short code when the SMPP client is down switch off when the SMPP client is trying to send a message to the mobile device and send multiple SMS messages in quick session with no back off.

For each of the certification scenarios the web portal provides detailed instructions and progress of the certification for display on the customer s test computer . If there is any setup issues probable causes and remedies are also displayed. After the customer completes all of the necessary tests he will be given a certificate instantly from the web portal e.g. via email or other electronic delivery means . The results of the certification are analyzed to generate the criteria or rules that define the signature behavior of the mobile device . In some embodiments pictorial analytics of the device behavior may be shown on the display of the test computer .

As illustrated in one embodiment of the mobile device is a wireless device with a Universal Serial Bus USB interface for connecting to the USB port of a standard computer system e.g. the test computer of . In an alternative embodiment the mobile device may be an independent stand alone wireless device such as a Windows Mobile device and the testing and monitoring program code may be executed directly on the mobile device e.g. loaded from non volatile to volatile memory and executed by the mobile device s processor . Consequently there is no need for an additional computer system executing the testing and monitoring program code in this alternative embodiment.

Although an USB interface is described herein it is understood that the underlying principles of the invention are not limited to any particular interface type. Other interface types which may be used in lieu of USB include by way of example and not limitation IEEE 1394b Firewire and eSATA. For simplicity the following discussion will refer to a USB device however the wireless device may be any type of wireless device without limitation.

In one embodiment the test computer is a Windows based computer with an Intel Core 2 Duo Core i7 or similar x86 based processor 2 4 GBytes of DDR2 or DDR3 memory and a 250 GByte or larger Serial ATA hard drive. Various other computer configurations may also be used while still complying with the underlying principles of the invention. For example in one embodiment the test computer is a Macintosh computer system such as a Macbook Pro or Mac Pro desktop.

One embodiment of the USB device includes a flash memory for storing testing and monitoring program code . The flash memory may be integrated directly within the USB device or may take the form of a memory card coupled to a memory card slot within the USB device e.g. a Secure Digital card slot . In one embodiment the USB device includes a wireless modem module pre configured to communicate over the wireless network and a SIM interface into which the pre provisioned SIM may be connected for configuring testing and debugging wireless applications. Once inserted into the SIM interface the SIM authorizes the USB device to communicate over the wireless service provider s network according to the provisioning parameters associated with the SIM .

In one embodiment when the USB device is initially inserted into the USB port of the test computer auto installation logic e.g. an automatic installation script is executed and upon authorization by the end user the testing and monitoring program code is automatically installed and executed on the test computer .

In an alternative embodiment the mobile device may be an independent stand alone wireless device such as a Windows Mobile device and the testing and monitoring program code may be executed directly on the mobile device e.g. loaded from non volatile to volatile memory and executed by the mobile device s processor . Consequently there is no need for an additional computer system executing the code in this implementation.

In the embodiment of the USB device is preconfigured with the Access Point Name APN i.e. the network address used to identify a GGSN at the control center . During the testing and configuration process all wireless cellular communication with the control center is routed through the GGSN . In addition to the APN the USB device is also configured with the hostname of the control center diagnostics system which includes one or more test servers used for IP traffic testing.

In one embodiment the provisioning parameters for each SIM include a communication profile specifying the wireless services allocated to the SIM e.g. whether SMS or voice functionality is permitted roaming restrictions etc. . The provisioning parameters also include the rate plan associated with the SIMs including the financial parameters i.e. the price the amount of data permitted under the financial parameters overage rates etc. As previously described in one embodiment each trial SIM is allocated a limited amount of data usage for testing and troubleshooting purposes and is not provided with voice or SMS communication services. In one embodiment even though the SIM is not provisioned for voice service the SIM is provided with GSM functionality in order to be authorized with GSM network prior to connecting to the GPRS network. In another embodiment the SIM may be provisioned with voice data and or SMS communication services.

The testing and monitoring program code can automatically establish a connection with the control center over the wireless cellular network and or a direct channel through the Internet and executes a series of automated tests thereby saving the end user a significant amount of time and effort in the process of developing new wireless applications. Moreover because the SIMs received by the end user are pre provisioned and the USB device may be pre configured by the control center the USB device is capable of establishing a wireless connection with minimal effort on the part of the prospective customer.

In one embodiment the testing and monitoring program code automatically checks for updates prior to executing the various tests and troubleshooting steps. The updates may include patches and additional tests troubleshooting operations. If an update is available the testing and monitoring software automatically installs the update upon confirmation by the end user and then executes the tests.

One embodiment of a computer implemented method for the mobile device to perform the self certification process is illustrated in . At step the testing and monitoring program code tests the provisioning of the USB device with a particular SIM installed. In one embodiment this involves checking the following parameters to determine whether traffic is allowed using the given SIM the SIM s state must be Activation Ready or Activated b the SIM must not have been blocked. An activation ready state allows a SIM to be ready to be activated. An activation ready state will authenticate and authorize with the HLR and AAA server of the provider system but no billing will occur. An activated state allows a SIM or a device with a SIM to be used by a user. In an activated state the SIM will authenticate and authorize on the HLR and AAA server of the provider system. Billing commences immediately on changing to this state.

Assuming that the foregoing conditions are met the USB device with the SIM passes the provisioning test step . A test failure indicates that one or more of the foregoing conditions were not met. For example if the SIM s state is not Activation Ready or Activated or if the SIM has been blocked due to excessive signaling or excessive data usage then the USB device with the SIM will fail the provisioning step . In response one embodiment of the testing and monitoring program code performs troubleshooting operations to fix the problem and or notifies the user of troubleshooting steps to be taken. For example if the SIM s status is not Active or Activation Ready then the testing and monitoring program code may check to ensure that the SIM s status is correctly reflected in the wireless device database .

At step the testing and monitoring program code tests the USB device and the SIM . In one embodiment this test involves determining whether the given USB device and SIM are available on the network based on one of two factors whichever comes first a reporting from the device via direct channel diagnostics or b any detected wireless signaling activity. With respect to a the direct channel comprises the direct connection of the test computer to the diagnostics system through the Internet . In one embodiment the testing and monitoring program code reports its status to the diagnostics system periodically through the direct channel. These reports may include local wireless statistics such as signal strength and data usage. If the USB device is unable to connect wirelessly due to lack of coverage or low signal strength the direct channel provides valuable diagnostic information that would otherwise be unavailable to the diagnostics system.

If a direct channel connection or wireless connection is detected then the USB device and SIM pass the device SIM testing step illustrated in . In one embodiment if neither connection is detected then troubleshooting steps are implemented including instructing the user to confirm that the SIM is inserted properly and determining whether wireless coverage exists at the test location. For example in one embodiment the control center and or the testing and monitoring program code maintains a database of service coverage locations. If the current location of the wireless device is outside of the coverage location then the testing and monitoring program code may notify the user that coverage is not available at the current location. The user s current location may be determined manually e.g. by requesting the current address or zip code for the user or automatically using GPS if the customer s test computer is equipped with GPS capabilities .

The customer may also be asked to verify that the USB device has adequate signal strength e.g. greater than 1 bar or a RSSI of 5 or more verify that the device s antenna is properly connected verify the USB device is configured with the proper frequency bands 850 1900 MHz for the US and 900 1800 MHz for Europe and or verify whether other wireless devices e.g. GSM GPRS cell phones in the proximity are working. Upon verification of one or more of the above variables the testing and monitoring program code may re execute step in to re test the USB device and SIM .

At step the testing and monitoring program code tests the USB device s wireless network connection. In one embodiment this involves checking the HLR to determine whether there has been any recent wireless signaling from the USB device . There are three types of wireless signaling which may be detected a GSM authorization request a Mobile Switching Center MSC Location Update and or a Serving GPRS Support Node SGSN Location Update. The presence of any of these signaling events indicates that the USB device has successfully registered on the GSM voice network and or the GPRS data network. As such if any of these signaling events are detected the testing and monitoring program code indicates that the USB device has passed the wireless network testing step in .

If none of these signaling events are detected then the testing and monitoring program code may initiate one or more troubleshooting operations. For example in one embodiment the control center may transmit an SMS message to the USB device . If the SMS message is successful then GSM service is available but perhaps not the GPRS service . In addition the testing and monitoring program code may check the GSM and GPRS registration using AT commands sent to the wireless modem e.g. to verify GSM registration the AT CREG command should return CREG x 1 or CREG x 5 where x is 0 1 or 2 to verify GPRS registration the AT CGATT command should return CGATT 1 and AT CGREG should return CGREG x 1 or CGREG x 5 where x is 0 1 or 2 . Finally the testing and monitoring program code may perform a soft reset of the USB device or the end user may be prompted to perform a hard reset of the USB device .

During the test step one or more aforementioned certification scenarios may be tested at a subset and the behavior of the USB device is monitored by the testing and monitoring program code . For example the network access mode of the SIM may be changed to GSM barred and the behavior of the USB device is monitored to establish its signature behavior.

Returning to at step the testing and monitoring program code tests the IP Internet connection of the USB device . In one embodiment this test includes two parts 1 Check the GGSN to determine whether the USB device has initiated a Packet Data Protocol PDP session. PDP session context data will be present in the GGSN when the USB device has established an active session. Consequently the existence of a PDP session data indicates that the device was able to resolve the APN to a GGSN and start a PDP session with that GGSN. 2 Run test traffic from the USB device to a control center test server within the diagnostics system and check the GGSN for real time IP traffic statistics. This test fails if the USB device has no upload download bytes at all which suggests a problem with the USB device s IP capabilities or if it has upload bytes but no download bytes which suggests a problem reaching the test server .

Assuming that the above conditions are met the testing and monitoring program code confirms that the USB device has passed the IP Internet test step . If these conditions have not been met the possible reasons include the APN is not configured properly the USB device is unable to open ports or sockets the IP address is incorrect and or the IP data cannot flow bi directionally.

During the test step one or more aforementioned certification scenarios may be tested at a subset and the behavior of the USB device is monitored by the testing and monitoring program code . For example the testing and monitoring program code may cause the USB device to send traffic to a destination server whose IP address is blocked by the control center operator s firewall and the behavior of the USB device is monitored to establish its signature behavior.

In one embodiment the testing and monitoring program code automatically performs the following troubleshooting operations and or instructs the user to manually perform these operations check whether the USB device has been configured with the correct APN verify that all sockets and ports on the USB device are closed and free to use and verify that the destination IP address programmed in the USB device is accurate.

In one embodiment the results of all of the foregoing tests certification and troubleshooting steps are stored within a diagnostics database . If necessary the results may be reviewed by personnel within the control center to provide guidance to the prospective customer when troubleshooting new wireless applications. In one embodiment local environment statistics are transmitted to the diagnostics database such as wireless signal strength of the trial device. The local environment statistics and other test data are then usable for performing diagnostics for the trial device and or aggregated across different trial devices to construct an estimate of the conditions in a given geographical area.

Moreover in one embodiment the testing and monitoring software automatically checks for updates prior to executing the various tests and troubleshooting steps described above. The updates may include patches and additional tests troubleshooting operations. If an update is available the testing and monitoring software automatically installs the update upon confirmation by the end user and then executes the tests.

In one embodiment the signature behavior of a mobile device obtained by the above self certification process can be stored in the mobile device in the control center database and or a network node. The signature behavior can be used to create a rules set defining the thresholds between the acceptable and aggressive behaviors of the mobile device . Based on the rules set the aggressive behavior of the mobile device can be detected blocked or throttled in real time. In one embodiment a software agent is installed in the SIM . The software agent also referred to as agent or SIM applet may be a SIM applet that controls the behavior of the mobile device independent of the device modules and mobile applications. The control can be performed without the mobile device asking the customer to change the application configuration or the control center pushing new firmware and or software onto the mobile device . Via the software agent an operator of the control center is given control to 1 access the critical files in the SIM which are required to operate the modem 2 disable nuke the mobile device or the SIM for a period of time called quasi dead period and 3 enable disable the services provided to the SIM .

In one embodiment the software agent or SIM applet may not have any dependency on SIM Application Toolkit SAT commands commands between a SIM and a modem or modem modules type versions release. In an alternative embodiment the software agent may utilize the SAT to interface with the modem.

Before describing the software agent in further detail it is helpful to explain the basic file structure of the SIMs. A SIM contains both a processor CPU and an operating system. SIMs also have Electrically Erasable Programmable Read Only Memory EEPROM Random Access Memory RAM for controlling program execution and persistent Read Only Memory ROM which stores user authentication data encryption algorithms the operating system and other applications.

A SIM contains a hierarchical file system which resides in the EEPROM. The file structure consists of a Master File MF which is the root of the file system Dedicated Files DFs and Elementary Files EFs . Dedicated Files are subordinate directories under the MF. Subordinate to each of the DFs are supporting EFs which contain the actual data. While all the files have headers only the EFs contain data. The first byte of the header identifies the file type. Headers contain the security and meta information related to the structure and attributes of the file such as length of record. The body of the EFs contains information related to mobile applications. Files can be either administrative or application specific and access to stored data is controlled by the operating system. A SIM card s MF DFs and EFs all contain security attributes. One security attribute the access conditions are constraints upon the execution of commands. These access conditions filter every execution attempt thus ensuring that only those with the proper authorization can access the requested functionality controlled by the DFs or EFs. Access conditions can be thought of as somewhat analogous to the user rights associated with the file directory attributes found in computer operating systems. According to one embodiment of the invention the control center can send over the air OTA instructions and content to change the SIM file contents.

In the embodiment illustrated in the SIM includes a processor and stores SIM files in memory. The software agent described above is shown in this embodiment as a SIM connection manager module SIM CMM residing in the SIM . The SIM CMM is privy to all communication occurring between a modem module and the SIM . In one embodiment the SIM CMM uses or includes running counters and timers which are derived from a configurable rules set. The SIM CMM can intercept the communication between the modem module and the SIM and block the communication if needed. The SIM CMM controls the access to the SIM files e.g. the EFs in the SIM . According to one embodiment the SIM CMM can invalidate and rehabilitate any of the EFs based upon event counters or running timers. When an access condition for invalidating an EF is satisfied the agent sets the respective flag in the file status accordingly. An invalidated file is no longer available to the mobile application or modem module for any function except for the select function and the rehabilitate functions unless the file status of the EF indicates that read and update are allowed . When an access condition for rehabilitating an invalidated EF is satisfied the agent sets the respective flag in the file status accordingly.

In one embodiment the control center sends a rules set file containing one or more rules sets as over the air OTA messages to the SIM . The rules file can be stored in a Rules Set module in the SIM . The rules file specifies among other things the number of successive accesses allowed for a particular SIM file and the length of the disabling period which may be indicated as a timer value or a counter value when an aggressive behavior of the mobile device is detected. The SIM CMM uses counters to count the number of accesses to the SIM files e.g. EF EF EF etc. . If the access to any of these files goes beyond a threshold the SIM CMM will block the access temporarily or turn off features in the EFthat determine access to network service controlled via the modem module .

In one embodiment the rules file includes a white sequence defining a pattern of allowed device behavior and or a black sequence defining a pattern of disallowed device behavior including aggressive behaviors . In one embodiment the rules file defines that upon detection of aggressive behavior the mobile device is placed into a quasi dead state by enabling pin in an EF file or invalidating SIM files . The SIM may be revived by the user control center administrator control center automated processor or network operator by entering a PIN or validating any of the invalidated SIM files .

When the modem module powers up the modem module requests access to the SIM for various purposes. The modem module may not access the SIM until power cycled. However if the SIM has to be disabled temporarily e.g. due to detected aggressive behavior of the mobile device the SIM CMM can perform one of the following actions to prevent the modem module from generating excessive traffic on the wireless network 1 Answer to Reset ATR response the SIM CMM can monitor the RESETs coming from the modem module and ignore the requests for a certain number of times. Ignoring the requests gives a false sense to the modem module that the SIM is dead i.e. non functional . 2 Disable the modem module via EF SIM Service Table EFis one of the SIM files . EFindicates which services are allocated and whether if allocated the service is activated. If a service is not allocated or not activated in the SIM the service should not be selected. The SIM CMM can enable disable the modem module by validating invalidating the entire EFor validate invalidate any of the services to allow block access to the wireless network. 3 Block access to EF EFis one of the SIM files . EFcontains the IMSI. If the modem module cannot read the IMSI in EF it will not try to register on the wireless network and result in an Invalid SIM response.

In an alternative embodiment the SIM CMM is embedded software within the SIM that controls the modem module ensures that a connection is established and maintained enables external network initiated connections and provides remote control options and diagnostic functions e.g. via the control center . The SIM CMM includes platform independent software code and platform adaptation components. In the embodiment of the SIM CMM includes an Application Programming Interface API module a Rules Engine Module and a Rules Set Module .

The API module provides an interface to a mobile application that allows M2M or mobile application developers to rapidly develop and deploy mobile applications without detailed knowledge of wireless networking or AT commands. Ultimately this results in a faster time to market and a robust wireless solution.

The SIM CMM platform independent software code manages all communications utilizing the Rules Engine Module which comprises a generic configurable state machine. The SIM CMM also utilizes the Rules Set Module which comprises rules sets that provide connection logic that defines operation of the modem module . The rules sets may be created revised updated and tested and can be distributed remotely by various means including generation and distribution by the control center . In one embodiment the rules sets are created at least in part based on results of the certification process described above.

The Rules Engine Module including the configurable state machine may be configured by rules set files that direct the modem module in setting up and maintaining connections. Rules sets may be maintained and distributed from the control center . The control center may create rules sets specific to each of the major wireless modules. Rules sets may also be obtained from alternative sources other than the control center . A collection of rules in the rule set drives the state transitions either unconditionally or in response to events. Events are raised based on modem module responses connectivity changes and the action of various timers and counters defined in the rules sets. Outputs specified on state transitions result in AT commands to drive the behavior of the modem module .

The state machine is defined by the rules sets which specify the state transition rules and the actions to be taken in the event of radio network errors. If desired there can be different rules sets for different types of applications e.g. stationary vs. mobile device roaming vs. non roaming device etc. .

In step the mobile device is powered up. In step a modem attempts a GSM registration. In step after the mobile device is GSM registered the device is GSM idle. In step the modem receives a connect request for establishing a data connection and attempts a dial operation establish a PDP context . In step if the data connection is established the mobile device is connected . If the data connection is not established i.e. a failure in step the SIM CMM issues an AT command to the modem requesting the extended release or error code JEER0 JEER1 JEER2 JEER3 JEER4 etc. .

Depending on the type of error code returned by the modem the SIM CMM utilizes the Rules Engine Module including the configurable state machine to determine the proper course of action. For example if the error code is JEER 4 the SIM CMM issues an AT command to the modem to retry step for GSM registration. If the error code is JEER 2 the SIM CMM issues an AT command to the modem to hold in step for a length of time defined by a back off timer before resetting the modem in step . If the error code is JEER 0 the SIM CMM issues an AT command to the modem to try to establish a connection with a different operator in step by starting over with a GSM registration in step . If the error code is JEER 1 the SIM CMM issues an AT command to the modem to hold or service wait in step for a length of time defined by a back off timer and instructs the modem to remain in GSM idle in step before re trying to establish a data connection in step . If the error code is JEER 3 the SIM CMM issues an AT command to the modem to enter a dead state in step .

As shown in the rules set comprises a collection of states rules timers and counters. The rules set is described by a binary file with a proprietary format. Rules sets may be very flexible and can define a wide range of logic to control the operation of the modem. There may be different strategies for managing the connectivity of a modem. For instance one strategy might be to obtain a connection regardless of how long it takes. Another might be to obtain a connection as quickly as possible. Rules sets allow wide variation in the system logic to accommodate a large range of strategies.

States define arbitrary states in the Rules Engine Module that may represent system states. Each state is defined by a name that is referenced by rules. Events are created by modem responses or expiration of timers and counters. Modem responses can be either normal or error responses to AT commands.

Timers are started on events and expire after their timeout value creating timeout events. Timers can be defined to operate with a back off mechanism wherein the timeout period may increase after each expiration. The utilization of timers may prevent aggressive behaviors of the system where operations are retried frequently causing unnecessary network traffic. Another feature of the timers is randomization where part of the timeout value can be a random value. The utilization of randomization may prevent a large number of devices from attempting operations on the network at the same time. In one embodiment a formula for calculating the next expiration value T2 from the current value T1 is T2 C n T1 where C is a constant and n is a multiplier. If n is a positive value the current timeout value is multiplied by n and added to C. If n is a negative number a random value between 0 and the absolute value of n is calculated. Counters count events that occur in the system to allow the rules set logic to take action after a fixed number of events.

Rules define the transition from one state to another. They are triggered by events and create outputs on the transitions. These outputs can be modem commands or starting or cancelling timers or counters. As the logic transitions from state to state within the rules set the outputs drive the modem to perform the actions that affect modem connectivity.

The SIM CMM and the rules set are flexible in terms of how they handle the different radio network error and reject codes. For example an event handled by the rules set may be a situation where the mobile device while involved in or attempting a data session receives a packet data protocol PDP reject cause code from a network and the modem and or SIM CMM continues to receive PDP activation requests from the upper device application layer. The SIM CMM can back off and retry on the same carrier back off then reset the modem module attempt to connect on another carrier or stop attempting.

In another example if the mobile device receives a GPRS attach reject with cause code the SIM CMM in accordance to the rules set will instruct the modem module to attempt to connect on another carrier e.g. a roaming partner .

In one embodiment the SIM CMM can issue an AT command e.g. CEER to the modem module to request for the extended release cause. The modem module in return replies with an error code e.g. JEER0 JEER1 JEER2 JEER3 or JEER4. Each error code indicates a distinct type of error that allows the SIM CMM or the control center to determine the cause of connection problems.

The control center has the ability to push rules set files to mobile devices on the network. The control center may initiate this function by sending an SMS message to the mobile app modem or SIM CMM . Upon receiving the message the SIM CMM establishes an IP connection via the wireless data network retrieves the specified rules set and disconnects. The SIM CMM may utilize a command channel for such communication. The SIM CMM may then restart or reboot using the new rules set. If the SIM CMM encounters any errors in loading the new rules set the SIM CMM may revert to the last known good rules set.

The SIM CMM interfaces with the mobile application by utilizing the API . In one embodiment a call back function is embedded in the mobile application source code. This function can be called by the SIM CMM whenever information is available. All data is delivered asynchronously using this mechanism. Network initiated connection requests are also communicated using the call back function. The mobile application source code must complete the connection operations by calling the SIM CMM in response to these requests. The SIM CMM can be initialized by calling CMM Open . After the initialization the API is utilized to connect disconnect request information or send SMS messages. Calling CMM Close releases the resources used by the API .

The API is a platform independent interface consisting of methods for connecting disconnecting querying parameters and sending SMS messages. The API allows a developer to design and implement a mobile application utilizing existing operating systems such as Windows CE VxWorks MeeGo and QNX etc. In one embodiment the mobile applications written in C or C can utilize the API directly. In another embodiment a wrapper may be created for the mobile applications written in other program language in order to utilize the API . The API sends information to the mobile application through an asynchronous notification mechanism. The API may send the information synchronously as well. The mobile application registers a call back function and the SIM CMM calls this function any time there is information to communicate. This mechanism is used to deliver status messages from the SIM CMM connection status information and mobile terminated SMS messages.

The SIM CMM drives the modem module using all necessary AT commands and responses. In addition the SIM CMM provides and executes logic to handle the various modem module and network error situations in ways that are compatible with the wireless network. The SIM CMM ensures that the mobile device connects to the wireless network when necessary and stays connected. The SIM CMM manages intelligent re tries when there are network related problems selecting alternative networks when needed. The SIM CMM may also enable alternative network selection in regards to international roaming which may be inherently less reliable than a native service. In particular there is the so called stuck SIM problem an inherent weakness of GSM that can allow a mobile device to remain on a network that can provide GSM service but is temporarily unable to provide GPRS service. In this situation the SIM CMM may ensure that an alternative network is selected and significantly improve the reliability of international roaming.

The SIM CMM also provides a valuable diagnostic function. The SIM CMM monitors the quality of wireless communications and makes the information available on demand for diagnostics purposes. The SIM CMM remotely monitors performance of network data connections checks for errors and checks the signal strength at the device.

The SIM CMM provides the ability to remotely cause the mobile device to connect or disconnect. The control center may also be used to initiate a connect or disconnect by sending SMS messages to the SIM CMM . The SIM CMM may use the call back mechanism to notify the mobile application of the request and the mobile application may complete the request by making API calls to CMM Connect or CMM Disconnect.

The SIM CMM maintains log files that record the activity of the SIM CMM . These log files may be uploaded and viewed in the control center . The control center may initiate the request to upload the logs by sending an SMS message to the SIM CMM . Upon receiving the SMS message the SIM CMM may establish an IP connection via the wireless data network upload the log files to the control center and then disconnect.

In the illustrated embodiment the service provider may be AT T and the modem modules include those wireless modules supported on the AT T data network. For example modem modules may include a Cinterion MC55i a Telit GE 865 a Siena Q2426 etc. However the underlying principles of the invention are not limited to any particular service provider.

The above description relates to a SIM based solution to aggressive behaviors. In an alternative embodiment detecting and real time blocking of aggressive behaviors can be performed by a network node e.g. at an SS7 STP gateway. In this alternative embodiment a software agent such as the SIM CMM described above can be implemented in a network node e.g. an STP. An example of an STP gateway is shown in as STP and STP . In one embodiment this approach is based upon the assumption that the signature behavior of the mobile device is known from the self certification process described above. The customer may agree that the signature behavior defines the acceptable behavior under the various scenarios that have been tested in the self certification process. If the signature behavior of the mobile device is not known a default signature behavior is applied to that device.

Alternatively any other process may be used that characterizes and quantifies the aggressive behavior of a mobile device and creates a device signature.

Referring to the network architecture of a Signal Transfer Point STP is a router that relays SS7 messages between signaling end points SEPs and other signaling transfer points STPs . Typical SEPs include service switching points SSPs and service control points SCPs . The STP is connected to adjacent SEPs and adjacent STPs via signaling links. Based on the address fields of the SS7 messages the STP routes the messages to the appropriate outgoing signaling link. SEPs send signaling messages to other SEPs but the messages are normally routed via the SEP s adjacent STPs. An STP s main function is to identify the best path for two SEPs to communicate.

In one embodiment the STP performs real time detection against the device signature by leveraging a sliding window concept which uses past behavior and expected behavior of the mobile device as a criterion for detection. When the detected behavior deviates from the signature behavior by a predetermined amount the STP blocks or throttles traffic from and to the Global Title GT per mobile device. A GT is a unique address used in Signaling Connection Control Part SCCP protocol for routing messages in telecommunication networks. A GT is equivalent to an IP address in the SS7 communication.

In one embodiment the STP includes a software agent which includes a Rules Engine module and a Rules Set module performing the same functions as the Rules Engine module and the Rules Set module of . The Rule Set module in the STP may define the same or similar states and state transitions per mobile device as shown in . In an alternative embodiment the detection of the aggressive behavior may be performed by the mobile devices and or control center . When an aggressive behavior of a mobile device is detected the STP is notified to block or throttle traffic to and from that mobile device.

In yet another embodiment the aggressive behavior of a mobile device can be detected and managed by a control center platform e.g. the control center of and . The control center platform uses the following data sources HLR SS7 logs Radius authentication logs Radius accounting records GGSN CDRs SMSC SMS logs and the SIM Status.

The HLR SS7 logs are sent from HLRs to control center in near real time. The HLR SS7 logs are stored in a control center Vault server a database that tracks the historical statistics on each IMSI. The HLR SS7 logs provides MSC SGSN Locations Location Updates and Cancel Locations for each IMSI including the carrier that it has registered with and Triplet Requests i.e. GSM authentication requests for each IMSI.

The Radius authentication logs are sent from Radius servers to control center in near real time. The Radius authentication logs are stored in a control center Authentication Database. The Radius authentication logs provide GPRS authentication successes and failures for each IMSI.

The Radius accounting records are sent from Radius servers to control center in near real time. The Radius accounting records are stored in a control center Usage Database. The Radius accounting records provide GPRS session information including In Session Status Device IP address SGSN address duration up down bytes.

The GGSN CDRs are sent from GGSN to control center in near real time. The GGSN CDRs are stored in the control center Usage Database. The GGSN CDRs provide the data usage including partial records with the incremental data usage in the middle of a session.

The SMSC SMS logs are sent from SMSC to control center in near real time. The SMSC SMS logs are stored in the control center Usage Database. The SMSC SMS logs provide SMS statistics including the number size frequency and delivery status per IMSI.

The SIM Status is tracked by the control center. The SIM Status is stored in the control center Provisioning Database. The SIM Status provides the SIM activation status suspend status overage limit status.

These data sources are also used by other parts of the control center platform. For example a Network Guard function uses the Radius authentication logs to identify abusive SIMs currently defined as the IMSIs that had more than 60 GPRS authentication failures per hour and automatically blocks them from the network.

The aggressive behaviors may be present when 1 the mobile device performs 100 SAI Send Authentication Information operations in a 24 hour period to HLR front end servers and or 2 the mobile device generates 50 Packet Data G CDR GGSN Call Data Records in a 24 hour period.

With respect to the SAI operations a control center database vault server monitors and tracks the numbers in the log files from all of the HLR servers to which the control center has access. These HLR log files contain 24 7 running records for each unique IMSI subscriber for the following HLR Map protocol operations SAI LU Location Update CL Cancel Location and the like. Therefore if the daily agreed maximum number of authentication requests i.e. SAI messages towards any HLR is exceeded for a subscriber IMSI the subscriber s IMSI will be flagged automatically and reported to the control center administrator. The data in the report contains the following IMSI ICCID number of authentication requests and SIM State e.g. activated purged test ready etc. . The account name can be gleaned by the account number and operator name. This data is made available for the administrator or operator to target and perform an action on either each ICCID which identifies a subscriber or for all offending IMSIs ICCIDs by the account name. Alternatively a control center processor or a rules engine such as CSP engine shown in may automatically implement a rule set based automated process to perform an action on either each ICCID which identifies a subscriber or for all offending IMSIs ICCIDs by the account name.

The actions include but are not limited to the following 1 purge the subscriber profile in the HLR subscriber deleted from HLR via a control center API call to the HLR. 2 Change the subscriber profile to subscribe to GSM only not GPRS i.e. Network Access Mode via a control center API call to the HLR. 3 Change the subscriber profile to be network registration barred which disallows location update via a control center API call to the HLR. 4 Amend the subscriber profile restriction to block certain MNC MCC combinations to disallow roaming via a control center API call to the HLR. 5 Force the subscriber to enter a PIN to enable the SIM when the next location update attempt occurs by an over the air update via SMS thus rendering the SIM useless until a correct PIN is manually entered via a control center API call.

With respect to the Packet Data G CDR the control center database vault server monitors and tracks the number of G CDRs from all of the GGSNs to which the control center has access. The GGSN log files that are sent to the control center contain 24 7 running records for each unique IMSI ICCID. Therefore if the daily agreed maximum quantity of G CDR generation is exceeded for a subscriber IMSI the subscriber s IMSI ICCID will be flagged and automatically reported to the control center administrator. The data in the report contains the following IMSI ICCID quantity of G CDRs and SIM state e.g. activated purged test ready etc. . The account name can be gleaned by the account number and operator name. This data is made available for the administrator or operator to target and perform an action on either each IMSIs ICCID which identifies a subscriber or for all offending IMSIs ICCIDs by the account name. Alternatively a control center processor or a rules engine may automatically implement a rule set based automated process to perform an action on either each ICCID which identifies a subscriber or for all offending IMSIs ICCIDs by the account name. The actions include the five actions described above in connection with the SAI operations.

In one embodiment a thumb rule can be provided to the control center processor or a rules engine and or operators for any kind of network or connection failure at any stage of connection establishment. For example it is acceptable for a mobile application to retry in case of connection or connectivity failure. However the thumb rule may specify the following the initial retries may be attempted no more frequently than once every minute and no more than 4 times in succession additional retries may occur at 15 minutes 30 minutes then every 60 minutes i.e. at 1 initial attempt 2 3 4 5 15 30 60 120 180 minutes etc. and a mobile device cannot have more than four resets in sequence in 24 hours.

The field behaviors of mobile devices vary from one type category of devices to another type category of devices. For example an M2M device category has a different behavior in field use from an emerging device category. Thus the thumb rule is adapted to different categories of mobile devices.

At step the mobile device receives over the air instructions via a wireless network from a control center to create or modify a rules set in the SIM where the rules set defines an acceptable behavior of the mobile device. At step the mobile device more specifically the SIM monitors requests from a wireless modem within the mobile device for access files stored in the SIM. At step an aggressive behavior of the mobile device is detected based on the rules set. At step the wireless modem is blocked from generating traffic in the wireless network.

The operations of the methods of have been described with reference to the exemplary embodiment of . However it should be understood that the operations of the methods of can be performed by embodiments of the invention other than those discussed with reference to and the embodiment discussed with reference to can perform operations different from those discussed with reference to the methods of . While the methods of show a particular order of operations performed by certain embodiments of the invention it should be understood that such order is exemplary e.g. alternative embodiments may perform the operations in a different order combine certain operations overlap certain operations etc. .

In one embodiment if the SIM applet determines that the mobile application or OS is acting aggressively i.e. excessive resetting the SIM applet may block access to SIM files. Thereafter the SIM applet may employ a back off counter and threshold mechanism that counts the number of ATR attempts while continuing to block access to SIM files until the count exceeds a threshold value for example 20 counts. After 20 counts any network related connectivity issue may have been resolved network related connectivity issue is fixed and the ATR can now then be allowed.

At step the modem requests access to multiple SIM files EFxxx. The SIM applet is constantly monitoring the pattern of accesses of SIM files by the modem. For example the modem may access the EFimsi file every 30 seconds. The SIM applet would recognize abnormal or aggressive behavior if the modem attempts to access the EFimsi file beyond this expected pattern of operation.

At the SIM agent determines if the SIM is operational or accessible. If access to any of the SIM files has been previously blocked the SIM agent will determine that the SIM is not operational or accessible and in step the SIM agent will update a counter when the SIM access is denied for example previously determined aggressive ATR operations. For illustrative purposes step may repeated several times when a back off counter is employed in the case of previously determined aggressive ATRs. After a threshold count is exceeded for the back off counter the SIM may now be flagged operational or accessible step .

If the SIM agent determines that the SIM is operational or accessible then the access to the SIM files proceeds and in step the SIM agent filters the specific access event and stores the event access information in step in a static storage for all the events and states. In step if the access to multiple SIM files is in response to an ATR then a counter for the ATR is updated in step . Exceeding a threshold count or count time period for ATRs may trigger the SIM agent to determine aggressive behavior is present and that the SIM should now be flagged non operational or not accessible step then the next access to the SIM files should not proceed to step but diverts to step to implement the back off counter.

Alternatively in step if the access is to an EFloci file then a counter for the EFloci file is updated in step . In step if the access is to an EFimsi file then a counter for the EFimsi file is updated in step . In step if the access is to an EFsst file then a counter for the EFsst file is updated in step . In step if the access is to an EFsms file then a counter for the EFsms file is updated in step . The process is then repeated for access to any of the other EFxxx files.

The operations of the methods of have been described with reference to the exemplary embodiment of . However it should be understood that the operations of the methods of can be performed by embodiments of the invention other than those discussed with reference to and the embodiment discussed with reference to can perform operations different from those discussed with reference to the methods of . While the methods of show a particular order of operations performed by certain embodiments of the invention it should be understood that such order is exemplary e.g. alternative embodiments may perform the operations in a different order combine certain operations overlap certain operations etc. .

This CIP application is based upon and claims the benefit of priority for prior U.S. patent application Ser. No. 12 387 962 now U.S. Pat. No. 8 391 161 filed on Mar. 7 2009 the entire contents of which are incorporated herein by reference. U.S. Pat. No. 8 391 161 discloses a network status display system. In one embodiment the network status display system comprises a processor further comprising diagnostic device software see . In one embodiment the network status display system may be a control center platform comprising hosted service platform and CSP engines see B wherein processor and CSP engines are equivalent.

The control center platform uses the following data sources HLR SS7 logs Radius authentication logs Radius accounting records GGSN CDRs SMSC SMS logs and the SIM Status.

The HLR SS7 logs are sent from HLRs to control center in near real time. The HLR SS7 logs are stored in a control center Vault server a database that tracks the historical statistics on each IMSI. The HLR SS7 logs provides MSC SGSN Locations Location Updates and Cancel Locations for each IMSI including the carrier that it has registered with and Triplet Requests i.e. GSM authentication requests for each IMSI.

The Radius authentication logs are sent from Radius servers to control center in near real time. The Radius authentication logs are stored in a control center Authentication Database. The Radius authentication logs provide GPRS authentication successes and failures for each IMSI.

The Radius accounting records are sent from Radius servers to control center in near real time. The Radius accounting records are stored in a control center Usage Database. The Radius accounting records provide GPRS session information including In Session Status Device IP address SGSN address duration up down bytes.

The GGSN CDRs are sent from GGSN to control center in near real time. The GGSN CDRs are stored in the control center Usage Database. The GGSN CDRs provide the data usage including partial records with the incremental data usage in the middle of a session.

The SMSC SMS logs are sent from SMSC to control center in near real time. The SMSC SMS logs are stored in the control center Usage Database. The SMSC SMS logs provide SMS statistics including the number size frequency and delivery status per IMSI.

The SIM Status is tracked by the control center. The SIM Status is stored in the control center Provisioning Database. The SIM Status provides the SIM activation status suspend status overage limit status.

These data sources are also used by other parts of the control center platform. For example a Network Guard function uses the Radius authentication logs to identify abusive SIMs currently defined as the IMSIs that had more than 60 GPRS authentication failures per hour and automatically blocks them from the network.

The network status display system comprises a display for correlating many types of historic events for a cellular device on a cellular network along a common timeline. Data is retrieved from a cellular device and from the systems that control the cellular network and is displayed in such a way so as to enable the user to identify problems unusual behaviors or inconsistencies. Controls on the network status display system additionally allow communication with the cellular device in order to gain e.g. probe the system by actively controlling systems further diagnostic information.

Network switching subsystem controls voice network switching maintains a register of cellular device locations and connects the GSM network with external voice network . External voice network is a voice telephony network for connecting various voice telephony devices. In various embodiments external voice network comprises a public switched telephone network a private voice telephony network or any other appropriate voice telephony network. By enabling cellular device to connect to external voice network a user of cellular device is able to have a verbal conversation with another user of a device that is directly or indirectly connected to external voice network e.g. a cell phone user a wired telephone user an internet telephone user for example a voice over internet protocol user . For example a user can use cellular device to make a telephone call to someone. Core data network controls data communications switching and connects cellular network with external data network . External data network comprises a data communications network for connection various data communications devices. External data network comprises one or more of the following a local area network a wide area network a wired network a wireless network the Internet a fiber network a storage area network or any other appropriate network enabling communication. By enabling cellular device to connect to external data network a user of cellular device or cellular device itself can interact with other devices or servers or applications running on other devices or servers via external data network . For example cellular device can contact a server to inquire about a transaction e.g. a credit card authorization for a purchase .

Cellular diagnostic device comprises a cellular device configured for diagnostic operations on a wireless network. Cellular diagnostic device communicates with wireless cellular network via base station . In some embodiments base station is the same base station as base station . Base station controller controls base station and enables communication with external voice network via network switching subsystem and with external data network via core data network . In some embodiments base station controller is the same base station controller as base station controller . Cellular diagnostic device is able to run diagnostic operations on a cellular device e.g. cellular device communicating with wireless cellular network and to display diagnostic information. In various embodiments cellular diagnostic device comprises a cellular telephone a mobile smart phone with data transfer capability a mobile data communications device a network interface for a wireless data processing device or any other appropriate mobile communications device.

Diagnostic device communicates with wireless cellular network via external data network and core data network . Diagnostic device is able to run diagnostic operations on a cellular device e.g. cellular device communicating with wireless cellular network and to display diagnostic information. In various embodiments diagnostic device comprises a computer a network enabled data device a network appliance or any other appropriate network enabled device.

In some embodiments GPRS core network implements GPRS core network of . In the example shown GPRS core network comprises serving GPRS support node SGSN gateway GPRS support node GGSN and charging gateway function . SGSN sends data packets to and receives data packets from a cellular device e.g. cellular device of and communicates data with GGSN . SGSN also retrieves information about roaming devices by contacting home location register of the home network of the roaming device via signaling system seven network . GGSN serves as an interface between GPRS core network and an external data network e.g. external data network of . GGSN communicates with SGSN and with the external data network and translates the data packets into the appropriate formats for the devices on each side. In some embodiments there is more than one GGSN in a given GPRS core network each GGSN connecting to the same SGSN. In some embodiments each GGSN connects to the same external data network. In some embodiments a plurality of GGSNs connect to one or more different data networks. Charging gateway function communicates with SGSN and GGSN and tracks the total amount to charge each cellular device connected to GPRS core network . A charging session by a charging gateway function is known as a charging data record CDR . In some embodiments a single data session can be charged as a plurality of sequential CDRs.

In the example shown cellular device comprises radio transmitter radio receiver processor memory subscriber identity module and display . Radio transmitter and radio receiver communicate with a base station e.g. base station of using wireless radio communication. For example radio transmitter and radio receiver communicate according to the GSM standard. In various embodiments radio transmitter and or radio receiver communicate using frequency modulated signals phase modulated signals amplitude modulated signals time division multiplexing signals code division multiplexing signals or signals encoded using any other appropriate communication scheme or protocol. In various embodiments radio transmitter and or radio receiver communicate in the medium frequency band the high frequency band the very high frequency band the ultra high frequency band or any other appropriate frequency band. In various embodiments radio transmitter and or radio receiver communicate voice signals data signals text signals e.g. short message service SMS configuration and or registration signals or any other appropriate kinds of signals. Radio transmitter and radio receiver receive instructions and communicate data with the rest of cellular device via processor . Processor controls cellular device . Processor communicates with radio transmitter and radio receiver as well as with memory subscriber identity module and display . Processor executes a set of instructions to control the device for example instructions in the form of software or code e.g. designated as cellular device software in . In some embodiments cellular device software is stored in digital memory e.g. random access memory read only memory programmable read only memory memory or any other appropriate storage for storing software for processing by a processor . Memory acts as temporary and or long term information storage for processor as it is controlling cellular device . Subscriber identity module SIM comprises a removable module for an identifying number that cellular device uses to identify the user of cellular device to the network. In one embodiment SIM comprises SIM of . In various embodiments SIM stores an international subscriber identity module IMSI number an integrated circuit card identifier ICCID number a serial number or any other appropriate identifying number. Display comprises a display for displaying information to a user. In various embodiments information comprises device status information user interface information diagnostic information network information SMS information or any other appropriate information.

In some embodiments cellular device comprises a cellular diagnostic device e.g. cellular diagnostic device of and cellular device software comprises cellular diagnostic software. In various embodiments cellular diagnostic software comprises software for determining the status of a cellular network e.g. cellular network of software for determining the status of a cellular device e.g. cellular device of software for sending diagnostic messages to a cellular device software for displaying the status of a cellular network software for displaying the status of a cellular device or any other appropriate cellular diagnostic software. In some embodiments cellular device software comprises software for a network status display. In some embodiments display comprises a diagnostic display. In various embodiments a diagnostic display comprises a display for displaying the status of a cellular network a display for displaying the status of a cellular device a display for displaying user interface information for diagnostic software or a display for any other appropriate diagnostic information. In some embodiments display comprises a network status display.

In various embodiments diagnostic device software comprises software for determining the status of a cellular network e.g. cellular network of software for determining the status of a cellular device e.g. cellular device of software for sending diagnostic messages to a cellular device software for displaying the status of a cellular network software for displaying the status of a cellular device or any other appropriate cellular diagnostic software. In some embodiments diagnostic device software comprises software for a network status display. In various embodiments a diagnostic display comprises a display for displaying the status of a cellular network a display for displaying the status of a cellular device a display for displaying user interface information for diagnostic software or a display for any other appropriate diagnostic information. In some embodiments display comprises a network status display.

ICCID comprises the ICCID for the SIM e.g. SIM of associated with the cellular device whose data is displayed in display . Dates comprise the dates over which data is displayed in the data rows. The range of dates over which data is displayed is displayed in zoom display and can be modified by a user by clicking on zoom menu button . In some embodiments the available date ranges comprise 30 days 14 days 7 days 3 days 1 day 12 hours 4 hours 30 minutes and 5 minutes. In various embodiments available date ranges include any other date ranges include date ranges input by the user or include date ranges set in any other appropriate way. In some embodiments the default date range is one day. In some embodiments the user interface also includes zoom in and zoom out buttons. Zoom in and zoom out buttons raise or lower the zoom level to the next appropriate zoom level with a single click by the user. In some embodiments double clicking in a window is associated with a zoom in or zoom out command. The date upon which range of dates is centered is displayed in date display and can be modified by a user by clicking on date menu button . In some embodiments clicking and dragging on the background of display can modify the center of range of dates . In some embodiments range of dates defaults to display the most recently acquired data. The time zone to which range of dates is referred is displayed in time zone display and can be modified by a user by clicking on time zone menu button . In some embodiments the time zone to which range of dates is referred defaults to the current time zone in the physical location of the user. Data displayed in display can be refreshed to the current time by clicking on refresh button .

In the example shown display includes one or more rows of data. The rows of data can include MSC Events data SGSN Events data GSM Authorization Requests data PDP Sessions data SMS Messages data Radius Failures data SIM Status data and Annotations data . A user can modify the set of rows displayed by clicking on show button . Show button brings up a menu of data rows and allows the user to select whether each row should be displayed. MSC Events row displays location updates for any MSCs e.g. MSC of on which the SIM has registered in the currently displayed time range. If the SIM has registered with multiple MSCs during the displayed time range one sub row e.g. sub row or sub row is displayed for each MSC the SIM has registered with. Each MSC Events data sub row displays shaded areas e.g. shaded area corresponding to times when the SIM has been registered with the associated MSC. Each MSC Events data sub row additionally displays icons e.g. icon corresponding to points in time when an unmatched register or disconnect event is found e.g. a register or disconnect event without a disconnect or register event to match it to . SGSN Events row displays location updates for any SGSNs e.g. SGSN of on which the SIM has registered in the currently displayed time range. If the SIM has registered with multiple SGSNs during the displayed time range one sub row e.g. sub row or sub row is displayed for each SGSN the SIM has registered with. Each SGSN Events data sub row displays shaded areas e.g. shaded area corresponding to times when the SIM has been registered with the associated SGSN. Each SGSN Events data sub row may additionally display icons e.g. icon corresponding to points in time when an unmatched register or disconnect event is found e.g. a register or disconnect event without a disconnect or register event to match it to .

GSM Authorization Requests data row displays GSM Authorization requests made during the displayed time range. A GSM Authorization request is a connection request made to an HLR e.g. HLR of . The GSM Authorization Requests data row displays shaded areas e.g. shaded area or colored areas corresponding to times where GSM Authorization requests are made. The shade or color of the shaded or colored area corresponds to the number of GSM Authorization requests made in the displayed time period. In some embodiments a light shade or a green color corresponds to between 1 and 30 requests made in the time period a medium shade or a yellow color corresponds to between 31 and 100 requests made in the time period and a dark shade or a red color corresponds to more than 100 requests made in the time period.

PDP Sessions data row displays PDP sessions established for the SIM within the displayed time range. The PDP Sessions data row displays shaded areas e.g. shaded area corresponding to open PDP sessions for the SIM during the currently displayed time range. The PDP Sessions data row also displays boxes e.g. box overlaid with the shaded areas corresponding to call detail records CDR s e.g. CDR s established by charging gateway function of . If multiple CDR s exist for a single PDP sessions boxes corresponding to the multiple CDR s are drawn adjacent to one another. Open PDP session box corresponds to a currently open PDP session and open CDR session corresponds to its associated open CDR. SMS Messages data row displays SMS e.g. short message service messages sent to or from the SIM within the displayed time range. The SMS Messages data row displays icons e.g. icon or icon corresponding to sent or received SMS messages. In some embodiments an empty or white icon e.g. icon corresponds to a sent SMS message and a filled or blue icon e.g. icon corresponds to a received SMS message. Authentication Failures data row displays failed attempts to establish data sessions during the time range. The Authentication Failures data row displays shaded areas e.g. shaded area or colored areas corresponding to failed attempts to establish data sessions. In some embodiments a light shade or a green color corresponds to between 1 and 10 authentication failures within a given time period a medium shade or a yellow color corresponds to between 10 and 30 authentication failures within a given time period and a dark shade or a red bar corresponds to more than 30 authentication failures within a given time period.

SIM Status data row displays the ability of the SIM to establish a data session within the displayed time range. The SIM Status data row displays shaded areas e.g. shaded area or colored areas corresponding to the ability of the SIM to establish a data session. In some embodiments a light shade or a green color corresponds to the SIM having the ability to establish a data session and a dark shade or a red color corresponds to the SIM not having the ability to establish a data session. Annotations data row displays notes describing event history made at given points in time. The Annotations data row displays icons e.g. icon icon icon or icon corresponding to notes describing event history. In some embodiments a filled or blue icon e.g. icon corresponds to a manual annotation an empty or white icon e.g. icon corresponds to automatically retrieved SIM information a lightly shaded or green icon e.g. icon corresponds to a diagnostic result with no expected connectivity issues and a darkly shaded or red icon e.g. icon corresponds to a diagnostic result with expected connectivity issues. A user can add a manual annotation to Annotations data row by clicking Add button .

A user of the display system can send an SMS message to the cellular device associated with the SIM by clicking Send SMS button . In various embodiments an SMS message can be used for communication with the person possessing the cellular device to test communication with the cellular device to send a diagnostic message to the device or for any other appropriate purpose. A user of the display system can send a cancel location message to the cellular device associated with the SIM by clicking Cancel Location button . The cancel location message causes the cellular device to cancel its current MSC location registration. A user of the display system can start a diagnostic process on the cellular device associated with the SIM by clicking Diagnose button . The diagnostic is an automatic process on the cellular device for determining connectivity problems. In some embodiments the diagnostic process requires additional information from the user of the display system and prompts the user for the required information. The user can request attribute information from the cellular device associated with the SIM by clicking SIM Information button . Clicking the button displays the last known values of SIM attributes and allows the user to request them to be updated. In some embodiments the SIM attributes comprise forbidden public land mobile networks FPLMN location information for the global packet radio system LOCIGPRS location information LOCI and public land mobile network selector PLMNsel .

In some embodiments data row comprises MSC Events data row of . If a user clicks on a shaded area e.g. shaded area of in MSC Events data row of a popup window e.g. popup window is displayed. The title of the popup window comprises the global title GT address of the session and the data in the popup window comprises the event type e.g. Location Update the carrier the GT address the IMSI number the initial location update date and time and the cancel location date and time. If the user clicks on an icon e.g. icon of in MSC Events data row of a popup window is displayed. The title of the popup window comprises the GT address of the session and the data in the popup window comprises the event type e.g. Location Update the carrier the GT address the IMSI number and the event date and time.

In some embodiments data row comprises SGSN Events data row of . If a user clicks on a shaded area e.g. shaded area of in SGSN Events data row of a popup window e.g. popup window is displayed. The title of the popup window comprises the GT address of the session and the data in the popup window comprises the event type e.g. Location Update the carrier the GT address the IMSI number the initial location update date and time and the cancel location date and time. If the user clicks on an icon e.g. icon of in SGSN Events data row of a popup window is displayed. The title of the popup window comprises the GT address of the session and the data in the popup window comprises the event type e.g. Location Update the carrier the GT address the IMSI number and the event date and time.

In some embodiments data row comprises GSM Authorization Requests data row of . If a user clicks on a shaded area e.g. shaded area of in MSC Events data row of a popup window e.g. popup window is displayed. The title of the popup window comprises the number of GSM Authorization requests in the displayed time period and the data in the popup window comprises the GSM Authorization request limit for the displayed color the start date and time for the displayed time period and the end date and time for the displayed time period.

In some embodiments data row comprises PDP Sessions data row of . If a user clicks on a shaded area e.g. shaded area of in PDP Sessions data row of a popup window e.g. popup window is displayed. The title of the popup window comprises the number of GSM Authorization requests in the displayed time period and the data in the popup window comprises the GSM Authorization request limit for the displayed color the start date and time for the displayed time period and the end date and time for the displayed time period. If a user clicks on a box corresponding to a CDR e.g. box of a popup window is displayed. The title of the popup window comprises the text CDR and the data in the popup window comprises the cause for the CDR closing the SGSN GT address the number of upload bytes during the CDR the number of download bytes during the CDR the session duration the CDR start date and time and the CDR end date and time.

In some embodiments data row comprises SMS Messages data row of . If a user clicks on an icon e.g. icon or icon of a popup window e.g. popup window is displayed. The title of the popup window comprises the text SMS MO for an outgoing SMS message and the title of the popup window comprises the text SMS MT for an incoming SMS message. The data in the popup window comprises the message status the MSISDN to which the message was sent the MSISDN from which the message was sent and the date and time the message was sent.

In some embodiments data row comprises Authentication Failures data row of . If a user clicks on a shaded area e.g. shaded area of a popup window e.g. popup window is displayed. The title of the popup window comprises the number of authentication failures in the displayed time period and the data in the popup window comprises the authentication failure limit for the displayed color the start date and time for the displayed time period and the end date and time for the displayed time period.

In some embodiments data row comprises SIM Status data row of . If a user clicks on a shaded area e.g. shaded area of a popup window e.g. popup window is displayed. The title of the popup window comprises the text SIM Status and the data in the popup window comprises the status of the SIM state at the time corresponding to the click the status of the suspended state at the time corresponding to the click the status of the overage limit at the time corresponding to the click the status of the overage limit override at the time corresponding to the click the date and time when this combination of settings took effect and the date and time when this combination of settings changed.

In some embodiments data row comprises Annotations data row of . If a user clicks on an icon e.g. icon icon icon or icon of a popup window e.g. popup window is displayed. The title of the popup window comprises the text Annotation and the data in the popup window comprises the text of the annotation. The popup window additionally comprises links that allow a user to delete or edit the annotation.

In data e.g. information is extracted from the one or more communication data log s or stream s . In extracted data e.g. information is displayed as a plurality of time correlated lanes. For example data is displayed using swim lanes or pop ups of a diagnostic display e.g. a display like in . In various embodiments swim lanes have information displayed as shaded or colored bars and or shaded or colored point events or any other appropriate display of information. In some embodiments data e.g. information is displayed as plurality of time correlated lanes in a graphical user interface. In some embodiments displaying information as a plurality of time correlated lanes is managed by a role based access control protocol. In some embodiments access control for displaying information as a plurality of time correlated lanes is based at least in part of an organization associated with a user.

In some embodiments the graphical user interface is also for providing a control for changing a time zone associated with the displayed information. For example a user selects that all times associated with lanes of displayed information are displayed in local time to a wireless cellular device in local time for a user in Greenwich Mean Time GMT or any other appropriate time. In some embodiments the graphical user interface is also for providing a control for changing a time scale associated with the displayed information. For example the time scale is set to show information within a few hours one hour a day a half day or any other appropriate time scale. In some embodiments providing a control for changing a time scale includes providing a control for zooming in or zooming out and or a control for displaying the information at multiple time scales e.g. some sections with longer time scales and some sections with shorter time scales a zoomed in section . In some embodiments the graphical user interface is also for providing a control for displaying by a desired time or a desired date. In some embodiments the graphical user interface is also for providing a control for displaying by scrolling or panning a time window associated with the desired information. In some embodiments a control for displaying by scrolling or panning is provided for ease of navigation. In some embodiments a click in a window centers a display e.g. a click on a time centers the time in the window . In some embodiments the graphical user interface is also for providing a control for a user to add a time based annotation e.g. a note of explanation . In some embodiments the graphical user interface is also for providing a control for a user to edit a time based annotation. In some embodiments the graphical user interface is also for providing a control for a user to share a time based annotation. In some embodiments the graphical user interface is also for providing a control for selecting a format for displaying the information wherein the format comprises one or more of the following Event format e.g. displays icons corresponding to events e.g. icon of Time bar format e.g. displays time bars corresponding to events with duration e.g. shaded area of Heat map format e.g. displays bars colored or patterned or shaded or grey scaled to correspond to density of events e.g. shaded area of and Annotations e.g. icons corresponding to human or machine created annotations e.g. icon of . In some embodiments the format adjusts automatically depending on the data content. In various embodiments the format adjusts automatically by switching from one format to another format e.g. from Event format to Heat map format or from Time bar format to Event format by automatically scaling the time axis by automatically scaling the density of events displayed by automatically changing the color of the bars in the Heat map format by automatically changing the size or shape of the icons in Event format or any other display feature or in any other appropriate way. In some embodiments the graphical user interface is also for providing a control for displaying additional information in response to a user click or hover. In some embodiments a user click or hover causes an interaction with a server to obtain the additional information. In some embodiments the graphical user interface is also for providing a control for selecting one or more time correlated lanes of the plurality of time correlated lanes to display or hide. In some embodiments information from one of the plurality of communication systems is displayed or associated with more than one of the plurality of time correlated lanes. In some embodiments a user selects which of the plurality of time correlated lanes the information is associated with. In some embodiments a selection of which of the plurality of time correlated lanes the information is associated with is based at least in part on distinguishing attributes of the information displayed. In some embodiments a user selects one or more criteria for deciding which of the plurality of time correlated lanes each of the information elements is associated with and the associating is achieved automatically based at least in part on the one or more criteria. In various embodiments distinguishing attributes of information displayed comprise time since information update total information received in the displayed time period total information received in a user defined time period access control properties of the display user externally defined information priority or any other appropriate attributes. In some embodiments the graphical user interface is also for providing a control for searching for a specific pattern in one or more of the plurality of time correlated lanes. In some embodiments the graphical user interface is also for providing a control for filtering out a specific pattern in one or more of the plurality of time correlated lanes. In some embodiments the graphical user interface is also for automatically highlighting a specific pattern in one or more of the plurality of time correlated lanes. In some embodiments the graphical user interface is also for automatically adding an annotation to a specific pattern in one or more of the plurality of time correlated lanes.

In some embodiments the graphical user interface is also for providing an active control. In some embodiments the active control comprises sends an SMS message wherein the sent SMS message sends a text message to a SIM. In some embodiments the active control comprises a control that when activated sends a cancel location command wherein the cancel location command sends a cancel location command to a SIM. In some embodiments the active control comprises a control that when activated sends a diagnose command wherein the diagnose control assess a SIM s ability to connect to a wireless network. In various embodiments the active control comprises a control that when activated retrieves SIM information from one or more of the following a SIM a SIM database a HLR or any other appropriate SIM information source. In various embodiments SIM information comprises one or more of the following last known value or last update date or time for a SGSN a MSC a FPLMN A LOCIGPRS a LOCI or any other appropriate SIM information. In some embodiments an active control comprises an update e.g. an update for a value associated with a SGSN a MSC a FPLMN A LOCIGPRS a LOCI etc. .

In some embodiments the display also includes active controls for example send SMS send cancel location diagnose SIM information.

Different embodiments of the invention may be implemented using different combinations of software firmware and or hardware. Thus the techniques shown in the figures can be implemented using code and data stored and executed on one or more electronic devices e.g. computers servers mobile devices etc. . Such electronic devices store and transmit internally and or with other electronic devices over a network code composed of software instructions and data using computer readable media such as non transitory tangible computer readable media e.g. computer readable storage media such as magnetic disks optical disks read only memory flash memory devices and transitory computer readable transmission media e.g. electrical optical acoustical or other form of propagated signals such as carrier waves infrared signals . In addition such electronic devices typically include a set of one or more processors coupled to one or more other components such as one or more non transitory machine readable media to store code and or data user input output devices e.g. a keyboard a touchscreen and or a display and network connections to transmit code and or data using propagating signals . The coupling of the set of processors and other components is typically through one or more busses and bridges also termed as bus controllers . Thus a non transitory computer readable medium of a given electronic device typically stores instructions for execution on one or more processors of that electronic device. One or more parts of an embodiment of the invention may be implemented using different combinations of software firmware and or hardware.

While the invention has been described in terms of several embodiments those skilled in the art will recognize that the invention is not limited to the embodiments described and can be practiced with modification and alteration within the spirit and scope of the appended claims. The description is thus to be regarded as illustrative instead of limiting.

