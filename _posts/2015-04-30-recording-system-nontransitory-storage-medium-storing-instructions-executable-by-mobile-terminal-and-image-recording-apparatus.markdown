---

title: Recording system, non-transitory storage medium storing instructions executable by mobile terminal, and image recording apparatus
abstract: A recording system includes: an image recording apparatus for image recording based on target data in a first format; a server device; and a mobile terminal including a wireless communication device, an operation device, and a controller. The controller transmits recording instruction information to the image recording apparatus when a recording instruction for the target data in a second format is received in a state in which the wireless communication device is connected to an access point. The controller instructs the server device to receive the target data in the second format, convert it to the first format, and cause the image recording apparatus to receive the target data and perform image recording, when the recording instruction for the target data in the second format is received in a state in which the wireless communication device is not connected to the access point.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09274734&OS=09274734&RS=09274734
owner: Brother Kogyo Kabushiki Kaisha
number: 09274734
owner_city: Nagoya-shi, Aichi-ken
owner_country: JP
publication_date: 20150430
---
The present application claims priority from Japanese Patent Application No. 2014 093431 which was filed on Apr. 30 2014 the disclosure of which is herein incorporated by reference in its entirety.

The following disclosure relates to i a recording system in which an image recording apparatus records an image based on recording instruction information transmitted wirelessly ii a non transitory storage medium storing a plurality of instructions executable by a processor of a mobile terminal and iii the image recording apparatus.

With the recent spread of mobile terminals attention has been directed toward a technique for causing an image recording apparatus to record an image based on recording instruction information wirelessly transmitted from a mobile terminal Also there has been known a technique for reducing the number of operations for image recording by preregistering into the mobile terminal information about the image recording apparatus to which the recording instruction information is to be wirelessly transmitted. As a similar technique there has been known a technique for monitoring a state of a registered default printer.

However a communication network used by the mobile terminal may be switched from one to another by movement of a user which may inhibit the wireless transmission of the recording instruction information based on the registered information. In this case information about the currently used network has to be registered into the mobile terminal requiring complicated operations of the user.

Accordingly an aspect of the disclosure relates to a recording system allowing transmission of recording instruction information to an image recording apparatus through an appropriate communication path depending on a current communication environment a non transitory storage medium storing a plurality of instructions executable by a processor of a mobile terminal in the recording system and the image recording apparatus.

In one aspect of the disclosure a recording system includes an image recording apparatus configured to perform a recording operation for recording an image on a recording medium based on target data in a first format a server device configured to execute a relay processing including a processing in which the server device converts target data in second format different from the first format to the target data in the first format and a processing in which the server device causes the image recording apparatus to receive the target data converted to the first format and perform the recording operation based on the target data and a mobile terminal including a wireless communication device configured to perform wireless communication with the image recording apparatus on a wireless LAN via an access point and configured to perform wireless communication with the server device on an internet an operation device configured to receive an operation of a user and a controller. The controller is configured to execute a first processing including a processing in which the controller converts the target data in the second format to the target data in the first format and a processing in which the controller transmits recording instruction information to the image recording apparatus via the wireless communication device the recording instruction information instructing the image recording apparatus to receive the target data converted to the first format and perform the recording operation and a second processing in which the controller transmits relay instruction information to the server device via the wireless communication device the relay instruction information instructing the server device to receive the target data in the second format and execute the relay processing. The controller is configured to execute the first processing when a recording instruction for the target data in the second format is received by the operation device in a state in which the wireless communication device is connected to the access point and the second processing when the recording instruction for the target data in the second format is received by the operation device in a state in which the wireless communication device is not connected to the access point.

In another aspect of the disclosure a recording system includes an image recording apparatus configured to perform a recording operation for recording an image on a recording medium based on target data in a first format a server device configured to execute a relay processing including a processing in which the server device converts target data in second format different from the first format to the target data in the first format and a processing in which the server device causes the image recording apparatus to receive the target data converted to the first format and perform the recording operation based on the target data and a mobile terminal including a wireless communication device configured to perform wireless communication with the image recording apparatus and the server device an operation device configured to receive an operation of a user and a controller. The controller is configured to execute a first processing including a processing in which the controller converts the target data in the second format to the target data in the first format and a processing in which the controller transmits recording instruction information to the image recording apparatus via the wireless communication device the recording instruction information instructing the image recording apparatus to receive the target data converted to the first format and perform the recording operation a second processing in which the controller transmits relay instruction information to the server device via the wireless communication device the relay instruction information instructing the server device to receive the target data in the second format and execute the relay processing and an acquisition processing in which the controller acquires higher priority processing information indicating a processing with a higher priority among the first processing and the second processing. When the higher priority processing information indicates that the first processing is the processing with a higher priority the controller is configured to execute the first processing when a recording instruction for the target data in the second format is received by the operation device in a state in which wireless communication with the image recording apparatus is performable and the second processing when the recording instruction is received by the operation device in a state in which wireless communication with the image recording apparatus is not performable. When the higher priority processing information indicates that the second processing is the processing with a higher priority the controller is configured to execute the second processing when the recording instruction is received by the operation device in a state in which wireless communication with the server device is performable and the first processing when the recording instruction is received by the operation device in a state in which wireless communication with the server device is not performable.

In another aspect of the disclosure a non transitory storage medium stores a plurality of instructions executable by a processor of a mobile terminal The mobile terminal includes a wireless communication device configured to perform wireless communication with an image recording apparatus on a wireless LAN via an access point and configured to perform wireless communication with a server device on an internet and an operation device configured to receive an operation of a user. The plurality of instructions when executed by the processor cause the mobile terminal to execute a first processing including a processing in which the mobile terminal converts target data in a second format to the target data in a first format and a processing in which the mobile terminal transmits recording instruction information to the image recording apparatus via the wireless communication device the recording instruction information instructing the image recording apparatus to receive the target data converted to the first format and perform a recording operation for recording an image on a recording medium based on the target data in the first format and a second processing in which the mobile terminal transmits relay instruction information to the server device via the wireless communication device the relay instruction information instructing the server device to receive the target data in the second format convert the target data in the second format to the target data in the first format and transmit the recording instruction information to the image recording apparatus. The plurality of instructions when executed by the processor cause the mobile terminal to execute the first processing when a recording instruction for the target data in the second format is received by the operation device in a state in which the wireless communication device is connected to the access point and the second processing when the recording instruction for the target data in the second format is received by the operation device in a state in which the wireless communication device is not connected to the access point.

In another aspect of the disclosure a non transitory storage medium stores a plurality of instructions executable by a processor of a mobile terminal The mobile terminal includes a wireless communication device configured to perform wireless communication with an image recording apparatus and configured to perform wireless communication with a server device and an operation device configured to receive an operation of a user. The plurality of instructions when executed by the processor cause the mobile terminal to execute a first processing including a processing in which the mobile terminal converts target data in a second format to the target data in a first format and a processing in which the mobile terminal transmits recording instruction information to the image recording apparatus via the wireless communication device the recording instruction information instructing the image recording apparatus to receive the target data converted to the first format and perform a recording operation for recording an image on a recording medium based on the target data in the first format a second processing in which the mobile terminal transmits relay instruction information to the server device via the wireless communication device the relay instruction information instructing the server device to receive the target data in the second format convert the target data in the second format to the target data in the first format and transmit the recording instruction information to the image recording apparatus and an acquisition processing in which the mobile terminal acquires higher priority processing information indicating a processing with a higher priority among the first processing and the second processing. The plurality of instructions when executed by the processor and when the higher priority processing information indicates that the first processing is the processing with a higher priority cause the mobile terminal to execute the first processing when a recording instruction for the target data in the second format is received by the operation device in a state in which wireless communication with the image recording apparatus is performable and the second processing when the recording instruction is received by the operation device in a state in which wireless communication with the image recording apparatus is not performable. The plurality of instructions when executed by the processor and when the higher priority processing information indicates that the second processing is the processing with a higher priority cause the mobile terminal to execute the second processing when the recording instruction is received by the operation device in a state in which wireless communication with the server device is performable and the first processing when the recording instruction is received by the operation device in a state in which wireless communication with the server device is not performable.

In another aspect of the disclosure an image recording apparatus includes a recording device configured to perform a recording operation for recording an image on a recording medium based on target data in a first format a communication device communicable with a mobile terminal and a server device and a controller configured to execute a registration processing in which when having received account information from the mobile terminal via the communication device the controller transmits the account information and identification information for identifying the image recording apparatus the server device via the communication device and a transmission processing in which when the registration processing is completed the controller transmits registration completion information to the mobile terminal via the communication device. The account information is information for authentication of a privilege of causing the server device to execute a relay processing including a processing in which the server device converts target data in second format different from the first format to the target data in the first format and a processing in which the server device causes the image recording apparatus to receive the target data converted to the first format and perform the recording operation based on the target data.

Hereinafter there will be described one embodiment by reference to the drawings. It is to be understood that the following embodiment is described only by way of example and the disclosure may be otherwise embodied with various modifications without departing from the scope and spirit of the disclosure.

In the example in the mobile communication network and the wireless LANs are connected to the Internet via routers not shown. The MFP and the mobile terminal are on the wireless LAN and the MFP A is on the wireless LAN . The server device is connected to the Internet . The MFPs A the mobile terminal and the server device are communicable with each other according to one or more communication standards. It is noted that the device on the wireless LAN means a device which is set so as to be connected to the wireless LAN and communicable with other devices on the wireless LAN . More specifically the device on the wireless LAN means a device assigned with the same SSID as that of an access point A of the wireless LAN and having a network address assigned to the wireless LAN .

The MFP on the wireless LAN can use the access point A to perform wireless communication with the mobile terminal on the wireless LAN and the server device connected to the Internet . The mobile terminal on the mobile communication network can use a base station A to perform wireless communication with the server device connected to the Internet . The mobile terminal on the wireless LANs can use the access point A and an access point A to perform wireless communication with the MFPs A on the respective wireless LANs and the server device connected to the Internet . The MFP and the mobile terminal can perform wireless communication with each other not via the access point A.

It is noted that the wireless communication via the base station A or the access points A A is not limited to wireless communication performed over the entire communication route. That is when the mobile terminal wirelessly transmits or receives information or data via the base station A or the access points A A wireless connection may be established at least between the mobile terminal and the base station A or the access points A A. This applies to the MFPs A.

As illustrated in the MFP includes a printing device a scanning device a display device an operation device a Wi Fi registered trademark of Wi Fi Alliance communication device an NFC Near Field Communication communication device a CPU Central Processing Unit a storage device and a communication bus . The devices of the MFP are connected to each other via the communication bus . The MFP is one example of an image recording apparatus. The printing device is one example of a recording device. Each of the Wi Fi communication device and the NFC communication device is one example of a communication device. It is noted that the MFPs A have the same configuration and only the MFP will be explained in detail.

The printing device performs a recording operation for recording an image on a recording sheet based on data in a first format. The recording sheet is one example of a recording medium. The printing device may be a well known printing device such as an ink jet printing device or an electronic photographic printing device. The scanning device performs a scanning operation for creating image data by reading an image recorded on a recording sheet. The MFP may further have other functions including a facsimile function for transmitting and receiving facsimiles and a copying function for reading an image recorded on a recording sheet and recording the image on another recording sheet.

The display device includes a display screen for displaying various kinds of information thereon. The display device may be constituted by any device such as a liquid crystal display LCD and an organic electroluminescent display organic ELD .

The operation device receives or accepts a user operation for selecting an object displayed on the display screen of the display device . Specifically the operation device includes push buttons for example and sends the CPU a signal corresponding to a pushed one of the push buttons. The operation device may further include a touch sensor shaped like a thin layer superposed on the display screen of the display device . That is the display device may be constituted as a touch panel display. The touch sensor may be constituted by a well known sensor such as a capacitance sensor and a resistive film sensor.

It is noted that the object is an image selectable by the user operating the operation device . For example the MFP may be configured such that each of objects is a character string displayed on the display device one of the displayed objects is highlighted by a push of a direction key of the operation device and the highlighted object is selected by a push of a determination button of the operation device . As another example in the case where the operation device is a touch panel the object may be an icon a button or a link displayed on the display device for example and the user may touch the object to select it.

The Wi Fi communication device is an interface for wireless communication with external devices. Specifically the Wi Fi communication device can perform i wireless communication with the mobile terminal through indirect wireless connection via the access point A ii wireless communication with the mobile terminal through direct wireless connection not via the access point A and iii wireless communication with the server device via the access point A and the router not shown. The Wi Fi communication device performs communication according to IEEE802.11 standards for example. In this case the indirect wireless connection refers to an infrastructure mode and the direct wireless connection refers to an ad hoc mode or Wi Fi Direct. The Wi Fi communication device is one example of a wireless communication device.

The NFC communication device is an interface for performing wireless communication through proximity wireless connection according to an NFC standard. The NFC communication device includes an IC chip having a storage device which transfers information and the like with external devices. The NFC standard is one example of a proximity wireless communication standard and the NFC communication device is one example of a proximity wireless communication device. Another example of the proximity wireless communication standard is TransferJet registered trademark of TransferJet Consortium .

It is noted that a device capable of performing communication according to the NFC standard will be hereinafter referred to as NFC device . That is each of the MFP and the mobile terminal is one example of the NFC device. The NFC device is operated in any one of a P2P mode a Reader mode a Writer mode and a CE mode. Also combination of the Reader mode and the Writer mode may be hereinafter referred to as R W mode .

The P2P mode is a mode for two way communication between a pair of NFC devices. An NFC device corresponding to Type A complying with ISO IEC1443 specified on the NFC Forum and an NFC device corresponding to Type F complying with ISO IEC18092 are operable in the P2P mode. An NFC device corresponding to Type B complying with ISO IEC1443 is not operable in the P2P mode.

Each of the R W mode and the CE mode is a mode for performing one way communication between a pair of NFC devices. The CE mode is a mode in which an NFC device operates as a card which is a form defined on the NFC Forum. The NFC devices respectively corresponding to Type A Type F and Type B are operable in the CE mode. The Reader mode is a mode for reading information or the like from an NFC device operating in the CE mode. The Writer mode is a mode for writing various kinds of information into an NFC device operating in the CE mode.

The following explanation will be given assuming the MFP operates in the R W mode and the mobile terminal operates in the CE mode by way of example. That is the MFP operating in the R W mode can read information or the like from the mobile terminal operating in the CE mode and can write information or the like to the mobile terminal . However the present invention is not limited to this configuration. For example the recording system may be configured such that the MFP operates in the CE mode and the mobile terminal operates in the R W mode and may be configured such that both of the MFP and the mobile terminal operate in the P2P mode.

In the present embodiment the NFC communication device of the MFP performs a Poll operation. In the Poll operation the NFC communication device transmits a polling signal at predetermined time intervals and monitors a response signal which is a response to the polling signal. After the NFC communication device receives the response signal the CPU hereinafter executes necessary processings. In the present embodiment an NFC communication device of the mobile terminal performs a Listen operation. In the Listen operation the NFC communication device monitors the polling signal transmitted from the MFP and transmits the response signal when having received the polling signal. After the NFC communication device transmits the response signal a CPU hereinafter executes necessary processings.

The CPU of the MFP then acquires information from the mobile terminal via the NFC communication device and this information indicates in which mode the mobile terminal is operable. Based on this information acquired from the mobile terminal the CPU determines a mode or modes in which the MFP and the mobile terminal are to be operated. The CPU then controls the NFC communication device to send the mobile terminal an Activation command which indicates the operation mode of the mobile terminal . When the Activation command transmitted from the MFP is received by the CPU of the mobile terminal via the NFC communication device the CPU controls the NFC communication device to send the MFP an OK command which is a response to the Activation command. As a result a communication link using the NFC is established between the MFP and the mobile terminal . The MFP and the mobile terminal thereafter transfer information and the like through this communication link.

When the CPU of the MFP then terminates the communication with the mobile terminal the CPU controls the NFC communication device to send the mobile terminal a Deactivation command for disconnecting the communication link. When the Deactivation command transmitted from the MFP is received by the CPU of the mobile terminal via the NFC communication device the CPU controls the NFC communication device to send the MFP an OK command which is a response to the Deactivation command. As a result the communication link between the MFP and the mobile terminal is disconnected.

The CPU controls overall operations of the MFP . The CPU acquires various kinds of programs which will be described below from the storage device to execute processings based on various kinds of information output from the operation device and various kinds of information acquired from the mobile terminal or the server device via the Wi Fi communication device or the NFC communication device for example. That is the CPU and the storage device are one example of a controller.

The storage device includes a program storage area A and a data storage area B. The program storage area A stores an operating system OS and a control program . It is noted that the control program may be a single program and may be a collection of a plurality of programs. The data storage area B stores data and or information required for execution of the control program . For example the data storage area B stores information or data received from the mobile terminal or the server device .

In the present specification the term data and the term information are the same in that each of them is a bit or a bit string which can be handled by a computer. The data can be handled by the computer regardless of details indicated by each bit. The information causes branching in an operation of the computer depending on details indicated by each bit. Moreover the term instruction is a control signal for demanding next operation to a device to which the instruction is transmitted and may include the information or may have a nature of the information.

Also even if the data and the information are changed in format e.g. a text format a binary format and a flag format for each computer the computer treats the data before the change and the data after the change as the same data as long as the computer recognizes that the data before the change and the data after the change are substantially the same as each other. For example information indicating two may be stored in one computer as information in a text format of 0x32 in the ASCII code and stored in another computer as information in a binary format of 10 as a binary number.

However the data and the information are not strictly distinguished and may be treated exceptionally. For example the data may be temporarily treated as the information and the information may be temporarily treated as the data. Also the data treated in one device may be treated as the information in another device and vice versa. Furthermore the information may be taken out from the data and the data from the information.

The storage device is for example constituted by a RAM Random Access Memory a ROM Read Only Memory an EEPROM Electrically Erasable Programmable Read Only Memory an HDD Hard Disk Drive a buffer for the CPU and other similar devices or constituted by a combination of at least two of these devices. The storage device may be a storage medium readable by a computer. The storage medium readable by a computer is a non transitory medium. Examples of the non transitory medium also include recording media such as a CD ROM and a DVD ROM. The non transitory medium is also a tangible medium. However an electrical signal for transmitting programs downloaded from e.g. a server on the Internet is a signal medium readable by the computer as one kind of a medium readable by the computer but is not a non transitory storage medium readable by the computer.

Programs stored in the program storage area A are executed by the CPU . However in the present specification an operation of each of the programs may be described without referring to the CPU . That is the description meaning that a program A executes a processing A may indicate that the CPU executes the processing A written in the program A . This applies to the mobile terminal and the server device which will be described later.

The OS is a basic program which provides an API Application Programming Interface for controlling hardware constituting the MFP such as the printing device the scanning device the display device the operation device the Wi Fi communication device and the NFC communication device . That is each of the above mentioned programs controls the hardware by calling up the API provided by the OS . However in the present specification operations of the programs will be described without referring to the OS . That is the description described later meaning that program B controls hardware C may indicate that the program B controls the hardware C through the API of the OS . This applies to the mobile terminal described later.

As illustrated in the mobile terminal includes a display device an operation device a Wi Fi communication device the NFC communication device a mobile communication device the CPU a storage device and a communication bus . Each of the Wi Fi communication device the NFC communication device and the mobile communication device is one example of a communication device. The Wi Fi communication device is one example of a first communication device and the NFC communication device is one example of a second communication device. Each of the display device the operation device the Wi Fi communication device the NFC communication device the CPU the storage device and the communication bus has the same configuration of a corresponding one of the display device the operation device the Wi Fi communication device the NFC communication device the CPU the storage device and the communication bus of the MFP and an explanation of which is dispensed with.

The mobile communication device is an interface for performing wireless communication with devices on the mobile communication network via the base station A or with the server device connected to the Internet for example. A program storage area A of the storage device stores an OS and a control program . As illustrated in a data storage area B stores Wi Fi connection information GCP connection information alternative connection information an NFC flag and a latest account information for example.

The server device executes a relay processing. In this relay processing the server device receives target data in a second format different from the first format converts the format of the target data from the second format to the first format and causes the MFP to perform the recording operation based on the target data in the converted or obtained first format. The server device stores information illustrated in for example. Any device may be employed as the server device . For example the server device may be a device for providing a Google Cloud Print service provided by Google Inc. This service will be hereinafter referred to as GCP .

As illustrated in the server device stores i account information containing a user ID and a password and ii MFC information containing a model name and a MAC address such that the account information and the MFC information are associated with each other for example. The account information is used for authentication of a privilege of causing the server device to execute the relay processing. The information illustrated in is registered into the server device in a registration processing which will be described below.

There will be next explained operations of the recording system with reference to . In the MFP according to the present embodiment when recording instruction information containing target data in the first format is received by the Wi Fi communication device the printing device records an image on a recording sheet based on the target data. In the mobile terminal according to the present embodiment when the operation device has accepted a user operation of selecting target data representative of an image to be recorded on a recording sheet the Wi Fi communication device transmits the recording instruction information to the MFP first processing or the mobile communication device transmits relay instruction information to the server device second processing .

There will be next explained a collecting processing with reference to the flow chart in . In this collecting processing the mobile terminal collects the Wi Fi connection information the GCP connection information the alternative connection information the NFC flag and other data. It is noted that the Wi Fi connection information is one example of first processing information and the GCP connection information is one example of second processing information. The alternative connection information associated with Wi Fi processing information see is another example of the second processing information and alternative connection information associated with GCP processing information see is another example of the first processing information.

The mobile terminal executes the collecting processing illustrated in according to the control program when the operation device has accepted a user operation of tapping on a collecting processing button displayed on a menu screen illustrated in . This flow begins with S at which the control program displays an IF selection screen on the display device . The screen illustrated in is one example of the IF selection screen. The IF selection screen illustrated in contains a Wi Fi button and a GCP button. In this specification a when clause indicates that in the case where a condition indicated by the when clause is satisfied a processing described after the when clause is executed. It is noted that the processing may be executed at any timing after the condition is satisfied and may not be executed immediately after the condition is satisfied.

When the operation device has accepted a user operation of tapping on the Wi Fi button S Wi Fi the control program at S searches a device on the wireless LAN more specifically a device including the printing device . A method of searching a device on the wireless LAN is well known and an explanation of which is dispensed with. The tapping on the Wi Fi button is one example of an input of instruction for acquiring the first processing information required for execution of the first processing.

The control program acquires various kinds of information from each of devices detected or found at S. Examples of the information acquired at S include a model name of the detected device an IP address of the detected device on the wireless LAN a MAC address of the detected device a GCP flag indicating whether the detected device is a GCP enabled device or not and an NFC flag indicating whether the detected device is the NFC device or not. The information acquired S is partly registered in an MIB Management Information Base of each device and acquired according to an SNMP Simple Network Management Protocol .

At S the control program displays a searched device selection screen on the display device . The screen illustrated in is one example of the searched device selection screen. The searched device selection screen illustrated in contains a button or buttons respectively indicating one or more devices detected at S. Information identifying the device is described on each button. In a model name of the device is described on each button. In the present embodiment it is assumed that a button with the model name MFC A of the MFP is selected in a processing at S which will be described below.

When the operation device has accepted a user operation of tapping on one of the buttons illustrated in S Yes the control program at S stores the model name and the IP address of the detected device into the data storage area B in a state in which the model name and the IP address are associated with each other. In the present embodiment as illustrated in the model name MFC A and the IP address 192.168.0.1 of the MFP are associated with each other and stored into the data storage area B. The IP address is location information which indicates a location of the detected device on the wireless LAN . The IP address is one example of the Wi Fi connection information. As a result the control program can perform communication with the device identified by the IP address according to TCP IP. The Wi Fi connection information is not limited to the IP address and may be a name of the detected device a URL Uniform Resource Locator or other similar information as long as such information can uniquely identify the detected device in order for the control program to designate and communicate with the device on the wireless LAN .

When the device selected at S is the GCP enabled device S Yes the control program at S executes the registration processing. When the device selected at S is not the GCP enabled device S No this flow goes to S. The determination of whether the device is the GCP enabled device or not can be made based on the GCP flag acquired at S. The GCP flag is one example of relay processing executable inexecutable information which indicates whether the device can be a device for which the relay processing is to be executed by the server device .

In the registration processing the account information and the identification information for identifying the device selected at S are registered into the server device in a state in which the account information and the identification information are associated with each other. There will be next explained the registration processing in detail with reference to the flow chart in .

This flow begins with S at which the control program executes an authentication processing illustrated in . In the authentication processing the control program checks whether a combination of the user ID and the password as the account information is registered in the server device or not. The user ID is one example of a user identifier and the password is one example of security information. It is noted that any information may be used as the security information. For example a PIN Personal Identification Number code may be used as the security information.

The control program at S acquires the user ID from the OS . The control program at S displays a password input screen on the display device . The screen illustrated in is one example of the password input screen. The password input screen illustrated in contains the user ID acquired from the OS a text box for input of the password and a login button.

In the present embodiment the OS stores the user ID of the user who can use the programs operable on the OS . The control program at S acquires the user ID from the OS . However the user ID may not be acquired from the OS . For example the user ID may be stored in the control program and may be acquired from the user via the operation device .

When the operation device has accepted the user operation of tapping on the login button the control program controls the Wi Fi communication device to send the server device authentication instruction information containing the user ID acquired at S from the OS and the password input to the text box and then the control program receives authentication result information as a response to the authentication instruction information from the server device via the Wi Fi communication device . The authentication result information indicates AUTHENTICATED in the case where a combination of the user ID and the password stored in the authentication instruction information is registered in the server device and the authentication result information indicates NOT AUTHENTICATED in the case where the combination of the user ID and the password is not registered in the server device .

When the authentication result information indicates AUTHENTICATED S Yes this flow ends. When the authentication result information indicates NOT AUTHENTICATED S No this flow returns to S at which the control program displays the password input screen on the display device again. In the present embodiment it is assumed that the user ID brother xyz.com is acquired at S the password abcdefg is input at S and the authentication result information indicates AUTHENTICATED at S.

In the following explanation various kinds of information is transmitted and received between the mobile terminal and the server device via the access points A A by way of example but various kinds of information may be transmitted and received via the base station A. For example the control program may transmit the authentication instruction information to the server device via the mobile communication device and receive the authentication result information from the server device via the mobile communication device . The various kinds of information is transmitted and received selectively via the base station A or the access points A A depending upon a communication environment of the mobile terminal and settings of the order of priority.

Returning to the flow in the control program at S controls the Wi Fi communication device to transmit registration instruction information to the MFP through the indirect wireless connection via the access point A. The registration instruction information is for instructing the MFP to execute a processing in which the identification information on the MFP and the account information authenticated at S are registered into the server device in a state in which the identification information and the account information are associated with each other. The registration instruction information contains the account information authenticated at S.

When the mobile terminal has received registration completion information from the MFP via the Wi Fi communication device through the indirect wireless connection via the access point A S Yes the control program at S stores the MAC address acquired at S and the account information contained in the registration instruction information into the data storage area B in association with the model name and the Wi Fi connection information.

The MAC address is one example of the identification information for identifying the MFP . However the identification information is not limited to the MAC address and may be any information as long as the information can uniquely identify the detected device. The associated account information and MAC address are one example of the alternative connection information. In the present embodiment only the user ID of the account information is stored in the data storage area B and the password is not stored in the data storage area. In the present embodiment as illustrated in the account information brother xyz.com and the MAC address 15 61 3D 4E A3 05 are stored into the data storage area B in association with the Wi Fi connection information.

When the registration instruction information transmitted from the mobile terminal is received by the MFP via the Wi Fi communication device through the indirect wireless connection the control program of the MFP controls the Wi Fi communication device to send the server device registration information containing i the account information contained in the registration instruction information and ii the MAC address of the MFP . In the present embodiment the registration information further contains the model name of the MFP . This processing is one example of the registration processing. As a result as illustrated in the model name MFC A and the MAC address 15 61 3D 4E A3 05 are registered in the server device in association with the user ID brother xyz.com and the password abcdefg .

When the MFP has received registration result information as a response to the registration information from the server device via the Wi Fi communication device the control program controls the Wi Fi communication device to transmit the registration completion information to the mobile terminal through the indirect wireless connection. The registration result information and the registration completion information indicate that a combination of the account information and the MAC address contained in the registration information has been registered in the server device that is the registration processing is completed.

The control program then at S in stores the NFC flag of the device selected at S into the data storage area B in association with the Wi Fi connection information and the alternative connection information and this flow ends. In the present embodiment as illustrated in the ON state of the NFC flag is stored into the data storage area B in association with the Wi Fi connection information and the alternative connection information. It is noted that the NFC flag is ON in the case where the detected device is the NFC device and the NFC flag is OFF in the case where the detected device is not the NFC device. The NFC flag is one example of proximity connection usable unusable information indicating whether wireless communication through the proximity wireless connection can be performed or not.

When the operation device has accepted the user operation of tapping on the GCP button displayed on the IF selection screen S GCP the control program at S executes the authentication processing illustrated in . The authentication processing has been explained above and an explanation of which is dispensed with. The tapping on the GCP button is one example of an input of instruction for acquiring the second processing information required for execution of the second processing.

The control program at S controls the Wi Fi communication device to send the server device registered device transmission information containing the account information authenticated at S. The registered device transmission information is for causing the server device to transmit a list of the identification information associated with the account information. In the present embodiment the registered device transmission information containing the user ID patent xyz.com and the password hijklmn is transmitted to the server device and two pieces of MFC information see associated with the account information are transmitted to the mobile terminal . Also the MFC information in the present embodiment contains the model name and the MAC address.

The control program at S displays a registered device selection screen on the display device . The screen illustrated in is one example of the registered device selection screen. The registered device selection screen illustrated in contains buttons respectively indicating the pieces of the MFC information received at S. Each of the buttons illustrated in is provided with the model name contained in a corresponding one of the pieces of the MFC information. In the present embodiment it is assumed that the button provided with the model name MFC C of the MFP A is to be selected in a processing at S which will be described below.

When the operation device has accepted a user operation of tapping on one of the buttons illustrated in S Yes the control program at S stores the model name and the MAC address of the detected device and the account information contained in the registered device transmission information into the data storage area B in a state in which the model name and the MAC address and the account information are associated with each other. The associated account information and MAC address are one example of the GCP connection information. In the present embodiment as illustrated in the model name MFC C of the MFP A the user ID patent xyz.com contained in the account information and the MAC address 28 5A 33 8C 14 D2 are stored into the data storage area B in a state in which these model name user ID and MAC address are associated with each other.

When the Wi Fi communication device is connected to any one of the access points A A S Yes the control program at S searches a device including the printing device on the wireless LAN to which the Wi Fi communication device is connected. When the device having the MAC address contained in the GCP connection information is detected at S S Yes the control program at S stores the NFC flag of the detected device and the IP address of the detected device as one example of the alternative connection information into the data storage area B in a state in which the NFC flag and the IP address are associated with the GCP processing information and this flow ends.

That is when the Wi Fi communication device is connected to the access point A the control program executes the processing at S. As a result as illustrated in the IP address 192.168.1.2 and the OFF state of the NFC flag of the MFP A are stored into the data storage area B in association with the GCP connection information. That is the MFP A in the present embodiment is not the NFC device.

When the device having the MAC address contained in the GCP connection information is not detected at S S No this flow ends without execution of the processing at S. Also when the Wi Fi communication device is connected to any of the access points A A S No this flow ends without execution of the processings at S . It is noted that the control program determines that the Wi Fi communication device is not connected to any of the access points A A in the case where the Wi Fi communication device does not have settings of connection to the access points A A or in the case where the Wi Fi communication device cannot receive radio waves transmitted from the access points A A for example.

There will be next explained an image recording processing with reference to . In this image recording processing the control program causes the printing device of the MFP to record an image on a recording sheet based on target data selected on the mobile terminal . In the image recording processing in the present embodiment in the case where the first processing is executable the mobile terminal executes the first processing using the various kinds of information illustrated in and in the case where the first processing is not executable the mobile terminal executes the second processing using the various kinds of information illustrated in . When the operation device has accepted a user operation of tapping on an image recording processing button on the menu screen illustrated in the control program of the mobile terminal executes the image recording processing illustrated in the flow chart in .

This flow begins with S at which the control program displays a data selection screen on the display device . The screen illustrated in is one example of the data selection screen. The data selection screen illustrated in contains one or more buttons. Each of the buttons is provided with a data identifier for identifying data which is a candidate of the target data. The number of buttons displayed on the data selection screen corresponds to the number of data selectable as the target data. Any data may be used as the data identifier one example of which is a file name. The data selectable on the data selection screen may be data stored in the data storage area B of the mobile terminal and may be data stored in a storage server not shown connected to the communication network.

When the operation device has accepted a user operation of tapping on one of the buttons displayed on the data selection screen S Yes the control program at S determines whether or not the Wi Fi communication device is connected to the access point A of the wireless LAN on which the MFP exists. In other words the control program at S determines whether the mobile terminal can perform wireless communication with the MFP through the indirect wireless connection or not. The tapping on the button displayed on the data selection screen is one example of an input of a recording instruction for selecting the target data in the second format and recording an image on a recording medium based on the selected target data. The following explanation will be given assuming that the user has tapped on the Estimate.pdf button.

When the Wi Fi communication device is connected to the access point A S Yes the control program at S executes a conversion processing for converting the format of the target data from the PDF format to the JPEG format. The conversion processing may be executed by the control program and may be executed by a server device not shown communicable over the communication network. That is in the case where the conversion processing is executed by the server device not shown the control program at S causes the server device to receive the target data in the PDF format and receives the target data in the JPEG format from the server for example. In the case where the target data selected at S is in the JPEG format this flow goes to S without execution of the processing in S.

It is noted that the conversion of the format is a processing of changing a data structure of the target data for example and an image based on the target data is not substantially changed. For example the wordings image based on the target data is not substantially changed include a concept in which a quality and colors hereinafter referred to as image quality of the image based on the target data is slightly deteriorated due to conversion of the format of the target data from the PDF format to the JPEG format. The wordings image based on the target data is not substantially changed further include a concept in which the image quality is slightly improved by the conversion of the format.

A procedure of conversion of the format of the target data is well known and an explanation of which is dispensed with. The JPEG format is one example of the first format and the PDF format is one example of the second format. The first format and the second format are not limited to these formats but the first format is more suitable for a forming processing than the second format. More preferably the first format is a format allowing the printing device to perform the recording operation and the second format is a format not allowing the printing device to perform the recording operation. That is the first format and the second format may vary depending on the MFP used.

The control program at S controls the Wi Fi communication device to transmit the recording instruction information to the MFP through the indirect wireless connection and this flow ends. The recording instruction information is information for instructing the MFP to receive the target data in the JPEG format converted from the PDF format and perform the recording operation based on the target data. For example in the case where the conversion processing has been executed by the control program the recording instruction information contains the target data whose format is converted to the JPEG format at S. As another example in the case where the conversion processing has been executed by the server device not shown the recording instruction information contains location information which indicates a location of the target data in the JPEG format on the server device. Any information may be used as the location information one example of which is a URL Uniform Resource Locator . The processings at S S are one example of the first processing.

When the Wi Fi communication device is not connected to the access point A S No the control program at S determines whether the relay instruction information which will be described below can be transmitted to the server device or not. The Wi Fi communication device is not connected to the access point A in the case where the Wi Fi communication device does not have settings of connection to the access point A or in the case where the Wi Fi communication device cannot receive radio waves transmitted from the access point A for example. Also the relay instruction information can be transmitted to the server device in the case where the alternative connection information is stored in the data storage area B and at least one of the Wi Fi communication device and the mobile communication device is connected to the Internet for example. On the other hand the relay instruction information cannot be transmitted to the server device in the case where the alternative connection information is not stored in the data storage area B or in the case where neither of the Wi Fi communication device and the mobile communication device is connected to the Internet for example.

When the relay instruction information can be transmitted to the server device S Yes the control program at S determines whether the account information contained in the alternative connection information in is identical to the latest account information illustrated in or not. The latest account information is account information which is stored into the relay instruction information in the most recent second processing. In the present embodiment the control program at S compares the user ID contained in the alternative connection information and the latest user ID contained in the latest account information with each other. The latest user ID is one example of a latest user identifier.

When the user ID contained in the alternative connection information differs from the latest user ID S No the control program at S executes the authentication processing for the user ID contained in the alternative connection information. Specifically the control program controls the display device to display the password input screen containing the user ID and controls the Wi Fi communication device to send the server device the authentication instruction information containing the user ID and a password input on the password input screen. The processing at S is the same as the authentication processing illustrated in except that the user ID is acquired from the alternative connection information.

The control program at S controls the Wi Fi communication device to transmit the relay instruction information to the server device and this flow ends. The relay instruction information is information for instructing the server device to receive the target data in the second format and execute the relay processing. For example the relay instruction information contains the target data selected at S the account information authenticated at S and the MAC address contained in the alternative connection information. Alternatively instead of the target data the relay instruction information may contain the location information stored in the storage server not shown which indicates the location of the target data. The control program stores the account information contained in the relay instruction information as the latest account information into the data storage area B. That is the latest account information illustrated in is overwritten. The processings at S S are one example of the second processing.

When the user ID contained in the alternative connection information and the latest user ID are identical to each other S Yes this flow goes to S without execution of the processing at S. Instead of the account information authenticated at S the control program at S controls the Wi Fi communication device to send the server device the relay instruction information containing the latest account information and this flow ends.

When the relay instruction information cannot be transmitted to the server device S No the control program at S determines whether the NFC flag associated with the Wi Fi connection information and the alternative connection information is ON or not. That is processings at S and subsequent steps are executed when both of the first processing and the second processing are inexecutable S S No .

When the NFC flag is ON S Yes the control program at S displays an approach instructing screen on the display device . The screen illustrated in is one example of the approach instructing screen. The approach instructing screen illustrated in is a screen for instructing the user to move the mobile terminal to a location at which the NFC communication device can receive the polling signal transmitted from the NFC communication device of the MFP . The location at which the NFC communication device can receive the polling signal is a location inside a sphere centered around the MFP and having the radius of about 10 cm for example. The processing at S is one example of a processing for indicating that the mobile terminal should be brought closer to the MFP until the MFP is located inside a communicable range of the NFC communication device .

When the NFC communication device has received the polling signal from the MFP located in the communicable range of the NFC communication device S Yes the control program at S is connected to the MFP through Wi Fi Direct. When the Wi Fi Direct connection is established the control program at S controls the Wi Fi communication device to transmit the recording instruction information to the MFP through the direct wireless connection. The recording instruction information is the same as that explained at the processing in S. The processings at S S will be hereinafter referred to as third processing .

Specifically the NFC communication device of the MFP is performing the Poll operation. The NFC communication device of the mobile terminal is performing the Listen operation at least while the approach instructing screen is displayed on the display device . When the NFC communication device has received the polling signal from the NFC communication device S Yes the control program controls the NFC communication device to acquire connection information from the MFP and use the connection information to establish connection with the MFP through Wi Fi Direct. For example the NFC communication device operating in the R W mode writes the connection information into an IC chip of the NFC communication device operating in the CE mode. The connection information is information which is required for connection through Wi Fi Direct. Examples of this connection information include an SSID Service Set Identifier and an encryption key.

When the MFP is the GCP enabled device S Yes the control program at S executes the registration processing and this flow ends. The registration processing at S is the same as the registration processing at S except that the registration instruction information and the registration completion information are transmitted and received between the MFP and the mobile terminal through the direct wireless connection. When the MFP is not the GCP enabled device S No this flow ends without execution of the processing at S. It is noted that the determination of whether the MFP is the GCP enabled device or not may be made based on the GCP flag acquired from the MFP via the Wi Fi communication device through the direct wireless connection.

When the NFC flag is OFF S No the control program at S displays an error screen on the display device . The screen illustrated in is one example of the error screen. The error screen illustrated in contains an OK button and a message indicating a failure of a print processing. The processing at S is one example of a processing for indicating that the recording operation for the target data is inexecutable. When the operation device has accepted a user operation of tapping on the OK button this flow ends.

Having received the relay instruction information from the mobile terminal the server device converts the format of the target data from the second format to the first format and sends the MFP the recording instruction information for instructing the MFP to perform the recording operation based on the target data in the first format. It is noted that when the relay instruction information contains the target data in the second format the server device converts the format of the target data from the second format to the first format. When the relay instruction information contains the location information of the target data on the other hand the server device receives the target data indicated by the location information and converts the format of the received target data from the second format to the first format. Also when a combination of the account information and the MAC address stored in the relay instruction information has been registered the server device transmits the recording instruction information to the MFP identified by the MAC address.

When the MFP has received the recording instruction information from the mobile terminal or the server device via the Wi Fi communication device the control program of the MFP controls the printing device to perform the recording operation based on the target data in the first format. It is noted that when the recording instruction information contains the target data in the first format the control program controls the printing device to perform the recording operation based on the target data. When the recording instruction information contains the location information of the target data the control program receives the target data indicated by the location information and control the printing device to perform the recording operation based on the target data.

In the above described embodiment the first processing is executed when the MFP and the mobile terminal are connected to the same wireless LAN and the second processing is executed when the MFP and the mobile terminal are not connected to the same wireless LAN . Also when neither of the first processing and the second processing is executable the third processing is executed. That is the recording instruction information is transmitted to the MFP through an appropriate communication path depending on the current communication environment of the mobile terminal . With this configuration the MFP can be caused to perform the recording operation according to the recording instruction information without complicated operations required of the user of the mobile terminal .

It is noted that the order of priority of the first processing the second processing and the third processing is not limited to that in the above described embodiment. For example the recording system may be configured such that the second processing is executed when an input of the recording instruction is received by the operation device in a state in which the operation device can perform wireless communication with the server device and the first processing is executed when an input of the recording instruction is received by the operation device in a state in which the operation device cannot perform wireless communication with the server device . In this configuration the recording system may be configured such that the GCP connection information illustrated in is used in the second processing and the alternative connection information illustrated in is used in the first processing. Furthermore when neither of the first processing and the second processing is executable the third processing is executed as in the above described embodiment.

The control program may use higher priority processing information to determine which processing is given a higher priority among the first processing and the second processing. A method of acquiring the higher priority processing information is not limited in particular. For example the higher priority processing information may be acquired from the user via the operation device and a most recently executed one of the first processing and the second processing may be acquired as the higher priority processing information. The processing for acquiring the higher priority processing information is one example of an acquisition processing. Hereinafter one of the first processing and the second processing which is indicated by the higher priority processing information will be referred to as higher priority processing and the other as alternative processing .

The control program may execute the higher priority processing when the higher priority processing is executable and execute the alternative processing when the higher priority processing is not executable. Specifically in the case where the higher priority processing information indicates the first processing the control program determines whether the first processing is executable or not. The control program executes the first processing when the first processing is executable and executes the second processing when the first processing is not executable. In the case where the higher priority processing information indicates the second processing on the other hand the control program determines whether the second processing is executable or not. The control program executes the second processing when the second processing is executable and executes the first processing when the second processing is not executable.

In the above described embodiment the Wi Fi button is tapped in the collecting processing whereby the Wi Fi connection information the alternative connection information and the NFC flag illustrated in are collected. Likewise the GCP button is tapped in the collecting processing the GCP connection information the alternative connection information and the NFC flag illustrated in are collected together. As thus described information required for the alternative processing is also collected when information required for the higher priority processing is collected. The required information can be collected without complicated operations required of the user of the mobile terminal .

In the above described embodiment when acquiring the account information the control program acquires the user ID from the OS or the data storage area B and acquires the password from the user via the password input screen. This configuration can save a user having the privilege the input of the user ID and prevent a user not having the privilege from using the mobile terminal to execute the second processing.

It is noted that the processing at S and the processings at S S in the collecting processing may be replaced with each other and may be both executed at their respective timings. For example the control program may execute the processings at S S first and execute the processings at S S when a desired device is displayed on the registered device selection screen and execute the processing at S when no desired device is displayed on the registered device selection screen.

In the MFP or the mobile terminal in each embodiment the CPU execute various programs stored in the program storage areas A A of the respective storage devices to execute processings to be executed by the controller. However the configuration of the controller is not limited to this configuration. For example the controller may be partly or entirely configured by hardware such as an integrated circuit IC .

The present invention is achieved by the MFP or the mobile terminal in the above described embodiment but may be achieved by programs for causing the MFP or the mobile terminal to execute processings. The programs may be stored in a non transitory storage medium. Examples of the non transitory storage medium include in addition to a CD ROM and a DVD ROM a storage device mounted on a server device connectable to the MFP or the mobile terminal over the communication network. The programs stored in the storage device of the server device may be distributed as information or signals representing the programs over the communication network such as the Internet.

