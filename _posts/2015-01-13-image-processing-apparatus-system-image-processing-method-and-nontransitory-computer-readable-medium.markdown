---

title: Image processing apparatus, system, image processing method, and non-transitory computer readable medium
abstract: An image processing apparatus includes a first memory, a reception unit, a storage controller, and an image processing executing unit. The first memory temporarily stores data and the data reading and writing speed of the first memory is higher than that of a second memory. The reception unit receives instruction data indicating the content of image processing that is directed. The storage controller stores the received instruction data in the first memory if an attribute of the received instruction data meets a predetermined condition and, otherwise, stores the received instruction data in the second memory. The image processing executing unit executes the image processing indicated by the stored instruction data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09258449&OS=09258449&RS=09258449
owner: FUJI XEROX CO., LTD.
number: 09258449
owner_city: Tokyo
owner_country: JP
publication_date: 20150113
---
This application is based on and claims priority under 35 USC 119 from Japanese Patent Application No. 2014 193651 filed Sep. 24 2014.

The present invention relates to an image processing apparatus a system an image processing method and a non transitory computer readable medium.

According to an aspect of the invention there is provided an image processing apparatus including a first memory a reception unit a storage controller and an image processing executing unit. The first memory temporarily stores data and the data reading and writing speed of the first memory is higher than that of a second memory. The reception unit receives instruction data indicating the content of image processing that is directed. The storage controller stores the received instruction data in the first memory if an attribute of the received instruction data meets a predetermined first condition and otherwise stores the received instruction data in the second memory. The image processing executing unit executes the image processing indicated by the stored instruction data.

An entire configuration hardware configurations and a functional configuration of an information processing system according to exemplary embodiments will herein be described with reference to to .

The communication line is a system for communication and includes at least one of for example the Internet a mobile communication network and a telephone line. The communication line mediates the communication between the apparatuses connected to the communication line . The information processing apparatus and the communication device are connected to the communication line . The communication device has a communication function and performs wireless communication according to a wireless local area network LAN standard in the present exemplary embodiment. The communication device performs the wireless communication with each user apparatus and communicates with the information processing apparatus via the communication line . In other words the information processing apparatus communicates with the user apparatus via the communication line and the communication device .

The information processing apparatus performs for example an image forming process to form an image on a medium and an image reading process to read an image formed on a medium. These processes are executed when the copy function the scan function the FAX function the print function or the like described above is provided to the user. The information processing apparatus includes an operation apparatus used to operate the information processing apparatus . The operation apparatus is an apparatus to operate the information processing apparatus and is a so called control panel. The operation apparatus is fixed to a housing of the information processing apparatus and is used by the user who is at the position where the information processing apparatus is placed. The operation apparatus includes for example a liquid crystal display and displays an image to operate the information processing apparatus such an image is hereinafter referred to as an operation image . The operation image will now be described with reference to .

Referring back to each user apparatus is for example a tablet terminal or a personal computer. The user apparatus may be carried by the user for usage or may be placed on a desk for usage. The user apparatus is not limitedly used for the operation of the information processing apparatus and may be used for other applications for example a business in a company . The user apparatus is similar to the operation apparatus in that the user apparatus displays the operation image and in response to an operation based on the displayed operation image requests the information processing apparatus to execute the process corresponding to the operation.

Upon execution of the process in response to the request from the operation apparatus or the user apparatus the information processing apparatus transmits information indicating the status of the process that is being executed such information is hereinafter referred to as status information to the operation apparatus or the user apparatus to notify the operation apparatus or the user apparatus of the status of the process. The status information indicates the number of media from which images are read the number of media on which images are formed and so on for example when the copy function is used.

When the copy process advances and the copying of the requested number of copies is completed the information processing apparatus transmits status information C. The status information C includes number information C indicating that the copying of the requested number of copies is completed a character string Copy is completed. and so on as illustrated in . The number information C and the number information C are each represented by a fraction using the requested number of copies as a denominator and the number of copies for which the copying is completed as a numerator. As described above the status information includes the information indicating the progress of the process the information indicating the result of the process the information about the parameters used for the process and so on. Each of the operation apparatus and the user apparatus is also a display apparatus that displays the status that is indicated in the manner illustrated in . When the operation apparatus and the user apparatus are not discriminated from each other the operation apparatus and the user apparatus are each hereinafter referred to as a display apparatus .

The storage unit includes for example a hard disk drive and stores data and programs used by the control unit for control image data and so on. The communication unit is a communication unit including a communication circuit and an antenna for performing the wireless communication according to the wireless LAN standard. The communication unit performs the wireless communication with for example the communication device illustrated in . The display unit includes for example a liquid crystal display. The display unit displays an image on a display screen under the control of the control unit . For example when the user apparatus is the tablet terminal the operation unit includes a touch sensor also referred to as a touch screen or a touch panel superposed on the display screen and buttons provided on the housing. Upon reception of an operation such as a tapping by the user the operation unit supplies operation data indicating the content of the operation to the control unit . When the user apparatus is the personal computer the operation unit may include a keyboard and a mouse. The control unit performs the control in accordance with the operation data that is supplied.

As described above when the operation apparatus and the user apparatus are not discriminated from each other the operation apparatus and the user apparatus are each referred to as the display apparatus . In association with this when it is not necessary to discriminate the control unit and the control unit from each other the control unit and the control unit are each referred to as a control unit . When it is not necessary to discriminate the storage unit and the storage unit from each other the storage unit and the storage unit are each referred to as a storage unit . When it is not necessary to discriminate the display unit and the display unit from each other the display unit and the display unit are each referred to as a display unit . When it is not necessary to discriminate the operation unit and the operation unit from each other the operation unit and the operation unit are each referred to as an operation unit . 

The image reading unit performs the image reading process to read out an image drawn on a document using for example a charge coupled device CCD method. The image reading unit optically reads out an image of content formed on a medium such as a sheet of paper and supplies the image data representing the image that is read out to the control unit . The image forming unit performs the image forming process to form an image on a medium using for example an electrophotographic method. The image forming unit forms an image indicated by the image data supplied from the control unit on a medium such as a sheet of paper. The method used for reading out an image and the method used for forming an image are only examples and other methods may be used.

The first communication unit includes a communication circuit for performing the communication according to the wired LAN standard and a port for receiving a connector of a communication cable LAN cable . The first communication unit performs a communication process to communicate with an apparatus connected via the cable. The first communication unit is connected to the communication line illustrated in and communicates with for example the user apparatus via an external apparatus the external apparatus for the information processing apparatus for example the communication device . The first communication unit is also connected to the communication unit in the operation apparatus via the communication cable and communicates with the operation apparatus not via the external apparatus described above. In other words the communication unit also communicates with the information processing apparatus not via the external apparatus described above.

The second communication unit includes a communication circuit for performing FAX communication and executes a process to exchange FAX data that is a FAX communication process. The connection unit includes for example a slot to which a storage medium such as a secure digital SD memory card is connected and is connected to the storage medium using the slot. The control unit reads out data stored in the storage medium and writes data to the storage medium via the connection unit . The operation apparatus has the configuration described above with reference to and communicates with the first communication unit . The operation apparatus performs the communication with the first communication unit and thus functions as for example the UI unit which displays an image indicated by the data transmitted from the control unit and transmits the data to operate the information processing apparatus to the control unit .

In the example in the control unit or the control unit and the first communication unit in the information processing apparatus are examples of the reception unit the storage controller and the image processing executer . A RAM in the control unit is an example of the first memory . The storage unit or the storage medium a memory card an SD card etc. connected to the connection unit is an example of the second memory and the third memory .

In the present exemplary embodiment the presentation layer that is the display apparatus communicates with the interface that is the information processing apparatus according to a World Wide Web WWW hereinafter referred to as a Web standard. In the example in the presentation layer communicates with the interface according to Hypertext Transfer Protocol HTTP and WebSocket.

When the display apparatus is the user apparatus the information processing apparatus and the user apparatus that is the interface and the presentation layer exchange data via the communication line and the communication device as described above with reference to . Specifically in this case the communication is performed via communication devices that are not the information processing apparatus and the user apparatus for example the communication device and a communication device of the communication line hereinafter referred to as other communication devices . In contrast when the display apparatus is the operation apparatus the information processing apparatus and the operation apparatus that is the interface and the presentation layer exchange data via the cable connected to the first communication unit described above with reference to . Specifically in this case the communication is performed not via the other communication devices. The other communication devices include for example a router and a hub of the communication line and a bridge in addition to the communication device . Even when the communication line does not have the router and so on the other communication devices at least include the communication device .

The presentation layer realized by the operation apparatus and the user apparatus realizes a function to receive an operation by the user a so called user interface . The presentation layer includes a UI control portion a device control portion and a communication portion . The UI control portion is a portion that controls the user interface. The UI control portion displays the operation image and or the status information described above which is transmitted from the interface that is the information processing apparatus in the display unit and receives an operation by the user in accordance with the data supplied from the operation unit . Specifically for example the UI control portion displays the status information C and the status information C illustrated in and respectively. Other examples of the status information will now be described with reference to and .

The UI control portion transmits a request for the operation image hereinafter referred to as an operation image request to the interface of the information processing apparatus for example in response to an operation to access a uniform resource locator URL of the information processing apparatus by the user. In addition the UI control portion displays the operation image indicated by data representing the operation image hereinafter referred to as operation image data which is transmitted from an operation image management portion in the information processing apparatus as a response to the transmitted operation image request in the display unit . More specifically the UI control portion displays the operation image on the basis of the parameters of the arrangement the size and so on of the operation image indicated by the operation image data. The operation images displayed in the above manner correspond to for example the operation image group A illustrated in .

Referring to the operation image group A includes operation images A to A used by the user to select the parameters including the magnification of the image to be copied the sheet on which the copied image is to be formed and the color mode of the copied image. The UI control portion displays images such images are hereinafter referred to as parameter transmission images to transmit to the user the content of the parameters selected by the user with the operations of the operation images. In the example in the parameter transmission images include an image B including a character string representing the magnification of the copy which is currently selected 110 in the example in and the operation images that represent the magnification of the copy the sheet and the color mode which are currently selected the operation images in which character strings Other magnifications A4 plain paper and monochrome are drawn in the example in and that are represented in a mode different from the mode of the operation images that are not selected in a mode in which the line is thickened in the example in a highlight mode or a mode using a radio button may be used .

The operation image group A includes the operation image A to start the copying. In response to an operation of the operation image A the function layer is requested to perform the copy process using the parameters selected at that time via the interface . An image used to determine the content which is requested of the information processing apparatus like the operation image A is hereinafter referred to as a content of request determining image. 

Referring back to the UI control portion supplies data concerning each operation image that is displayed to the device control portion . The data concerning the operation image is used to determine whether the operation image is operated. For example the data concerning the operation image indicates an area where the operation image is displayed such an area is hereinafter referred to as an operation image area . In addition the UI control portion supplies data concerning the displayed parameter transmission images to the device control portion . The data concerning the parameter transmission images indicates the content of the parameters transmitted with the parameter transmission images.

The device control portion requests the function layer to execute the process via the interface on the basis of the operation by the user. In response to an operation of the operation image by the user the device control portion requests the information processing apparatus to execute the process corresponding to the operation by the user on the basis of the data supplied from the UI control portion . For example when the user taps the touch sensor of the operation unit the device control portion determines whether the tapped position is included in the operation image area on the basis of the data supplied from the UI control portion . If the device control portion determines that the tapped position is included in the operation image area the device control portion accepts the operation of the operation image displayed in the operation image area.

When an operation of the content of request determining image described above an operation of the operation image A in the example in is accepted the device control portion requests the information processing apparatus to execute the process indicated by the content of request determining image using the parameters indicated by the data concerning the parameter transmission images supplied from the UI control portion . When the operation of the operation image A is performed in the state illustrated in the device control portion requests the information processing apparatus to execute the monochrome copy on the A4 plain paper at a magnification of 110 .

In the above example the device control portion generates the instruction data in which an instruction to execute the process corresponding to the content of request determining image that is operated the copy process in the example in using the parameters transmitted with the parameter transmission images is described such instruction data is hereinafter referred to as directions . In the present exemplary embodiment data described in Extensible Markup Language XML hereinafter referred to as XML data is used as the directions. The device control portion generates an HTTP request including the generated XML data. The device control portion transmits the generated HTTP request to the interface and requests the function layer to execute the process. The HTTP request transmitted to the interface by the device control portion to request the process is hereinafter referred to as a process request. Although the process request including the directions is generated when the copy process is requested the directions may not be included in the process request depending on the process that is requested. For example when a process to turn off the information processing apparatus is requested the directions are not included in the process request.

The communication portion controls the communication between the interface and the UI control portion and device control portion .

The interface is a layer that realizes a function to intermediate the connection between the presentation layer and the function layer . The connection between the presentation layer and the interface may be performed via the external apparatus such as the communication device illustrated in having the communication function the connection to the user apparatus or may be performed not via the external apparatus the connection to the operation apparatus . The interface intermediates the communication with the user apparatus and the operation apparatus according to a common communication procedure a communication procedure according to for example the HTTP or the WebSocket . For example the interface receives the HTTP request transmitted from the presentation layer to supply the HTTP request to the function layer or receives an HTTP response to the HTTP request supplied from the function layer to transmit the HTTP response to the presentation layer .

The function layer is a layer that realizes a function such as the copy function or the scan function to process data for a desired application. The function layer includes a reception and response portion an event notification portion the operation image management portion an operation image database DB and a function portion that provides the copy function the scan function and so on.

The reception and response portion receives the process request transmitted from the presentation layer via the interface and requests the function portion to execute the process. At this time the reception and response portion issues a transaction identifier ID as information for identifying the requested process. In addition the reception and response portion issues a client ID as information for identifying the requester the display apparatus of the process. The reception and response portion stores the transaction ID and the client ID which are issued and the communication destination of the display apparatus which is the requester in the storage unit in association with each other. The reception and response portion supplies the issued transaction ID to the function portion when the reception and response portion requests the process of the function portion . In addition the reception and response portion transmits a response to the received request to the presentation layer via the interface . The response may only indicate that the request is received or may include the status information.

The event notification portion generates the XML data including the status information and includes the generated XML data in the data according to the WebSocket to transmit the XML data included in the data according to the WebSocket to the presentation layer via the interface .

In the present exemplary embodiment the function layer and the presentation layer transmit the request the response or the notification using roughly four methods. A first method and a second method use the HTTP and are performed by the reception and response portion . A third method uses both the HTTP and the WebSocket protocol and is performed by cooperation of the reception and response portion and the event notification portion . A fourth method uses the WebSocket protocol to transmit the notification and is performed by the event notification portion .

In the first method upon reception of the process request the HTTP request from the presentation layer the reception and response portion waits for completion of the execution of the process by the middleware layer and the hardware layer . In this case upon notification of the completion of the process from the middleware layer the reception and response portion transmits the HTTP response including the status information indicating the status when the process is completed to the presentation layer from which the process has been requested. Specifically for example when a operation image A or a operation image A in the Select magnification field in is operated by the user a process to decrease or increase the parameter of the magnification of the copy is requested from the presentation layer . In response to the request for the process the reception and response portion transmits the response including the value of the parameter which is varied as the result of the execution of the requested process to the presentation layer .

In the second method upon reception of the process request the HTTP request from the presentation layer the reception and response portion transmits the response the HTTP response indicating that the process request is received without waiting for completion of the requested process. Then the status information is acquired by the presentation layer through so called polling according to the HTTP. Specifically upon reception of a request for notification of the status of the process hereinafter referred to as a notification request from the presentation layer the reception and response portion transmits the response to the notification request. When the response is transmitted with the second method for example the number information C illustrated in is indicated not each time the copied image is formed on the medium but each time the polling is performed for display. Accordingly for example the number of pages may be incremented not by one but by multiple pages.

As described above when the first method and the second method are used the reception and response portion transmits the response to the request upon reception of the request the process request or the notification request from the presentation layer . Specifically the reception and response portion transmits the result of the process as the response to the process request to the presentation layer which is the requester when the first method is used. The reception and response portion transmits the result of the process and the statuses of other processes as the response to the notification request received after the response to the process request to the presentation layer which is the requester when the second method is used.

In the third method upon reception of the process request the HTTP request from the presentation layer the reception and response portion transmits the response the HTTP response indicating that the process request has been received without waiting for completion of the requested process as in the second method. Then upon occurrence of the status to be notified in the process that is being executed by the middleware layer and the hardware layer the event notification portion transmits the message the notification including the status information indicating the status to the presentation layer according to the WebSocket protocol even with no notification request. In other words the status notified with the third method is the status of the process executed in response to the process request. In the transmission of the notification with the third method for example the Number of pages in the number information C illustrated in is incremented each time the copied image is formed on the medium.

In the fourth method upon occurrence of the status to be notified the event notification portion transmits the message the notification including the status information indicating the status to the presentation layer according to the WebSocket protocol even with no notification request regardless of the presence of the process request from the presentation layer . In other words the status notified with the fourth method is not related to the process executed in response to the process request. For example any presentation layer the session of which with the information processing apparatus is established according to the WebSocket standard may be the notification destination in the fourth method. In the information processing system the status such as out of toner out of sheet or open container the state in which the container storing the media such as the sheets is opened is defined so as to be notified with the fourth method. The status notified with the fourth method may be varied with the presentation layer the display apparatus which is the notification destination.

As described above when the third method and the fourth method are used the event notification portion actively performs the notification performs so called push type notification regardless of the presence of the requests the process request and the notification request from the presentation layer . The event notification portion notifies the presentation layer of the result of the process and the statuses of other processes after the response to the process request when the third method is used and notifies the presentation layer of the status of a predetermined process when the fourth method is used.

When the second method and the third method are used the reception and response portion or the event notification portion transmits the result of the process and the statuses of other processes after the response to the process request. The three methods the first to third methods are methods to notify the presentation layer of the status of the requested process. In the present exemplary embodiment the presentation layer specifies the method that is any of the first to third methods of transmitting the status of the process including the result of the process when the presentation layer submits the request for the process. For example the transmission method may be specified with the parameter included in the process request generated by the device control portion . The reception and response portion and the event notification portion transmit the response and or the notification using the method specified by the presentation layer .

In the present exemplary embodiment the status information is generated by the middleware layer and is supplied to the reception and response portion or the event notification portion . The status information may be generated by the function portion the reception and response portion or the event notification portion . The status information to be supplied to the event notification portion may be supplied to the event notification portion via the reception and response portion without being directly supplied from the middleware layer or the function portion to the event notification portion .

Referring back to the operation image management portion manages the operation image to be transmitted to the presentation layer . The operation image DB stores the operation image. The operation image management portion supplies the operation image described above to the presentation layer via the interface . The operation image management portion stores the operation image specifically the image data indicating the operation image and upon reception of the operation image request via the interface transmits the response including the operation image to the requester via the interface .

Upon reception of the operation image request from the user apparatus the operation image management portion transmits the operation image data to the user apparatus in response to the operation image request. Upon reception of the operation image request from the operation apparatus the operation image management portion transmits the operation image data to the operation apparatus in response to the operation image request. The operation image management portion transmits the operation image data to the requesters the user apparatus and the operation apparatus of the operation image in the above manner to supply the operation image to the requesters.

The function portion is a module group for realizing the functions provided to the user by the information processing apparatus . Upon reception of the process request from the presentation layer via the interface the function portion in the information processing apparatus causes the middleware layer to execute the process requested with the process request.

The function portion analyzes for example the directions included in the process request and causes the middleware layer to execute the process in accordance with the content of the instructions that are analyzed. Specifically the function portion causes the middleware layer to execute the directed process for example the copy process with the directed parameters. The middleware layer reads out an image from the medium for example with the image quality and the reading method set with operations by the user and forms the image that is read out in the output format at the magnification on the sheet and in the color mode set with operations by the user.

The function portion supplies the transaction ID supplied from the reception and response portion to the middleware layer when the function portion instructs the middleware layer to execute the process. The middleware layer supplies the transaction ID to the reception and response portion along with the status information described above.

The function portion analyzes the description specifying the method any of the first to third methods described in the process request and transmits the analyzed method that is the method specified by the display apparatus to the reception and response portion . The reception and response portion or the event notification portion transmits the XML data in which the status information supplied with the transaction ID is described to the communication destination associated with the transaction ID supplied from the function portion according to the transmitted method. The reception and response portion or the event notification portion transmits the status of the process to the requester of the process using the specified method in the above manner. The function portion may only supply the process request to the reception and response portion and the reception and response portion may analyze the specified notification destination.

The middleware layer is a layer that executes a general purpose process between the function layer and the hardware layer . The hardware layer is a layer that physically realizes for example the image reading process and the image forming process. The middleware layer and the hardware layer execute the various processes including the scan process the FAX process and the print process the processes to provide the scan function the FAX function and the print function respectively in addition to the copy process described above. The copy process includes the image reading process by the image reading unit illustrated in and the image forming process by the image forming unit illustrated in . The scan process includes the image reading process. The FAX process includes the FAX transmission process by the second communication unit . The print process includes the communication process by the first communication unit and the image forming process. The scan process and the FAX process also include for example a data communication process using the second communication unit a writing process to write data to the storage unit and a reading process to read out data that is stored from the storage unit depending on the method of acquiring the data and the method of outputting the data. Upon execution of the process the middleware layer and the hardware layer supply the status information the information indicating the status of the process that is being executed to the function layer .

At least one of the reception and response portion the event notification portion the operation image management portion the function portion the middleware layer and the hardware layer illustrated in is an example of the reception unit the storage controller and the image processing executer illustrated in .

Exemplary operations performed by the respective apparatuses in the transmission of the status information using the four methods the first to fourth methods described above will now be described with reference to to .

In Step S the middleware layer executes the specified process that is updates the parameter in cooperation with the hardware layer . In Step S the middleware layer supplies the information indicating the result of the process to the reception and response portion as the status information. In Step S the reception and response portion generates the XML data in which the supplied status information the result of the update of the parameter in the example in is described. In Step S the reception and response portion transmits the HTTP response including the generated XML data to the display apparatus which is the requester of the process. In Step S the control unit in the display apparatus displays the status information included in the transmitted HTTP response in the display unit in the display apparatus .

In Step S the reception and response portion instructs the middleware layer to execute the copy process on the basis of the interpreted content. In Step S the middleware layer and the hardware layer cooperatively execute the process based on the directed content the copy process . After instructing the middleware layer to execute the copy process in Step S the reception and response portion transmits the HTTP response indicating that the request for the copy process is received to the display apparatus as the response to the HTTP request received in Step S. In Step S the control unit in the display apparatus displays the content corresponding to the received HTTP response in the display unit in the display apparatus . Step S may be executed before Step S or Step S.

In the second method the notification of the process status in response to the process request from the display apparatus and the notification of the completion of the process are acquired by the display apparatus through the polling with the HTTP request. After receiving the response to the request for the copy process in Step S the control unit in the display apparatus transmits the notification request the HTTP request requesting the notification of the status of the copy process and thus performs the polling. If the status information about the copy process is not supplied in Step S the reception and response portion in the information processing apparatus transmits the HTTP response indicating that the status information about the copy process is not supplied to the display apparatus . Step S and Step S are repeatedly executed.

In Step S the middleware layer in the information processing apparatus detects output of the copy the image indicating the document that is read out on the medium. In Step S the middleware layer in the information processing apparatus supplies the status information indicating the status in which the copy is output on the medium to the reception and response portion . After the status information is supplied in Step S the reception and response portion receives the notification request the HTTP request . In Step S the reception and response portion generates the HTTP response including the status information. In Step S the reception and response portion transmits the generated HTTP response to the display apparatus . In Step S the control unit in the display apparatus displays the content corresponding to the HTTP response in the display unit in the display apparatus as in Step S.

The operation illustrated in is started in response to the operation to start the copying by the user as in the example illustrated in . Referring to in Step S the control unit in the display apparatus receives the operation to start the copying. The control unit in the display apparatus executes a process to establish the WebSocket session with the information processing apparatus . Specifically the control unit transmits the HTTP request which is a WebSocket handshake request to the information processing apparatus . The HTTP request includes the client ID for identifying the display apparatus .

The interface in the information processing apparatus switches to the WebSocket on the basis of the HTTP request received from the display apparatus . In Step S the reception and response portion transmits a WebSocket handshake response to the display apparatus to establish the WebSocket session hereinafter simply referred to as a session between the display apparatus and the information processing apparatus . The timing when the session is established is not limited to the above timing. For example the establishment of the session may be performed at timing when the user starts a Web browser using the display apparatus to perform an operation to access the URL of the information processing apparatus .

The reception and response portion stores the client ID included in the received HTTP request in a predetermined area hereinafter referred to as a cache area in the storage unit . The client ID stored in the cache area is deleted from the cache area when the session is normally disconnected. In other words the client ID of the display apparatus that is establishing the session with the information processing apparatus and the client ID of the display apparatus the session of which is disconnected during the process are accumulated in the cache area

In Step S and the subsequent steps the display apparatus and the information processing apparatus exchange messages using the HTTP or the WebSocket protocol. When it is not necessary to discriminate between the messages transmitted and received using the HTTP and the messages transmitted and received using the WebSocket protocol the messages transmitted and received using the HTTP and the messages transmitted and received using the WebSocket protocol are simply referred to as messages for description. The reception and response portion in the information processing apparatus stores the message which the information processing apparatus has transmitted in the cache area along with the client ID the transaction ID and a sequence ID added to the message. The sequence ID is identification information for identifying the message. The control unit in the display apparatus stores a pair of the transaction ID and the sequence ID added to the message received by the display apparatus in a cache area hereinafter referred to as a cache area in the display apparatus . The cache area may be provided in the storage unit or may be provided in the RAM. The pair of the transaction ID and the sequence ID stored in the cache area is referred to for example when the session is disconnected during the process.

Referring back to upon establishment of the WebSocket session in Step S the control unit transmits the HTTP request including the XML data in which the application of the third method described above is described to the information processing apparatus . Upon reception of the HTTP request in Step S the reception and response portion in the information processing apparatus transmits the content of the application described in the XML data included in the received HTTP request to the middleware layer . In Step S the middleware layer receives the transmitted application and makes settings to subsequently transmit the status information using the third method to the display apparatus . The middleware layer turns on for example a flag indicating whether the notification is made using the third method.

Then Steps S to S and Steps S and S illustrated in are performed. Then in Step S the middleware layer and the hardware layer in the information processing apparatus detect output of the copy. In Step S the middleware layer and the hardware layer in the information processing apparatus supply the status information indicating the status in which the copy is output on the medium not to the reception and response portion but to the event notification portion because the above flog is turned on. In Step S the event notification portion generates the XML data in which the supplied status information the number of copies etc. is described. In Step S the event notification portion transmits the generated XML data to the display apparatus via the WebSocket session established in Step S. In Step S the control unit in the display apparatus displays the content for example the status information C illustrated in described in the received data in the display unit in the display apparatus .

In Step S the middleware layer and the hardware layer complete the copy process. In Step S the middleware layer and the hardware layer supply the status information indicating that the copy process is completed to the event notification portion . In Step S the event notification portion generates the XML data in which the status information is described for example the XML data including a character string Copy is completed. . In Step S the event notification portion transmits the generated XML data which is included in the WebSocket message to the display apparatus . In Step S the control unit in the display apparatus displays the content described in the XML data received in Step S for example the status information C illustrated in in the display unit in the display apparatus .

As described above different display apparatuses may be notified of different statuses. In such a case before Step S the control unit transmits the XML data in which the status to be indicated to the display apparatus is described to the information processing apparatus via the communication portion . The event notification portion which receives the XML data via the interface stores the status to be indicated to the display apparatus in association with the destination of the display apparatus . The event notification portion makes the notification of the status if the status information supplied in Step S indicates the status to be indicated which has been stored to the display apparatus .

An example of an operation to store the directions and an operation to execute the directed image processing by the information processing apparatus will now be described. In this example the user sets a document in the image reading unit in the information processing apparatus and performs an operation to cause the display apparatus to start the copying. Upon reception of the operation to start the copying the control unit in the display apparatus creates the directions the XML data corresponding to the received operation. In this example the image forming unit creates the directions in a first data format or a second data format.

In the examples in the first data format is a format in which one piece of image processing or the flow of a series of multiple pieces of image processing is described. Specifically for example the directions specifying a series of pieces of processing to perform a character recognition process for image data that is scanned and store the data indicating the result of the character recognition process in multiple external storages are created in the first data format. In contrast the second data format is a format in which one piece of image processing for example the copy process is specified. It is not possible to describe the flow of the series of multiple pieces of image processing in the second data format.

If the process specified by the user includes multiple pieces of image processing the control unit creates the directions in the first data format indicating the specified process. If the process specified by the user does not include multiple pieces of image processing the control unit creates the directions in the first data format or the second data format.

Upon reception of the HTTP request from the display apparatus the control unit in the information processing apparatus interprets the directions included in the received HTTP request and thus interprets the content of the instructions. First the control unit determines whether the received directions are described in the first data format or the second data format. In this example the control unit identifies the format of the directions on the basis of whether a value indicating the second data format is set in a predetermined header area in the received directions. The image processing directed by the directions described in the second data format is called standard processing and the image processing directed by the directions described in the first data format is called flow processing in the following description for convenience. In this example the data size of the directions of the flow processing is often larger than that of the directions of the standard processing.

Since the reading and writing speed of data in the RAM is higher than that in the storage unit in the information processing apparatus the RAM is used as a general rule and the RAM is continued to be used until the free space of the RAM is smaller than or equal to a predetermined size. When the free space of the RAM is made smaller than or equal to the predetermined size the data is stored in the storage unit . However if predetermined directions are received the data is stored in the RAM even if the free space of the RAM is smaller than or equal to the predetermined size. The predetermined directions direct for example a preferably set process or a process in which the size of the directions may possibly be increased.

For example when the size of the directions is variable because delivery is included in the directed image processing and multiple destinations are selectable the size of the directions may possibly be increased. Since the size of the directions may possibly be increased if the attribute of the directed image processing does not meet a predetermined condition even when the standard processing has been directed the received directions are stored in the RAM. The time required to read out the data is lengthened with the increasing size of the directions and this tendency is pronounced in the case in which the directions are stored in the storage unit compared with the case in which the directions are stored in the RAM. Accordingly the directions the size of which may possibly be increased are stored in the RAM as described above to cause the time required to read out the directions to be shortened compared with the case in which the directions are stored in the storage unit . In contrast if the attribute of the directed image processing meets the predetermined condition for example when the standard processing is directed and the free space of the RAM is sufficient the received directions are stored in the storage unit . The operation of the control unit when the directions are stored in the above manner will now be described with reference to the flowchart in .

Referring to in Step S the control unit determines whether the directed image processing is the standard processing or the flow processing. If the control unit determines that the directed image processing is the flow processing NO in Step S the process goes to Step S the directions are stored in the storage unit . If the control unit determines that the directed image processing is the standard processing YES in Step S the process goes to Step S. In Step S the control unit calculates the free space of the RAM. In Step S the control unit compares the free space of the RAM with a predetermined threshold value to determine whether the free space of the RAM is sufficient. If the control unit determines that the free space of the RAM is sufficient YES in Step S the process goes to Step S. If the control unit determines that the free space of the RAM is not sufficient NO in Step S the process goes to Step S.

In Step S the control unit identifies the type of the process directed by the directions. The identification may be performed with reference to the value of the predetermined header area in the directions. In Step S the control unit determines whether the identified type is a preferably set process type. Whether the identified type is a preferably set process type is based on reference by the control unit to a preferably set table stored in advance in the storage unit .

Referring back to if the type identified in Step S and the time zone including the current time are stored in the preferably set table in association with each other the control unit determines in Step S that the directed image processing is preferably set. If the type identified in Step S and the time zone including the current time are not stored in the preferably set table in association with each other the control unit determines in Step S that the directed image processing is not preferably set. If the control unit determines that the directed image processing is preferably set YES in Step S the process goes to Step S. If the control unit determines that the directed image processing is not preferably set NO in Step S the process goes to Step S.

In Step S the control unit determines whether the directed image processing is the process the size of the directions of which may possibly be increased. This determination is based on whether the type of the image processing is a predetermined type. If the control unit determines that the directed image processing is the process the size of the directions of which may possibly be increased YES in Step S the process goes to Step S. If the control unit determines that the directed image processing is not the process the size of the directions of which may possibly be increased NO in Step S the process goes to Step S. In Step S the control unit stores the received directions in a predetermined storage area of the storage unit . In Step S the control unit stores the received directions in the RAM. After Step S the process goes to Step S.

In Step S the control unit determines whether the image processing directed by the directions stored in the RAM in Step S is a process for which recovery is required. This determination may be based on for example whether the type of the image processing directed by the directions is a predetermined type. If the control unit determines that the image processing is a process for which the recovery is required YES in Step S the process goes to Step S. In Step S the control unit stores the copy of the directions stored in the RAM in the predetermined storage area of the storage unit . If the control unit determines that the image processing is a process for which the recovery is not required NO in Step S the process skips Step S and goes to Step S.

In Step S the control unit starts execution of the image processing directed by the directions in accordance with the directions stored in the storage unit or the directions stored in the RAM. More specifically the control unit interprets the content of the directions controls the image reading unit and or the image forming unit on the basis of the interpreted content and starts execution of the directed image processing for example the copy process . For example if the data stored in the RAM disappears for example when the information processing apparatus is turned off or due to power failure while the directed image processing is being executed the control unit restarts the execution of the image processing in accordance with the directions stored in the storage unit .

In the execution of the image processing using the directions it may take an extremely long time to start the execution of the image processing directed by the directions when all the received directions are stored in the storage unit or an externally connected storage medium for example a memory card . In the present exemplary embodiment at least part of the directions is stored in the RAM to suppress the lengthening of the time required to start the execution of the image processing.

In addition for example even if the information processing apparatus is configured so as not have the hard disk drive the storage of the directions in the RAM prevents the execution of the directed image processing from being disabled. In the present exemplary embodiment the copy of the directions of the process for which the recovery is required is stored in the storage unit . Accordingly the directed process is restarted by referring to the directions stored in the storage unit even if the data stored in the RAM disappears.

The exemplary embodiments described above are only examples and may be modified in the following manners. The exemplary embodiments described above and the modifications described below may be appropriately combined if needed.

The directions storage operation and execution operation in are exemplified in the above exemplary embodiments the directions storage operation is not limited to the one illustrated in as long as the control unit stores the received instruction data in the RAM if the attribute of the received instruction data the directions meets a predetermined condition and otherwise stores the received instruction data in the storage unit . In particular if at least one attribute of the content of the image processing directed by the received instruction data the free space of the RAM the parameters included in the instruction data the type of the data format of the instruction data and the time when the instruction data is received meets a predetermined condition the control unit may store the received instruction data in the RAM.

Although the control unit determines whether the recovery is required for the directions stored in the RAM and stores the copy of the directions in the storage unit if the control unit determines that the recovery is required in the above exemplary embodiments the copy of the directions may not be stored in the storage unit .

Although the control unit stores the received directions in the RAM or the storage unit in the above exemplary embodiments the directions may not be limitedly stored in the storage unit . For example the control unit may store the received directions in a storage medium for example an SD memory card connected to the connection unit instead of the storage unit . In particular if the information processing apparatus is configured so as not to have the storage unit the control unit stores the received directions in the RAM or the storage medium connected to the connection unit .

Although the user apparatus includes the communication unit that performs the wireless communication according to the wireless LAN standard in the above exemplary embodiments the user apparatus may not include the communication unit that performs the wireless communication according to the wireless LAN standard and for example may include a communication unit that performs the communication according to the wired LAN standard like the communication unit in the communication device . In this case the user apparatus is connected to the router or the hub of the wired LAN via the communication cable. The communication unit in the user apparatus in this case also functions as a communication unit that communicates with the other communication devices the router and the hub described above.

Although the first communication unit in the information processing apparatus communicates with the communication unit in the operation apparatus according to the wired LAN standard in the above exemplary embodiments the wired LAN standard is not limitedly used. For example the communication according to universal serial bus USB or High Definition Multimedia Interface HDMI registered trademark may be performed or the wireless communication according to the wireless LAN standard a Bluetooth registered trademark standard or near field communication NFC may be performed. In any of the above cases the communication unit in the operation apparatus communicates with the first communication unit in the information processing apparatus not via the other communication devices such as the router or the hub. As described above the communication unit in the operation apparatus functions as a communication unit that communicates with the information processing apparatus not via the other communication devices.

Although the information processing apparatus exchanges data with the display apparatus using the two communication protocols including the HTTP and the WebSocket in the above exemplary embodiments the communication protocols that are used are not limited to the above ones. The communication protocols used by the information processing apparatus and the display apparatus may include a first communication protocol used by the information processing apparatus the Web server to transmit the response to the request transmitted from the display apparatus the Web client and a second communication protocol for transmitting the notification from the information processing apparatus to the display apparatus .

The information processing apparatus may exchange data with the display apparatus according to Simple Object Access Protocol SOAP in the above exemplary embodiments. The protocol used by the information processing apparatus and the display apparatus for the exchange of data is not limited to the above one. The information processing apparatus may communicate with the display apparatus for example according to a Representational State Transfer REST standard or a Standard Generalized Markup Language SGML standard.

Although the operation apparatus includes the control unit the storage unit and the communication unit in the above exemplary embodiments as illustrated in the operation apparatus may not include the control unit the storage unit and the communication unit.

The communication unit and the UI unit are connected to a bus in the information processing apparatus to be controlled by the control unit . The communication unit is also connected to the first communication unit . The UI unit includes a display screen and a touch sensor superposed on the display screen. The UI unit receives an operation by the user and displays an image. The UI unit supplies the operation data corresponding to the received user s operation to the control unit and the control unit executes the process corresponding to the operation data. In this modification the control unit executes the programs of the browser to realize the functions of the display apparatus illustrated in .

Although the operation apparatus is fixed to the housing of the information processing apparatus in the above exemplary embodiments and the modification the operation apparatus may not be fixed. For example the operation apparatus which is not fixed to the housing of the information processing apparatus may be used as a remote controller.

The operation apparatus is connected to the first communication unit via a communication cable and is used by the user in a state in which the operation apparatus is mounted in the mounting portion. The operation apparatus is used as the local display apparatus communicating with the information processing apparatus not via the other communication devices like the operation apparatus in the above exemplary embodiments. The user may detach the cable from the operation apparatus and may carry the operation apparatus to another location for another application. In the example in instead of the operation apparatus another apparatus functioning as an operation unit for example the user apparatus illustrated in may be connected to the information processing apparatus . The operation apparatus may be connected to the communication device to cause the operation apparatus to communicate with the information processing apparatus via the communication device and the communication line .

Although the operations when the copy process is executed are descried in the above exemplary embodiments the process executed by the information processing apparatus is not limited to the copy process. The process executed by the information processing apparatus may be for example the image reading process or the image forming process described above.

Although the control unit receives the operation by the user with the touch sensor in the above exemplary embodiments the method of receiving the operation by the user is not limited to this. For example when the display apparatus is the tablet terminal the operation by the user may be received with the buttons provided on the housing. When the display apparatus is the personal computer the operation by the user may be received with the keyboard and or the mouse.

Although the event notification portion transmits the XML data conforming to the WebSocket standard in the above exemplary embodiments the transmission by the event notification portion is not limited to this. For example the event notification portion may keep the HTTP request transmitted from the UI control portion in the display apparatus using a technology called Comet and may transmit the status information as the response to the kept HTTP request upon occurrence of a message to be transmitted for example update of the status information . The status of the process is rapidly transmitted to the user with the method using Comet as in the above exemplary embodiments compared with the case in which the status information is transmitted as the response to the request from the operation apparatus.

The present invention may be embodied as an information processing method for realizing the processes executed by the information processing apparatus the display apparatus the communication device and the information processing system including these apparatuses in addition to the information processing apparatus the display apparatus the communication device and the information processing system including these apparatuses. The present invention may be embodied as a program causing computers of the information processing apparatus and the display apparatus to function as the units described above. The program may be provided in a mode of a recording medium such as an optical disk in which the program is stored. The program may be provided in a mode in which the program is downloaded to the computer via a communication line such as the Internet and is installed in the computer for usage.

The foregoing description of the exemplary embodiments of the present invention has been provided for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise forms disclosed. Obviously many modifications and variations will be apparent to practitioners skilled in the art. The embodiments were chosen and described in order to best explain the principles of the invention and its practical applications thereby enabling others skilled in the art to understand the invention for various embodiments and with the various modifications as are suited to the particular use contemplated. It is intended that the scope of the invention be defined by the following claims and their equivalents.

