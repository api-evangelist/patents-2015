---

title: Prediction of disk failure
abstract: Systems and methods are disclosed for predicting failure of a hard disk in a storage system. Embodiments are disclosed that predict failure of at least one hard disk in a storage system having a plurality hard disks. A data center reports to a data collection center than a hard disk has reported an initial non-zero medium error count (NMEC). The data collection center stores historic data of initial NMEC for many hard disks, and subsequent failure of those hard disks. From the historic data, the data collection center can report to the data center a prediction of when a hard disk reporting an initial NMEC may fail. Different models of hard disks fail at different times relative to a reported initial NMEC. The data collection center can track historic hard disk data by manufacturer, model of hard disk, and by model of storage system and thus can predict, by hard disk model, a probability of failure of a hard disk.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09612896&OS=09612896&RS=09612896
owner: EMC IP Holding Company LLC
number: 09612896
owner_city: Hopkinton
owner_country: US
publication_date: 20150824
---
Several known predictors of hard disk electromechanical failure include reallocated sectors reallocated event counts and current pending sector counts. Medium errors have not yet been studied as a predictor of disk failure rates.

When a physical problem is encountered when trying to read data from a hard disk and multiple read attempts fail the hard disk experiences a medium error. Medium errors can be classified as a real medium error or a head failure . A real medium failure indicates a marginal disk platter or a loss of proper magnetic properties. A head failure occurs when the read write header has deteriorated. Conditions that may cause such an error are external conditions e.g. dust physically harming the disk head imprecision in the physical write location or improper alignment. A sudden power failure may also cause a medium error but this is typically limited to one sector in most cases. Most medium errors are head failures or a defect on the magnetic medium.

Although reallocated sectors have been studied as predictors of disk failure not all medium errors result in reallocated sectors. Thus using reallocation of sectors as a predictor of disk failures is an incomplete method of predicting disk failures.

In the following detailed description of embodiments reference is made to the accompanying drawings in which like references indicate similar elements and in which is shown by way of illustration manners in which specific embodiments may be practiced. These embodiments are described in sufficient detail to enable those skilled in the art to practice the invention and it is to be understood that other embodiments may be utilized and that logical mechanical electrical functional and other changes may be made without departing from the scope of the present disclosure. The following detailed description is therefore not to be taken in a limiting sense and the scope of the present invention is defined only by the appended claims.

Embodiments are described for determining a probability that a hard disk will fail based upon a date and a count of an initial non zero medium error count NMEC reported for a hard disk. A data collection server can receive a customer report from a customer data center that one or more hard disks have reported an initial NMEC. The customer report can further include a manufacturer and model of each hard disk reporting an initial NMEC. A subsequent customer report from the customer data center can contain data indicating that one or more hard disks have failed. A data collection center can receive such customer reports from a wide customer base thereby generating a substantial body of data that can be analyzed to generate a probability of failure of a hard disk based at least in part on a date and initial NMEC of a hard disk. A hard disk can be a part of a storage system comprising numerous hard disks. In an embodiment the data collection center can generate a probability of failure that least one hard disk in a system of hard disks will fail based at least in part on a current NMEC of a plurality of hard disks. In an embodiment the data collection center can generate a probability of failure of a hard disk based at least in part on an initial NMEC and a manufacturer and model of the hard disk.

Some embodiments include one or more application programming interfaces APIs in an environment with calling program code interacting with other program code being called through the one or more interfaces. Various function calls messages or other types of invocations which further may include various kinds of parameters can be transferred via the APIs between the calling program and the code being called. In addition an API may provide the calling program code the ability to use data types or classes defined in the API and implemented in the called program code. At least certain embodiments include an environment with a calling software component interacting with a called software component through an API. A method for operating through an API in this environment includes transferring one or more function calls messages other types of invocations or parameters via the API.

A system for determining a probability of a disk failure in a storage system can include a plurality of customer data centers that can communicate with a data collection server via network .

A data collection server can receive customer reports from one or more customer data centers . A customer report can include a report of at least one hard disk that has incurred an initial non zero medium error count NMEC or has failed. A customer report can further include a unique identifier of a hard disk a manufacturer and model of a hard disk or a storage system manufacturer and model that the hard disk forms a part of.

Data collection server can be comprise a plurality of databases including a customer accounts database a customer reports database a disk and storage system models database a disk historical data database and a database of predictors of a probability that a hard disk will fail after receiving an initial NMEC.

Databases can be implemented on a computing system as described in below. Database s can be implemented using any database software such as Microsoft SQL Server Oracle IBM DB2 SAP Sybase and the like.

Customer database can include a unique customer identifier customer contact information a list of storage systems and or hard disks that the customer has installed at a customer data center . A customer report received by the data collection server can include the customer identifier. The customer report can include a storage system identifier of a storage system the customer has installed at the customer data center . The customer reports can further include an identifier of a hard disk that forms a part of the storage system. From the foregoing information the data collection center can look up the hard disk manufacturer and model so that the data collection center can record the hard disk manufacturer and model with along with the report of an initial NMEC or failure for the hard disk.

Customer reports database can include a date time stamp that a report was generated by the customer data center a date time stamp that the report was received by the data collection center a customer identifier a customer data center identifier a storage system identifier and a hard disk identifier so that the data collection server can generate records for the disk statistics database for a hard disk that is as specific as possible from the customer report.

A disk storage models database record can include a field for a storage system identifier that uniquely identifies particular instance of a storage system its manufacturer and the particular model of storage system e.g. EMC VNXe3200. Disk storage models database can further include records that identify particular models of hard disks e.g. Seagate ST1000DM003. Hard disk model records may include a field for a unique identifier of a hard disk the manufacturer of the hard disk and particular model of the hard disk.

A hard disk historic data database can store historic data about a plurality of hard disks. A hard disk record can be generated for the hard disk historic data database in response to parsing a customer report to obtain hard disk initial NMEC and failure information. In an embodiment a new record can be generated for each instance of a customer report for a hard disk. For example a record may be generated in the hard disk historic data database when a customer reports that a specific hard disk reports an initial NMEC. An additional record can be generated for the same hard disk if a subsequent report indicates that the NMEC for the hard disk has increased. Yet another record may be generated for the same hard disk if a subsequent report indicates that the hard disk FAILED. Alternatively or in addition a single record may be generated representing the life of a hard disk. The record can store the date and initial NMEC then be updated with the date of the failure of the hard disk when the failure is reported in a future customer report.

A predictors database can store records including probabilities of failure of a hard disk determined from historic hard disk data that can be used to determine a probability that a hard disk will fail given an initial NMEC and date of the initial NMEC. In an embodiment the probability that a hard disk will fail can be based at least in part on the manufacturer and model of hard disk that incurred the initial NMEC. Predictors can be generated by analyzing a selected set of historical data records from the disk historic data database .

A customer data center can include one or more client computers e.g. and connected to a storage system via network . Each client device e.g. and can be implemented using a computing system as described below with reference to . Similarly storage system can be implemented using a computing system as described below with reference to .

Storage system can be a primary storage or a backup storage comprising a plurality of storage units e.g. and . In an embodiment a storage unit can be a hard disk. In an embodiment a storage unit can comprise a plurality of hard disks. Storage system can include backup software and can further include diagnostic reporting module . Diagnostic reporting module can generate a customer report and transmit the customer report to the data collection server via network .

Storage system can include a bus or communication path that allows backup software and diagnostic reporting module to access the plurality of storage units e.g. and . Each storage unit may read and or write metadata and storage objects e.g. metadata and and storage objects and .

In an embodiment a storage layer can provide a first level of abstraction of the storage units e.g. and . In an embodiment the plurality of storage units may comprise a redundant array of independent disks RAID managed by a RAID layer over the storage layer . In an embodiment a file system can be a next higher level of abstraction implemented on the RAID layer and in turn upon the storage layer .

Storage layer can report a medium error count for a hard disk in a storage unit and whether a hard disk has failed. Diagnostic reporting module can receive the medium error count for the hard disk from the storage layer . In an embodiment RAID layer can report diagnostic information including whether a hard disk has failed medium error count reallocated sector count and other hard disk information via Self Monitoring and Analysis Reporting Technology S.M.A.R.T. .

As described above with reference to and a customer data center can include a plurality of storage systems each having a plurality of hard disks or storage units and . A diagnostic reporting module can generate customer reports that contain hard disk diagnostic data such as an initial non zero medium error count NMEC for a hard disk the date that the initial NMEC was detected and the status of the hard disk such as ALIVE or FAILED. The customer report can be transmitted to data collection server where the customer report can be stored in a customer reports database . The data collection server can parse the customer report into hard disk data and store data in database records . Customer reports can be transmitted by a customer data center on a periodic basis such as each day or upon detection of new or changed hard disk data. For example a customer report may be generated when an initial NMEC is detected for a particular hard disk. At a different date or time a customer report may be generated for the particular hard disk when it is detected that the hard disk has failed.

Data collection server can receive customer reports for a plurality of customer data centers from a plurality of different customers each having different storage systems and hard disks distinct from other customers or customer data centers.

Referring to a first database record for a hard disk can indicate a date time that the hard disk incurred an initial NMEC and a count of the initial NMEC for the hard disk. Additionally the status ALIVE may be recorded for the hard disk. At a later time a next database record may record that the hard disk is still alive and the NMEC for the hard disk has increased to 6. At a still later time a third database record may record that the hard disk NMEC increased to 7 and the disk status has changed to FAILED. Also shown in two other records and have been generated from one or more customer reports indicating a respective date time that each hard disk incurred an initial NMEC of 1.

At a later time these three database records may be processed into a single record for the hard disk as described with reference to below.

Disk historic data database records can each reference a specific manufacturer and model of hard disk. In an embodiment the disk identifier of can act as an index into a database of hard disk models . Disk model record illustrates that the disk identifier for hard disk historic data database records and is a Seagate model ST1000MD0003. Hard disk historic data database records and reference hard disk model records Western Digital model WD1002FAEX and Toshiba model PX3009E 1HP0 respectively. In an embodiment a particular disk may reference a particular storage system via a storage identifier.

A hard disk may often form a portion of a storage system such as a redundant array of independent disks RAID or other storage system comprising a plurality of disks. For example as indicated in disk model database record and storage system models the Seagate hard disk indicated in reference forms a part of storage system an EMC VMAX storage system having up to 5 760 hard disks. Similarly the Western Digital hard disk in model record forms a part of a storage system an EMC VMAX 10K 40K with up to 3 200 hard disks. By associating a particular hard disk with a storage system a probability that one or more hard disks in a storage system will fail can be determined.

Disk historic database records illustrated in can be analyzed and consolidated into a single database record for each hard disk. For example in database records and for the hard disk having identifier FA5D 7823 CB23 FAEF can be consolidated into a single record indicating the initial non zero medium error count NMEC and the number of days that the hard disk survived after the initial NMEC. Based upon the initial NMEC value a statistical category or bucket can be assigned to the hard disk survival record e.g. . For record the initial NMEC count can be obtained from historic hard disk data database record . For record the survival days after initial NMEC can be determined from the date time stamp on database record and the database record that indicated the date that the hard disk failed. The bucket value of 2 for record can be based on a statistical category or bucket e.g. a first bucket can group hard disks having an initial NMEC of 1 a second bucket can group hard disks having an initial NMEC of 2 10 and a third bucket can group hard disks having an initial NMEC of 11 or more.

As shown in record and in record the hard disk having disk identifier 1245 DE82 AF45 B467 has incurred an initial NMEC of 1 and has not yet failed. The record can be used to statistically represent an instance of a hard disk that has incurred an initial NMEC on an identified date but has not yet failed.

In operation a computing system can scan one or more hard disks within the computing system. The one or more hard disks may form part of a storage system . Scanning the one or more hard disks can include detecting whether or not a hard disk has failed and whether or not a hard disk has incurred a non zero medium error count NMEC .

In operation if none of the one or more hard disks has failed or has a non zero medium error count then the method ends. Otherwise the method continues at operation .

In operation a disk index is set to an initial value such as zero 0 . Hard disks in a storage system often comprising a redundant array of independent disks RAID system. Scanning a hard disk of a RAID system can include scanning sequentially through the hard disks that make up the RAID system and incrementing the disk index to scan a next hard disk.

In operation it is determined whether the hard disk currently being scanned has failed. If so then in operation the method can record the failure of this hard disk and optionally record the storage system that the hard disk being scanned forms a part of. Recording the failure can include generating a line item in a customer report that reports the failure including a disk identifier of the failed disk the date that the disk failed and optionally an identifier of the storage system. After operation the method resumes at operation .

If in operation it is determined that the hard disk being scanned has not failed then in operation it can be determined whether the hard disk has a non zero medium error count NMEC . If so then in operation the NMEC and date that the NMEC occurred can be recorded. In an embodiment scanning the hard disk can determine that the NMEC is an initial NMEC being reported for the first time. In an embodiment determining whether an NMEC is an initial NMEC for the hard disk being scanned can be determined by the data collection server at a later time. The method resumes at operation .

In operation it can be determined whether there are more hard disks to scan. If so then the method resumes at operation otherwise the method resumes at operation .

In operation the disk index is incremented and the next disk is scanned. The method resumes at operation .

In operation the method can optionally generate a customer report to send to the data collection server . The customer report can indicate a line item for each hard disk that either had a status of failed or had an NMEC and the date that the failed status or NMEC occurred. As described above the report can optionally indicate whether the NMEC is an initial NMEC. In an embodiment the customer report can further include a date that the initial NMEC for a hard disk occurred.

Data collection server can receive the customer report and store the customer report in customer report database . Data collection server can further parse the line items in the report and generate database records for the disk historic database that record the failed status or initial NMEC and data of occurrence for the hard disk along with the hard disk unique identifier.

As shown in a vast majority of initial NMECs are less than 10. Due to the variability in the initial NMEC it is worthwhile to calculate the survival probabilities conditioning on the initial non zero medium error count not simply the existence of a non zero medium error count. In an embodiment the following statistical categories or buckets are used to capture a sufficient number of disks for each category. The first bucket groups together all hard disks having an initial NMEC of 1 the second bucket groups together all hard disks having an initial NMEC from 2 to 10 and the third bucket groups together all hard disks having an initial NMEC of 11 or more.

As shown in there is a marked difference in the survival functions of hard disks depending on the initial NMEC itself. A disk with an initial NMEC 10 has a 27.8 chance of failure within the first day a 32.9 chance of failure within the first week and a 40.14 chance of failure within the first month.

Referring to Table 1 and it can be seen that hard disk model A has a better survival function for each initial NMEC bucket than e.g. model C.

In operation hard disk data is selected for analysis from the hard disk database . In an embodiment the selection can be limited to a particular hard disk manufacturer and model. In an embodiment the selection can incorporate all hard disks used in a particular manufacturer and model of storage system. In an embodiment the selection can include all hard disk data for all hard disks of all manufacturers stored within the hard disk database . For convenience in processing the selection may be sorted by a specific criteria such as by manufacturer then by model or by unique disk identifier.

In operation for each hard disk represented by the selection of historic hard disk data a record is generated and stored for that hard disk with information including a unique hard disk identifier and initial NMEC a date of the initial NMEC a status of the hard disk ALIVE or FAILED a date of the status of the hard disk and a statistical category or bucket of the initial NMEC for the hard disk. Example records are shown and described with reference to . In an embodiment a first bucket may group together hard disks having an initial NMEC of 1 a second bucket may group together hard disks having an initial NMEC of 2 10 and third buck may group together hard disk having an initial NMEC of 11 or more.

In operation for each hard disk represented by the selection of hard disk data the record can optionally store an indication of the storage system that houses the hard disk a manufacturer of the hard disk and a model of the hard disk. These fields can be used to make manufacture and model specific probability of failure determinations.

In operation for each statistical bucket a record can be generated and stored in the predictors database indicating a percentage of hard disks in the bucket that failed and the average number of days after the initial NMEC that the hard disk failed if it failed.

In operation optionally for each statistical bucket a record can be generated and stored in the predictors database indicating a percentage of hard disks that failed within 1 day 7 days 30 days 60 days or longer than 60 days after the date of the initial NMEC for the hard disk.

In operation it can be determined whether the status of a hard disk is alive i.e. not failed . If the hard disk has already failed i.e. is not alive then the method ends because the probability of the hard disk failing is already 100 because the hard disk status is failed. 

In operation it can be determined whether the initial NMEC for the hard disk is equal to value range that defines a first classification or bucket for analysis. For example a first bucket may include only hard disks that have an NMEC of 1. If so then in operation the hard disk is classified for analysis in the first bucket and the method continues at operation . Otherwise the method continues at operation .

If in operation the initial NMEC for the hard disk falls within a value range that defines a second classification or bucket for analysis then in operation the hard disk is classified for analysis in the second bucket and the method continues at operation . Otherwise the hard disk is classified within a third classification having a third initial NMEC value range. The method continues at operation .

In operation based upon the classification by initial NMEC value first second or third bucket a probability of survival of the hard disk can be looked up in the predictors database . In an embodiment the probability is also dependent upon the particular manufacturer and model of the hard disk.

In operation optionally the probability that the hard disk will survive for a predetermined number of days can be looked up. In an embodiment the predetermined number of days can be 1 day 7 days 30 days 60 days or longer than 60 days.

Table 2 below illustrates an example computation for a storage system having four hard disks n 4 determining a probability that at least one hard disk will fail during the next 30 days assuming initial NMEC values as shown.

In operation a window of time for the probability of failure can be specified. For example the method can determine the probability that one or more hard disks in the storage system will fail within 30 days based upon the current status of the hard disks in the storage system.

In operation the hard disks within the storage system can be scanned to determine whether any all or none of the hard disks has incurred an initial NMEC or a failure.

In operation it can be determined whether at least one hard disk in the storage system has failed. If so then in operation the failed hard disk s can be reported and the method ends. Otherwise the method resumes at operation .

In operation it can be determined whether at least one hard disk in the storage system has an NMEC. If so then in operation it can be reported that there are no hard disks with an NMEC and the method ends. Otherwise the method resumes at operation .

In operation a disk index can be set to an initial value such as 0 or 1 to loop through all disks in the storage system. A temporary variable Pis initialized to a value of 1. After the method loops through all disks in the storage system Prepresents the probability of survival of all disks in the storage system 1 Pi .

In operation it can be determined whether disk i has an NMEC. For purposes of the calculations in method the current NMEC and current date can be used as an estimate for the initial NMEC and date of initial NMEC. If disk i has does not have an initial NMEC then the method continues at operation otherwise the method continues at operation .

In operation the NMEC and optionally and additionally the disk manufacturers and model can be used to look up a probability Pi that the idisk will fail within the time window e.g. 30 days. In an embodiment a customer data center can perform method and can request that the data collection server lookup the probabilities in the databases of the data collection server on behalf of the customer data center .

In operation Pcan be updated to reflect the probability that none of the first i disks will fail within 30 days.

In operations it can be determined whether there are more disks to consider in the storage system. If so then the method resumes at operation where the disk index i can be incremented.

In operation a report can be generated and transmitted to the customer data center as to the probability of failure of at least one disk in the storage system during the time window.

In operation customer data center can scan the hard disks within the storage system to determine whether any all or none of the hard disks have incurred an initial NMEC or a failure.

In operation the customer data center can determine whether at least one hard disk in the storage system has failed. If so then in operation the failed hard disk s can be reported and the method ends. Otherwise the method resumes at operation .

In operation the customer data center can determine whether at least one hard disk in the storage system has an NMEC. If so then in operation it can be reported that there are no hard disks with an NMEC and the method ends. Otherwise the method resumes at operation .

In operation customer data center can optionally provide the manufacturer and model of the storage system housing the hard disks being scanned to the data collection center so that a probability calculation can be manufacturer and model specific. Alternatively or in addition the customer data center can provide a manufacturer and model of each disk scanned in the storage system to the data collection server .

In operation the customer data center can provide the NMEC if any and disk status for all hard disks scanned in the storage system to the data collection server .

In operations data collection server reports to the customer data center a probability of failure of each hard disk scanned and a probability of failure of at least one hard disk failure in the storage system of the hard disks scanned.

In Software Stack an exemplary embodiment applications can make calls to Services A or B using several Service APIs and to Operating System OS using several as APIs A and B can make calls to as using several as APIs.

Note that the Service has two APIs one of which Service API receives calls from and returns values to Application and the other Service API receives calls from and returns values to Application Service which can be for example a software library makes calls to and receives returned values from OS API and Service which can be for example a software library makes calls to and receives returned values from both as API and OS API Application makes calls to and receives returned values from as API .

Note that some or all of the components as shown and described above may be implemented in software hardware or a combination thereof. For example such components can be implemented as software installed and stored in a persistent storage device which can be loaded and executed in a memory by a processor not shown to carry out the processes or operations described throughout this application. Alternatively such components can be implemented as executable code programmed or embedded into dedicated hardware such as an integrated circuit e.g. an application specific IC or ASIC a digital signal processor DSP or a field programmable gate array FPGA which can be accessed via a corresponding driver and or operating system from an application. Furthermore such components can be implemented as specific hardware logic in a processor or processor core as part of an instruction set accessible by a software component via one or more specific instructions.

Computing system includes bus or other communication device to communicate information and processor coupled to bus that may process information.

While computing system is illustrated with a single processor computing system may include multiple processors and or co processors . Computing system further may include random access memory RAM or other dynamic storage device referred to as main memory coupled to bus and may store information and instructions that may be executed by processor s . Main memory may also be used to store temporary variables or other intermediate information during execution of instructions by processor .

Computing system may also include read only memory ROM and or other static storage device coupled to bus that may store static information and instructions for processor s . Data storage device may be coupled to bus to store information and instructions. Data storage device such as flash memory or a magnetic disk or optical disc and corresponding disk may be coupled to computing system .

Computing system may also be coupled via bus to display device such as a cathode ray tube CRT liquid crystal display LCD or light emitting diode LED display to display information to a user. Computing system can also include an alphanumeric input device including alphanumeric and other keys which may be coupled to bus to communicate information and command selections to processor s . Another type of user input device is cursor control such as a touchpad a mouse a trackball or cursor direction keys to communicate direction information and command selections to processor s and to control cursor movement on display . Computing system may further include a real time clock . The real time clock may be used for generating date time stamps for data records computing elapsed time and other time keeping functions. A real time clock can be a battery backed chipset with a settable date and time. Alternatively a real time clock may include logic to retrieve a real time from a network source such as a server or an Internet server via network interfaces described below.

Computing system further may include one or more network interface s to provide access to a network such as a local area network. Network interface s may include for example a wireless network interface having antenna which may represent one or more antenna e . Computing system can include multiple wireless network interfaces such as a combination of WiFi Bluetooth and cellular telephony interfaces. Network interface s may also include for example a wired network interface to communicate with remote devices via network cable which may be for example an Ethernet cable a coaxial cable a fiber optic cable a serial cable or a parallel cable.

In one embodiment network interface s may provide access to a local area network for example by conforming to IEEE 802.11b 802.11g or 802.11n standards and or the wireless network interface may provide access to a personal area network for example by conforming to Bluetooth standards. Other wireless network interfaces and or protocols can also be supported. In addition to or instead of communication via wireless LAN standards network interface s may provide wireless communications using for example Time Division Multiple Access TDMA protocols Global System for Mobile Communications GSM protocols Code Division Multiple Access CDMA protocols and or any other type of wireless communications protocol.

In the foregoing specification the invention has been described with reference to specific embodiments thereof. It will however be evident that various modifications and changes can be made thereto without departing from the broader spirit and scope of the invention. The specification and drawings are accordingly to be regarded in an illustrative rather than a restrictive sense.

