---

title: Messaging between set top box and head end systems
abstract: A system, apparatus, and method provide messaging, between a headend system and a set top box. A distributor determines and provides an assigned communication identifier and an assigned server host address, that correspond to one of one or more first servers, to each of one or more set top box clients. The first servers maintain a persistent connection with the set top box clients and provide messaging, presence, and routing features via the persistent connection. A gateway service provides a gateway for one or more headend servers to communicate with the set top box clients through the first servers. A server controller provides administrative graphical user interfaces for operators to monitor and control health checks, configuration changes, and collect statistics for the distributor, first servers, and the gateway service.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09538259&OS=09538259&RS=09538259
owner: The DirecTV Group, Inc.
number: 09538259
owner_city: El Segundo
owner_country: US
publication_date: 20150223
---
Embodiments of the present invention relates generally to broadcast programming systems and in particular to a method apparatus and article of manufacture for bi directional messaging between a set top box and head end system within a broadcast programming system.

Traditionally customers access business websites e.g. a customer visits a retailer s website or the website of a service that the customer utilizes such as a phone company gas company water and power company etc. . Usually businesses don t access a customer s home. In some circumstances it would be beneficial for the business to contact a customer client and or access a customer s devices. For example it may be desirable for a satellite television provider to control a customer s set top box STB that is used to access the provider s services content. Such a provider may want to exchange deliver configuration information to a STB such as parental controls pause points indicating where the user paused when watching viewing content on another device such as a phone and or other configuration information. There is insufficient bandwidth to deliver such configuration information over a broadcast signal e.g. via satellite . Further as a matter of course customers don t maintain an Internet presence through which the business can communicate information and or access a STB. In view of the above it is desirable to provide a mechanism for a business to access a customer s home and or devices in order to deliver control various parameters for such a customer. To provide a better understanding of the prior art a brief description of STB communications may be useful.

Unlike mobile devices such as iOS using Apple Push Notification Service APNS and Android using Google Cloud Message GCM devices there has not been an effective way to deliver one on one notifications to STB devices. Traditionally in order to send notifications to STBs television providers such as DirecTV rely on broadcast messages to deliver notifications to their television STBs. Broadcast messages are effective for group notifications such as firmware upgrades program guide updates etc. However it becomes very expensive if providers attempt to deliver more personalized service notifications such as recommendations and personal messages.

More broadly traditional communications between broadband connected set top box STB devices clients and head end HE application servers i.e. where television broadcast signals are collected and transmitted from have been relying on HTTP hypertext transfer protocol as the transport protocol which requires the STB clients to initiate the connection. There are times when the HE application needs to start initiate the communication with designated client STB devices. Such an initiation is usually achieved either by the client constantly polling HE applications or running a local service on the managed client device for the HE server to call. However if the STB resides behind a firewall such a mechanism doesn t work without some protocol like STUN Session Traversal Utilities for NAT network address translation or port forwarding rules in place.

In view of the above what is needed is the capability for a business e.g. an HE to initiate and maintain a connection with a STB to communicate various messaging configuration parameters.

Embodiments of the invention utilize a communication protocol for a head end HE application to initiate and maintain a persistent connection with a device e.g. an STB device to provide personalized services. Based on the persistent connection full knowledge of the connection status of individual STBs may be maintained enabling the distribution e.g. push of one on one messages commands and notifications to individual broadband connected devices to collect configuration files parental control settings playlist synchronization across household devices personal recommendations etc. on demand.

In the following description reference is made to the accompanying drawings which form a part hereof and which is shown by way of illustration several embodiments of the present invention. It is understood that other embodiments may be utilized and structural changes may be made without departing from the scope of the present invention.

Embodiments of the invention provide a method and system for a head end to initiate and maintain a persistent connection with a set top box.

The uplink center receives program material and program control information from the control center and using an uplink antenna and transmitter transmits the program material and program control information to the satellite . The satellite receives and processes this information and transmits the video programs and control information to the subscriber receiver station via downlink using one or more transponders or transmitters. The subscriber receiving station comprises a receiver communicatively coupled to an outdoor unit ODU and a display . The receiver processes the information received from the satellite and provides the processed information to the display for viewing by the subscriber . The ODU may include a subscriber antenna and a low noise block converter LNB .

In one embodiment the subscriber receiving station antenna is an 18 inch slightly oval shaped antenna. Standard definition transmissions are typically in the Ku band while the high definition HD transmissions are typically in the Ka band. The slight oval shape is due to the 22.5 degree offset feed of the LNB which is used to receive signals reflected from the subscriber antenna. The offset feed positions the LNB out of the way so it does not block any surface area of the antenna minimizing attenuation of the incoming microwave signal.

The distribution system can comprise a plurality of satellites in order to provide wider terrestrial coverage to provide additional channels or to provide additional bandwidth per channel. In one embodiment of the invention each satellite comprises 16 transponders to receive and transmit program material and other control data from the uplink center and provide it to the subscriber receiving stations . Using data compression and multiplexing techniques two satellites working together can receive and broadcast over 150 conventional non HDTV audio and video channels via 32 transponders.

While embodiments of the invention disclosed herein will be described with reference to a satellite based distribution system embodiments of the invention may also be practiced with terrestrial based transmission of program information whether by broadcasting means cable or other means. Further the different functions collectively allocated among the control center and the uplink center as described above can be reallocated as desired without departing from the intended scope of embodiments of the present invention.

Although the foregoing has been described with respect to an embodiment in which the program material delivered to the subscriber is video and audio program material such as a movie the foregoing method can be used to deliver program material comprising purely audio information or other data as well. It is also used to deliver current receiver software and announcement schedules for the receiver to rendezvous to the appropriate downlink . Link may be used to report the receiver s current software version.

As described above it is desirable to have a mechanism to initiate a connection between a set top box in a subscriber receiving station e.g. in a home with a head end that remains open persistent e.g. until a subscriber reboots the set top box loses power downloads new software etc. . Such a persistent connection may remain open for weeks or months at a time. By enabling such a persistent connection a business e.g. via the head end may perform various functions including troubleshooting e.g. to retrieve diagnostic information about within the set top box via the persistent connection enabling configuring parental controls synchronizing viewing between multiple devices e.g. mobile phones and homes personalized messaging etc.

While multiple different communication protocols may be utilized to maintain a persistent connection embodiments of the invention may utilize XMPP Extensible Messaging and Presence Protocol . To utilize such a communication protocol various components may be required. illustrate the overall architecture that utilizes a communication protocol e.g. XMPP to enable a bi directional messaging system in accordance with one or more embodiments of the invention. In particular illustrates the points of presence POPs at the various locations e.g. Los Angeles Castle Rock and Sterling locations while illustrates various data centers e.g. containing components with limited more secure access at the various locations.

The XMPP system includes four core head end components and one core client STB component the core components are in bold in . The core components are the JID Jabber Identifier distributor the XMPP servers e.g. XMPP server A XMPP server B as well as additional XMP servers not illustrated . collectively referred to as XMPP servers XMPP Gateway Services e.g. XMPP gateway services A within POPs and dedicated XMPP gateways services B within data centers XMPP server controller and the XMPP enabled STB . Referring to the JID Distributor and the XMPP Servers are located within the internet service provider ISP POPs point of presence locations e.g. Los Angeles Castle Rock and Sterling ISP POPs . Similarly the XMPP Server Controller is located in the data centers . XMPP Gateway Services A are located in the POPs and are used to perform services that may be initialized utilized by STBs e.g. to return to the pause point for content played on another device . XMPP Gateway Services B are located in data centers and are dedicated for services utilized by head end such as messages sent to a large subset of STBs .

Such XMPP Gateway Services A and B work with device notification data services DNDS A and B respectively. In particular the DNDS A may reside in the POP while the DNDS B may reside in a datacenter . Further end users may only access services in the POP that provides a secure area where outside services may be stored available. End users may not have the capability to directly access services in the datacenters but some services within datacenters may be accessed by applications within the POPs .

XMPP Gateway Services A may receive data information notifications from DNDS A such as pause point synchronization information from other devices that may be viewing content. For example devices such as cellular phones tablet computers etc. may be viewing content e.g. via a cellular network connection Ethernet connection or other network based connection to the Internet . Such devices communicate with and retrieve content from ISP POP Locations via various universal processes. The universal process data services UPDS provides content and serves as an OSB Oracle service bus proxy for the UPAS the universal process application service UPAS provides applications services that may be utilized by device e.g. it serves as a service layer for profiles and pause points the universal process data access UPDA stores data for a variety of services objects and the edge cache provides access to information content that is in cache and is available within from cache memory e.g. at a higher access data rate . As an example the UPAS may provide pause point synchronization information regarding where the user has paused when viewing content on device . Such pause point synchronization information may be provided to DNDS A which in turn provides the information to XMPP Gateway Services A to be passed to the STB e.g. via XMPP servers . In addition the XMPP server may provide GHV global viewing history pause resume services by requesting information e.g. the pause resume point and or communication with the universal process data service . In this regard the GHV pause resume services enable the ability for a user to log into an STB or mobile device and view their personalized viewing history as well as any viewing in progress e.g. pause points .

The XMPP JID Distributor allows authenticated STB clients to retrieve assigned Jabber ID and XMPP server host addresses. The XMPP servers provide XMPP messaging presence and XML Extensible Markup Language routing features. The XMPP gateway services provide an interface to encapsulate XMPP specifics from other head end components and provide a gateway for the head end servers to communicate to STB clients through XMPP servers . The XMPP server controller provides administrative graphical user interfaces for operators to monitor and control XMPP component health checks configuration changes and collect statistics. The XMPP enabled STB is provisioned as the service endpoint of the XMPP JID Distributor . Each of the components will be described with respect to the functionality and features performed below.

After the STB boots the STB requires an authentication token from the authentication server AS web service. Accordingly at a first step i.e. step the STB sends a setup RID resource identifier request command i.e. Setup RID CardID RID to the authentication server AS . The request to setup the RID includes an identifier for the STB card i.e. the conditional access module identifier see further description below as well as a resource identifier RID . The AS provides a service for authenticating the user and determining if the user is authorized to receive the service requested. For example the AS may determine whether the user user account associated with the STB is a current subscriber that is up to date on bill payment. The AS communicates with the device profile system DPS to acquire a device ID from the DPS . The AS then generates an EToken that includes the device ID and returns the EToken to the STB i.e. step . return EToken .

Once The STB has retrieved the token the STB contacts the JID Distributor service to retrieve an assigned Jabber ID resource ID and the host and port information which is derived based on user account number and zip code information . Accordingly at step the STB sends a getJID request that includes the EToken RID and site ID to the JID Distributor .

The JID Distributor has the responsibility for equally distributing the load across the servers and across the POPs and accounts for any health and availability issues. Once the request for the JID is received from the STB the JID Distributor checks with the AS to authenticate the STB . Accordingly the JID Distributor presents the EToken to the AS at step requesting authentication and the AS returns the EToken along with the device ID account ID and zip code information for the zip code associated with the account holder i.e. at step . The JID Distributor determines which XMPP server the STB device should connect to. The JID Distributor then returns the JID to the STB i.e. at step .

The STB then starts the connection with the assigned XMP server providing the assigned Jabber ID authentication token and resource ID e.g. at step the STB opens an XMPP connection SASL simple authentication and security layer with the JID and EToken . The XMPP server authenticates the token provided by the STB with the AS i.e. step by sending an authentication request with the EToken site ID and RID . Once the AS authenticates the EToken the STB may establish the persistent connection with the XMPP server i.e. step . In other words once the server authenticates the STB client i.e. with the AS the XMPP stream can be started and the STB remains connected to the XMPP server . Similar actions may be performed with multiple XMPP Servers A B.

Within ISP POPs viewer data collection services VDCS e.g. via VDCS proxy may be used to collect data about the STB . For example suppose an STB is experiencing a problem information such as configuration data may be utilized by the head end to determine and or solve the problem. VDCS may retrieve such configuration information from the STB via the XMPP server . Similar to the XMPP servers the VDCS authenticates the STB with the AS using an EToken. Once authenticated the VDCS provides pushes such STB configuration data using a service call API to VDCS in a data center . The STB configuration is stored by the VDCS in a device user configuration database . The head end can then process analyze the configuration data as needed.

The Device Notification and Data Service DNDS B is the head end system i.e. the DNDS B that is dedicated to head end based actions that initiates commands to be sent to connected STBs e.g. messages sent to a large subset of STBs . The DNDS DNDS A and DNDS B is also responsible for converting notification requests to XMPP XML messages and or for providing a user interface to send commands to devices e.g. using a DNDS User Interface UI Notification Scheduler Layer . The notification requests data etc. may be stored in the DNDS Application database e.g. on an AMP Enterprise RAC e.g. an Oracle middleware cluster and or may be received from various headend system applications . In this regard commands notifications etc. originating at the head end e.g. via the head end system or applications at in the headend are provided to the DNDS for further processing conversion to send to the XMPP servers which communicate with the STBs .

To enable the processing between DNDS B and STB DNDS B may communicate with the data access layer . For example DNDS B may request information from data access layer about the receivers that the DNDS B desires to communicate with e.g. by requesting resource IDs by zip code e.g. via a getRID request from the data access layer . Such information may be stored organized in a centralized coherence cache grid HUB . The data access layer retrieves the information from the HUB and returns the requested info to the DNDS B which in turn can send the commands notifications etc. to the STB via XMPP gateway services B .

When the XMPP gateway service B receives calls from DNDS B to distribute commands the gateway service B uses the same logic described above to find out the Jabber ID and XMPP server based on the provided account number and zip code information from the DNDS B. The gateway service B then delivers the payload to the designated devices through the XMPP server controller .

As described above the XMPP server controller provides administrative GUI interfaces for operators to monitor and control XMPP component e.g. XMPP Servers and or POPs health checks configuration changes and collect statistics e.g. from XMPP servers . For example if the LA POP or XMPP server that the STB is connected to becomes unhealthy or fails the XMPP server controller updates the JID Distributor as well as the XMPP Gateway Services with a new updated policy indicating that the POP or XMPP server is offline. Similarly if the XMPP server that the STB is connected to is overloaded the STB may be disconnected and the STB would initiate the process again i.e. at step above to determine which XMPP server to connect to and would receive a different answer based on the XMPP server controller management policy. Further if an entire POP were to go offline the STB may discover such an issue via a regularly timed ping connection test e.g. where the STB pings the connection every five 5 minutes and would restart the connection process as described above.

In view of the above embodiments of the invention initiate and maintain a persistent connection between a STB and a headend . In particular embodiments of the invention utilize a communication protocol to facilitate an IP network based bi directional messaging between STBs and head end systems . Such a persistent connection may be utilized to provide a variety of different services functions. Some exemplary use cases for such services described below may require headend components to send commands to broadband connected STBs see below for additional descriptions of STB configuration synchronization parental control and playlist synchronization . An exemplary embodiment may also utilize the XMPP protocol a protocol that was designed to enable client to client C2C client to server C2S server to client S2C and server to server S2S communications for use primarily in instant messaging gaming and video chats.

With STB configuration synchronization a head end system can command a STB to send back its configuration on a periodic or on demand basis. The backup configuration can later be restored or installed on a STB via XMPP.

This function enables a client application to request parental control settings of STB receivers. Having STB parental control settings be retrievable on demand allows for parity of enforcing parental control on non STB devices.

This function allows a satellite television subscriber to display on a client device an aggregated view of playlists that are maintained on STB receivers of the user s account.

This function enables the ability to synchronizing viewing between an STB and other devices . When a user watches media content e.g. a television episodic or movie on a device and pauses viewing such a pause point is relayed transmitted to the STB thereby allowing the user to pickup viewing at the same pause point on a display device connected to the STB .

This function enables titles to be recommended to and delivered to individual users STBs based on prior viewing habits and or similar viewing of other users.

The video channels are provided by a program source of video material A C collectively referred to hereinafter as video source s . The data from each video program source is provided to an encoder A C collectively referred to hereinafter as encoder s . Each of the encoders accepts a program time stamp PTS from the controller . The PTS is a wrap around binary time stamp that is used to assure that the video information is properly synchronized with the audio information after encoding and decoding. A PTS time stamp is sent with each I frame of the MPEG encoded data.

In one embodiment of the present invention each encoder is a second generation Motion Picture Experts Group MPEG 2 encoder but other decoders implementing other coding techniques can be used as well. The data channel can be subjected to a similar compression scheme by an encoder not shown but such compression is usually either unnecessary or performed by computer programs in the computer data source for example photographic data is typically compressed into .TIF files or .JPG files before transmission . After encoding by the encoders the signals are converted into data packets by a packetizer A F collectively referred to hereinafter as packetizer s associated with each source .

The data packets are assembled using a reference from the system clock SCR and from the conditional access manager which provides the SCID to the packetizers for use in generating the data packets. These data packets are then multiplexed into serial data and transmitted.

Schedule feeds provide electronic schedule information about the timing and content of various television channels such as that found in television schedules contained in newspapers and television guides. Schedule feeds preferably include information from one or more companies that specialize in providing schedule information such as GNS TRIBUNE MEDIA SERVICES and T.V. DATA. The data provided by companies such as GNS TRIBUNE MEDIA SERVICES and T.V. DATA are typically transmitted over telephone lines or the Internet to program guide database . These companies provide television schedule data for all of the television stations across the nation plus the nationwide channels such as SHOWTIME HBO and the DISNEY CHANNEL. The specific format of the data that are provided by these companies varies from company to company. Program guide database preferably includes schedule data for television channels across the entire nation including all nationwide channels and local channels regardless of whether the channels are transmitted by the transmission station.

Program guide database is a computer based system that receives data from schedule feeds and organizes the data into a standard format. Compiler reads the standard form data out of program guide database identifies common schedule portions converts the program guide data into the proper format for transmission to users specifically the program guide data are converted into objects as discussed below and outputs the program guide data to one or more of sub databases .

Program guide data are also manually entered into program guide database through data entry station . Data entry station allows an operator to enter additional scheduling information as well as combining and organizing data supplied by the scheduling companies. As with the computer organized data the manually entered data are converted by the compiler into separate objects and sent to one or more of sub databases .

The program guide objects are temporarily stored in sub databases until cyclers request the information. Each of cyclers preferably transmits objects at a different rate than the other cyclers . For example cycler A may transmit objects every second while cyclers B and C may transmit objects every 5 seconds and every 10 seconds respectively.

Since the subscriber s receivers may not always be on and receiving and saving objects the program guide information is continuously re transmitted. Program guide objects for programs that will be shown in the next couple of hours are sent more frequently than program guide objects for programs that will be shown later. Thus the program guide objects for the most current programs are sent to a cycler with a high rate of transmission while program guide objects for later programs are sent to cyclers with a lower rate of transmission. One or more of the data outputs of cyclers are forwarded to the packetizer of a particular transponder.

It is noted that the uplink configuration depicted in the prior figures and the program guide subsystem depicted in can be implemented by one or more hardware modules one or more software modules defining instructions performed by a processor or a combination of both.

The data stream therefore comprises a series of packets from any one of the data sources in an order determined by a controller. The data stream is encrypted by an encryption module modulated by the modulator typically using a QPSK modulation scheme and provided to a transmitter that broadcasts the modulated data stream on a frequency bandwidth to the satellite via the antenna . The receiver STB receives these signals and using the SCID reassembles the packets to regenerate the program material for each of the channels.

Embodiments of the present invention may also be implemented using MPEG transport protocols. is a diagram showing another embodiment of a data packet for the MPEG 2 protocol. Each data packet comprises a sync byte three transport flags and a packet identifier PID . The sync byte is used for packet synchronization. The transport flags include a transport error indicator flat set if errors cannot be corrected in the data stream a payload unit start indicator indicting the start of PES data or PSI data and a transport priority flag . The PID is analogous to the SCID discussed above in that it identifies a data channel. A demultiplexer in the transport chip discussed below extracts elementary streams from the transport stream in part by looking for packets identified by the same PID. The scramble control flag indicates how the payload is scrambled the adaptation field flag indicates the presence of an adaptation field and the payload flag indicates that the packet includes payload . The final packet segment is data required to perform forward error correction.

The tuner demodulator isolates a single digitally modulated transponder and converts the modulated data to a digital data stream. As packets are received the tuner demodulator identifies the type of each packet. If tuner demodulator identifies a packet as program guide data tuner demodulator outputs the packet to memory. The digital data stream is then supplied to a forward error correction FEC decoder . This allows the set top box to reassemble the data transmitted by the uplink center which applied the forward error correction to the desired signal before transmission to the subscriber receiving station verifying that the correct data signal was received and correcting errors if any. The error corrected data may be fed from the FEC decoder module to the transport module via an 8 bit parallel interface.

The transport module performs many of the data processing functions performed by the set top box e.g. using system random access memory . The transport module processes data received from the FEC decoder module and provides the processed data to the video MPEG decoder the audio MPEG decoder and the microcontroller and or data storage processor for further data manipulation. In one embodiment of the present invention the transport module video MPEG decoder and audio MPEG decoder are all implemented on integrated circuits. This design promotes both space and power efficiency and increases the security of the functions performed within the transport module . The transport module also provides a passage for communications between the microprocessor and the video and audio MPEG decoders . As set forth more fully hereinafter the transport module also works with the conditional access module CAM to determine whether the subscriber receiving station is permitted to access certain program material. Data from the transport module can also be supplied to external communication module .

The CAM functions in association with other elements to decode an encrypted signal from the transport module . The CAM may also be used for tracking and billing these services. In one embodiment of the present invention the CAM is a smart card having contacts cooperatively interacting with contacts in the set top box to pass information. In order to implement the processing performed in the CAM the set top box and specifically the transport module provides a clock signal to the CAM .

Video data is processed by the MPEG video decoder . Using the video random access memory RAM the MPEG video decoder decodes the compressed video data and sends it to an encoder or video processor which converts the digital video information received from the video MPEG module into an output signal usable by a display or other output device. By way of example processor may comprise a National TV Standards Committee NTSC or Advanced Television Systems Committee ATSC encoder. In one embodiment of the invention both S Video baseband video and RF modulated video NTSC or ATSC signals are provided. Other outputs may also be utilized and are advantageous if high definition programming is processed. Such outputs may include for example component video and the high definition multimedia interface HDMI .

Using the audio RAM audio data is likewise decoded by the MPEG audio decoder . The decoded audio data may then be sent to a digital to analog D A converter . In one embodiment of the present invention the D A converter is a dual D A converter one for the right and left channels. If desired additional channels can be added for use in surround sound processing or secondary audio programs SAPs . In one embodiment of the invention the dual D A converter itself separates the left and right channel information as well as any additional channel information. Other audio formats such as DOLBY DIGITAL AC 3 may similarly be supported.

A description of the processes performed in the encoding and decoding of video streams particularly with respect to MPEG and JPEG encoding decoding can be found in Chapter 8 of Digital Television Fundamentals by Michael Robin and Michel Poulin McGraw Hill 1998 which is hereby incorporated by reference herein.

The microprocessor receives and processes command signals from the remote control a set top box keyboard interface modem and transport . The microcontroller receives commands for performing its operations from a processor programming memory which permanently stores such instructions for performing such commands. The memory used to store data for microprocessor and or transport operations may comprise a read only memory ROM an electrically erasable programmable read only memory EEPROM a flash memory and or a random access memory and or similar memory devices. The microprocessor also controls the other digital devices of the set top box via address and data lines denoted A and D respectively in .

The modem connects to the customer s phone line via the PSTN port. Alternatively the modem may comprise an Ethernet connection or wireless adapter to connect to the customer s network and related Internet connection. The set top box communicates with e.g. via the modem the head end e.g. the program provider and transmits the customer s purchase information for billing purposes and or other information. The modem is controlled by the microprocessor . The modem can output data to other I O port types including standard parallel and serial computer I O ports. Data can also be obtained from a cable or digital subscriber line DSL modem or any other suitable source. Further the modem may be utilized to maintain the persistent connection with the head end as described above.

The set top box may also comprise a local storage unit such as the storage device for storing video and or audio and or other data obtained from the transport module . Video storage device can be a hard disk drive a read writeable compact disc of DVD a solid state RAM or any other storage medium. In one embodiment of the present invention the video storage device is a hard disk drive with specialized parallel read write capability so that data may be read from the video storage device and written to the device at the same time. To accomplish this feat additional buffer memory accessible by the video storage or its controller may be used. Optionally a video storage processor can be used to manage the storage and retrieval of the video audio and or other data from the storage device . The video storage processor may also comprise memory for buffering data passing into and out of the video storage device . Alternatively or in combination with the foregoing a plurality of video storage devices can be used. Also alternatively or in combination with the foregoing the microprocessor can also perform the operations required to store and or retrieve video and other data in the video storage device .

The video processing module output can be directly supplied as a video output to a viewing device such as a video or computer monitor. In addition the video and or audio outputs can be supplied to an RF modulator to produce an RF output and or 8 vestigial side band VSB suitable as an input signal to a conventional television tuner. This allows the set top box to operate with televisions without a video input.

Each of the satellites comprises one or more transponders each of which accepts program information from the uplink center and relays this information to the subscriber receiving station . Known multiplexing techniques are used so that multiple channels can be provided to the user. These multiplexing techniques include by way of example various statistical or other time domain multiplexing techniques and polarization multiplexing. In one embodiment of the invention a single transponder operating at a single frequency band carries a plurality of channels identified by respective SCIDs.

Preferably the set top box also receives and stores a program guide in a memory available to the microprocessor . Typically the program guide is received in one or more data packets in the data stream from the satellite . The program guide can be accessed and searched by the execution of suitable operation steps implemented by the microcontroller and stored in the processor ROM . The program guide may include data to map viewer channel numbers to satellite networks satellite transponders and SCIDs and also provide TV program listing information to the subscriber identifying program events.

Initially as data enters the set top box the tuner demodulator looks for a boot object. Boot objects are always transmitted with the same SCID number so tuner knows that it must look for packets marked with that identification number. A boot object identifies the identification numbers where all other objects can be found. Further such boot objects may initiate the persistent connection methods described above.

As data is received and stored in the memory the microprocessor acts as a control device and performs various operations on the data in preparation for processing the received data. These operations include packet assembly object assembly and object processing.

The first operation performed on data objects stored in the memory is packet assembly. During the packet assembly operation microprocessor examines the stored data and determines the locations of the packet boundaries.

The next step performed by microprocessor is object assembly. During the object assembly step microprocessor combines packets to create object frames and then combines the object frames to create objects. Microprocessor examines the checksum transmitted within each object frame and verifies whether the frame data was accurately received. If the object frame was not accurately received it is discarded from memory . Also during the object assembly step the microprocessor discards assembled objects that are of an object type that the microprocessor does not recognize. The set top box maintains a list of known object types in memory . The microprocessor examines the object header of each received object to determine the object type and the microprocessor compares the object type of each received object to the list of known object types stored in memory . If the object type of an object is not found in the list of known object types the object is discarded from memory . Similarly the set top box maintains a list of known descriptor types in memory and discards any received descriptors that are of a type not in the list of known descriptor types.

The last step performed by microprocessor on received object data is object processing. During object processing the objects stored in the memory are combined to create a digital image. Instructions within the objects direct microprocessor to incorporate other objects or create accessible user links. Some or all of the digital images can be later converted to an analog signal that is sent by the set top box to a television or other display device for display to a user.

The functionality implemented in the set top box depicted in can be implemented by one or more hardware modules one or more software modules defining instructions performed by a processor or a combination of both.

At step a distributor e.g. a JID distributor determines and provides an assigned communication identifier e.g. a JID or Jabber ID that is uniquely assigned to each of the set top box clients and an assigned server host address that corresponds to one or more first e.g. XMPP servers to each of one or more set top box clients. As part of the determination the distributor may also authenticate the STB clients with an authentication server e.g. prior to providing the assigned communication ID . The assigned communication ID and server host address that are assigned maybe based on a user account number and zip code information corresponding to the location of the user STB client.

At step a persistent connection is maintained between the first servers and the STB e.g. XMPP enabled STB clients.

At step the first servers are configured to provide messaging e.g. XMPP messaging presence and routing features via the persistent connection. As part of maintaining the persistent connection the first servers may also authenticate the STB clients prior to initializing providing maintaining the persistent connection.

At step a gateway service e.g. an XMPP gateway service provides a gateway for headend servers to communicate with the STB clients through the first servers. Such a gateway may be used by a DNDS to initiate command to send to a group of the STB clients through the first servers.

At step a server controller e.g. an XMPP server controller provides administrative graphical user interfaces for operators to monitor and control health checks configuration changes and collect statistics for the distributor first servers and the gateway service. The server controller may also as part of the admin GUIs provide a policy update to the distributor and the gateway based on a status of the headend system and or the first servers e.g. health status .

In the logical flow the distributor and first services may be maintained at an ISP POP location of a satellite broadcast television system. In addition the gateway service and server controller may be maintained at a data center of the satellite broadcast television system.

This concludes the description of the preferred embodiment of the invention. The foregoing description of the preferred embodiment of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise form disclosed. Many modifications and variations are possible in light of the above teaching. It is intended that the scope of the invention be limited not by this detailed description but rather by the claims appended hereto.

