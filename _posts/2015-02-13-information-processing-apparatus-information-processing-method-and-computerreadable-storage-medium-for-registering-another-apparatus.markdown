---

title: Information processing apparatus information processing method, and computer-readable storage medium for registering another apparatus
abstract: Registration is performed so as to allow an information processing apparatus to use predetermined processing of a predetermined device. The registration state of another information processing apparatus capable of using the predetermine device is confirmed by communicating with the other information processing apparatus. In accordance with a confirmation result, deregistration processing is performed to deregister another information processing apparatus already registered as an apparatus which uses the predetermined processing of the predetermined device. If the confirmation result indicates that there is another information processing apparatus already registered, registration is performed based on deregistration processing.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09420123&OS=09420123&RS=09420123
owner: CANON KABUSHIKI KAISHA
number: 09420123
owner_city: Tokyo
owner_country: JP
publication_date: 20150213
---
The present invention relates to an information processing technique which uses predetermined processing by a predetermined device.

Some conventional image reading apparatuses connected on a network have a scan function of transmitting to an information terminal apparatus such as a PC data to be referred to as scan data image data or document data generated by reading a document. An example of the scan function is a push scan function. The push scan function is a function of transmitting scan data to an information terminal apparatus by a user operation to an image reading apparatus.

There may be a plurality of transmission destination candidates to which scan data is transmitted by the push scan function. For example this is a case in which a plurality of information terminal apparatuses are connected to an image reading apparatus. Japanese Patent Laid Open No. 2013 074366 describes a technique of registering a scan data transmission destination in an image reading apparatus. Japanese Patent Laid Open No. 2013 074366 also describes a technique in which if the number of destinations has reached the upper limit when a request to newly register a destination is received from a host computer the host computer is notified of a registration failure.

According to Japanese Patent Laid Open No. 2013 074366 however even if an attempt to newly register a scan data transmission destination is made if the number of transmission destinations has reached the upper limit registration fails. Consequently the user cannot register a desired transmission destination in some cases.

The present invention provides an information processing technique capable of appropriately performing registration to use predetermined processing by a predetermined device.

To achieve the above object an information processing apparatus according to the present invention has the following arrangement. That is an information processing apparatus which uses predetermined processing by a predetermined device comprising a registration unit configured to perform registration so as to allow the information processing apparatus to use the predetermined processing of the predetermined device a confirmation unit configured to confirm a registration state of another information processing apparatus capable of using the predetermined device by communicating with the other information processing apparatus and a deregistration unit configured to perform based on a confirmation result of the confirmation unit deregistration processing for deregistering another information processing apparatus already registered as an apparatus which uses the predetermined processing of the predetermined device wherein in a case that the confirmation result of the confirmation unit indicates that there is the other information processing apparatus already registered the registration unit performs the registration based on the deregistration processing by the deregistration unit.

According to the present invention an information processing apparatus performs registration based on deregistration processing for deregistering another information processing apparatus already registered. This makes it possible to appropriately perform registration to use predetermined processing by a predetermined device.

Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings .

Embodiments of the present invention will be described in detail below with reference to the accompanying drawings.

In the image forming apparatus the printer function is implemented by a printer portion . A scanner portion operates as an image reading apparatus to implement the scanner function. The storage function is implemented by a memory card mounting portion and a memory card .

Furthermore it is possible to implement a copy function by combining the printer function and the scanner function.

The printer portion prints data such as externally received print data or image data stored in the memory card on printing paper by a printing method such as an inkjet method or electrophotographic method. The scanner portion optically reads a document set on a document table converts it into electronic data further converts the electronic data into a designated file format and transmits the resultant data to an external apparatus via a network. The copy service transfers to the printer portion image data generated by reading a document set on the document table by the scanner portion and prints the document data on printing paper by the printer portion . An external apparatus connected via a network can read out a file stored in the memory card edit it and store it in the memory card .

The image forming apparatus also includes a central processing apparatus CPU for controlling various components and a program memory such as a ROM which stores data such as program codes to be read out by the central processing apparatus . Furthermore the image forming apparatus includes a work memory such as a RAM for temporarily storing or buffering data such as image data in executing each service. The image forming apparatus includes a display portion such as an LCD and an operation portion with respective switches including a push scan switch and a touch panel. The central processing apparatus can implement various kinds of processes to be described later by executing programs stored in the program memory on the work memory .

Furthermore the image forming apparatus includes a network communication portion for connecting the image forming apparatus to a network to perform various communications and a network connection portion for connecting the network communication portion to a network medium. The network communication portion copes with at least one of a wired network and wireless network. The wired network compatible network connection portion serves as a connector for connecting a wired network cable to the image forming apparatus . The wireless network compatible network connection portion serves as an antenna. Note that the wired network compatible network connection portion is connected to an external apparatus via a wired LAN. The wireless network compatible network connection portion is connected to an external apparatus by various methods such as wireless LAN Bluetooth NFC Near Field Communication and infrared communication.

Furthermore the image forming apparatus includes a flash memory serving as a nonvolatile memory which can store transmission source information of a packet received by the network communication portion . The image forming apparatus also includes a USB Universal Serial Bus communication portion for communicating with an information terminal via a USB interface. The image forming apparatus is connected to the information terminal via a USB connection portion formed by a connector such as a USB connector. Note that the information terminal may be connected to the image forming apparatus via the network communication portion and the network connection portion by wired or wireless connection.

A signal line connects the various components of the image forming apparatus to each other. As described above the image forming apparatus serves as an image processing apparatus which processes an image by the printer function scanner function and storage function and also serves as an image reading apparatus which reads an image by the scanner function.

Referring to a CPU controls various components of the information terminal . A disk apparatus installs an OS Operating System and application programs read out by the CPU and stores data such as various files. An external disk reading apparatus reads out contents in an external storage medium such as a CD ROM. A memory is used by the CPU to perform processing such as temporal storage and buffering of data as needed. The CPU can implement various kinds of processes to be described later by executing various programs stored in the disk apparatus on the memory .

When the CPU executes a software setup program for using the image forming apparatus from the information terminal the various programs are installed in the information terminal . The various programs stored in the disk apparatus include various device drivers such as a scanner driver for using the scan function and a printer driver for using the printer function. The various programs also include various applications such as a polling application for inquiring about the state the presence absence of an event or the like of the image forming apparatus and management software button monitor for managing the state status of the image forming apparatus .

A display portion includes an LCD. An operation portion is implemented by a keyboard and mouse or a touch panel. A network communication portion performs various communications by connecting the information terminal to a network. A network connection portion connects the network communication portion to a network medium. The information terminal is connectable to the network connection portion of the image forming apparatus via the network connection portion .

Similarly to the image forming apparatus the network communication portion and network connection portion cope with at least one of a wired network and wireless network. As a concrete form of them the network communication portion and network connection portion take a necessary function and form in accordance with a compatible network similarly to the network communication portion and network connection portion incorporated in the image forming apparatus . A signal line connects the various components. A USB communication portion communicates with various peripheral apparatuses via a USB interface. A USB connection portion includes a USB connector. The information terminal is connectable to the USB connection portion of the image forming apparatus via the USB connection portion .

In this way a processing system can be formed by connecting the image forming apparatus and the information terminal via a network. An example of the network is a LAN Local Area Network . Although a network formed from a network using a wired network cable will be exemplified below the present invention is not limited to this. The form of the network remains the same regardless of whether it is a wireless network or a network including both a wired network and a wireless network. An example of the image forming apparatus is an MFP. However the image forming apparatus need not always be an MFP and may be an image scanner or digital camera.

Application software designates scan settings such as a scan method color settings and resolution settings and instructs driver software to acquire an image by using an application programming interface API . Note that the application software can implement both the pull scan function and push scan function. In the pull scan function in response to a user operation to the information terminal the application software can make scan settings and issue a scan instruction to the image forming apparatus as described above. In the push scan function in response to a user operation to the image forming apparatus the application software can cause the image forming apparatus to read a document and acquire an image obtained by the reading operation. The application software can register the scan settings of the push scan function in the image forming apparatus . The push scan function will be described in detail later. The application software has a function of setting the function of the operation portion of the image forming apparatus and saving files in various formats.

Note that examples of the API are TWAIN and WIA OS standard image input APIs employed by Microsoft for WindowsMe and subsequent versions of Windows and interfaces based on standards unique to venders.

The driver software can transfer the image acquired from the image forming apparatus to the application software and display a unique GUI Graphical User Interface . The GUI has a function of for example previewing an image designating a crop area with respect to a preview image setting a resolution setting a reading mode a binary mode 8 bit multi level mode 24 bit multi level mode or the like and setting color adjustment such as gamma correction.

A device driver acquires an image by transmitting a control command for controlling a program incorporated in the image forming apparatus to the image forming apparatus . For the image forming apparatus which incorporates no firmware the device driver performs various types of control by accessing the control registers of the respective modules of the image forming apparatus . For example the device driver performs shading control motor speed setting in accordance with a resolution and a crop range transmission processing of gamma correction data received from the driver software to the image forming apparatus and sequence control for image reading.

A port driver performs communication control with the image forming apparatus in accordance with an interface such as a parallel interface USB interface IEEE1394 interface SCSI interface LAN interface wired LAN interface or wireless LAN interface. An operating system OS is for example a basic system of the information terminal such as Windows . A button monitor is a module which detects whether a given button on the operation portion of the image forming apparatus has been pressed.

In this embodiment a polling based push scan is adopted as an example of a push scan. The button monitor always detects performs polling at given intervals whether a button has been pressed in the image forming apparatus . For example the button monitor detects whether the push scan instruction button of the image forming apparatus has been pressed. Upon detecting that the button has been pressed the button monitor notifies the application software of information of the pressed button. Upon receiving the notification the application software causes the image forming apparatus to read a document under the conditions set for each button. More specifically when the button monitor detects that the button has been pressed the application software acquires a push scan instruction and scan settings from the image forming apparatus . Note that the scan settings are registered in the image forming apparatus as settings in a push scan. The application software then causes the image forming apparatus to read a document according to the scan settings.

Even if the information terminal and the image forming apparatus are connected via USB and the image forming apparatus operates as a USB device it is possible to implement a push scan by the above described polling based push scan.

Note that this embodiment is also applicable to a method event based push scan in which an image forming apparatus notifies all or specific information terminal apparatuses of occurrence of a push scan event.

The image forming apparatus and the plurality of information terminals are connected to a local area network . A case in which the apparatuses are connected to a wired network will be exemplified with reference to and subsequent drawings. However the apparatuses may be connected to a wireless network or a network including both a wired network and a wireless network.

The image forming apparatus and the plurality of information terminals information terminals A and B are connected on the local area network . In the following description the two information terminals will be referred to as information terminals A and B to discriminate them. Note that the names are not limited to them and the number of information terminals connected on the local area network is not limited to two.

In this embodiment a push scan assumes that identification information for specifying the information terminal is registered in advance in the image forming apparatus and used. If no information terminal is registered a plurality of information terminals may receive a push scan event notification and a large number of unintended information terminals may simultaneously perform reading control. In addition the image forming apparatus may unintentionally send a push scan event notification to the information terminal which does not want to perform a push scan. To prevent these situations the information terminal as a push scan target is registered in the image forming apparatus and a push scan event notification is sent to only the registered information terminal .

For example a plurality of information terminals connected to a network can register themselves as scan data read image transmission destinations in an image forming apparatus and the user can select an information terminal as a transmission destination in the image forming apparatus. In this case a display device and user input device for selecting an information terminal are required. In the first embodiment a case in which the upper limit number of registrable information terminals is one will be described. In this case if an attempt to register the second information terminal in the image forming apparatus is made the image forming apparatus may return an error resulting in a registration failure.

To cope with this the first embodiment provides an arrangement for registering an appropriate information terminal as a scan data transmission destination in a push scan. More specifically an information terminal to be registered as described above is decided by communication between information terminals on a network. This arrangement will be described in detail below.

Processing when the information terminal is registered deregistered in from the image forming apparatus will be explained with reference to the flowchart of . Processing shown in is implemented when the CPU of the information terminal executes the application software .

This flowchart is operable in all the information terminals registrable in the image forming apparatus and thus the expression information terminal is used instead of information terminal A or information terminal B. These expressions are used for different purposes in accordance with an information terminal registered in the image forming apparatus or the situation and an information terminal to be referred to as a registered terminal registered in the image forming apparatus . More specifically processing executed by cooperation of information terminals A and B will be described in detail with reference to the sequence charts of .

The flowchart shown in is executed when for example the application software is activated a transmission destination registration function is activated in a push scan or a registered terminal search instruction to be described later is issued to register a transmission destination.

In S the information terminal searches for a registered terminal as a push scan transmission destination in the image forming apparatus on the local area network . For example the information terminal searches for a registered terminal using UDP User Datagram Protocol broadcast. A registered terminal stands by to listen to a UDP broadcast from the information terminal . Upon receiving the UDP broadcast the registered terminal returns the information of itself to the information terminal . With this processing the information terminal searches for a registered terminal. In S based on the search result of the search processing the information terminal determines whether a registered terminal has been found. If a registered terminal has been found YES in S the process advances to S. On the other hand if no broadcast response has been received and no registered terminal has been found NO in S it is determined that the information terminal can be registered and the process advances to S.

In S the information terminal transmits a deregistration request to the registered terminal found in S. In S based on a response to this request the information terminal determines whether the registered terminal has been deregistered. If the request has succeeded to allow registration YES in S the process advances to S. On the other hand if the request has failed to disable registration NO in S the information terminal terminates the registration processing by excluding itself from push scan targets.

Note that processing when a deregistration request is received will be described later in S and subsequent steps.

According to the flowchart of if the user explicitly performs registration processing for example if the user issues a registration instruction when NO is determined in S the information terminal may display an error message shown in . In this case the user of the information terminal can finish the display by pressing an OK button after confirming contents of the error message .

On the other hand according to the flowchart of the user may implicitly perform registration processing. For example the application software is activated and the information terminal is automatically registered at the time of login. In this case data may be written in history information such as an internal log without displaying an error message so as to allow the user to confirm the information later. When transmitting a deregistration request data necessary for deregistration determination S to be described later may be transmitted. For example the necessary data includes a password for deregistration and setting data of the information terminal. This data may be included in data for transmitting a deregistration request or a deregistration request may be transmitted to the registered terminal and necessary data may be transmitted according to the return value of the request as needed.

In S the information terminal performs registration processing of registering itself in the image forming apparatus . Registration is completed by for example transmitting registration information necessary for registration to the image forming apparatus . This registration information includes for example identification information for specifying the information terminal . Upon receiving the registration information the image forming apparatus stores the registration information in the flash memory . A method of using the thus stored registration information will be described later. This registration information can implement control of transmitting scan data in a push scan to the registered terminal without performing transmission to an unregistered information terminal.

In S the information terminal stands by for reception of a deregistration request. As described in S the information terminal stands by to listen to the UDP broadcast. When another information terminal transmits a UDP broadcast the processing is to register the other information terminal resulting in reception of a deregistration request of the self information terminal S . Note that in processing such as end processing of the registered terminal the registered terminal may want to deregister itself. In this case even if no other information terminal transmits a UDP broadcast the registered terminal can deregister itself from the image forming apparatus by terminating this step and performing processing in S to be described later .

In S the information terminal receives a deregistration request from another information terminal. If no deregistration request is received in S the information terminal continues the deregistration request standby state in S. Note that the deregistration request in S is information similar to the deregistration request transmitted by the information terminal in S and the deregistration request transmitted by another information terminal on the network is received.

In S and S based on the received deregistration request the information terminal determines whether deregistration is performed deregistration determination . If deregistration cannot be performed NO in S the process advances to S otherwise YES in S the process advances to S.

Note that as described in S if there is other information necessary for deregistration a request for the information is set in the return value of the deregistration request as needed. For example there are some determination conditions for deregistration determination in S and S as follows.

The first determination condition indicates that deregistration is performed when a deregistration request is received. Since deregistration can be freely performed when the user wants to perform a push scan this is effective in a small scale network environment such as a home network.

The second determination condition indicates that deregistration is performed when the user of the registered terminal confirms and permits deregistration. In this case for example a dialog shown in is displayed on the display portion of the registered terminal and the user of the registered terminal confirms deregistration. Under this determination condition it is possible to prevent deregistration unintended by the user. When the dialog is displayed on the display portion if the user of the registered terminal permits deregistration he she can permit deregistration by pressing an OK button . On the other hand if the user does not permit deregistration he she can prohibit deregistration by pressing a Cancel button . When either of the buttons is pressed a message or information indicating it is transmitted to the information terminal as the deregistration request source.

The third determination condition indicates that deregistration is performed when a password is set in advance in the registered terminal the user of an information terminal to be registered is prompted to input a password and then the input password coincides with the set password. For example a dialog shown in is displayed on the information terminal which has transmitted the deregistration request and the user is prompted to input a password via an input field and press an OK button . The information terminal which has transmitted the deregistration request transmits the password together with the deregistration request to the registered terminal. When the user inputs the password in the registered terminal which has received the password it is determined to perform deregistration. This determination condition is effective when for example one user uses a plurality of information terminals and only the user wants to switch a registration target terminal.

The fourth determination condition indicates that deregistration is performed depending on the state of the registered terminal. In a predetermined state for example a sleep state a power supply state or a working state in which an input device of the information terminal such as a keyboard or mouse operates deregistration is performed. For example when the user of the registered terminal is away from the registered terminal deregistration cannot be performed under only the second determination condition. Under a combination of the second and fourth conditions it is possible to perform deregistration when the user is away from the registered terminal and the registered terminal is in a speed state.

The fifth determination condition indicates that the registered terminal is deregistered when usable time information is set in the image forming apparatus for each user and a predetermined condition date time condition such as a use time period and a day of the week is satisfied. For example the user of the image forming apparatus may be different depending on a specific time period such as a weekday or holiday. In this case this determination condition is effective.

The sixth determination condition indicates that deregistration is performed depending on an elapsed time after the registered terminal used the image forming apparatus last time. When an operation to the image forming apparatus by the registered terminal satisfies a predetermined condition operation condition for example when one hour has elapsed after a push scan was used last time the probability that a push scan is executed next time is assumed to be low thereby performing deregistration.

The seventh determination condition indicates that deregistration is performed depending on the use count. For example the registered terminal can use the image forming apparatus a predetermined number of times for example five times after the registered terminal is registered for a push scan. If another user wants to use the image forming apparatus after the registered terminal uses the image forming apparatus the predetermined number of times the registered terminal is deregistered to allow the other user to use the image forming apparatus.

The eighth determination condition indicates that information terminals are switched depending on the installation time of a program for implementing the flowchart shown in . The installation times of the respective information terminals are compared with each other. Based on the comparison result for example the user who has installed the program first is prioritized.

The ninth determination condition indicates that deregistration is performed when priority levels are set for respective users or information terminals and a deregistration request is received from the information terminal of a user with a higher priority level.

Note that the above determination conditions are merely examples and a plurality of conditions can be used in combination in accordance with the use environment of the user. Therefore it is possible to adaptively use determination conditions other than the above conditions.

Furthermore the user can set the determination condition in a host apparatus for example the information terminal connected to the image forming apparatus via a communication interface the network connection portion or the USB connection portion . More specifically the user can set the determination condition via the operation portion by providing a user interface UI for setting the determination condition to the display portion of the host apparatus for example the information terminal . This UI is displayed when for example the CPU of the information terminal executes the application software . Similarly the UIs shown in are also displayed when the CPU of the information terminal executes the application software .

If it is determined in Sthat deregistration cannot be performed the information terminal transmits in S a non deregistration status as the return value of the deregistration request to the information terminal as the deregistration request source. In this case the information terminal which has issued the deregistration request performs the processing in S. When the registered terminal transmits the non deregistration status in S it is determined that the deregistration request has failed. As a result only the information terminal which is executing this step remains as a push scan target.

After that the process advances to S and the information terminal stands by for reception of a deregistration request again.

On the other hand if it is determined in Sthat deregistration can be performed the information terminal performs in S deregistration processing of deregistering itself from the image forming apparatus . For example the information terminal completes deregistration by transmitting information necessary for deregistration to the image forming apparatus .

In S the information terminal transmits a deregistration status as the return value of the deregistration request to the other information terminal. At this time the other information terminal is performing the processing in S. When the registered information terminal transmits the deregistration status in S the other information terminal determines that the deregistration request has succeeded. As result the other information terminal executes the processes in S and subsequent steps and is registered as a push scan target.

Note that the deregistration status and non deregistration status are managed in the memory of the information terminal . The CPU switches between the deregistration status and the non deregistration status in accordance with exchange processing with another information terminal.

The sequence between the plurality of information terminals and the image forming apparatus will be described with reference to the sequence charts of . shows an example in which information terminal A is set as a push scan target and is not deregistered in response to a deregistration request from information terminal B. shows an example in which information terminal A is registered as a push scan target but information terminal B deregisters information terminal A later and is set as a push scan target.

Information terminal A searches for a registered terminal S . This processing corresponds to S of . Since information terminal B has not performed registration processing there is no information terminal which responses to a UDP broadcast. It is then determined that there is no registered terminal thereby performing the processing in S of .

The image forming apparatus determines that registration has succeeded and returns a response registration completion S . The processes in S and S correspond to that in S of .

With the above processing information terminal A is in a state in which a push scan can be performed from the image forming apparatus .

A case in which registration processing of information terminal B is performed and fails will be described next.

Information terminal B searches for a registered terminal S . In this search processing information terminal B transmits a UDP broadcast as described above.

Information terminal A is a registered terminal and stands by for a deregistration request in S of . Thus upon receiving the UDP broadcast information terminal A returns a response S . This corresponds to S of and information terminal B advances the process to S.

Information terminal A internally performs deregistration determination S . This corresponds to S of . In this case information terminal A determines that no deregistration is performed. Thus information terminal A transmits the non deregistration status to information terminal B S . Since information terminal A is not deregistered by information terminal B in information terminal A returns the non deregistration status as a response in S of . After S of the process advances to S and information terminal A stands by for a deregistration request. While information terminal A stands by for a deregistration request it remains registered in the image forming apparatus and is a push scan target.

On the other hand since the deregistration request of information terminal B fails in S of the process is terminated.

A case in which information terminal B is set as a push scan target will now be described with reference to . Note that processes in S to S correspond to those in S to S of . The processing contents are the same and a description thereof will be omitted.

Information terminal A internally performs deregistration determination S . The difference from is that deregistration is determined to be performed in this processing. Information terminal A performs deregistration processing for the image forming apparatus S .

The image forming apparatus returns to information terminal A deregistration completion information indicating that deregistration has been performed. The processes in S and S correspond to that in S of .

Information terminal A transmits the deregistration status to information terminal B S . The processing in S corresponds to S of and the processing of information terminal A ends.

Information terminal B recognizes that the deregistration request has succeeded in S of and thus the process advances to S.

Information terminal B performs registration processing for the image forming apparatus S . In this registration processing information terminal B can be registered since information terminal A registered first has been deregistered.

The image forming apparatus determines that registration has succeeded and returns a response registration completion S . The processes in S and S correspond to that in S of .

With the above processing information terminal A registered first is deregistered and information terminal B registered later is set as a push scan target.

No information terminal is registered during a period from the deregistration processing S of information terminal A to the registration processing S of information terminal B. During this period therefore information terminal A may unwantedly perform registration processing. The above unregistration period may be a negligibly short time depending on the processing speed. If however the unregistration period is not negligible according to the processing speed information terminal A can handle this by extending a period during which it listens to the UDP broadcast until the registration processing S is completed. Information terminal A may be configured not to perform registration processing during the listening period. Also during the above period a third party information terminal other than information terminals A and B may unwantedly perform registration processing. To solve this problem the image forming apparatus may be configured not to accept new registration processing during a predetermined period after deregistration is performed. The predetermined period is set as needed in accordance with the time from when the deregistration processing is performed until the registration processing of information terminal B is performed in S.

Alternatively in the deregistration processing in S the image forming apparatus may be notified of the identification information of an information terminal for example information terminal B to be newly registered. The image forming apparatus may be configured to deregister information terminal A and not to register any terminal whose identification information does not coincide with the above identification information during the predetermined period.

Furthermore if the image forming apparatus is notified of the identification information of the information terminal for example information terminal B to be newly registered in the deregistration processing as described above the new information terminal information terminal B may be registered simultaneously with deregistration. This arrangement can prevent the above unregistration period from occurring. Furthermore the arrangement may produce an effect that information terminal B need not perform the registration processing in S.

Processing of determining an information terminal registered as a push scan transmission destination when a user instruction for a push scan is issued to the image forming apparatus will now be described.

As an example of the above processing for example the image forming apparatus may specify a registered information terminal and transmit scan data to only the specified information terminal. When for example a button for a push scan is pressed in the image forming apparatus while an information terminal on the network performs polling the information terminal transmits to the image forming apparatus the identification information of itself together with a scan instruction. Under the condition that the received identification information coincides with the identification information of the registered information terminal stored in the flash memory the image forming apparatus transmits scan data to the information terminal.

That is by determining a registered information terminal by the image forming apparatus it is possible to prevent scan data from being transmitted when an unregistered information terminal issues a scan instruction. Note that if the above two pieces of identification information do not coincide with each other a document need not be scanned.

As another example of the above determination processing for example an information terminal may determine whether it has been registered. For example the image forming apparatus returns the identification information of the information terminal registered in itself as a response to polling from the information terminal. If the returned identification information coincides with the identification information of its own the information terminal issues a scan instruction to the image forming apparatus . With this processing when the button for a push scan is pressed the image forming apparatus can appropriately transmit scan data to the registered information terminal without determining whether the information terminal which is performing polling has been registered.

As still another example an information terminal may determine whether it has been registered. If the information terminal itself has not been registered it need not perform polling for a push scan. In this case it is possible to construct a system so as to prevent an unregistered information terminal from performing polling. Therefore the identification information of an information terminal registered in the image forming apparatus need not be stored.

As described above according to the first embodiment when registering an information terminal as a push scan transmission destination in an image forming apparatus a deregistration request is issued to another information terminal already registered to deregister the other information terminal thereby performing registration. Consequently it is possible to newly register in the image forming apparatus an information terminal for which a push scan is to be performed while limiting the number of information terminals registered in the image forming apparatus.

When for example an information terminal is registered in an image forming apparatus to be a push scan target it is possible to limit the number of information terminals registered in the image forming apparatus to one.

According to the first embodiment it is possible to decide an information terminal a terminal to be newly registered or a terminal to remain registered to be registered in an image forming apparatus by communication between a plurality of information terminals registrable in the image forming apparatus. Consequently it is possible to register an appropriate information terminal in the image forming apparatus without performing processing of selecting an information terminal to be registered.

Note that the number of information processing apparatuses registrable in an image forming apparatus is set to one in the first embodiment. The present invention however is not limited to this and a plurality of information processing apparatuses may be registrable.

There is also a case in which old registration processing software incorporating no processing of the flowchart of of the first embodiment is included on the network. In this case the old registration processing software may execute registration processing for an image forming apparatus in which the number of registered information processing apparatuses is limited to one. In this case in the registration processing in S registration from the old registration processing software can be disabled by limiting registration by a software version or the like. As a result software which can perform registration in an image forming apparatus in which the number of registered information processing apparatuses is limited to one is limited to new software incorporating the flowchart of the first embodiment. Thus even if a plurality of information terminals on the network incorporate new and old software programs the number of registered information terminals can be limited to one.

The first embodiment has exemplified a case in which one image forming apparatus is connected on a network. However a plurality of image forming apparatuses may be connected. In this case the upper limit number of registered information terminals may be set in some of the image forming apparatuses. If the upper limit number is set it is only necessary to perform the registration method of the first embodiment. On the other hand if no upper limit number is set it is necessary to perform registration processing of all information terminals each of which issues a registration request. The upper limit number may change depending on an image forming apparatus or no arrangement for confirming the upper limit number may be prepared in an image forming apparatus produced in the past and the like.

In the second embodiment an arrangement will be described in which even if both an image forming apparatus which is limited in terms of the number of registered information terminals and an image forming apparatus which is not limited in terms of the number of registered information terminals are included registration processing is performed for the image forming apparatus which is limited in terms of the number of registered information terminals.

Note that the software arrangement of an image forming apparatus and an information terminal according to the second embodiment is the same as in the first embodiment and a detailed description thereof will be omitted.

Referring to the plurality of image forming apparatuses and the plurality of information terminals are connected to a local area network . A case in which the apparatuses are connected to a wired network will be exemplified with reference to and subsequent drawings. However the apparatuses may be connected to a wireless network or a network including both a wired network and a wireless network.

The plurality of image forming apparatuses image forming apparatuses A B and C and the plurality of information terminals information terminals A and B are connected on the local area network . In the following description the three image forming apparatuses will be referred to as image forming apparatuses A B and C to discriminate them. Similarly the two information terminals will be referred to as information terminals A and B to discriminate them. Note that the names are not limited to them and the number of image forming apparatuses and that of information terminals connected on the local area network are not limited to them.

In this example for image forming apparatus A the number of registrable information terminals to be referred to as a registrable count hereinafter is limited to one. For each of image forming apparatuses B and C the registrable count is limited to 64. Image forming apparatus B has a function of returning the registrable count. Upon receiving a command to acquire the registrable count from an information terminal image forming apparatus B can return the registrable count as a response. On the other hand image forming apparatus C has no function of returning the registrable count. Even if image forming apparatus C receives a command to acquire the registrable count from an information terminal it returns an unknown command error as a response.

Note that in the second embodiment a flash memory of the image forming apparatus stores the registrable count in addition to identification information for identifying a registered terminal as registration information about an information terminal. In response to a command from the information terminal the image forming apparatus returns the registrable count included in the registration information to the information terminal .

Processing when registering deregistering the information terminal in from the image forming apparatus will now be described with reference to the flowchart of . Processing shown in is implemented when a CPU of the information terminal executes application software .

In S the information terminal transmits a command to acquire the registrable count the remaining registrable count to the image forming apparatus to which the information terminal issues a registration request of itself and receives a response from the image forming apparatus .

In S based on the received response the information terminal determines whether it can acquire the registrable count. If the information terminal cannot acquire the registrable count NO in S the process advances to S. On the other hand if the information terminal can acquire the registrable count YES in S the process advances to S.

In this determination processing for example if a response is received from image forming apparatus C the response indicates an unknown command error and thus the information terminal cannot acquire the registrable count. The process then advances to S.

If it is determined in S that the registrable count can be acquired the information terminal determines in S whether the registrable count is equal to or larger than a predetermined number. Assume that the predetermined number is one. If therefore the registrable count is equal to or larger than the predetermined number one it is possible to register the information terminal in the image forming apparatus in S and thus the information terminal performs registration processing in the image forming apparatus thereby terminating the process. On the other hand if the registrable count is smaller than the predetermined number the information terminal performs deregistration processing in S. The deregistration processing corresponds to the processing shown in the flowchart of of the first embodiment.

In this determination processing for example if a response is received from image forming apparatus A whose registrable count is limited to one 1 is returned as the registrable count when no information terminal has been registered in image forming apparatus A and 0 is returned when an information terminal has already been registered.

If it is determined in S that the registrable count cannot be acquired NO in S the information terminal attempts in S to perform registration processing in the image forming apparatus . After that the information terminal determines whether the registration processing has succeeded. If registration has succeeded YES in S the process ends. On the other hand if registration has failed NO in S the information terminal performs deregistration processing in S.

Note that a case in which registration fails may be a case in which the number of information terminals registered in the image forming apparatus has already reached the upper limit of the registrable count.

If the registrable count is smaller than one or registration has failed the information terminal performs deregistration processing for the image forming apparatus . In this processing for example the deregistration processing executed in the flowchart of of the first embodiment is performed.

As described above according to the second embodiment when an image forming apparatus can return an information terminal registrable count it is possible to switch between registration processing and the processing shown in the flowchart of of the first embodiment in accordance with the returned registrable count. Consequently in the image forming apparatus which can return the registrable count it is possible to prevent the situation in which the number of registered information terminals exceeds the registrable count to disable registration as a result of attempting registration processing. Furthermore even if a plurality of image forming apparatuses are connected on a network and the information terminal registrable counts of the respective image forming apparatuses are different from each other it is possible to appropriately switch processing.

In addition even if an image forming apparatus cannot return the information terminal registrable count it is possible to attempt registration processing and perform the processing shown in the flowchart of of the first embodiment in accordance with the result of the registration processing. Therefore even if a plurality of image forming apparatuses are connected on a network and some of them cannot return the information terminal registration counts it is possible to perform the processing shown in the flowchart of of the first embodiment after attempting registration processing only in this case.

As described above even if a plurality of image forming apparatuses are connected to a network and some of them cannot return the information terminal registrable counts it is possible to perform appropriate registration processing in each image forming apparatus. There is a case in which a plurality of image forming apparatuses are connected on a network and the information terminal registrable counts of some of the image forming apparatuses are limited to one. In this case as well the above arrangement can limit the information terminal registrable counts to one without influencing registration processes by other image forming apparatuses.

Furthermore it is possible to prevent an information terminal in use from being deregistered against the user s intention by limiting a deregistration method.

Note that the information terminal registrable count remaining registrable count of the image forming apparatus is acquired in S. The present invention however is not limited to this. For example if each information terminal stores the total number of information terminals registrable in the image forming apparatus the number of information terminals already registered in the image forming apparatus may be acquired in S. This allows the information terminal to grasp the remaining registrable count. Note that the total number may be transmitted from the image forming apparatus to the information terminal on the network at for example an arbitrary timing. Alternatively if the total number is set for each image forming apparatus model it may be determined in accordance with the model of an image forming apparatus to which the information terminal issues a registration request.

In the first embodiment the upper limit number of information terminals registrable in an image forming apparatus is one. However the upper limit number may be set to a plural number two or more . For example if the upper limit number is set to two it is possible to switch a push scan transmission destination without arranging a display device such as an LCD by providing two operation portions operation portions in in the image forming apparatus. Alternatively the image forming apparatus may include a display portion and the user may select an information terminal as a transmission destination on the display portion at the time of a push scan. In this case setting the upper limit number of registrable information terminals can limit selection candidates thereby facilitating a selection operation by the user.

Even if the upper limit number is two or more it is necessary to perform registration processing when the upper limit number of information terminals registrable in the image forming apparatus is exceeded.

Note that the software arrangement of an image forming apparatus and an information terminal according to the third embodiment is the same as in the first embodiment and a detailed description thereof will be omitted.

Processing when registering deregistering the information terminal in from the image forming apparatus will now be described with reference to the flowchart of . Processing shown in is implemented when a CPU of the information terminal executes application software .

In S the information terminal searches for a registered terminal. This processing corresponds to S of . In S based on the number of found registered terminals the information terminal determines whether it can register itself in the image forming apparatus as a registration target. This determination processing is performed depending on whether the number of found registered terminals is smaller than the upper limit number of information terminal registrable in the image forming apparatus as a registration target. Note that a registrable count may be set in advance in the application software or may be acquired before or after S from the image forming apparatus in which the information terminal is to be desirably registered.

If registration is possible YES in S that is if the number of found registered terminals is smaller than the upper limit of the registrable count the process advances to S. On the other hand if the number of found registered terminals is equal to or larger than the upper limit of the registrable count NO in S the process advances to S.

In S the information terminal selects from the plurality of other found registered terminals a registered terminal to which a deregistration request is to be transmitted an information terminal to be deregistered deregistration terminal . For example a UI shown in is displayed on a display portion of the information terminal and an information terminal to be deregistered deregistration terminal is selected based on a user operation to the UI. shows a state in which information terminals B and C are displayed in a registered terminal list and information terminal C is selected as a deregistration terminal. In this case subsequent deregistration processing is performed for information terminal C.

Note that when the CPU of the information terminal executes the application software the UI shown in is displayed.

Subsequent processes in S to S correspond to those in S to S in the first embodiment. The processing contents are the same and a description thereof will be omitted.

As described above according to the third embodiment it is possible to obtain the following effect in addition to the effects described in the first and second embodiments. That is according to the third embodiment even if the upper limit number of information terminals registrable in an image forming apparatus is set to two or more it is possible to perform appropriate registration processing by selecting another information terminal to be deregistered in deregistration processing.

Furthermore Scan Service Definition Version 1.0 of WSD indicates a Scan Service using WSD which is defined by Microsoft USA.

This embodiment can be implemented by using a service and protocol other than the above described network protocol. For example the Windows 8 OS provided by Microsoft can implement a push scan via a network using the WSD Scan Service and can also use the WSD Scan Service.

Note that the software arrangement of an image forming apparatus and an information terminal according to the fourth embodiment is the same as in the first embodiment and a detailed description thereof will be omitted.

Processing when registering deregistering the information terminal in from the image forming apparatus will now be described with reference to the flowchart of . Processing shown in is implemented when a CPU of the information terminal executes application software .

As preprocessing of the flowchart the information terminal receives a message from the image forming apparatus in response to a WS Discovery message issued by the information terminal . More specifically the information terminal receives a Hello message response or a WSD Hello message from the image forming apparatus at the time of activation of the image forming apparatus . Assume that an image forming apparatus in which an event is to be registered has been found by a WS Eventing Probe message.

Processes in S to S correspond to those in S to S of of the first embodiment. The processing contents are the same and a detailed description thereof will be omitted.

In S the information terminal performs registration processing of registering itself in the image forming apparatus . The information terminal completes registration by for example transmitting a WS Eventing Subscribe message to the image forming apparatus .

In S the information terminal stands by for reception of a deregistration request. Similarly to S the information terminal stands by to listen to a UDP broadcast. If another information terminal transmits a UDP broadcast processing of registering the other information terminal is performed to receive a deregistration request of the self information terminal S . Note that in processing such as end processing of a registered terminal the registered terminal may want to deregister itself. In this case even if no other information terminal transmits a UDP broadcast the registered terminal can end this step and deregister itself by transmitting a WS Eventing Unsubscribe message to the image forming apparatus . In WSD the image forming apparatus transmits a WSD Bye message before it is powered off. Upon receiving the Bye message the information terminal ends this step.

Processes in S to S correspond to those in S to S of of the first embodiment. The processing contents are the same and a detailed description thereof will be omitted. Note that deregistration in S is completed when for example the information terminal transmits a WS Eventing Unsubscribe message to the image forming apparatus .

Note that the fourth embodiment assumes a case in which the number registrable count of information terminals registrable in the image forming apparatus is limited to one. The arrangement of the third embodiment in which the registrable count is confirmed with the image forming apparatus and then processing is executed is also applicable.

In the fourth embodiment the registrable count can be confirmed with the image forming apparatus by the following method. That is a custom element is added as private information of GetScannerElements the definition of a name space xmlns ans http www.abc.xxx ns wdp scan v100 . It is then possible to acquire the registrable count by setting it in the custom element.

The information terminal receives the GetScannerElementsResponse message shown in . The information terminal reads an element of 1. This makes it possible to acquire the registrable count of the image forming apparatus .

In the fourth embodiment the element is used as private information the definition of the name space xmlns ans http www.abc.xxx ns wdp scan v100 . The present invention however is not limited to this. If for example the OS has the similar function public information the definition of a name space wse http www.yyyy.xxx YYYY MM ws evt is used.

As described above according to the fourth embodiment even if a push scan is implemented using the WSD protocol when an information terminal is registered in an image forming apparatus to be a push scan target the number of information terminals registered in the image forming apparatus can be limited to one.

Furthermore if an old OS incorporating no function of implementing the processing shown in each flowchart of the above embodiments is included on a network it may execute registration processing for an image forming apparatus whose registrable count is limited to one. In this case by installing software of implementing the processing shown in the flowchart of in the old OS it is possible to limit the registrable count to one even if both new and old OSs are included on the network.

Note that if 16 is set in the element to describe 16 the registrable count is limited to 16. In this way it is possible to set the upper limit number of information terminals registrable in an image forming apparatus to two or more in accordance with the specifications of the image forming apparatus.

In each of the aforementioned embodiments a case in which an information terminal which has received a deregistration request executes deregistration processing for the image forming apparatus has been described. The present invention however is not limited to this. For example an information terminal which has issued a deregistration request may perform deregistration processing. More specifically the information terminal receives from a registered information terminal deregistration permission as a response to the deregistration request. Upon receiving the deregistration permission the information terminal may perform processing of deregistering the registered information terminal from the image forming apparatus .

In each of the aforementioned embodiments when a given information terminal registers itself it executes the confirmation processing S of confirming whether another information terminal has already been registered. However the present invention is not limited to this and the above confirmation processing may be executed at an arbitrary timing. For example the confirmation processing may be performed in response to a user instruction to the application software . More specifically the user may instruct the confirmation processing and the application software may display the presence absence of another registered information processing apparatus. The user may then confirm the display with the information terminal and transmit a deregistration request in S or instruct the registration processing in S. Similarly a deregistration request may be transmitted at an arbitrary timing in S.

Furthermore the processing of searching for a registered information terminal in S and the processing of transmitting a deregistration request in S may be performed by one instruction from the user. That is in response to one instruction from the user the search processing in S may be performed and a deregistration request may be automatically transmitted in S based on the result of the search processing. Alternatively in response to a registration instruction from the user the processes in S to S may be automatically executed.

Search processing may be performed in response to a search instruction from the user and the result may be displayed on an information terminal. After the user confirms the display he she may additionally issue a registration instruction or deregistration request instruction.

In each of the aforementioned embodiments a case in which a push scan is performed as a service provided by the image forming apparatus has been exemplified. The present invention however is not limited to this. Each of the aforementioned embodiments is applicable to a case in which for each of various services provided by an image forming apparatus the number of information terminals which can use the service is limited. For example each of the aforementioned embodiments may be applied to a case in which an operation on the image forming apparatus side decides an information terminal apparatus from which print data is received and the print data is received from the information terminal apparatus. A device which provides a service is not limited to an image reading apparatus and printing apparatus and may be for example a digital camera PC or Web server. As for a digital camera processing of transmitting a shot image to an information processing apparatus may be provided as a service by the digital camera. Alternatively as for a PC or Web server processing of transmitting various data to an information processing apparatus or processing of receiving data may be provided as a service.

Examples of an information processing apparatus to which the device provides a service are a PC a Web server and mobile devices such as a digital camera smartphone and tablet.

In the above embodiments a case in which an information processing apparatus which is provided with a service among a plurality of information processing apparatuses is registered in a device which provides the service. The present invention however is not limited to this. In an information processing apparatus provided with a service registration information as an apparatus which is provided with the service may be stored. In this case an information processing apparatus which stores no registration information is prevented from requesting execution of the service for example instructing a push scan . Alternatively when the information processing apparatus requests execution of the service it may transmit the registration information to a device for example a scanner and the device may provide the service for example transmit scan data in response to only the request including the registration information.

Embodiment s of the present invention can also be realized by a computer of a system or apparatus that reads out and executes computer executable instructions e.g. one or more programs recorded on a storage medium which may also be referred to more fully as a non transitory computer readable storage medium to perform the functions of one or more of the above described embodiment s and or that includes one or more circuits e.g. application specific integrated circuit ASIC for performing the functions of one or more of the above described embodiment s and by a method performed by the computer of the system or apparatus by for example reading out and executing the computer executable instructions from the storage medium to perform the functions of one or more of the above described embodiment s and or controlling the one or more circuits to perform the functions of one or more of the above described embodiment s . The computer may comprise one or more processors e.g. central processing unit CPU micro processing unit MPU and may include a network of separate computers or separate processors to read out and execute the computer executable instructions. The computer executable instructions may be provided to the computer for example from a network or the storage medium. The storage medium may include for example one or more of a hard disk a random access memory RAM a read only memory ROM a storage of distributed computing systems an optical disk such as a compact disc CD digital versatile disc DVD or Blu ray Disc BD a flash memory device a memory card and the like.

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.

This application claims the benefit of Japanese Patent Application No. 2014 039291 filed Feb. 28 2014 which is hereby incorporated by reference wherein in its entirety.

