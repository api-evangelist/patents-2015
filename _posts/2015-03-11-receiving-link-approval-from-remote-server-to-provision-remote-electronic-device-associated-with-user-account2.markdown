---

title: Receiving link approval from remote server to provision remote electronic device associated with user account
abstract: This application discloses a method of provisioning an electronic device. The electronic device proactively broadcasts an advertising packet that includes a device identifier associated with the electronic device. A server receives the device identifier via a client device, and issues a link approval response when it verifies that the electronic device associated with the device identifier is available for provisioning in association with a user account. In response to the link approval response, the electronic device and the client device establish communication via a short range wireless link. The client device encrypts at least a portion of network credentials of a secure wireless network using a password key generated at the server, and provides the encrypted network credentials to the electronic device. The electronic device decrypts the encrypted network credentials using a key generated at the electronic device, and accesses the secure wireless network using the decrypted network credentials.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09600726&OS=09600726&RS=09600726
owner: GOOGLE INC.
number: 09600726
owner_city: Mountain View
owner_country: US
publication_date: 20150311
---
This application is a continuation of U.S. Utility patent application Ser. No. 14 510 023 filed Oct. 8 2014 issued as U.S. Pat. No. 9 009 805 on Apr. 14 2015 entitled Method and System for Provisioning an Electronic Device which claims priority to U.S. Provisional Patent Application No. 62 057 991 filed Sep. 30 2014 entitled Method and System for Video Monitoring both of which are hereby incorporated by reference in their entirety.

This application is also related to co pending U.S. Design patent application Ser. No. 29 504 605 filed Oct. 7 2014 entitled Video Monitoring User Interface with Event Timeline and Display of Multiple Preview Windows At User Selected Event Marks which is hereby incorporated by reference in its entirety.

This relates generally to computer technology including but not limited to methods and systems for provisioning an electronic device by associating a user account with the electronic device and establishing a secure network connection for the electronic device.

Video surveillance produces a large amount of continuous video data over the course of hours days and even months. Such video data includes many long and uneventful portions that are of no significance or interest to a reviewer. In some existing video surveillance systems motion detection is used to trigger alerts or video recording. However using motion detection as the only means for selecting video segments for user review may still produce too many video segments that are of no interest to the reviewer. For example some detected motions are generated by normal activities that routinely occur at the monitored location and it is tedious and time consuming to manually scan through all of the normal activities recorded on video to identify a small number of activities that warrant special attention. In addition when the sensitivity of the motion detection is set too high for the location being monitored trivial movements e.g. movements of tree leaves shifting of the sunlight etc. can account for a large amount of video being recorded and or reviewed. On the other hand when the sensitivity of the motion detection is set too low for the location being monitored the surveillance system may fail to record and present video data on some important and useful events.

It is a challenge to identify meaningful segments of the video stream and to present them to the reviewer in an efficient intuitive and convenient manner. Human friendly techniques for discovering and presenting motion events of interest both in real time or at a later time are in great need.

In some environments the large amount of information produced by home monitoring devices is communicated to a remote server to enable long term off site storage and sharing of the information. Because this information such as videos produced by surveillance cameras could involve private subscriber information it is important that transmission of the data between the home monitoring device and remote server is secure. Similarly it is important that the process of provisioning an electronic monitoring device i.e. the process of associating the device with an account user and configuring the device to communicate with a remote server e.g. via a home wireless network connected to the Internet via a router is secure. For example a provisioning process for a home monitoring device should prevent unauthorized access to the home monitoring device and should also protect network security credentials e.g. network encryption keys and passwords . In addition to being secure a provisioning process should be user friendly. This could be a challenge given that many home monitoring devices have constrained user interfaces. For example a small surveillance camera is unlikely to have a display or a rich set of user interface controls that can be used in a provisioning process.

A home monitoring device can be provisioned via an application running on a second device connected to the home monitoring device but that could expose the device to unauthorized use and or expose network security credentials especially if the home monitoring device and the second device are connected by an unsecure wireless link. Some risk of exposure of network credentials can be prevented by using direct wired connections between the home monitoring device and the second device and or an Internet router during provisioning but direct wired connections are less convenient than wireless links and even with the use of wired connections confidential device and network information could still be compromised if saved in the clear on the second device and or the server. For the above reasons it would be useful to provide methods for provisioning electronic monitoring devices that are both convenient and secure.

Accordingly there is a need for provisioning an electronic device e.g. a video surveillance camera or other monitoring device by associating the electronic device with a user account and establishing secure communication for the electronic device in a secure and wireless manner. Such methods optionally complement or replace conventional methods of using a wired connection with a personal computer or other second device to establish secure communications for the electronic device during and after provisioning.

In accordance with one aspect of this application a device provisioning method is executed by an electronic device a client device and a server. The device provisioning method includes logging onto a user account managed by the server from the client device broadcasting by the electronic device an advertising packet that includes a device identifier uniquely associated with the electronic device and transmitting the advertising packet to the server via the client device as part of a link approval request. The device provisioning method further includes in response to receiving the link approval request verifying by the server that the electronic device associated with the device identifier is available for provisioning in association with the user account and when verified issuing by the server a link approval response to the client device the link approval response indicating that the electronic device associated with the device identifier is available for provisioning in association with the user account.

The device provisioning method further includes in response to receiving the link approval response indicating that the electronic device associated with the device identifier is available for provisioning in association with the user account establishing a short range wireless link between the electronic device and the client device obtaining at the client device network credentials for accessing a secure wireless network encrypting at the client device at least a portion of the network credentials using a password key generated at the server and communicated from the server to the client device sending the encrypted network credentials from the client device to the electronic device over the short range wireless link and obtaining at the electronic device decrypted network credentials by decrypting the encrypted network credentials using a key generated at the electronic device. The device provisioning method further includes accessing by the electronic device the secure wireless network using the decrypted network credentials.

In accordance with some implementations a computer system includes one or more processors memory and one or more programs the one or more programs are stored in the memory and configured to be executed by the one or more processors and the one or more programs include instructions for performing the operations of any of the methods described above. In accordance with some implementations a computer readable storage medium has stored therein instructions which when executed by a computer system with one or more processors cause the computing system to perform the operations of any of the methods described above. In accordance with some implementations a computer system includes means for performing the operations of any of the methods described above.

In accordance with various implementations of the present invention an electronic device is placed in proximity to a client device during the course of provisioning the electronic device. The electronic device broadcasts advertising packets for the purpose of identifying itself and facilitating establishing of a short range wireless link with the client device. In some situations the short range wireless link has a limited security level as in the case of a classical Bluetooth link or a Bluetooth Low Energy BLE link without optional security features . However the short range wireless link is convenient for clients and provisioning as it is widely implemented in client devices e.g. in smart phones laptop computers and tablet computers automatically established and demands little or no user intervention. Using the short range wireless link the client device functions as an intermediary device that helps exchange information between the electronic device and a server before communication via any secure wireless network is made available between the electronic device and the server. Exemplary information that can be exchanged between the electronic device and the server includes but is not limited to device identifiers encryption seeds e.g. random numbers authentication tokens and tags and flags. In some implementations the client device encrypts security sensitive data e.g. network credentials of secure networks before communicating them over the short range wireless link.

Further during the course of provisioning the electronic device the client device functions temporarily as an input output interface to enable the electronic device to be associated with a user account managed by a server system and establish secure communication with the server system. As noted above sensitive information exchanged between the server and the electronic device via the client device is protected from being intercepted by encryption e.g. by the electronic device being provisioned . In some implementations the electronic device encrypts sensitive information with a device secret that is specific to the electronic device being provisioned and that is known only to the electronic device and the server which is responsible for managing the process by which a specific electronic device is associated with and provisioned for a specific user account.

Reference will now be made in detail to implementations examples of which are illustrated in the accompanying drawings. In the following detailed description numerous specific details are set forth in order to provide a thorough understanding of the various described implementations. However it will be apparent to one of ordinary skill in the art that the various described implementations may be practiced without these specific details. In other instances well known methods procedures components circuits and networks have not been described in detail so as not to unnecessarily obscure aspects of the implementations.

It will also be understood that although the terms first second etc. are in some instances used herein to describe various elements these elements should not be limited by these terms. These terms are only used to distinguish one element from another. For example a first user interface could be termed a second user interface and similarly a second user interface could be termed a first user interface without departing from the scope of the various described implementations. The first user interface and the second user interface are both user interfaces but they are not the same user interface.

The terminology used in the description of the various described implementations herein is for the purpose of describing particular implementations only and is not intended to be limiting. As used in the description of the various described implementations and the appended claims the singular forms a an and the are intended to include the plural forms as well unless the context clearly indicates otherwise. It will also be understood that the term and or as used herein refers to and encompasses any and all possible combinations of one or more of the associated listed items. It will be further understood that the terms includes including comprises and or comprising when used in this specification specify the presence of stated features integers steps operations elements and or components but do not preclude the presence or addition of one or more other features integers steps operations elements components and or groups thereof.

As used herein the term if is optionally construed to mean when or upon or in response to determining or in response to detecting or in accordance with a determination that depending on the context. Similarly the phrase if it is determined or if a stated condition or event is detected is optionally construed to mean upon determining or in response to determining or upon detecting the stated condition or event or in response to detecting the stated condition or event or in accordance with a determination that a stated condition or event is detected depending on the context.

It is to be appreciated that smart home environments may refer to smart environments for homes such as a single family house but the scope of the present teachings is not so limited. The present teachings are also applicable without limitation to duplexes townhomes multi unit apartment buildings hotels retail stores office buildings industrial buildings and more generally any living space or work space.

It is also to be appreciated that while the terms user customer installer homeowner occupant guest tenant landlord repair person and the like may be used to refer to the person or persons acting in the context of some particularly situations described herein these references do not limit the scope of the present teachings with respect to the person or persons who are performing such actions. Thus for example the terms user customer purchaser installer subscriber and homeowner may often refer to the same person in the case of a single family residential dwelling because the head of the household is often the person who makes the purchasing decision buys the unit and installs and configures the unit and is also one of the users of the unit. However in other scenarios such as a landlord tenant environment the customer may be the landlord with respect to purchasing the unit the installer may be a local apartment supervisor a first user may be the tenant and a second user may again be the landlord with respect to remote control functionality. Importantly while the identity of the person performing the action may be germane to a particular advantage provided by one or more of the implementations such identity should not be construed in the descriptions that follow as necessarily limiting the scope of the present teachings to those particular individuals having those particular identities.

The depicted structure includes a plurality of rooms separated at least partly from each other via walls . The walls may include interior walls or exterior walls. Each room may further include a floor and a ceiling . Devices may be mounted on integrated with and or supported by a wall floor or ceiling .

In some implementations the smart home environment includes a plurality of devices including intelligent multi sensing network connected devices that integrate seamlessly with each other in a smart home network e.g. and or with a central server or a cloud computing system to provide a variety of useful smart home functions. The smart home environment may include one or more intelligent multi sensing network connected thermostats hereinafter referred to as smart thermostats one or more intelligent network connected multi sensing hazard detection units hereinafter referred to as smart hazard detectors and one or more intelligent multi sensing network connected entryway interface devices hereinafter referred to as smart doorbells . In some implementations the smart thermostat detects ambient climate characteristics e.g. temperature and or humidity and controls a HVAC system accordingly. The smart hazard detector may detect the presence of a hazardous substance or a substance indicative of a hazardous substance e.g. smoke fire and or carbon monoxide . The smart doorbell may detect a person s approach to or departure from a location e.g. an outer door control doorbell functionality announce a person s approach or departure via audio or visual means and or control settings on a security system e.g. to activate or deactivate the security system when occupants go and come .

In some implementations the smart home environment includes one or more intelligent multi sensing network connected wall switches hereinafter referred to as smart wall switches along with one or more intelligent multi sensing network connected wall plug interfaces hereinafter referred to as smart wall plugs . The smart wall switches may detect ambient lighting conditions detect room occupancy states and control a power and or dim state of one or more lights. In some instances smart wall switches may also control a power state or speed of a fan such as a ceiling fan. The smart wall plugs may detect occupancy of a room or enclosure and control supply of power to one or more wall plugs e.g. such that power is not supplied to the plug if nobody is at home .

In some implementations the smart home environment of includes a plurality of intelligent multi sensing network connected appliances hereinafter referred to as smart appliances such as refrigerators stoves ovens televisions washers dryers lights stereos intercom systems garage door openers floor fans ceiling fans wall air conditioners pool heaters irrigation systems security systems space heaters window AC units motorized duct vents and so forth. In some implementations when plugged in an appliance may announce itself to the smart home network such as by indicating what type of appliance it is and it may automatically integrate with the controls of the smart home. Such communication by the appliance to the smart home may be facilitated by either a wired or wireless communication protocol. The smart home may also include a variety of non communicating legacy appliances such as old conventional washer dryers refrigerators and the like which may be controlled by smart wall plugs . The smart home environment may further include a variety of partially communicating legacy appliances such as infrared IR controlled wall air conditioners or other IR controlled devices which may be controlled by IR signals provided by the smart hazard detectors or the smart wall switches .

In some implementations the smart home environment includes one or more network connected cameras that are configured to provide video monitoring and security in the smart home environment .

The smart home environment may also include communication with devices outside of the physical home but within a proximate geographical range of the home. For example the smart home environment may include a pool heater monitor that communicates a current pool temperature to other devices within the smart home environment and or receives commands for controlling the pool temperature. Similarly the smart home environment may include an irrigation monitor that communicates information regarding irrigation systems within the smart home environment and or receives control information for controlling such irrigation systems.

By virtue of network connectivity one or more of the smart home devices of may further allow a user to interact with the device even if the user is not proximate to the device. For example a user may communicate with a device using a computer e.g. a desktop computer laptop computer or tablet or other portable electronic device e.g. a smartphone . A webpage or application may be configured to receive communications from the user and control the device based on the communications and or to present information about the device s operation to the user. For example the user may view a current set point temperature for a device and adjust it using a computer. The user may be in the structure during this remote communication or outside the structure.

As discussed above users may control the smart thermostat and other smart devices in the smart home environment using a network connected computer or portable electronic device . In some examples some or all of the occupants e.g. individuals who live in the home may register their device with the smart home environment . Such registration may be made at a central server to authenticate the occupant and or the device as being associated with the home and to give permission to the occupant to use the device to control the smart devices in the home. An occupant may use their registered device to remotely control the smart devices of the home such as when the occupant is at work or on vacation. The occupant may also use their registered device to control the smart devices when the occupant is actually located inside the home such as when the occupant is sitting on a couch inside the home. It should be appreciated that instead of or in addition to registering the devices the smart home environment may make inferences about which individuals live in the home and are therefore occupants and which devices are associated with those individuals. As such the smart home environment may learn who is an occupant and permit the devices associated with those individuals to control the smart devices of the home.

In some implementations in addition to containing processing and sensing capabilities the devices and or collectively referred to as the smart devices are capable of data communications and information sharing with other smart devices a central server or cloud computing system and or other devices that are network connected. The required data communications may be carried out using any of a variety of custom or standard wireless protocols IEEE 802.15.4 Wi Fi ZigBee 6LoWPAN Thread Z Wave Bluetooth Smart ISA100.11a WirelessHART MiWi etc. and or any of a variety of custom or standard wired protocols CAT6 Ethernet HomePlug etc. or any other suitable communication protocol including communication protocols not yet developed as of the filing date of this document.

In some implementations the smart devices serve as wireless or wired repeaters. For example a first one of the smart devices communicates with a second one of the smart devices via a wireless router. The smart devices may further communicate with each other via a connection to one or more networks such as the Internet. Through the one or more networks the smart devices may communicate with a smart home provider server system also called a central server system and or a cloud computing system herein . In some implementations the smart home provider server system may include multiple server systems each dedicated to data processing associated with a respective subset of the smart devices e.g. a video server system may be dedicated to data processing associated with camera s . The smart home provider server system may be associated with a manufacturer support entity or service provider associated with the smart device. In some implementations a user is able to contact customer support using a smart device itself rather than needing to use other communication means such as a telephone or Internet connected computer. In some implementations software updates are automatically sent from the smart home provider server system to smart devices e.g. when available when purchased or at routine intervals .

In some implementations some low power nodes are incapable of bidirectional communication. These low power nodes send messages but they are unable to listen . Thus other devices in the smart home environment such as the spokesman nodes cannot send information to these low power nodes.

As described the spokesman nodes and some of the low powered nodes are capable of listening. Accordingly users other devices and or the central server or cloud computing system may communicate control commands to the low powered nodes. For example a user may use the portable electronic device e.g. a smartphone to send commands over the Internet to the central server or cloud computing system which then relays the commands to one or more spokesman nodes in the smart home network . The spokesman nodes drop down to a low power protocol to communicate the commands to the low power nodes throughout the smart home network as well as to other spokesman nodes that did not receive the commands directly from the central server or cloud computing system .

In some implementations a smart nightlight is a low power node. In addition to housing a light source the smart nightlight houses an occupancy sensor such as an ultrasonic or passive IR sensor and an ambient light sensor such as a photo resistor or a single pixel sensor that measures light in the room. In some implementations the smart nightlight is configured to activate the light source when its ambient light sensor detects that the room is dark and when its occupancy sensor detects that someone is in the room. In other implementations the smart nightlight is simply configured to activate the light source when its ambient light sensor detects that the room is dark. Further in some implementations the smart nightlight includes a low power wireless communication chip e.g. a ZigBee chip that regularly sends out messages regarding the occupancy of the room and the amount of light in the room including instantaneous messages coincident with the occupancy sensor detecting the presence of a person in the room. As mentioned above these messages may be sent wirelessly using the mesh network from node to node i.e. smart device to smart device within the smart home network as well as over the one or more networks to the central server or cloud computing system .

Other examples of low power nodes include battery operated versions of the smart hazard detectors . These smart hazard detectors are often located in an area without access to constant and reliable power and may include any number and type of sensors such as smoke fire heat sensors carbon monoxide dioxide sensors occupancy motion sensors ambient light sensors temperature sensors humidity sensors and the like. Furthermore the smart hazard detectors may send messages that correspond to each of the respective sensors to the other devices and or the central server or cloud computing system such as by using the mesh network as described above.

Examples of spokesman nodes include smart doorbells smart thermostats smart wall switches and smart wall plugs . These devices and are often located near and connected to a reliable power source and therefore may include more power consuming components such as one or more communication chips capable of bidirectional communication in a variety of protocols.

In some implementations the smart home environment includes service robots that are configured to carry out in an autonomous manner any of a variety of household tasks.

In some implementations the devices and services platform communicates with and collects data from the smart devices of the smart home environment . In addition in some implementations the devices and services platform communicates with and collects data from a plurality of smart home environments across the world. For example the smart home provider server system collects home data from the devices of one or more smart home environments where the devices may routinely transmit home data or may transmit home data in specific instances e.g. when a device queries the home data . Example collected home data includes without limitation power consumption data occupancy data HVAC settings and usage data carbon monoxide levels data carbon dioxide levels data volatile organic compounds levels data sleeping schedule data cooking schedule data inside and outside temperature humidity data television viewership data inside and outside noise level data pressure data video data etc.

In some implementations the smart home provider server system provides one or more services to smart homes. Example services include without limitation software updates customer support sensor data collection logging remote access remote or distributed control and or use suggestions e.g. based on the collected home data to improve performance reduce utility cost increase safety etc. In some implementations data associated with the services is stored at the smart home provider server system and the smart home provider server system retrieves and transmits the data at appropriate times e.g. at regular intervals upon receiving a request from a user etc. .

In some implementations the extensible devices and the services platform includes a processing engine which may be concentrated at a single server or distributed among several different computing entities without limitation. In some implementations the processing engine includes engines configured to receive data from the devices of smart home environments e.g. via the Internet and or a network interface to index the data to analyze the data and or to generate statistics based on the analysis or as part of the analysis. In some implementations the analyzed data is stored as derived home data .

Results of the analysis or statistics may thereafter be transmitted back to the device that provided home data used to derive the results to other devices to a server providing a webpage to a user of the device or to other non smart device entities. In some implementations use statistics use statistics relative to use of other devices use patterns and or statistics summarizing sensor readings are generated by the processing engine and transmitted. The results or statistics may be provided via the one or more networks . In this manner the processing engine may be configured and programmed to derive a variety of useful information from the home data . A single server may include one or more processing engines.

The derived home data may be used at different granularities for a variety of useful purposes ranging from explicit programmed control of the devices on a per home per neighborhood or per region basis for example demand response programs for electrical utilities to the generation of inferential abstractions that may assist on a per home basis for example an inference may be drawn that the homeowner has left for vacation and so security detection equipment may be put on heightened sensitivity to the generation of statistics and associated inferential abstractions that may be used for government or charitable purposes. For example processing engine may generate statistics about device usage across a population of devices and send the statistics to device users service providers or other entities e.g. entities that have requested the statistics and or entities that have provided monetary compensation for the statistics .

In some implementations to encourage innovation and research and to increase products and services available to users the devices and services platform exposes a range of application programming interfaces APIs to third parties such as charities governmental entities e.g. the Food and Drug Administration or the Environmental Protection Agency academic institutions e.g. university researchers businesses e.g. providing device warranties or service to related equipment targeting advertisements based on home data utility companies and other third parties. The APIs are coupled to and permit third party systems to communicate with the smart home provider server system including the services the processing engine the home data and the derived home data . In some implementations the APIs allow applications executed by the third parties to initiate specific data processing tasks that are executed by the smart home provider server system as well as to receive dynamic updates to the home data and the derived home data .

For example third parties may develop programs and or applications such as web applications or mobile applications that integrate with the smart home provider server system to provide services and information to users. Such programs and applications may be for example designed to help users reduce energy consumption to preemptively service faulty equipment to prepare for high service demands to track past service performance etc. and or to perform other beneficial functions or tasks.

In some implementations the processing engine includes a challenges rules compliance rewards paradigm that informs a user of challenges competitions rules compliance regulations and or rewards and or that uses operation data to determine whether a challenge has been met a rule or regulation has been complied with and or a reward has been earned. The challenges rules and or regulations may relate to efforts to conserve energy to live safely e.g. reducing exposure to toxins or carcinogens to conserve money and or equipment life to improve health etc. For example one challenge may involve participants turning down their thermostat by one degree for one week. Those participants that successfully complete the challenge are rewarded such as with coupons virtual currency status etc. Regarding compliance an example involves a rental property owner making a rule that no renters are permitted to access certain owner s rooms. The devices in the room having occupancy sensors may send updates to the owner when the room is accessed.

In some implementations the processing engine integrates or otherwise uses extrinsic information from extrinsic sources to improve the functioning of one or more processing paradigms. The extrinsic information may be used to interpret data received from a device to determine a characteristic of the environment near the device e.g. outside a structure that the device is enclosed in to determine services or products available to the user to identify a social network or social network information to determine contact information of entities e.g. public service entities such as an emergency response team the police or a hospital near the device to identify statistical or environmental conditions trends or other information associated with a home or neighborhood and so forth.

In some implementations the smart home provider server system or a component thereof serves as the video server system . In some implementations the video server system is a dedicated video processing server that provides video processing services to video sources and client devices independent of other services provided by the video server system .

In some implementations each of the video sources includes one or more video cameras that capture video and send the captured video to the video server system substantially in real time. In some implementations each of the video sources optionally includes a controller device not shown that serves as an intermediary between the one or more cameras and the video server system . The controller device receives the video data from the one or more cameras optionally performs some preliminary processing on the video data and sends the video data to the video server system on behalf of the one or more cameras substantially in real time. In some implementations each camera has its own on board processing capabilities to perform some preliminary processing on the captured video data before sending the processed video data along with metadata obtained through the preliminary processing to the controller device and or the video server system .

As shown in in accordance with some implementations each of the client devices includes a client side module . The client side module communicates with a server side module executed on the video server system through the one or more networks . The client side module provides client side functionalities for the event monitoring and review processing and communications with the server side module . The server side module provides server side functionalities for event monitoring and review processing for any number of client side modules each residing on a respective client device . The server side module also provides server side functionalities for video processing and camera control for any number of the video sources including any number of control devices and the cameras .

In some implementations the server side module includes one or more processors a video storage database device and account databases an I O interface to one or more client devices and an I O interface to one or more video sources . The I O interface to one or more clients facilitates the client facing input and output processing for the server side module . The databases store a plurality of profiles for reviewer accounts registered with the video processing server where a respective user profile includes account credentials for a respective reviewer account and one or more video sources linked to the respective reviewer account. The I O interface to one or more video sources facilitates communications with one or more video sources e.g. groups of one or more cameras and associated controller devices . The video storage database stores raw video data received from the video sources as well as various types of metadata such as motion events event categories event category models event filters and event masks for use in data processing for event monitoring and review for each reviewer account.

Examples of a representative client device include but are not limited to a handheld computer a wearable computing device a personal digital assistant PDA a tablet computer a laptop computer a desktop computer a cellular telephone a smart phone an enhanced general packet radio service EGPRS mobile phone a media player a navigation device a game console a television a remote control a point of sale POS terminal vehicle mounted computer an ebook reader or a combination of any two or more of these data processing devices or other data processing devices.

Examples of the one or more networks include local area networks LAN and wide area networks WAN such as the Internet. The one or more networks are optionally implemented using any known network protocol including various wired or wireless protocols such as Ethernet Universal Serial Bus USB FIREWIRE Long Term Evolution LTE Global System for Mobile Communications GSM Enhanced Data GSM Environment EDGE code division multiple access CDMA time division multiple access TDMA Bluetooth Wi Fi voice over Internet Protocol VoIP Wi MAX or any other suitable communication protocol.

In some implementations the video server system is implemented on one or more standalone data processing apparatuses or a distributed network of computers. In some implementations the video server system also employs various virtual devices and or services of third party service providers e.g. third party cloud service providers to provide the underlying computing resources and or infrastructure resources of the video server system . In some implementations the video server system includes but is not limited to a handheld computer a tablet computer a laptop computer a desktop computer or a combination of any two or more of these data processing devices or other data processing devices.

The server client environment shown in includes both a client side portion e.g. the client side module and a server side portion e.g. the server side module . The division of functionalities between the client and server portions of operating environment can vary in different implementations. Similarly the division of functionalities between the video source and the video server system can vary in different implementations. For example in some implementations client side module is a thin client that provides only user facing input and output processing functions and delegates all other data processing functionalities to a backend server e.g. the video server system . Similarly in some implementations a respective one of the video sources is a simple video capturing device that continuously captures and streams video data to the video server system without no or limited local preliminary processing on the video data. Although many aspects of the present technology are described from the perspective of the video server system the corresponding actions performed by the client device and or the video sources would be apparent to ones skilled in the art without any creative efforts. Similarly some aspects of the present technology may be described from the perspective of the client device or the video source and the corresponding actions performed by the video server would be apparent to ones skilled in the art without any creative efforts. Furthermore some aspects of the present technology may be performed by the video server system the client device and the video sources cooperatively.

It should be understood that operating environment that involves video server system video sources and video cameras is merely an example. Many aspects of operating environment are generally applicable in other operating environments in which a server system provides data processing for monitoring and facilitating review of data captured by other types of electronic devices e.g. smart thermostats smart hazard detectors smart doorbells smart wall plugs appliances and the like .

The electronic devices the client devices or the server system communicate with each other using one or more communication networks . In some implementations two or more devices e.g. electronic devices and and client devices are located in close proximity to each other such that they could be communicatively coupled in the same sub network via wired connections a WLAN or a Bluetooth Personal Area Network PAN . The Bluetooth PAN is optionally established based on classical Bluetooth technology or Bluetooth Low Energy BLE technology.

During normal operation the electronic devices send data it has captured to the server system via secure network connections e.g. a Wi Fi network link and a wired link and the client devices also receive processed data from the server via secure network connections e.g. a Wi Fi network link and a cellular network link . Under some circumstances a short range communication network e.g. a Bluetooth PAN offers a lower security level than these secure network connections and therefore is not used for secure data communication among the server system the electronic devices and the client devices. Instead in various implementations of the present application short range communication network is used to provision a new electronic device. Specially in some implementations short range communication network is used to facilitate association of the electronic devices with a user account managed by the server and establishing of the secure network connections between the server system and the new electronic device.

In some implementations each client device includes a respective client side module that functions to provision new electronic devices in conjunction with a server side module executed on the server system. Note that a device provision operation bonds a new electronic device with a user account managed on the server system and is typically done the first time a user uses the electronic device. In some implementations client side module provides client side functionalities for identifying the new electronic device that is located in proximity to the client device enabling communication with the electronic device via a short range wireless link and using this short range communication to establish a secure network connection for the electronic device. In some implementations server side module provides server side functionalities for associating any number of the electronic devices with their corresponding user accounts and facilitating the short range communications between the client devices and the electronic devices for the purpose of setting up secure communications with the electronic devices.

In a specific example e.g. the devices within the oval shown on the electronic devices and the client device are communicatively coupled via a short range wireless link which thereby facilitates establishing of secure communication by transferring network credentials associated with other secure network connections e.g. the connections and . The network credentials associated with the other secure network connections are transferred in an encrypted format over the short range communication network . Specifically in some implementations the client device encrypts the network credentials using a password key that is created by the server system based on a random number provided by the electronic device and transfers the encrypted network credentials to the electronic device via the short range communication network . In some implementations once the electronic device recovers the network credentials of the corresponding secure networks using the random number it transfers data to the server system via these other secure networks i.e. not via the short range communication network during its normal operation.

Upon receiving the link approval request the server system obtains the device identifier associated with the electronic device and searches its account database to determine whether the electronic device associated with the device identifier is available for provisioning in association with the user account. Specifically in some implementations the server system determines whether the received device identifier has been associated with any user account this user account or a different user account . When it is determined that the electronic device is available for provisioning in association with this user account the server system associates the user account logged on by the client device with the device identifier of the electronic device and issues a link approval response to the client device . In some implementations the link approval response includes an alternative device identifier e.g. a universally unique identifier UUID and or a device name associated with the electronic device . Both the device identifier and the alternative device identifier are used by the client device and the server system for referencing the electronic device . Optionally the device name is used to represent the electronic device on a provisioning interface displayed on the client device and a user of the client device is allowed to modify the device name on the provisioning interface.

Further in accordance with the link approval response the client device is communicatively coupled to electronic device via a short range wireless link. The client device then sends a secure network setup request to the electronic device via the wireless link and initializes a secure network setup session for the electronic device . In some implementations the electronic device and the client device rely on the short range wireless link to communicate information directly during the entire secure network setup session.

In some implementations after receiving the secure network setup request from the client device the electronic device generates an encryption seed e.g. a random number . Optionally the random number is valid only for a predetermined duration of time e.g. 15 minutes . The electronic device provides the random number to the client device via the short range wireless link. The client device then forwards the random number to the server system in conjunction with one or more of other information items e.g. the user account information . Upon receiving the random number the server system generates an authentication tag and a password key based on the random number. In some implementations the authentication tag and the password key are generated based on both the random number and a device specific key that is shared between the electronic device and the server system . In some implementations both the authentication tag and the password key have the same length e.g. 16 bytes . Then the server system returns payload data that include at least the authentication tag and the password key to the client device .

In some implementations the client device forwards the authentication tag to the electronic device . In accordance with a verification of the authentication tag the electronic device implements a secure network scan and identifies a list of secure networks that are accessible by the electronic device . The client device receives information regarding the list of available secure networks and displays the list of available secure networks on the provisioning interface. When a user selects a preferred secure network from the list of available secure networks the client device encrypts network credentials of the preferred secure network using the password key that is provided by the server system . The client device then sends the encrypted network credentials to the electronic device . In some implementations the client device sends the authentication tag and a network identifier associated with the preferred secure network in conjunction with the encrypted network credentials. After receiving the encrypted network credentials the electronic device recovers the network credentials of the preferred secure network using the random number.

Similarly in some implementations the random number is associated with a second custom data structure when it is forwarded from the electronic device to the server system . is an exemplary custom data structure associated with the random number in accordance with some implementations. In accordance with an exemplary custom data structure each random number has sixteen bytes and is followed with a one byte flag and a sixteen byte authentication token . The one byte flag optionally indicates if a reset button provided by the electronic device has been pushed. In some implementations the sixteen byte authentication token is generated based on the random number and the device specific secret. In a specific example the six byte device identifier the sixteen byte random number and the one byte flag are combined and hashed based on a predetermined cryptographic hash function e.g. SHA 256 and the first sixteen bytes of the hashing result are then used as the authentication token associated with the random number.

Note that implementations of the provisioning technology described herein that employ classical Bluetooth BLE or other widely available wireless technologies to provide short range communications between the electronic device and the client device do not require the use of security features provided by those technologies to secure such short range wireless communications. This is because appropriate security is provided by these implementations in such a way that dependence on particular third party security features is not required. This enhances user convenience and efficient communications between the client device and the electronic device.

In some implementations upon receiving the device identifier or the random number the server system combines the received device identifier or random number with the device specific secret in the same manner as their respective authentication token is generated in the electronic device . When the server system confirms the combining result and the received authentication token are consistent it authenticates the electronic device and validates the corresponding device identifier or random number.

Prior to establishing secure communication for the electronic device a user registers a user account on a client side application associated with the electronic device and logs onto the user account. In response to a user action the client device initializes a device scan process to search for advertising packets that are broadcast by one or more the electronic devices located nearby. In some implementations the user action for initializing the device scan process is associated with a click on an information item displayed on a provisioning interface e.g. the start item . By clicking on the start item the user also acknowledges that I agree to Placement Guidelines via the same click.

On the device side the electronic device is powered on and configured to broadcast the advertising packets proactively. In one example the advertising packets are broadcast regularly based on Bluetooth based technology. The advertising packets at least include a device identifier that is assigned to the electronic device when it is shipped out of factory. Optionally when the client device is proactively searching for the electronic device a provisioning interface is displayed to indicate that such a device scan process is under way and remind the user of the client device that the electronic device needs to be placed in proximity to the client device and powered properly.

As a result of the device scan process the client device receives the advertising packets broadcast by one or more electronic devices. The client device then forwards the device identifiers associated with the one or more electronic devices to the server system in conjunction with other information items e.g. information concerning the user account an encryption type and an IP address of the client device . In some implementations the device identifiers are transferred in an encrypted format and decrypted in the server system according to the encryption type. Optionally the encryption type is associated with one of the following encryption standards Advanced Encryption Standard AES Temporal Key Integrity Protocol TKIP Wired Equivalent Privacy WEP Wi Fi Protected Access WPA Extensible Authentication Protocol EAP IEEE8021X Lightweight EAP LEAP WPA2 WPA PSK Remote Authentication Dial In User Service RADIUS and the like.

After receiving from the client device the device identifiers of the one or more the electronic devices the server system determines whether each of the one or more the electronic devices has already been linked to any other user account i.e. each device s availability for provisioning according to information stored in an account database of the server system . In accordance with a determination that each of a subset of the electronic devices e.g. the electronic device is not linked to any other user account the server system associates the respective device identifiers with the user account that the client device has been logged onto and sends a link approval response to the client device to authorize the client device to associate the user account with the subset of the electronic devices. In some implementations as shown in the provisioning interface is displayed at the client device until the server system generates the link approval response.

After receiving the link approval response the client device associates the user account activated on the client device with the subset of the electronic devices according to the link approval response. Specifically in response to receiving the link approval response the client device provides a list of the subset of the electronic devices that are available and approved for provisioning. As shown in device names of the subset of electronic devices are displayed on a provisioning interface of the client device.

When a user of the client device selects an approved electronic device from the available electronic devices client device sends a secure network setup request to initiate a secure network setup session for the selected electronic device. In some implementations the user selects one of the device names associated with the available electronic devices on a provisioning interface . In response to the user selection the selected electronic device receives from the client device the secure network setup request that includes an instruction to provide a list of available secure networks for the selected electronic device. As such a short range wireless link is established between the selected electronic device and the client device .

In some implementations in accordance with the secure network setup request the selected electronic device generates a random number and sends the random number to the client device . The client device then forwards the random number to the server system . In some implementations the random number is accompanied by an authentication token that is created based on a device specific secret.

Upon receiving the random number the server system generates an authentication tag and a password word based on the random number. Optionally the authentication tag and the password word are generated based on both the random number and the device specific secret. For example an intermediate data item is created by combining the device specific secret a device identifier and the random number according to a predetermined data structure. If the combined data item is less than 32 byte long it is optionally filled with zeros to form the 32 byte intermediate data item. Then the 32 byte intermediate data item is converted to a tag key data item based on a cryptographic hash function e.g. SHA 256 . The first and second 16 bytes of the tag key data item are separated and used as the authentication tag and the password key respectively. Therefore in this specific example both the authentication tag and the password key have the same length of 16 bytes.

The server system sends the authentication tag and the password key to the client device . Upon receiving the authentication tag and the password key the client device further sends the authentication tag to the electronic device . The electronic device receives the authentication tag and validates the authentication tag based on the random number. In some implementations the authentication tag is generated based on both the random number and the device specific secret in the server system and therefore has to be verified using both the random number and the device specific secret in the electronic device . In an example the electronic device recreates an authentication tag by combining and converting the device specific secret a device identifier and the random number all stored locally in its memory in the same manner as the received authentication tag is created in the server system. When the recreated authentication tag is consistent with the received authentication tag the validity of the received authentication tag is verified. As such it is verified that the authentication tag is sent by an authorized party e.g. the server system and its integrity has been properly maintained during data transmission.

After verifying the authentication tag the electronic device scans to identify a list of available secure networks e.g. a Wi Fi network that are accessible by the electronic device . The electronic device then provides network identifiers of the list of available secure networks to the client device via the short range wireless link between the electronic device and the client device .

The client device receives the network identifiers of the available secure networks and determines a preferred secure network among the available secure networks. As shown in in some implementations a provisioning interface is displayed while the electronic device is searching for available secure networks. When the electronic device identifies and provides the list of available secure networks to the client device the list of secure networks are displayed on a provisioning interface in association with the electronic device as shown in . Optionally the list of secure networks includes a Phone s network that is used by the client device to communicate with the server system . Optionally the list of secure networks is arranged on the provisioning interface according to signal strengths of the listed secure networks.

In some implementations the user then selects a preferred secure network from the list of secure networks by clicking on the corresponding device name displayed on the provisioning interface as shown in . This preferred secure network is optionally the first secure network e.g. the Phone s network or another secure network in the list of the secure networks. As shown in in response to a user selection of a preferred secure network on the provisioning interface another provisioning interface is displayed to provide a virtual keyboard and allows the user to input network passwords for the preferred secure network. In some situations the user selects the preferred secure network and does not need to input the network password because the network password has been entered previously and stored in a local memory of the client device .

Then the client device encrypts network credentials of the preferred secure network using the password key provided by the server system . After receiving the encrypted network credentials the electronic device decrypts the encrypted network credentials of the preferred secure network based on the random number. Specifically the electronic device recreates the password key from the random number using the same tag key generation method used by server system to create the password key. In some implementations the password key is recreated from both the random number and the device specific secret if the device specific secret is used to create the password key in the server system .

Once the electronic device has recovered the network credentials it uses the network credentials to communicate and with the server system via the preferred secure network independently of the client device. As shown in in some implementations a provisioning interface is displayed at client device to notify the user that the electronic device has been successfully connected to the server system via a secure network. In some implementations the preferred secure network is a secure wireless network.

As explained above during exemplary device provisioning process user interventions are optionally needed in a limited number of situations such as starting client side application associated with electronic devices logging onto a user account initializing a device provisioning process selecting one of a set of electronic devices for device provisioning selecting a preferred secure network and inputting network credentials. Other than these basic controls the user does not need to connect the electronic devices to any personal computer e.g. a laptop or desktop computer using an electronic wire nor does the user need to load a separate device provision application that is distinct from the client side application used in normal operation for device control and data review. As such the device provisioning operations for the electronic device are simplified from both the hardware and software perspectives and would improve user experience for most users who may not be sophisticated with handling different types of electronic devices.

Each of the above identified elements may be stored in one or more of the previously mentioned memory devices and corresponds to a set of instructions for performing a function described above. The above identified modules or programs i.e. sets of instructions need not be implemented as separate software programs procedures or modules and thus various subsets of these modules may be combined or otherwise re arranged in various implementations. In some implementations memory optionally stores a subset of the modules and data structures identified above. Furthermore memory optionally stores additional modules and data structures not described above.

Memory includes high speed random access memory such as DRAM SRAM DDR RAM or other random access solid state memory devices and optionally includes non volatile memory such as one or more magnetic disk storage devices one or more optical disk storage devices one or more flash memory devices or one or more other non volatile solid state storage devices. Memory optionally includes one or more storage devices remotely located from one or more processing units . Memory or alternatively the non volatile memory within memory includes a non transitory computer readable storage medium. In some implementations memory or the non transitory computer readable storage medium of memory stores the following programs modules and data structures or a subset or superset thereof 

Each of the above identified elements may be stored in one or more of the previously mentioned memory devices and corresponds to a set of instructions for performing a function described above. The above identified modules or programs i.e. sets of instructions need not be implemented as separate software programs procedures modules or data structures and thus various subsets of these modules may be combined or otherwise re arranged in various implementations. In some implementations memory optionally stores a subset of the modules and data structures identified above. Furthermore memory optionally stores additional modules and data structures not described above.

In some implementations at least some of the functions of the server system are performed by the client device and the corresponding sub modules of these functions may be located within the client device rather than server system . In some implementations at least some of the functions of the client device are performed by the server system and the corresponding sub modules of these functions may be located within the server system rather than client device . The client device and the server system shown in respectively are merely illustrative and different configurations of the modules for implementing the functions described herein are possible in various implementations.

Memory includes high speed random access memory such as DRAM SRAM DDR RAM or other random access solid state memory devices and optionally includes non volatile memory such as one or more magnetic disk storage devices one or more optical disk storage devices one or more flash memory devices or one or more other non volatile solid state storage devices. Memory or alternatively the non volatile memory within memory includes a non transitory computer readable storage medium. In some implementations memory or the non transitory computer readable storage medium of memory stores the following programs modules and data structures or a subset or superset thereof 

In some implementations the secure network setup module further includes a random number generator a device authentication module a secure network scan module and a credential recovery module . The random number generator generates a random number. Optionally the data protection module generates an authentication token by combining the random number and the device specific secret. The random number is provided to server system together with the corresponding authentication token. The server system returns the authentication tag generated based on the random number.

In some implementations the device authentication module verifies the validity of the authentication tag by recreating another authentication tag and comparing the received and recreated authentication tags. In accordance with a verification of the authentication tag secure network scan module implements a secure network scan to identify a list of available secure networks that are accessible by the electronic device . A preferred secure network e.g. a secure wireless network is selected from the list of available secure networks and its network credentials are provided to the electronic device in an encrypted format. Then the credential recovery module recreates the password key in the same manner as it is created by server system and recovers the network credentials of the preferred secure network using the recreated password key. As such the electronic device is enabled to communication with the server system via the preferred secure network using the recovered network credentials.

Each of the above identified elements may be stored in one or more of the previously mentioned memory devices and corresponds to a set of instructions for performing a function described above. The above identified modules or programs i.e. sets of instructions need not be implemented as separate software programs procedures or modules and thus various subsets of these modules may be combined or otherwise re arranged in various implementations. In some implementations memory optionally stores a subset of the modules and data structures identified above. Furthermore memory optionally stores additional modules and data structures not described above.

In accordance with device provisioning method a user logs onto a user account managed by the server from the client device. The electronic device broadcasts an advertising packet that includes a device identifier uniquely associated with the electronic device. In some implementations the electronic device is a camera. In some implementations the advertising packet is broadcast based on a custom data structure that is distinct from any data format used by a Bluetooth based network .

The client device then transmits the advertising packet to the server as part of a link approval request. In some implementations the link approval request is communicated from the client device to the server based on an encryption type selected from the group consisting of AES TKIP WEP WPA EAP IEEE8021X Cisco LEAP WPA PSK and RADIUS.

In response to receiving the link approval request the server verifies that the electronic device associated with the device identifier is available for provisioning in association with the user account. When the availability of the electronic device is verified the server issues a link approval response to the client device and this link approval response indicates that the electronic device associated with the device identifier is available for provisioning in association with the user account.

In some implementations the advertising packet forwarded by the client device to the server further includes a first authentication token that is generated based on a device specific secret shared between the electronic device and the server. The server is configured to authenticate the device identifier based on the device specific secret and the first authentication token before it verifies the availability of the electronic device based on the device identifier. Further in some implementations a device specific secret is predetermined and stored in a memory of the electronic device before the electronic device is shipped out of factory and the server includes a database recording both the device identifier and the device specific secret associated with the electronic device.

In response to receiving the link approval response the electronic device and the client device establish communication via a short range wireless link. In some implementations the electronic device is located in proximity to the client device and the short range wireless link is established based on classical Bluetooth technology or Bluetooth low energy BLE technology.

In some implementations in response to receiving the link approval response the client device provides a random number to the server and the random number is forwarded to the server via the client device. Further in some implementations the random number remains valid only for a predetermined duration of time e.g. 15 minutes . In some implementations the electronic device shares a device specific secret with the server and the random number are provided to the server with a second authentication token that is generated by the electronic device based on the device specific secret and wherein the server is configured to authenticate the random number based on the second authentication token and the device specific secret.

In some implementations after receiving the random number the server generates an authentication tag and a password key by the server based on the random number. Optionally the password key is encrypted by the server based on both the random number and a device secret known to the server and the electronic device. The server then forwards the authentication tag to the electronic device via the client device and the electronic device verifies the authentication tag based on the random number. Here the random number and the authentication tag are communicated between the electronic device and the client device via the short range wireless link.

In some implementations after a verification of the authentication tag the electronic device identifies a list of available secure networks in a secure network scan and provides the list of available secure networks to the client device. The client device is configured to determine a secure wireless network from the list of available secure networks. In some implementations the client device determines the secure wireless network from the list of available secure networks by displaying the list of available secure networks on a provisioning interface displayed on the client device and receiving a user selection of the secure wireless network.

After determining the secure wireless network the client device obtains network credentials for accessing the secure wireless network. In some implementations the secure wireless network includes a wireless local area network WLAN and the network credentials of the secure wireless network further include at least a service set identifier SSID and a network password for the WLAN.

The client device encrypts at least a portion of the network credentials using a password key generated at the server and communicated from the server to the client device. As explained above in some implementations the password key is generated in conjunction with the authentication tag based on a random number provided by the electronic device. In that situation the client device encrypts the at least a portion of the network credentials using the password key only when the electronic device verifies the authentication tag. The encrypted network credentials are optionally communicated between the electronic device and the client device via the short range wireless link.

In some implementations the network credentials of the secure wireless network include a network password and the client device receives a user input of the network password and encrypts the network password using the password key provided by the server.

After encrypting the at least a portion of the network credentials the client device sends the encrypted network credentials to the electronic device over the short range wireless link. The electronic device obtains decrypted network credentials by decrypting the encrypted network credentials using a key generated at the electronic device. Then the electronic device accesses the secure wireless network using the decrypted network credentials.

In some implementations during the course of provisioning the electronic device the client device communicates with the server system at least partially via the secure wireless network that is selected to enable the communication between the electronic device and the server. An example of such a secure network is a WiFi network covering both the client device and the electronic device. Alternatively in some implementations the client device communicates with the server independently of the secure wireless network that is selected to enable the communication between the electronic device and the server. For example the secure wireless network includes a WiFi network that covers the electronic device and ultimately enables its communication with the server system. However the client device communicates with the server via a cellular network that is distinct and independent from the WiFi network.

It should be understood that the particular order in which the operations in are shown and have been described is merely exemplary and is not intended to indicate that the described order is the only order in which the operations could be performed. One of ordinary skill in the art would recognize various ways to cache and distribute specific data as described herein. Additionally it should be noted that details of other processes described herein with respect to method e.g. are also applicable in an analogous manner to methods and described above with respect to respectively. For brevity these details are not repeated here.

In some implementations method is implemented on the electronic device to set up a secure network for the electronic device automatically and without user intervention. The electronic device is located in proximity to a client device and shares a device specific secret with a server. The electronic device proactively broadcasts advertising packets that include a device identifier uniquely associated with the electronic device. In accordance with a link approval response that is generated by the server to verify that the device identifier of the electronic device is not associated with any user account the electronic device establishes communication with the client device via a short range wireless link.

The electronic device then establishes communication with the server via a secure network by a series of operations. Specifically the electronic device provides a random number to the server via the client device and verifies an authentication tag that is generated by the server based on the random number and forwarded to the electronic device by the client device. In accordance with the verification of the authentication tag the electronic device obtains encrypted network credentials of a preferred secure network. Network credentials of the preferred secure network are encrypted in the client device using a password key generated by the server based on the random number. The electronic device recovers the network credentials of the preferred secure network using the password key recreated from the random number and uses the recovered network credentials to communicate with the server via the preferred secure network independently from the client device.

It should be understood that the particular order in which the operations in have been described are merely exemplary and are not intended to indicate that the described order is the only order in which the operations could be performed. One of ordinary skill in the art would recognize various ways to cache and distribute specific data as described herein. Additionally it should be noted that details of other processes described herein with respect to method e.g. are also applicable in an analogous manner to method and described above with respect to respectively. For brevity these details are not repeated here.

In some implementations method is implemented on a client device to set up a secure network for the electronic device. The client device creates and logs onto a user account managed by a server system. Then the client device associates the user account with an electronic device by 1 forwarding to the server a device identifier that is uniquely associated with the electronic device and 2 receiving from the server a link approval response that verifies that the electronic device is not associated with any user account. The electronic device is located in proximity to the client device and the device identifier is received in advertising packets proactively broadcast by the electronic device.

After receiving the link approval response the client device establishes communication via a secure network for the electronic device and the server by a series of operations. Specifically the client device forwards a random number to the server and the random number is provided to by the electronic device. The client device then receives from the server payload data that include an authentication tag and a password key both generated based on the random number.

After a verification of the authentication tag by the electronic device the client device provides encrypted network credentials of a preferred secure network to the electronic device and network credentials of the preferred secure network are encrypted using a password key generated by the server based on the random number. The client device sends the encrypted network credentials to the electronic device. The electronic device is configured to recreate the password key from the random number recover the network credentials of the preferred secure network using the password key and apply the recovered network credentials to communicate with the server via the preferred secure network independently from the client device.

It should be understood that the particular order in which the operations in have been described are merely exemplary and are not intended to indicate that the described order is the only order in which the operations could be performed. One of ordinary skill in the art would recognize various ways to cache and distribute specific data as described herein. Additionally it should be noted that details of other processes described herein with respect to method e.g. are also applicable in an analogous manner to method and described above with respect to respectively. For brevity these details are not repeated here.

In some implementations method is implemented on the server system to set up a secure network for the electronic device. The server enables a client device to log onto a user account managed by the server. Then the server system associates the user account with the electronic device by 1 receiving via a client device a device identifier that is uniquely associated with the electronic device and 2 generating a link approval response that verifies that the electronic device is not associated with any user account. The electronic device is located in proximity to the client device and the device identifier is received by the client device in advertising packets proactively broadcast by the electronic device.

Further the server system establishes communication with the electronic device via a secure network by a series of operations. The server system receives a random number from the electronic device via the client device and generates payload data based on the random number wherein the payload data include an authentication tag and a password key.

The server system then provides the authentication tag and the password key to the client device. The client device is configured to encrypt network credentials of a preferred secure network using the password key after a verification of the authentication tag by the electronic device and the electronic device is configured to recreate the password key from the random number and recover the network credentials of the preferred secure network using the password key.

After the electronic device obtains the network credentials for the preferred secure network the server system communicates with the electronic device via the preferred secure network based on the recovered network credentials independently from the client device.

It should be understood that the particular order in which the operations in have been described are merely exemplary and are not intended to indicate that the described order is the only order in which the operations could be performed. One of ordinary skill in the art would recognize various ways to cache and distribute specific data as described herein. Additionally it should be noted that details of other processes described herein with respect to method e.g. are also applicable in an analogous manner to method and described above with respect to respectively. For brevity these details are not repeated here.

Although various drawings illustrate a number of logical stages in a particular order stages that are not order dependent may be reordered and other stages may be combined or broken out. While some reordering or other groupings are specifically mentioned others will be obvious to those of ordinary skill in the art so the ordering and groupings presented herein are not an exhaustive list of alternatives. Moreover it should be recognized that the stages could be implemented in hardware firmware software or any combination thereof.

The foregoing description for purpose of explanation has been described with reference to specific implementations. However the illustrative discussions above are not intended to be exhaustive or to limit the scope of the claims to the precise forms disclosed. Many modifications and variations are possible in view of the above teachings. The implementations were chosen in order to best explain the principles underlying the claims and their practical applications to thereby enable others skilled in the art to best use the implementations with various modifications as are suited to the particular uses contemplated.

