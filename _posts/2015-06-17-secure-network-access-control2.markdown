---

title: Secure network access control
abstract: A new approach to network security includes manipulating an access point such that an initial communication from an external device is passed to a restricted subset of a computing network including a gatekeeper. The gatekeeper is configured to enforce a security policy against the external device before granting access to a less-restricted subset of the computing network. If requirements of the security policy are satisfied, then the gatekeeper reconfigures the access point such that further communication from the external device may be received by elements of the less-restricted subset. Enforcement of the security policy optionally includes performing a security audit of the external device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09621553&OS=09621553&RS=09621553
owner: INFOEXPRESS, INC.
number: 09621553
owner_city: Mountain View
owner_country: US
publication_date: 20150617
---
This application is a continuation of co pending U.S. Non Provisional patent application Ser. No. 14 175 687 filed on Feb. 7 2014 which

The invention is in the field of computing systems and more specifically in the field of network security.

Several approaches to controlling external access to computing networks have been developed. The goals in developing these approaches include limiting access to authorized users and assuring that computing devices employed by these users do not include malicious computing code such as viruses worms or Trojan horses. The need for access control has grown with users demands for accessing secure networks over the Internet and from personal devices such as laptop computers and personal digital assistants.

A first level of access control is achieved by requiring authentication of a user. This may be accomplished by requiring the user to enter a username and password or by reading a MAC address or other identifying information from an access device. In some systems a network switch is programmed to grant access to a secure network only after proper authentication is achieved. Systems capable of using this approach include those using a proprietary VMPS protocol from Cisco Systems Inc. of San Jose Calif. or using a IEEE 802.1x standard protocol.

Reliance on mere user authentication includes several disadvantages. For example there are no provisions to assure that an access device used by the authenticated user meets network security policies. The access device may have out of date virus software may have security vulnerabilities or may be otherwise compromised. Further this approach requires that access points e.g. network switches support one of a specific set of access protocols. Because many access points do not support VMPS 802.1x or a similar protocol implementation of this approach on a large preexisting network such as a corporate network may be prohibitively expensive.

A greater level of access control may be achieved by including a gatekeeper between the secure network and the access device. The gatekeeper is configured to ensure that the access device conforms to a predetermined security policy. is a block diagram of a Secure Network generally designated including two instances of a Gatekeeper each associated with a different instance of an Access Point . Secure Network further includes as an illustrative example a network File Server a Network PC personal computer and a Printer included in and connected via a local area network designated LAN .

Each instance of Access Point may include a large number of individual communication ports. These ports are used to connect through GateKeeper to other elements within Secure Network such as File Server or LAN . Large corporate networks may include many instances of Access Point each including hundreds of individual communication ports and being associated with an instance of GateKeeper .

Some instances of Access Point are capable of supporting virtual local area networks VLANs . VLANs are generated by associating communication ports within Access Point with separate virtual networks. For example one Access Device may be placed on a different VLAN than another Access Device by assigning the communication ports of Access Point to separate VLANs. From the point of view of these devices the effect of a VLAN is equivalent to having a separate hardwired network.

GateKeeper is configured to control access to Secure Network . In addition to authenticating users who wish to access Secure Network using an Access Device GateKeeper is configured to ensure that Access Device conforms to a predetermined security policy before granting access to Secure Network . For example GateKeeper may make certain that Access Device has up to date virus software and encryption protocols as proscribed by the security policy. Once GateKeeper has verified that Access Device satisfies the security policy Access Device is allowed to communicate through GateKeeper to LAN .

A disadvantage of the use of GateKeeper as practiced in the prior art is that all communications between Access Device and LAN pass through GateKeeper . For large networks including many instances of Access Point each of which may include many communication ports this can be a significant burden. The use of one instance of GateKeeper to support numerous instances of Access Device is limited by bandwidth and required sophistication e.g. cost of GateKeeper . It is undesirable for GateKeeper to become a limiting factor on the bandwidth of communication between instances of Access Device and Secure Network . Further the use of a separate GateKeeper for each instance of Access Device or Access Point is often prohibitively expensive. Even if a separate GateKeeper is used for each Access Point there is no isolation between compliant and non compliant Access Devices which are attached to the same Access Point .

Systems and methods of the invention include a protected network physically or logically divided into a restricted subset and one or more less restricted subsets. Requests from an access device for access to the less restricted subset are first passed to the restricted subset. Elements e.g. a gatekeeper of the restricted subset are then used to apply security policies to the access device in the form of an audit and if security policies are satisfied the access device is granted access to a less restricted subset of the protected network. The passing of access requests to the restricted subset and granting of access are accomplished by configuring and reconfiguring a communication port of an access point. After access is granted further communication between the access device and the protected network can include access to the less restricted subset.

In some embodiments the less restricted subset of the protected network and the restricted subset of the protected network are characterized by Virtual Local Area Networks e.g. VLANs defined within the access point and optionally by access control lists ACL of a router firewall or switch situated between the VLAN and the protected network. Different VLANs within the same access point or within different access points may be configured to characterize a plurality of restricted subsets and or a plurality of less restricted subsets within the protected network. A communication port of the access point is configured such that network traffic directed at the protected network is initially passed through a restricted VLAN rather than through a less restricted VLAN. The restricted VLAN allows network traffic to pass to the restricted subset of the protected network and is typically restricted in the sense that it only allows access to elements of the protected network that are configured to communicate with an access device whose security characteristics are unknown or questionable. In contrast the less restricted VLAN allows access to the less restricted subset of the protected network and in typical embodiments to elements of both the less restricted subset and the restricted subset. For example the restricted VLAN allows traffic to pass to a gatekeeper configured to receive requests for access to the less restricted VLAN and to determine if and to what extent access may be allowed. To grant access the gatekeeper sends commands to the access point in order to reconfigure a communication port to which the access device is connected. The reconfiguration typically includes reassigning the communication port from the restricted VLAN to the less restricted VLAN.

Subsequent to reconfiguration of the communication port network traffic can pass from the access device through the less restricted VLAN to elements of both the less restricted subset and optionally the restricted subset. This network traffic need not pass through the gatekeeper. Thus in various embodiments of the invention a gatekeeper is used to grant access to the less restricted subset and after access has been granted most network traffic does not need to pass through the gatekeeper. For example in some embodiments the gatekeeper only receives requests to access the less restricted network and data regarding access to and security of the protected network. This data may be received from administrators access devices access points routers and or other devices on the network. These limited communications with gatekeeper occur both before and after reconfiguration of the communication port and eliminate a significant disadvantage associated with the use of prior art gatekeepers.

Various embodiments of the invention include a computing network comprising a less restricted subset of the computing network access to the less restricted subset being responsive to a first VLAN a restricted subset of the computing network including a gatekeeper the gatekeeper configured to receive requests for access to the less restricted subset from an access device and to issue commands configured to allow access to the less restricted subset access to the restricted subset of the computing network being responsive to a second VLAN and at least one access point including a communication port configurable for communication with the less restricted subset or alternatively for communication with only the restricted subset configuration of the communication port including association of the communication port alternatively with the first VLAN or the second VLAN configuration of the communication port being responsive to the commands issued by the gatekeeper. Other elements are optional.

Various embodiments of the invention include a network gatekeeper comprising at least one security policy including requirements that must be satisfied before an access device is granted access to a less restricted subset of a protected network a policy auditor configured to audit an access device using the at least one security policy in response to a request to access the less restricted subset of the protected network the request being sent from the access device to the gatekeeper via a communication device and an access control configured to reconfigure the communication device such that data sent from the access device can be received by the less restricted subset of the protected network rather than merely a restricted subset of the protected network if the audit results in a determination that the access device meets the requirements of the at least one security policy the restricted subset of the protected network including the gatekeeper. Other elements are optional.

Various embodiments of the invention include a method of granting access to a protected network the method comprising receiving a request for access to a less restricted subset of the protected network from an access device external to the protected network the request being received through a communication port of an access point the communication port configured for communicating between the access device and a restricted subset of the protected network the restricted subset including a gatekeeper applying a security policy to the access device responsive to the request and reconfiguring the communication port for communicating between the access device and the less restricted subset of the protected network if requirements of the security policy are satisfied. Other steps are optional.

Various embodiments of the invention include a method of granting access to a protected network the method comprising receiving a first communication from an access device at a communication port the communication port being configured to pass the first communication to a restricted subset of the protected network the restricted subset including a gatekeeper configured to enforce security policy for access to a less restricted subset of the protected network receiving a command from the gatekeeper the command being responsive to the received first communication and being configured to reconfigure the communication port to communicate data to the less restricted subset of the protected network configuring the communication port to communicate data to the less restricted subset of the protected network rather than merely the restricted subset of the protected network responsive to the received command and receiving a second communication from the access device at the communication port the communication port now being configured to pass the second communication to the less restricted subset of the protected network. Other steps are optional.

Various embodiments of the invention include a computing network comprising means for dividing the computing network into a restricted subset and a less restricted subset means for receiving a request at the restricted subset the request being to access the less restricted subset means for enforcing a security policy in response to the request and means for allowing communication to the less restricted subset responsive to the enforcement of the security policy the communication to the less restricted subset not necessarily passing through the restricted subset. Other elements are optional.

In various embodiments of the invention the restricted subset of a computing network includes elements configured to communicate with access devices having an unknown or questionable security status and the less restricted subset of the computing network includes those elements of the computing network not included in the restricted subset.

In various embodiments an access point may be programmed to restrict access to a protected network by an access device until the access devices passes authentication by an authentication server and also passes an audit performed a software agent under the direction of a gatekeeper. This is optionally accomplished while still supporting existing encryption and authentication functionality. For example these embodiments may be used to support auditing functionality over the 802.1x protocol. The 802.1x protocol as used herein is a protocol compliant with one or more of the IEEE 802.1x standards. The access device may include a remote server a data collection device a cellular device a terminal a laptop computer a desktop personal computer a personal digital assistant or similar computing device.

In various embodiments the auditing protocol takes place between agent software executing on an access device e.g. client and a gatekeeper. A client side filter identifies and redirects calls for audit information to the agent on the access device and sends the responses to an 802.1x compliant access point which relays them to an EAP Extensible Authentication Protocol server. The EAP server then calls a server side filter which sends the responses to the gatekeeper for evaluation. The gatekeeper sends requests for more information on the reverse path and this continues until the audit is completed. If the audit is successful the server sends a configuration message to the access point. This configuration message reconfigures a port of the access point to which the access device is connected to allow greater access to the protected network from the access device. If the audit fails the port on the access point is optionally left disabled or in a limited access state.

According to an exemplary embodiment client filters CF and server filters SF along with an agent and gatekeeper are included in an access point and protected network respectively to perform audits. There may be one or more instances of the client filters and server filters which correspond to separate EAP Authentication Modules EAPM that are supported. The agent and gatekeeper are logical components. The functionality of the agent and gatekeeper can be embedded into the client filters and server filters respectively or in the case of the gatekeeper may reside on a separate server. The gatekeeper may be included in or separate from an authentication server.

Various embodiments of the invention include a method of controlling access to a computing network the method comprising receiving 802.1X authentication credentials from a client at an authentication server of the network determining if the authentication credentials are valid to establish an 802.1X authentication receiving information characterizing a security status of the client within the protected network determining if the security status of the client is compliant with a security policy of the network and if the client is compliant with the security policy increasing access from the client to the network.

Various embodiments of the invention include a system comprising a computing network comprising a plurality of devices the plurality of devices being divided into a restricted subset and a less restricted subset an 802.1x compliant access point configured for accessing the computing network an authentication server configured to receive client authentication credentials from a client via the access point and to authenticate the client using the authentications credentials logic configured to receive a security status of the client via the access point and to determine if the client is compliant with a security policy of the network based on the security status and logic configured to allow access to the restricted subset from the client if the client is compliant with the security policy and to limit access to the less restricted subset if the client is not compliant with the security policy.

Access to a protected computing network is controlled by manipulating a communication port within an access point. The access point is a switch or wireless access point WAP that is used to connect an access device or network device to a protected network. For example an access device may connect to a switch via an Ethernet cable at one of the switch s ports. An access device or network device typically connects to a WAP through a wireless network card commonly through protocols like 802.11a or 802.11b.

When an access request is first received the communication port is configured to pass the request to a restricted subset of a protected computing network. This restricted subset includes a gatekeeper configured to administer a security policy governing access to those parts of the protected computing network that are not part of the restricted subset. Those parts of the protected computing network that are not part of the restricted network are considered to be in a less restricted subset. The less restricted subset being less restricted relative to the restricted subset in terms of what elements may be included in each subset. If the device requesting access satisfies requirements of the security policy then the gatekeeper sends commands to the access point in order to reconfigure the communication port through which the access request was received. The communication port is reconfigured such that further communication from the access device is passed to the less restricted subset as well as optionally the restricted subset. In some embodiments the less restricted subset and the restricted subset are characterized by VLANs defined within the protected network. In some embodiments the less restricted subset and the restricted subset are defined using and an access control list. An access control list is a list within a switch or router that includes a set of filtering rules that specify what traffic is permitted through a port. Each port may be associated with a different access control list. An access control list may be used to restrict traffic based on the traffic s destination e.g. block traffic to a less restricted subset of a protected network while allowing traffic to a restricted subset.

In various embodiments Protected Network includes a corporate network telephone network private network local area network wide area network wireless network communication network government network university network and or the like. Restricted Subset is a subset of Protected Network including at least GateKeeper . In some embodiments Restricted Subset further includes a DHCP dynamic host configuration protocol service configured to assign and manage network addresses and or an Update Module configured for providing security updates to Access Device . For example in one embodiment Restricted Subset includes a server configured to function as DHCP and a server configured to function as GateKeeper . In one embodiment Restricted Subset includes a single computing device configured to function as both Update Module and GateKeeper .

Less Restricted Subset includes those elements of Protected Network not included in Restricted Subset . Less Restricted Subset optionally includes devices such as a File Server a Network PC a Printer or the like. In some embodiments Protected Network includes elements having a hierarchy of access restrictions. For example access to Network PC may require a higher level of authority than access to File Server . In this case as described further herein access control lists within Router are optionally used to independently control access to specific devices within Less Restricted Subset . Protected Network may be large including tens hundreds or thousands of devices. The hierarchy of access restrictions may be enforced by a hierarchical set of security policies defined using Policy Manager . In various embodiments Router and Access Point may be considered part of Restricted Subset or Less Restricted Subset . The functionality of Router and Access Point is optionally in a single device e.g. in Access Point .

GateKeeper is configured to enforce one or more security policies against an instance of Access Device attempting to access Protected Network . The security polices may include requirements for user identification such as user names and passwords configuration requirements relating to the configuration of Access Device application requirements relating to applications running on Access Device or the like. For example in one embodiment GateKeeper is configured to enforce a security policy that requires a user of Access Device to provide a username and password requires Access Device to be running an operating system with specific security patches installed requires that Access Device not be connected to any insecure devices and requires that Access Device have current antivirus software installed.

In some embodiments GateKeeper is configured to enforce several alternative security policies having different levels of requirements and to determine which security policy to enforce based on the identity of Access Device the identity of a user of Access Device those elements of Less Restricted Subset to which access is requested and or the like. For example a request to access File Server may have to satisfy a security policy that includes scanning Access Device for malicious code while a request to access Printer may have to satisfy a security policy that includes establishing a user identity. Security policies may be stored on GateKeeper on Policy Manager or elsewhere accessible to Restricted Subset .

In some embodiments a single instance of GateKeeper is configured to manage access through more than one Access Point and or to manage access to more than one Protected Network . As is described further herein management of Access Point is accomplished by configuring and reconfiguring one or more communication ports within Access Point and optionally setting access control lists within Router or Access Point . In some embodiments Protected Network includes a plurality of Access Point a plurality of GateKeeper and or a plurality of Restricted Subset . Further details of GateKeeper and Access Point are discussed elsewhere herein.

Access Device is a computing device configured to operate as an end point EP in a communication channel including Access Point and Access Device . In various embodiments Access Device is a personal computer a personal digital assistant a telephone a wireless device a communication device such as a router Ethernet card wireless card another access point a network device or the like. Access Device is optionally identified by a MAC address by a cookie by data stored on Access Device by a user name an IP address a network address or the like.

In some embodiments Access Device is configured to execute a software and or hardware agent for communicating with GateKeeper . For example in one embodiment Access Device includes an agent configured to monitor code running on Access Device and report any suspicious code to GateKeeper . In another example Access Device may include software and or hardware configured to monitor other devices connected to Access Device and to report information about these devices e.g. their security statuses or MAC addresses to GateKeeper .

Policy Manager is configured to centrally create update and distribute security policies enforced by one or more GateKeeper . For example in various embodiments Policy Manager is configured to manage passwords to specify access privileges to specify requirements of security policies or the like. In some embodiments Policy Manager is configured to establish several security policies and to specify conditions under which each of the security policies should be used. For example a security policy may be selected for use responsive to a device type of Access Device and or the elements of Protected Network to which access has been requested. In some embodiments Policy Manager is configured for specifying the restricted and less restricted subsets of a protected network.

Update Module is configured for remotely modifying Access Device or a device connected to Access Device in order to improve compliance with a security policy. For example if it is found that Access Device includes out of date antivirus software then Update Module may facilitate updating of the antivirus software on Access Device . In some embodiments Update Module is configured to update an agent executing on Access Device . Update Module is optionally included in Less Restricted Subset or external to Protected Network . Update Module optionally operates responsive to a security policy and or to GateKeeper .

Communication received at one member of Ports A G is directed internally to another member of Ports A G via a member of VLANs A D. VLANs A D are logical associations between members of Ports A G. Typically any members of Ports A G that are configured to be associated with the same member of VLANs A D are in bi directional communication with each other. These associations are illustrated in by Lines . For example with Ports A G configured set as shown in communication from Access Device and received at Port A is directed to Port F because Port A and Port F are both associated with VLAN C. In some embodiments of Access Point a member of VLANs A D may be configured such that some members of Ports A G even if associated with the same VLAN are hidden from each other. For example in these embodiments both Ports A and B may be in communication with Port F but not with each other. 

The associations between member of Ports A G and VLANs A D are controlled by Switch Logic which is accessible to other devices for example through Port G. Switch Logic is configured for configuring and reconfiguring members of Ports A G responsive to received commands. For example by receiving an appropriate command Switch Logic is configured to reconfigure Port A to be associated with VLAN A as illustrated in below. In this configuration data received at Port A is directed to Port D via VLAN A rather than to Port F.

As is discussed further below the commands received by Switch Logic may be generated by GateKeeper . This communication between GateKeeper and Switch Logic may be accomplished using SNMP Simple Network Management Protocol telnet SSH Secure Shell RADIUS Remote Authentication User Dial In Service EAP Extensible Authentication Protocol or the like.

In some embodiments Switch Logic includes a memory not shown configured to store the status of Ports A G and or identification data regarding Access Device . This identification data may include for example MAC addresses IP internet protocol addresses or other data that may be used to identify Access Device or data sent by Access Device .

Data passed through members of Ports DA G are received by Router and may be communicated to other elements of Protected Network responsive to access control lists ACL A D associated with Ports A D of Router . ACL A through D are each communication filters that deny or allow communication to be passed to specific elements or sets of elements within Protected Network . For example ACL C may be an access control list that specifically allows communication to network addresses used by GateKeeper and DHCP and blocks communication to all other network addresses. In this case communication through Port C of Router would only be allowed to reach these to elements of Restricted Subset and would not be allowed to reach elements of Less Restricted Subset .

ACL A D of Router may be used to limit communication from Access Device to specific elements of Protected Network . For example in the embodiments illustrated by if ACL C is configured to restrict communication to Restricted Subset and Ports A C are associated with VLAN C as indicated by Lines then communication via these member of Ports A G will be restricted to Restricted Subset . In typical embodiments at least one member of ACL A D is configured to allow communication to Restricted Subset but not to Less Restricted Subset . As is discussed further herein by reconfiguring a member of Ports A C to be associated with a different member of VLANs A D not subject to the filtering of ACL C communications from Access Device can be directed to elements within Less Restricted Subset and optionally Restricted Subset rather than merely to Restricted Subset .

When Access Point is embodied in a wireless access point some or all of Ports A G may be wireless connections rather than physical ports. In these embodiments Lines may represent logical associations used to control data flow between wireless connections to Access Point and or members of Ports A G that are physical communication ports. For example in some embodiments MAC addresses are used to distinguish wireless communications from different instances of Access Device and the logical associations represented by Lines are used to direct these communications to various output channels. The output channels may be other wireless connections or physical members of Ports A G. These logical associations may be altered by Switch Logic just as associations with members of VLANs A D are modified. Therefore the teachings herein that use a network switch as an example of Access Point apply equally to wireless access points.

Switch Logic is controlled by an Access Control included in GateKeeper . Access Control is configured to send commands to Switch Logic in order to reconfigure members of Ports A G. This reconfiguration includes modifying the association of members of Ports A G with different members of VLANs A D. In some embodiments as described further herein Access Control is also configured to read a status of members of Ports A G and or device identification data from Switch Logic . In some embodiments access control lists at a switch and or router are used to control access to restricted and less restricted subsets of a network without explicitly defining a VLAN.

Access Control is responsive to a Policy Auditor included in GateKeeper . Policy Auditor is configured to receive a request for access to Less Restricted Subset from Access Device to determine which of Security Policy A or optional Security Policy B applies to the current request to perform a security audit of Access Device based on the appropriate member of Security Policies A B and to notify Access Control if the audit is passed. This notice typically causes Access Control to reconfigure a member of Ports A G using Switch Logic . For example in some embodiments if Security Policy A applies and if Access Device satisfies requirements of Security Policy A then Policy Auditor provides a notice to Access Control . In response Access Control sends appropriate commands to Switch Logic . These commands cause changes in Port A such that communication from Access Device is no longer blocked by ACL C and can now be received by elements of Less restricted Subset . In alternative embodiments Security Policies A B are stored elsewhere in Protected Network accessible to Policy Auditor . Restricted Subset optionally includes one two or more security policy such as Security Policies A B.

In some embodiments members of VLAN A D and ACL A D are optionally used to grant or bar access to different subsets of Protected Network Less Restricted Subset or Restricted Subset . For example ACL B may be configured to grant access to File Server Policy Manager and GateKeeper . In this case associating a member of Ports A C with VLAN B may provide access to these devices from an instance of Access Device . Granting of access to a specific region of Less Restricted Subset is optionally responsive to which member of Security Policies A B has been satisfied.

In Update Port Log Step Access Control reads port configuration data from Access Point to determine the current configuration of Ports A G. If any of Ports A G have been configured by an administrator of Access Point then in Update Port Log Step the administrator specified configuration s are stored for later use during Reconfigure Port Step . Typically the read configuration data is stored in a port configuration table for example within GateKeeper . Update Port Log Step is optional as discussed further herein.

In Restrict Port Step Access Control configures those members of Ports A G that may be accessed by external devices such as Access Device . These communication ports are configured to be associated with VLAN C such that any data e.g. communications they receive from external devices are directed to Port F and thus to subject to ACL C. ACL C is configured to allow communication to for example DHCP and GateKeeper . As a result any requests for access received from external devices are prevented from reaching Less Restricted Subset and instead are received by elements of Restricted Subset . Restrict Port Step results in a configuration such as that illustrated in FIG. A. In this configuration those members of Ports A G that may be accessed by external devices include Port A Port B and Port C. As a result of Restrict Port Step these members of Ports A G are associated with VLAN C and communicatively coupled to Protected Network through ACL C. Restrict Port Step is optional for example when members of Ports A C have been configured to communicate data to elements of Restricted Subset by an administrator of Access Point .

In Receive Access Request Step a request for access to Less Restricted Subset is received at one of Ports A C configured to pass data to DHCP and Gatekeeper . Typically this request is received from an external device such as Access Device . Because Port A Port B and Port C are configured to pass data to DHCP and Gatekeeper the received access request passes through Access Point and is received by either DHCP or Gatekeeper In typical embodiments an initial access request is first acknowledged by DHCP which assigns a dynamic network address e.g. IP address to Access Device and returns to Access Device a network address associated with GateKeeper or more specifically Policy Auditor . Using this network address Access Device may engage in further communication with GateKeeper or Policy Auditor . In some embodiments DHCP and instances of GateKeeper are associated with a local domain name service configured to provide network addresses associated with a particular instance of GateKeeper configured to manage reconfigure the particular Access Point to which Access Device is connected.

In optional Authenticate User Step Policy Auditor authenticates the identity of Access Device and or a user of Access Device . This authentication may be required by a member of Security Policies A B. In various embodiments the authentication may include receipt of a user name and password receipt of a MAC address reading of data stored on Access Device communication with an agent executing on Access Device or the like.

In optional Obtain Audit Data Step Policy Auditor collects further data to perform a security audit of Access Device responsive to Security Policy A or Security Policy B. In some embodiments Obtain Audit Data Step includes sending system data requests to Access Device Router or Access Point . The requested system data may include for example operating system status version updates etc. antivirus software status information concerning devices connected to Access Device Windows registry information MAC address IP addresses cookies status of applications executing on Access Device or the like. Collectively the above information is indicative of the security status of the Access Device .

In some embodiments Obtain Audit Data Step is facilitated by an agent running on Access Device . For example Access Device may include a software agent configured to monitor local security and to report results of this monitoring to Policy Auditor .

In Apply Security Policy Step a security audit of Access Device is performed by Policy Auditor responsive to a member of Security Policy A or Security Policy B. The particular member of Security Policy A or Security Policy B used to perform the audit may be responsive to the identity of Access Device an identity of a user of Access Device a part of Less Restricted Subset to which access is requested or the like. The security audit typically includes determining if Access Device satisfies requirements of the security policy. The security audit optionally includes active probing scanning and or collection of third party data regarding Access Device . In some embodiments Authenticate User Step is considered part of the security policy audit.

As is discussed further herein in some embodiments satisfaction of all the requirements of a particular security policy results in access to Less Restricted Subset while satisfaction of a subset of the requirements associated with the particular security policy is considered partial satisfaction of the security policy and may result in a more limited access to Less Restricted Subset .

In some embodiments Apply Security Policy Step includes using Update Module to overcome deficiencies in the security of Access Device . For example in one embodiment Apply Security Policy Step includes updating antivirus software on Access Device in response to a security audit that determined that the current antivirus software is out of date.

In Reconfigure Port Step the communication port of Access Point to which Access Device is communicatively connected is reconfigured responsive to a successful security audit in Apply Security Policy Step . This communication port is reconfigured such that data received by the communication port is passed to one or more elements of Less Restricted Subset rather than merely elements of Restricted Subset e.g. GateKeeper . For example shows Port A prior to execution of Reconfigure Port Step and shows Port A following execution of Reconfigure Port Step . In Port A is associated with VLAN A and thus communicatively coupled through Port D to Protected Network subject to the restrictions of ACL A. The restrictions of ACL A allow access to all or part of Less Restricted Subset as well as optionally all or part of Restricted Subset .

In typical embodiments reconfiguration of Port A is accomplished by sending commands from Access Control to Switch Logic . These commands or responses to requests from Switch Logic are optionally sent via SNMP telnet SSH RADIUS EAP or the like and are responsive to data received in Authenticate User Step and Obtain Audit Data Step and or to the security audit performed in Apply Security Policy Step . In response to these commands Switch Logic configures Port A to be associated with VLAN A and thus communicate through Port D. Reconfigure Port Step optionally includes changing an access control list without establishment of VLANs.

While access control lists ACL A D within Router are typically configured prior to Receive Access Request Step in some embodiments Reconfigure Port Step further includes configuring one or more members of ACL A D. In alternative embodiments reconfiguring of members of ACL A D may be used to grant access to elements of Less Restricted Subset as an alternative to associating members of Ports A G to different members of VLANs A D.

Access Control may selectively grant access to different parts of Protected Network if ACL B is configured to allow access to different elements within Protected Network than ACL A is configured. For example in one embodiment Access Device will receive access to all of Less Restricted Subset if Port A is associated with VLAN A or alternatively Access Device will receive access to only a part of Less Restricted Subset if Port A is associated with VLAN B. When Port A is associated with VLAN A as in communication from Access Device is directed through Port A of Router subject to ACL A and thus may access only those elements of Protected Network allowed by ACL A. When Port A is associated with VLAN B communication from Access Device is instead passed through Port B subject to ACL B and may access only those elements of Protected Network permitted by ACL B. A selection between granting access to a first or second part of Protected Network can therefore be made using Access Control . The selection is optionally responsive to the security policy used in Apply Security Policy Step to whether the security policy was fully or partially satisfied to data obtained in Authenticate User Step or Obtain Audit Data Step or the like.

As illustrated in the above example a member of Ports A G through which Access Device is requesting access may be reconfigured to more than one alternative setting in Reconfigure Port Step . For example in various embodiments a communication port may be reconfigured to a prior administrator specified configuration previously read in Update Port Log Step reconfigured to be linked to a specific port responsive to the request received in Receive Access Request Step reconfigured to grant access to a particular part of Less Restricted Subset reconfigured to a default setting and or the like. By reading administrator specified port configurations in Update Port Log Step and reconfiguring communication ports back to these read configurations in Reconfigure Port Step an administrator may reconfigure Protected Network without concern that their specifications will be lost or permanently overwritten by methods of the invention. In embodiments wherein a communication port is not reconfigured to a previous administrator specified configuration Update Port Log Step is optional.

In Communicate Step communication occurs between Access Device and elements of Less Restricted Subset via the communication port reconfigured in Reconfigure Port Step . However in some embodiments ACL A is configured to allow access to GateKeeper as well as Less Restricted Subset . Thus general network traffic does not need to pass through GateKeeper while communication regarding security of Protected Network is optionally received by GateKeeper . Further communication between Access Device and GateKeeper may provide a variety of advantages. For example further communication between GateKeeper and an agent executing on Access Device may allow for continuing audits of security aspects of Access Devices . These audits may be similar to those performed in Apply Security Policy Step . In one embodiment ACL A is configured to grant access to all of Protected Network .

Further communication between GateKeeper and an agent executing on Access Device may also allow for a user of Access Device to explicitly logoff Protected Network . An explicit logoff will result in reconfiguration of Port A such that access is again restricted to Restricted Subset . A logoff may alternatively be responsive to a timeout of communication with Access Device a SNMP trap message indicating a connection has been broken or the like.

According to embodiments like that disclosed in U.S. Provisional Patent Application No. 60 513 080 the disclosure of which has been incorporated herein by reference an AP e.g. a switch or wireless access point WAP which is used to connect end points to the corporate network may be programmed to prohibit access by the PC e.g. notebook desktop PC PDA or similar computing device to the corporate network until authentication with the authentication server passes AND an audit with the software agent with the GK e.g. software that acts as a gatekeeper by granting or denying access to the corporate network from end points after auditing the end point based on certain criteria passes while still supporting the existing encryption and authentication functionality. The method used to support auditing functionality over the existing 802.1x protocol implementation is complicated and not an obvious variation of the 802.1x protocol.

According to an embodiment like that disclosed in U.S. Provisional Patent Application No. 60 513 080 the disclosure of which has been incorporated herein by reference the auditing protocol takes place between the EP e.g. end point which can either be a PC or network device agent software and the GK. A client filter redirects calls for audit information to an agent on the EP and sends the responses to the 802.1x compliant AP which relays them to the EAP server. The EAP server then calls a server filter which sends the responses to the GK for evaluation. The GK sends requests for more information on the reverse path and this continues until the audit is completed. If the audit is successful the server sends a message to the AP which enables the EP s port allowing access for the PC. If the audit fails the port on the AP is left disabled.

According to an exemplary embodiment client filters CF and server filters SF are added along with an agent and GK to perform audits as highlighted in . There may be one or more instances of the CF and SF which correspond to the separate EAP Authentication Modules EAPM that are supported. Note that the agent and GK are logical components. The functionality of the agent and GK can be embedded into the CF and SF respectively or in the case of the GK may reside on a separate server.

The CF and SF APIs have APIs which correspond to the EAPM APIs. Therefore the EAP Client Layer ECL or EAP Server Layer ESL can call the CF and SF instances corresponding to a particular authentication method as shown in . To the ECL and ESL each instance of the CF and SF appears to be an EAPM which incorporates the functionality of the original EAPM prior to completion of the success response by the server EAPM.

To use the invention as disclosed in U.S. Provisional Patent Application No. 60 513 080 the disclosure of which has been incorporated herein by reference the ECL and ESL are configured to use the instance of the CF and SF corresponding to the desired authentication method. This authentication method corresponds to an authentication method supported by one of the EAPMs.

The ECL calls the corresponding CF to perform authentication which at first calls the appropriate EAPM to obtain the proper authentication response. The authentication response is returned by the CF to the ESL which sends the response to the server s ESL SF and EAPM. This process continues until the authentication either succeeds or fails at which time the server s authentication EAPM returns a success or failure response to the SF.

If the SF receives a success response from the server EAPM as shown in the SF changes to the audit state and calls GK to obtain audit requests to send back to the client. In this state the SF returns specially formatted audit requests to the ESL which are passed to the ECL and eventually to the CF which sends back audit responses to the SF requests.

On the client audit requests are passed to the agent API instead of to the client EAPM. The agent returns information about the local system which is converted to audit responses that are sent to the server.

During the audit state the SF and CF exchange audit requests and responses about the EP as shown in . The ECL and ESL continue to communicate with the CF and SF but instead of calling the EAPM the CF and SF call the agent and GK respectively to perform this exchange. The audit session continues until the necessary audit information has been passed to the SF.

If the audit indicates the client EP is in compliance the SF returns a success response. If the VLAN for the EP is specified in the policy then the VLAN that should be used for this EP is passed back as well.

If the GK determines that the EP has failed the audit GK returns a failure response to SF which causes one of the following 1 the SF returns a failure to ECL and the corresponding port on the AP is left disabled or 2 the SF returns a success response to the ECL but specifies that the EP should be set to a restricted VLAN where the EP has limited network access. In either case the EP is isolated from the company network until it successfully passes an audit with the GK.

After the audit has been performed keep alives and updates regarding changes to previous audit information are exchanged. Changes are reevaluated and if inconsistent with the current state access to the network is modified appropriately by changing the VLAN used for the EP or by terminating access by the EP by communicating with the AP.

Several embodiments are specifically illustrated and or described herein. However it will be appreciated that modifications and variations are covered by the above teachings and within the scope of the appended claims without departing from the spirit and intended scope thereof. For example the teachings herein may be applied to embodiments wherein Access Point is a wireless access point and MAC addresses or the like are used instead of VLANs to separate traffic from different instances of Access Device . It is thus anticipated that network management techniques other than VLANs may be used to distinguish Less Restricted Subset from Restricted Subset . In some embodiments various aspects of GateKeeper may be incorporated into Access Point and or Router . GateKeeper and Policy Manager are each optionally implemented on a plurality of computing devices within Restricted Subset .

In some embodiments GateKeeper uses DHCP to assign IP addresses from a restricted IP address range depending on the compliance of Access Device to security policies A B. GateKeeper inserts DHCP options and or modifies the IP source addresses of DHCPDISCOVER and DHCPREQUEST packets based on the compliance of the Access Device to security policies A B. DHCP is configured to provide an address from the restricted address range or the less restricted address range based on the source address and or options present in the DHCP request or discover packets that have been modified by GateKeeper . In some embodiments the insertion of DHCP options and or modification of IP source addresses may be used to characterize restricted and less restricted subnets rather then configuring port associations with VLANs as discussed herein.

EAP Server Layer and EAP Client Layer are configured to communicate with each other to establish 802.1x authentication. For example EAP Client Layer may send an authentication response as the result of standard 802.1x handshaking that occurs between an access device and an 802.1x configured port of an access point. In various embodiments a handshaking signal received at EPA Client Layer is passed to Client Filter via an application programming interface of Client Filter . If the signal is part of a standard 802.01x communication then the signal is passed from Client Filter to Authentication Module via an application programming interface of Authentication Module for use in the 802.1x authentication process. Optionally the application programming interface of Client Filter is configured to be the same as the application programming interface of Authentication Module from the viewpoints of EAP Client Layer and or Authentication Module . This allows Client Filter to be inserted between what are optionally prior art instances of EAP Client Layer and Authentication Module without adversely effecting their operation. In some embodiments different versions of Client Filter and Server Filter are provided to support different EAP authentication modules.

Authentication Module is configured to perform authentication of Access Device e.g. 802.1x authentication of a user s personal computer. Specifically Authentication Module is configured to provide an authentication response in answer to an authentication signal received through EAP Client Layer . This authentication response may be passed through Client Filter and or EAP Client Layer to Access Point .

EAP Server Layer is configured to exchange 802.1x handshaking signals from and to Access Point . For example EAP Server Layer may receive 802.1x protocol signals from EAP Client Layer via Access Point . These signals are passed to Authentication Module via Server Filter . As discussed with respect to Client Filter Server Filter optionally includes APIs configured to mimic an API of Authentication Module and thus make Server Filter transparent to 802.1x authentication messages. In some embodiments this allows Server Filter to be inserted between Authentication Module and EAP Server Layer without substantially altering their operation. Authentication Module is configured to perform the server side of an authentication protocol such as 802.1x.

One of the functions of Client Filter and Server Filter is to determine which received signals are part of an authentication protocol to be handled by Authentication Module and Authentication Module respectively and which received signals should be sent elsewhere. For example Server Filter may be configured to receive and identify a signal indicating that 802.1x authentication is complete and to pass that signal to GateKeeper . Likewise Client Filter may be configured to receive and identify a signal that is generated by GateKeeper and pass this signal to Agent rather than Authentication Module .

Because of Server Filter and Client Filter communication between Protected Network and Access Device can take several stages. In an initial authentication stage 802.1x authentication occurs between the client and network using EAP packets. In the authentication stage data is passed through Server Filter and Client Filter in what is optionally a transparent manner.

In the next audit stage Access Device is audited using GateKeeper . In the audit stage Server Filter is used to redirect data received at Protected Network e.g. Access Point and or EAP Server Layer to GateKeeper . Likewise Client Filter is used to redirect data received at Access Device to Agent . In this stage GateKeeper or more specifically Policy Auditor and Agent are used to perform a security audit of the status of Access Device . This security audit is compared to one or more security policy to determine whether Access Device may be granted further access to the Protected Network . The audit typically occurs through the 802.1x authenticated communication channel.

In a next access stage the Access Device is granted greater access to Protected Network if the security policy is satisfied. This further access is granted by configuring Access Point . For example Access Point may be reconfigured such that signals received at a port to which Access Device is connected can be communicated to File Server . In some embodiments this is accomplished by modifying an access control list of Access Point and or a router attached thereto. Communication between Access Device and File Server need not traverse GateKeeper . If the security policy is not satisfied there are a variety of alternative consequences. For example in some embodiments the port of Access Point to which Access Device is connected is closed and Access Device is disconnected from Protected Network. In some embodiments Access Device is allowed continued access to the Restricted Subset and blocked from Less Restricted Subset . In some embodiments Update Module is used to improve the health of Access Device . For example Update Module may be used to apply on operating system patch or virus signature file to Access Device . After Access Device has been modified the audit stage may be repeated to again determine if Access Device satisfies a security policy. Optionally the audit stage is repeated periodically to assure that Access Device remains compliant with the security policy.

In Set Network Security Policy Step a security policy is set for Protected Network . This security policy may include requirements of operating system patches virus signature files the presence of Agent or other security related factors discussed herein. The security policy is optionally set by a manager of Protected Network using Policy Manager .

In Configure Access Point Step Access Point is configured such that a device attempting to access Protected Network e.g. Access Device is initially limited to accessing Restricted Subset and not allowed to access Less Restricted Subset . Configure Access Point Step may include setting port configurations e.g. access control lists such that data passing through these ports is only communicated to Restricted Subset .

In Provide Filter Step Client Filter and or Agent are provided to Access Device . Provide Filter Step may be performed by a user of Access Device or the manager of Protected Network . Client Filter and or Agent may be provided via Access Point or alternatively on a computer readable media e.g. ROM RAM a magnetic disk or an optical disk . All or part of Provide Filer Step is optionally included as part of a Perform Remediation Step discussed elsewhere herein.

In a Receive Authentication Credentials Step 802.1x authentication credentials are generated by Authentication Module and received by Authentication Module via Access Point . These authentication credentials typically pass through Server Filter and Client Filter and may include 802.1x authentication credentials of the prior art. Receive Authentication Credentials Step is optionally one of several 802.1x handshaking communications between Authentication Module and Authentication Module . Each of these communications optionally pass through Server Filter and Client Filter . In one example an authentication request is first received by Authentication Module from Access Device . Authentication Module then provides an authentication response that is communicated back to Authentication Module .

In a Determine Validity Step the validity of the 802.1x authentication credentials received in Receive Authentication Credentials Step are determined. This determination may be based on the communications between Authentication module and Authentication Module . Determine Validity Step optionally includes communication of a user identifier a password and or the like. Determine Validity Step optionally includes Authenticate User Step . If the authentication is successful notification of this success is received by Server Filter from Authentication Module and therefrom provided to GateKeeper . Server Filter then switches to the audit phase in which information other than 802.1x authentication data is communicated to and from GateKeeper .

In a Receive Security Status Information Step the data representing a security status e.g. health of Access Device is received by EAP Server . This data is optionally received in response to a request from GateKeeper . For example in some embodiments when 802.1x authentication is successful GateKeeper receives an indication of this success from Server Filter . GateKeeper then automatically sends a request for audit information to Agent via Server Filter and Client Filter . Client Filter is configured to direct this request to Agent rather than Authentication Module . For example the request may include identifying data and or format recognizable by Client Filter . A lack of response to this request may be used to indicate that Agent and or Client Filter are not properly installed on Access Device . In this case Access Device is optionally determined not to be in compliance with a security policy by default. The data that can be included in a representation of the security status of Access Device is discussed elsewhere herein. Because 802.1x authentication has been established the audit and exchange of security status information can take place using redirected authentication EAP packets communicated through EAP Server Layer and EAP Client Layer .

Receive Security Status Information Step optionally includes several communications between GateKeeper and Agent . For example initial communications may be used to determine a version of Agent while subsequent communications may include requests from GateKeeper for specific information and responses to these requests from Agent . Each of these communications are identified by Server Filter and Client Filter and directed to GateKeeper and Agent accordingly. Receive Security Status Information Step optionally includes Obtain Audit Data Step .

In a Determine Compliancy Step the data received by GateKeeper in Receive Security Status Information Step is compared with one or more security policy to determine if Access Device satisfies the security policy. Determine Compliancy Step is similar to Apply Security Policy Step . In some embodiments the security status of Access Device satisfies a first security policy but not a second security policy.

If Access Device satisfies at least one security policy then in an Increase Access Step access to Protected Network from Access Device is increased. For example Access Device may be allowed access to all or parts of Less Restricted Subset . The scope of access provided and which devices within Protected Network access is provided is optionally a function of which security policy was satisfied. For example satisfaction of a low level security policy may result in access being granted only to a printer while access to a relatively high level security policy may result in access being granted to all of Less Restricted Subset .

Access is optionally granted by changing reconfiguring ports of Access Point e.g. setting appropriate switches and or access control lists. This results in a change in the operation of Access Point such that information received via the port to which Access Device is connected is communicated to additional parts of Protected Network . Data communicated between Access Device and Access Point typically continues to be communicated using the 802.1x protocols as established in the authentication state.

In an optional Monitor Status Step Agent and GateKeeper are used to monitor the security status of Access Device after the initial status has been determined to satisfy a security policy. For example in some embodiments the identity of Access Device is reconfirmed every 30 seconds while a more complete audit is performed every 30 minutes. Security status updates regarding changes to previous audit information are optionally exchanged. Changes are reevaluated and if inconsistent with the current state access to the network is modified appropriately

If Access Device does not satisfy at least one security policy then in a Continue Limited Access Step access restrictions relative to Protected Network are continued. These restrictions may include preventing access altogether or continuing to allow access to only Restricted Subset . For example the configuration of Access Point may be changed to prevent all access or to allow access to only EAP Server and or GateKeeper .

In optional Perform Remediation Step Update Module is used to correct deficiencies in the security status of Access Device . As is discussed elsewhere herein these updates may include applying patches providing virus signature files and or the like. In some embodiments Perform Remediation Step includes providing a current version of Agent and or Client Filter to Access Device . Following Perform Remediation Step the method optionally returns to Determine Compliancy Step wherein it is determined whether the remediation has brought Access Device into compliance with a security policy.

Several embodiments are specifically illustrated and or described herein. However it will be appreciated that modifications and variations are covered by the above teachings and within the scope of the appended claims without departing from the spirit and intended scope thereof. For example the teachings herein may be applied to embodiments wherein Access Point is a wireless access point and MAC addresses or the like are used instead of VLANs to separate traffic from different instances of Access Device . It is thus anticipated that network management techniques other than VLANs may be used to distinguish Less Restricted Subset from Restricted Subset . In some embodiments various aspects of GateKeeper may be incorporated into Access Point and or Router . GateKeeper and Policy Manager are each optionally implemented on a plurality of computing devices within Restricted Subset .

In some embodiments GateKeeper uses DHCP to assign IP addresses from a restricted IP address range depending on the compliance of Access Device to security policies A B. GateKeeper inserts DHCP options and or modifies the IP source addresses of DHCPDISCOVER and DHCPREQUEST packets based on the compliance of the Access Device to security policies A B. DHCP is configured to provide an address from the restricted address range or the less restricted address range based on the source address and or options present in the DHCP request or discover packets that have been modified by GateKeeper . In some embodiments the insertion of DHCP options and or modification of IP source addresses may be used to characterize restricted and less restricted subnets rather then configuring port associations with VLANs as discussed herein. The embodiments discussed herein may work with any access point that supports 802.1x protocols.

While the examples discussed herein are focused on the security status of an access device in some embodiments the same systems and techniques may be used to qualify other aspects of a device s health. For example they may be used to monitor software crashes reliability connection speed hardware conflicts and or the like. In some embodiments the systems and methods disclosed herein are used to grant access to a protected network from a network device such as a printer that may not be capable of supporting a client side filter or agent. In these embodiments the client side filter and agent are optional.

The embodiments discussed herein are illustrative of the present invention. As these embodiments of the present invention are described with reference to illustrations various modifications or adaptations of the methods and or specific structures described may become apparent to those skilled in the art. All such modifications adaptations or variations that rely upon the teachings of the present invention and through which these teachings have advanced the art are considered to be within the spirit and scope of the present invention. Hence these descriptions and drawings should not be considered in a limiting sense as it is understood that the present invention is in no way limited to only the embodiments illustrated.

