---

title: Digital I/Q reprocessing demodulator (DIRD)
abstract: A digital I/Q reprocessing demodulator and a process for significantly reducing arctangent computational loads. This is done by ensuring that all calculations are carried out in the linear part of the curve. The architecture of the demodulator is such that the demodulator 100 utilizes two I/Q stages. The first stage is utilized to determine a phase offset with regards to the free-running I/Q clocks. In the second processing stage, the phase of the I/Q reference signals are phase shifted based on the initial estimate such that the incoming carrier signal is nearly in-phase.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09628314&OS=09628314&RS=09628314
owner: The United States of America as represented by the Secretary of the Navy
number: 09628314
owner_city: Washington
owner_country: US
publication_date: 20150930
---
This application claims the benefit of U.S. Provisional Application No. 62 148 054 filed Apr. 15 2015 which is incorporated herein by reference.

This application is related to U.S. provisional patent application No. 62 148 042 filed Apr. 15 2015 hereby incorporated herein by reference entitled Dynamic Range Extension of Heterodyne Fiber Optic Interferometers Via Instantaneous Carrier Measurement by inventor David Mellick who is also the sole inventor of the instant patent application.

The following description was made in the performance of official duties by employees of the Department of the Navy and thus the claimed invention may be manufactured used licensed by or for the United States Government for governmental purposes without the payment of any royalties thereon.

The following description relates generally to a digital I Q reprocessing demodulator and a process for significantly reducing arctangent computational loads.

Demodulation of heterodyne interferometric signals has traditionally been accomplished with a combination of hardware and firmware as shown in . The front end is comprised of various analog circuit stages. This includes a photodiode a trans impedance amplifier TIA analog frequency mixers and low pass filters . The signal outputs of the LPFs are digitized by analog to digital converters . The two digital values the In phase and Quadrature components of the incoming carrier signal are then used to calculate an arctangent value and recover the phase signal of interest. This arctangent computation is performed in the digital domain and can be accomplished through the use of either a digital signal processor DSP or Field Programmable Gate Array FPGA . However calculation of the arctangent value in the digital domain is very computationally intensive. Likewise an exponential relationship exists in the required computational resources used and the error in the computed valued. The lower the required error the more computational resources and processing that is needed.

Various techniques exist for computing the arctangent within a digital system. The three most common methods include look up tables LUTs the CORDIC algorithm and a Taylor series computation. All three methods however would require an excessive amount of computational cycles to meet the low error requirement 

As opposed to the analogue to digital demodulator outlined above and shown in the invention is directed towards an all digital demodulator. It should be noted that some all digital demodulator designs are also known in the art. For example is an exemplary illustration of an all digital demodulator that is known in the prior art. As compared to the arrangement of in the embodiment of the analog frequency mixers and the analog LPFs have been moved to the digital domain . A single ADC now directly digitizes the incoming heterodyne carrier signal following the photodiode and TIA . The I Q frequency mixing is now performed using digital multipliers . Finite Impulse Response FIR filters are used to replace the analog low pass filters. The illustration is a comparable digital implementation of the above analog embodiment however there is no inherent reduction in arctangent processing requirements using the all digital approach. It is desired to have a digital I Q reprocessing demodulator that improves upon the above outlined basic digital demodulator particularly one that is faster and utilizes processing time more efficiently.

In one aspect the invention is a digital I Q reprocessing demodulator having a digital processor with a first stage unit and a second stage unit. In this aspect the first stage unit includes a first pair of digital multipliers and a first pair of finite impulse response filters each of the first pair of finite impulse response filters connected to a respective one of the first pair of digital multipliers. The first stage unit also includes a phase offset estimator connected to and receiving signals from the pair of finite impulse response filters the phase offset estimator determining an initial phase offset with regards to free running I Q clocks. The first stage unit also includes a FIFO memory for storing raw digitized carrier samples while said initial phase offset is being computed. In this aspect the second stage unit has a second pair of digital multipliers and a second pair of finite impulse response filters each of the second pair of finite impulse response filters connected to a respective one of the second pair of digital multipliers. The second stage unit also includes an arctangent processing unit estimator connected to and receiving signals from the pair of finite impulse response filters. The arctangent processing unit estimator is for calculating arctangent values and for producing a final arctangent output within a range R defined by a substantially linear range of an output curve for an arctangent function. In this aspect the second stage unit also includes a phase accumulation calculator at which the amount to which the multipliers were phase shifted is subtracted from the final arctangent output.

In another aspect the invention is a method of I Q reprocessing. In this aspect the method includes the providing of a digital processor having a first stage unit and a second stage unit. In this aspect the first stage unit is provided with a first pair of digital multipliers and a first pair of finite impulse response filters each of the first pair of finite impulse response filters connected to a respective one of the first pair of digital multipliers. The first stage unit is also provided with a phase offset estimator connected to and receiving signals from the pair of finite impulse response filters and a FIFO memory. The second stage unit is provided with a second pair of digital multipliers and a second pair of finite impulse response filters each of the second pair of finite impulse response filters connected to a respective one of the second pair of digital multipliers. The second stage unit is also provided with an arctangent processing unit estimator connected to and receiving signals from the pair of finite impulse response filters. According to this method the second stage unit is also provided with a phase accumulation calculator. In this aspect the method of I Q reprocessing includes the receiving of a transmission within the processor and the approximating of a phase offset with regards to the free running I Q clocks using the phase offset estimator. The method also includes the storing of data related to raw digitized carrier samples in the FIFO memory for later processing and the transmitting of phase offset estimate data and data from the FIFO memory to the second stage elements. The method further includes the phase adjusting of digital multipliers of the second stage such that they are nearly in phase with the data contained in the FIFO and calculating arctangent values based on the phase adjusted values so that calculations are within the range R. In this aspect R is defined by a substantially linear range of an output curve for an arctangent function. The method of this invention also includes the subtracting of the amount which the multipliers were phase shifted from the final arctangent output with the phase accumulation calculator performing this task.

The invention is directed towards a demodulator that significantly reduces arctangent computational load. The reduction in arctangent computational load is accomplished by ensuring that all calculations are carried out within the substantially linear part of the output curve for the relevant arctangent function. is an exemplary illustration of an output curve for an arctangent function showing the calculation range R for arctangent processing according to the invention.

Arctangent processing is one of the most computationally intensive parts of the digital demodulation process. Numerous approaches exist for arctangent calculation. Three common approaches to arctangent computation are the CORDIC algorithm look up tables and Taylor series approximations. The amount of processing time required by each is a direct function of the input value and the required output accuracy. Most implementations require an output that is accurate to approximately 1 rad so as to not introduce an additional source of error. The input value z will have the largest impact on the amount of required processing.

As stated above shows the output curve for the arctangent function. For input values of z between 0.3 the output will be in the range of 10. As shown in within this range R 10 the arctangent output is substantially linear. The further away from this region the more the output becomes non linear. Regardless of the computational approach arctangent calculations within the substantially linear section of the function will require far less processing than those outside. For example an arctangent calculation using a Taylor series approximation can be defined as arctan 3 5 7 . . . 1.0 

If the input value z to the arctangent function is 0.3 then only the first three terms of the Taylor series are sufficient to meet the 1 rad error requirement. However if z lies only slightly in the non linear part of the curve at a value of 0.99 then as many terms are required. As this example illustrates it is highly desirable to limit the arctangent processing to the substantially linear portion of the curve. One arctangent calculation is required for each demodulation point. This may be as many as 1 2 million per second. Such processing requirements can pose a problem if not handled properly. Consequently one of the goals of the instant invention is to limit arctangent processing to the calculation range R shown in .

As shown in the digital I Q reprocessing demodulator DIRD includes a photodiode and a trans impedance amplifier TIA . A single ADC may be employed to directly digitize the incoming heterodyne carrier signal following the photodiode and TIA . As shown the demodulator includes a digital processor which be a digital signal processor DSP a field programmable gate array FPGA or a combination thereof.

According to the process step is the providing of a digital processor having a first stage unit and a second stage unit. The features of the digital processor have been outlined above and have been illustrated in . Step is the receipt of a transmission via the photodiode the trans impedance amplifier TIA and the ADC . The transmission is digitized by the ADC .

At step an approximate phase offset with regards to the free running I O clocks is determined. Here the incoming heterodyne modulated signal is mixed with the in phase and phase shifted carrier signal using multipliers and . The output of these multipliers are then low pass filtered using FIR filters and to obtain the in phase I and quadrature Q components of the original incoming heterodyne signal. A phase offset can then be determined by taking the ratio of the I and Q components and either extracting an approximate arctangent value from a look up table or from computing a three term Taylor series approximation.

At step incoming data is stored in the FIFO memory for later processing. The data that is stored is the same incoming heterodyne signal as is used for computing the initial phase offset estimate. The data is stored so that once an initial phase estimate offset has been determined it can be reprocessed after shifting the next I Q demodulator stage by the obtained phase shift estimate. It should be noted that step is performed simultaneous with the performance of step . Additionally steps are first stage steps. As outlined above the process is a two stage process. The second stage of I Q reprocessing by the processor includes steps and .

At step signals including the phase offset estimate from the phase offset estimator as well as data from the FIFO memory are sent to the second stage elements and received at the digital multipliers and . At step the digital multipliers of the second stage are phase adjusted such that they are nearly in phase with the data contained in the FIFO thus ensuring that the magnitude of the z value as shown in passed to the arctangent processing circuitry is always less than 0.3.

At step the arctangent processing unit calculates arctangent values within the range R shown in . The arctangent computational requirements may be met with a simple three term Taylor series calculation. At step at the phase accumulation calculator the amount to which the multipliers were phase shifted is then subtracted to the final arctangent output. Essentially during this process a known phase amount is shifted to align for processing with this known amount is subtracted out at the end. By using this technique although the I Q reprocessing requires two stages and some additional hardware resources the overall computational simplification is significant.

What has been described and illustrated herein are preferred embodiments of the invention along with some variations. The terms descriptions and figures used herein are set forth by way of illustration only and are not meant as limitations. Those skilled in the art will recognize that many variations are possible within the spirit and scope of the invention which is intended to be defined by the following claims and their equivalents in which all terms are meant in their broadest reasonable sense unless otherwise indicated.

