---

title: Selectively wiping a remote device
abstract: A system and method for selectively securing data from unauthorized access on a client device storing a plurality of data types with reference to an authorization level indicated in a command. A command is received at a client device comprising an authorization level indicator. Based on at least one predefined rule, which may be implemented in an IT policy stored at the client device, each of the plurality of data types to be secured is determined, and then the data corresponding to those types is secured. The data may be secured by encrypting and/or deleting the data at the client device. The predefined rules associated with each authorization level may be configured by a user or administrator having an authorization level that exceeds the associated authorization level.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09652629&OS=09652629&RS=09652629
owner: BlackBerry Limited
number: 09652629
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20150803
---
This application is a continuation of U.S. application Ser. No. 13 245 061 filed Sep. 26 2011 which is a continuation of U.S. application Ser. No. 12 016 723 filed Jan. 18 2008 which claims priority from U.S. Application No. 60 885 796 filed Jan. 19 2007 the entirety of which is incorporated herein by reference.

The present disclosure relates generally to the field of computer and network security and more particularly to wiping data stored on a remote device such as a mobile communication device.

Data stored in the memory of a communication and or computing device such as a mobile communication device personal digital assistant PDA smartphone laptop computer and the like may include data of a sensitive or critical nature that is accessible only by authorized users. Such data may include e mail calendar information contact information in an address book and other information that may be utilized received or transmitted by or from the communication device in the execution of communication related or productivity related applications. The data may further include applications or data files created at the device or received by an authorized user at the device that are personal to the user or that are used by the device for the management of data and or security functions on the communication device. Such data includes information technology IT policies which may comprise rules concerning a variety of security and management related issues such as user authorization to use certain functions or install software on the communication device encryption algorithms in wireless communication and authentication processes to be employed before allowing user access to data on the device for example if an authentication token such as a smart card is required.

While data may be protected by requiring the user to enter a valid password in order to access applications or data on the device or by encrypting data stored on the device such that access to the data requires decryption by a valid decryption key there are instances when the device may be compromised decommissioned or redeployed making it desirable to delete or wipe data including applications on the communication device so that it cannot be accessed by unauthorized or malicious users. However it may not always be necessary or desirable to wipe all data and applications from a device.

Therefore it is desirable to provide a system and method for selectively wiping data at a communication device. Thus as described herein there is provided a method for selectively securing data from unauthorized access on a client device storing a plurality of data types the method comprising receiving a command at the client device the command comprising an indicator of an authorization level wherein the authorization level is associated with an issuer of the command determining which of a plurality of data types is to be secured by identifying a predefined rule associated with the authorization level indicated in the received command wherein the client device is provided with a plurality of predefined rules each associated with one of a plurality of authorization levels each of the predefined rules comprising a value indicating each of the plurality of data types to be secured in response to a received command and securing the data of the data types indicated by the value comprised in the identified predefined rule.

In a further aspect determining which of a plurality of data types is to be secured further comprises when a predefined rule associated with the authorization level indicated in the received command is not found identifying a predefined rule associated with the next highest authorization level that is lower than the indicated authorization level. In still a further aspect the plurality of predefined rules is stored at the client device in association with an IT policy. In another aspect securing the data further comprises setting a flag at the client device the flag comprising a subset value for each of the plurality of data types the subset value indicating whether the data of that data type is to be secured in response to the received command checking each of the subset values of the flag and carrying out a securing operation if the subset value indicates that the data of that data type is to be secured and after each of the subset values has been checked resetting the subset values to indicate that no further securing operation is to be carried out. In yet a further aspect securing the data comprises one of deleting the data encrypting the data or encrypting then deleting the data. The securing operation may comprise one of deleting the data of that data type encrypting the data of that data type and encrypting then deleting the data of that data type. In a further aspect the command is received in an encrypted message and prior to securing the data the command is authenticated by decrypting the message and extracting the command such that the command is authenticated if the command is extracted successfully. The client device may comprise a mobile communications device and the command may be received over the air or received from input at the client device or received as detection of a predetermined action condition or trigger for the execution of the wipe command at the client device. In yet a further aspect prior to receiving the command at the client device the method may comprise defining at a location remote from the client device a plurality of predefined rules associated with an authorization level and transmitting to the client device the plurality of predefined rules thus defined. Defining the plurality of predefined rules may comprise for a given authorization level presenting a set of configuration options for configuring securing operations for each of the plurality of data types for authorization levels lower than the given authorization level and constructing a plurality of rules comprising selected configuration options. The data types may comprise at least one of an operating system encryption and decryption keys personal information management applications messaging applications e mail data short message service data instant messaging data multimedia message data voicemail data calendar data address book data or IT policies.

There is further provided a computer readable memory having recorded thereon statements and instructions for execution by a computer to receive a command at the client device the command comprising an indicator of an authorization level wherein the authorization level is associated with an issuer of the command determine which of a plurality of data types is to be secured by identifying a predefined rule associated with the authorization level indicated in the received command wherein the client device is provided with a plurality of predefined rules each associated with one of a plurality of authorization levels each of the predefined rules comprising a value indicating each of the plurality of data types to be secured in response to a received command and secure the data of the data types indicated by the value comprised in the identified predefined rule.

In a further embodiment there is provided a method for selectively securing data from unauthorized access on a client device storing a plurality of data types the method comprising receiving a command at the client device the command comprising an indicator of an authorization level wherein the authorization level is associated with an issuer of the command determining which of the plurality of data types is to be secured by identifying each of a plurality of predefined rules comprising an indicator of an authorization level equal to or less than the authorization level indicated in the received command each of the plurality of predefined rules being associated with one of the plurality of data types and securing only the data corresponding to each of the plurality of data types associated with the predefined rules thus identified. In a further aspect securing the data further comprises setting a flag at the client device the flag comprising a subset value for each of the plurality of data types the subset value indicating whether the data of that data type is to be secured in response to the received command checking each of the subset values of the flag and carrying out a securing operation if the subset value indicates that the data of that data type is to be secured and after each of the subset values has been checked resetting the subset values to indicate that no further securing operation is to be carried out. In another aspect securing the data comprises one of deleting the data encrypting the data or encrypting then deleting the data.

In still a further aspect there is provided computer readable memory having recorded thereon statements and instructions for execution by a computer to receive a command at the client device the command comprising an indicator of an authorization level wherein the authorization level is associated with an issuer of the command determine which of the plurality of data types is to be secured by identifying each of a plurality of predefined rules comprising an indicator of an authorization level equal to or less than the authorization level indicated in the received command each of the plurality of predefined rules being associated with one of the plurality of data types and secure only the data corresponding to each of the plurality of data types associated with the predefined rules thus identified.

In yet a further embodiment there is provided a mobile client device for selectively securing data from unauthorized access on the client device storing a plurality of data types the device comprising a processor a memory storing data comprising at least one of a plurality of data types and a receiver operatively connected to the processor for receiving a command at the client device the command comprising an indicator of an authorization level wherein the authorization level is associated with an issuer of the command wherein the processor is configured to determine using at least one predefined rule associated with the authorization level indicated by the authorization level indicator which of a plurality of data types is to be secured and to secure the data stored in the memory corresponding to each of the plurality of data types thus determined. In a further aspect each of the predefined rules is associated with one of a plurality of authorization levels and each of the predefined rules comprises a value indicating each of the plurality of data types to be secured in response to a received command and wherein the processor is further configured to identify the predefined rule associated with the authorization level indicated in the received command and to secure only those data types indicated by the value comprised in the identified predefined rule. In still a further aspect the device further comprises a memory for storing a flag comprising a subset value for each of the plurality of data types the subset value indicating whether the data of that data type is to be secured the processor being further configured to set the flag in response to the received command check each of the subset values of the flag and carry out a securing operation if the subset value indicates that the data of that data type is to be secured and after each of the subset values has been checked reset the subset values to indicate that no further securing operation is to be carried out. The processor may be configured to secure the data by deleting the data corresponding to each of the plurality of data types thus determined from the memory or to secure the data by encrypting the data corresponding to each of the plurality of data types thus determined in the memory. Further in another aspect the command may be received in an encrypted message and the processor is configured to decrypt the message and extract the command such that the command is authenticated if the command is extracted successfully.

Referring to an overview of an exemplary communication system for use with the embodiments described below is shown. One skilled in the art will appreciate that there may be many different topologies but the system shown in helps demonstrate the operation of the systems and methods described in the present application. There may be many communication devices connected to the system that are not shown in the simple overview of .

A client personal computer may for example be connected to an ISP Internet Service Provider on which a user of the system has an account located within a company possibly connected to a local area network LAN and connected to the Internet or connected to the Internet through a large ASP application service provider . Those skilled in the art will appreciate that the systems shown in may instead be connected to a wide area network WAN other than the Internet.

The wireless gateway and infrastructure provide a link between the Internet and wireless network . The wireless infrastructure determines the most likely network for locating a given user and tracks the user as they roam between countries or networks. Messages and other data may be delivered to the client mobile device via wireless transmission typically at a radio frequency RF from a base station in the wireless network to the client mobile device . The particular network may be any wireless network over which messages may be exchanged with a mobile communication device. The client mobile device may also receive data by other means for example through a direct connection to a port provided on the mobile device such as a Universal Serial Bus USB link.

The server system may be implemented for example on a network computer within the firewall of a corporation a computer within an ISP or ASP system or the like. The server system may act as the application network access and or file server for one or more communication devices. In the embodiment described below the server system also acts as an authoritative server for managing IP policies and issuing software and security related commands to the client devices . The mobile device if it is configured for receiving and possibly sending e mail may be associated with an account on the server system . The software products and other components that are often used in conjunction with the functions of the server system described herein are not shown in as they do not directly play a role in the system and method described below. If the server system acts as a message server the server system may support either a so called pull or push message access scheme wherein the mobile device requests that stored messages be forwarded by the message server to the mobile device pull or the server system may be provided with means for automatically redirecting messages addressed to the user of the mobile device as they are received push .

The server system may be used to provide administrative functions for the client devices and for example by establishing and transmitting information technology IT policies. In accordance with various embodiments administrator access is provided at the server system for issuing various commands relating to the management and security features of the client devices although the system and method described herein may be implemented from another device on the network if such administrator level access is provided at the other device. For ease of reference the various administrative functions and registration of client devices at a server will be described with reference to the server system . The system of may be configured to provide for multiple levels of administrator level access for example the system of may be implemented for use with an organization or institution mandating multiple levels of security authorization and IT support. The IT support roles may comprise help desk support which is authorized to provide a first set of administrator and IT support services to users of client devices such as application support and certain security related support such as resetting passwords but is not authorized to provide certain higher level administrator functions relating to more sensitive security issues and security IT support with a higher level of authorization for providing a second set of administrator and IT support services to the users of the client devices such as deploying and redeploying client devices configuring security protocols at and between the client devices and the server and other functions that may require a greater level of knowledge certification trust or security clearance to implement or configure. The level of authorization provided to particular support or administrative personnel may be determined by the server in accordance with a predetermined IT policy when the individual support person logs into the server upon login the server may look up the individual s administrative authorization level and provide the individual with access to the functions commensurate with his or her authorization level.

Typically and particularly in the instance where the client device is a communication device such as a smartphone PDA or laptop or other mobile computer a single user is designated as the authorized user of the client device although more than one user may be authorized to use the client device particularly if the device is a networked desktop computer or other non mobile device. Depending on the IT policy configured on that client device the user of the device may have access to a varied set of functions on the device. For example in the case of a smartphone or other client device capable of voice and or SMS communication the voice and or SMS functions may be disabled. While one method of disabling a function is to delete or simply not install the portion of the device s applications or operating system relating to this function this may not be feasible or desirable. Instead the availability of the function may be determined by the IT policy configured for that device. Furthermore users may be granted varying levels of access to configure or use the functions of the same client device . Some users may only be provided with access to previously installed application programs and may not have sufficient authority to install further applications and may only be provided with access to a portion of the data stores of the client device . Other users with a higher level of authorization may possess sufficient authority to install applications access secure data such as data stored in memory locations generally designated as inaccessible to typical users at the client device and alter selected security settings. The level of access afforded to the users of the client device again may be determined by an IT policy configured for that device. The IT policy may be consulted by the client device upon user login to determine the level of access to be granted to the user and is stored at the client device rather than only at the server in the event that a user logs into the client device while it is disconnected from the network the IT policy will still be available to the client device .

The client device may store data in an erasable persistent memory. In the case of a mobile device this may be flash memory. With reference to which depicts one embodiment of a mobile communication device and is described in detail below data may be stored in non volatile memory . The data stored on the client device may comprise user application data for example e mail messages address book data contact information calendar appointments and associated information text files image files and other data generated by either the user at the client device or received and stored by the communication device . Referring to a schematic representation of the data stored at the client device is shown. The data store of the communication device here represented as may be comprised in the non volatile memory and may comprise different types of data such as an operating system keys which may generally include encryption and decryption keys and addressing information for use in communicating between the communication device and the server personal information management PIM applications and messaging applications third party applications that may have been installed by the user or an administrator message PIM data such as e mail data short message service SMS data IM data multimedia message data and voicemail data calendar data and address book data other user entered data and IT policies . The message PIM data may comprise one or more of the various types of e mail data and other data . Voicemail data may comprise digitized audio recordings or may comprise a stub entry available for viewing in a messaging application indicating the availability of a voicemail message stored at another location. The user entered data may comprise text based graphic or other multimedia files loaded onto the communication device by the user. The various types of data through may be provided in whatever data format is best suited for the purpose. IT policy data may be in a human readable format but may also be stored in a binary format. discussed in more detail below provides an example of the nature of the information that may be represented by IT policy data .

The systems and methods disclosed herein may be used with many different computers and devices such as a wireless mobile communications device shown in . With reference to the communication device may comprise a dual mode mobile device and includes a transceiver a microprocessor a display non volatile memory random access memory RAM one or more auxiliary input output I O devices a serial port a keyboard a speaker a microphone a short range wireless communications sub system and other device sub systems .

The transceiver includes a receiver a transmitter antennas and one or more local oscillators and a digital signal processor DSP . The antennas and may be antenna elements of a multiple element antenna and may be embedded antennas. However the systems and methods described herein are in no way restricted to a particular type of antenna or even to wireless communication devices.

The communication device may comprise a two way communication device having voice and data communication capabilities. Thus for example the communication device may communicate over a voice network such as any of the analog or digital cellular networks and may also communicate over a data network. The voice and data networks are depicted in by the communication tower . These voice and data networks may be separate communication networks using separate infrastructure such as base stations network controllers etc. or they may be integrated into a single wireless network.

The transceiver is used to communicate with the network and includes the receiver the transmitter the one or more local oscillators and the DSP . The DSP is used to send and receive signals to and from the transceivers and and also provides control information to the receiver and the transmitter . If the voice and data communications occur at a single frequency or closely spaced sets of frequencies then a single local oscillator may be used in conjunction with the receiver and the transmitter . Alternatively if different frequencies are utilized for voice communications versus data communications for example then a plurality of local oscillators can be used to generate a plurality of frequencies corresponding to the voice and data networks . Information which includes both voice and data information is communicated to and from the transceiver via a link between the DSP and the microprocessor .

The detailed design of the transceiver such as frequency band component selection power level etc. will be dependent upon the communication network in which the mobile device is intended to operate. The voice and data networks may be separate voice networks and separate data networks or may comprise integrated voice and data networks. It will be appreciated by those skilled in the art that these embodiments may be implemented on a variety of voice and data communication networks including but not limited to 2G 2.5G 3G 4G and other voice and data networks such as GSM CDMA2000 GPRS EDGE W CDMA UMTS FOMA EV DO TD SCDMA HSPA HSOPA and the like.

Depending upon the type of network or networks the access requirements for the communication device may also vary. For example in the Mobitex and DataTAC data networks mobile devices are registered on the network using a unique identification number associated with each mobile device. In GPRS data networks however network access is associated with a subscriber or user of a mobile device. A GPRS device typically uses a subscriber identity module SIM which is required in order to operate a mobile device on a GPRS network. Local or non network communication functions if any may be operable without the SIM device but a mobile device will be unable to carry out any functions involving communications over the data network other than any legally required operations such as 911 emergency calling.

After any required network registration or activation procedures have been completed the communication device may the send and receive communication signals including both voice and data signals over the networks . Signals received by the antenna from the communication network are routed to the receiver which provides for signal amplification frequency down conversion filtering channel selection etc. and may also provide analog to digital conversion. Analog to digital conversion of the received signal allows more complex communication functions such as digital demodulation and decoding to be performed using the DSP . In a similar manner signals to be transmitted to the network are processed including modulation and encoding for example by the DSP and are then provided to the transmitter for digital to analog conversion frequency up conversion filtering amplification and transmission to the communication network via the antenna .

In addition to processing the communication signals the DSP also provides for transceiver control. For example the gain levels applied to communication signals in the receiver and the transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP . Other transceiver control algorithms could also be implemented in the DSP in order to provide more sophisticated control of the transceiver .

The microprocessor manages and controls the overall operation of the communication device . Many types of microprocessors or microcontrollers could be used here or alternatively a single DSP could be used to carry out the functions of the microprocessor . Low level communication functions including at least data and voice communications are performed through the DSP in the transceiver . Other high level communication applications such as a voice communication application A and a data communication application B may be stored in the non volatile memory for execution by the microprocessor . For example the voice communication module A may provide a high level user interface operable to transmit and receive voice calls between the mobile device and a plurality of other voice or dual mode devices via the network . Similarly the data communication module B may provide a high level user interface operable for sending and receiving data such as e mail messages files organizer information short text messages etc. between the communication device and a plurality of other data devices via the networks . The microprocessor also interacts with other device subsystems such as the display the RAM the auxiliary input output I O subsystems the serial port the keyboard the speaker the microphone the short range communications subsystem and any other device subsystems generally designated as .

Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as the keyboard and the display may be used for both communication related functions such as entering a text message for transmission over a data communication network and device resident functions such as a calculator or task list or other PDA type functions.

Operating system software used by the microprocessor may be stored in a persistent store such as non volatile memory . The non volatile memory may be implemented for example as a Flash memory component or as battery backed up RAM. In addition to the operating system which controls low level functions of the mobile device the non volatile memory includes a plurality of software modules A N that can be executed by the microprocessor and or the DSP including a voice communication module A a data communication module B and a plurality of other operational modules N for carrying out a plurality of other functions. These modules are executed by the microprocessor and provide a high level interface between a user and the communication device . This interface typically includes a graphical component provided through the display and an input output component provided through the auxiliary I O keyboard speaker and microphone . The operating system specific device applications or modules or parts thereof may be temporarily loaded into a volatile store such as RAM for faster operation. Moreover received communication signals may also be temporarily stored to RAM before permanently writing them to a file system located in a persistent store such as the flash memory .

The non volatile memory provides a file system to facilitate storage of PIM data items on the device. The PIM application includes the ability to send and receive data items either by itself or in conjunction with the voice and data communication modules A B via the wireless networks . The PIM data items are seamlessly integrated synchronized and updated via the wireless networks with a corresponding set of data items stored or associated with a host computer system thereby creating a mirrored system for data items associated with a particular user.

Context objects representing at least partially decoded data items as well as fully decoded data items are stored on the communication device in a volatile and non persistent store such as the RAM . Such information may instead be stored in the non volatile memory for example when storage intervals are relatively short such that the information is removed from memory soon after it is stored. However storage of this information in the RAM or another volatile and non persistent store ensures that the information is erased from memory when the communication device loses power. This prevents an unauthorized party from obtaining any stored decoded or partially decoded information by removing a memory chip from the communication device for example.

The communication device may be manually synchronized with a host system by placing the device in an interface cradle which couples the serial port of the communication device to the serial port of a computer system or device. The serial port may also be used to enable a user to set preferences through an external device or software application or to download other application modules N for installation. This wired download path may be used to load an encryption key onto the device which is a more secure method than exchanging encryption information via the wireless network .

A short range communications subsystem is also included in the communication device . The subsystem may include an infrared device and associated circuits and components or a short range RF communication module such as a BLUETOOTH module or an 802.11 module for example to provide for communication with similarly enabled systems and devices. Those skilled in the art will appreciate that BLUETOOTH and 802.11 refer to sets of specifications available from the Institute of Electrical and Electronics Engineers relating to wireless personal area networks and wireless local area networks respectively.

Returning to in accordance with various embodiments the data is stored in a manner such that either the location of the various types of data is tracked or that the type of data stored in the memory may be determined by querying a data table represented by the schematic . For example the data table may comprise a look up reference correlating each type of data with one or more memory address ranges . Thus it can be seen that in any IT policy data is stored in memory location addresses F0000001 through F0G00000. If the client device is configured such that predetermined ranges of memory addresses are allocated to different types of data it will be understood that the full range of memory addresses may not be utilized if only a portion of the memory allowance is required also the data may not be stored at consecutive memory addresses. Further if the memory address ranges allocated to the various types of data are not predetermined it will be understood that each type of data may not actually be stored in contiguous memory blocks thus a data table may comprise multiple memory address ranges as necessary in order to track the locations of each data type . Alternatively or in addition to the recording of corresponding memory address ranges each data type may be correlated with a further tag or label and the data stored in the memory store may be stored with associated tags such that the store can be scanned to identify all data blocks associated with a given tag .

As noted above an IT policy may be stored at the client device in a binary format. The content of the IT policy which may be described as a set of predefined rules may be configurable at the server by a user or administrator vested with sufficient access privileges or security clearance and is transmitted from the server to the client device . Configuration of the IT policy at the server may be carried out by means of a graphical user interface not shown in another embodiment the IT policy may be composed as a text file and then stored as an IT policy file at the client device . depict some exemplary contents of an IT policy illustrated in human readable form for ease of reference. The policy may consist of a series of key value pairs wherein the key defines a characteristic controlled by the IT policy and the corresponding value is alterable by an administrator with sufficient administrator access to alter the policy or by an administrator with sufficient administrator access to alter a subset of the policy that includes the key corresponding to the value to be changed. An example of a key value pair in the exemplary IT policy is PasswordRequired True in this example PasswordRequired corresponds to a rule that may be enacted by a security module executable on the device that a password must be entered by a user before access to the functions of the device is granted and the value set as True means that the rule is in force when this IT policy is applied. Another exemplary rule depicted in the IT policy is AllowVoiceCalling False. AllowVoiceCalling corresponds to a rule that may be enacted by the security module and or a voice calling module executable on the device equipped with such a feature that the user is allowed to use the device to make a voice call. An alternate exemplary rule that would determine the availability of a voice calling or SMS function would be a rule relating to use of a subscriber identity module SIM card in a mobile device . In this exemplary rule False indicates that this rule when in force does not allow the user to make voice calls. The implementation of IT policies on client devices will be generally understood by those skilled in the art. It will further be appreciated that the IT policy may be generated or stored in other formats and may not consist of key value pairs but rather of other commands or instructions that may be applied by the client device to configure the operation of the device.

Thus it can be seen that there may be various categories of data stored at the client device . Occasionally it may be desirable to delete data at the client device to prevent its access by an unauthorized party. This deletion which may comprise either the overwriting of all or substantially all memory addresses in the data store for example all but the addresses used to store the operating system and PIM messaging applications may be accomplished through the invocation of a wipe command.

Following the authentication step or receipt of the wipe command the client device then sets a flag at step in its non volatile memory for example memory of client device shown in . The flag may be set in the memory at a predetermined hidden location that is not accessible to third parties via an application programming interface and is set in the event that the client device is powered off before the deletion and or disablement of applications in response to the security command is completed. The device may be configured so that when it is powered on a security module or the boot code configures the processor to check the flag bits during boot up of the device to determine whether the flag was set if it was set the security module or boot code aborts any log in procedure executable on the device and re invokes the wipe command. Thus the wipe command cannot be circumvented without erasing the hidden location of the memory of the client device . The setting of the flag at step is described in further detail below.

The client device then executes the wipe command at step . The process of wiping data can be accomplished by writing zeroes ones or random combination of ones and zeros to the non volatile memory and optionally to portions of the volatile memory and or by removing memory references or pointers to the data in the non volatile memory and portions of the volatile memory . The wiping process may also include repeated overwriting of ones zeroes or a random arrangement of ones and zeros over the data to be wiped.

In some circumstances it may not be desirable to delete all types of data at the client device . For example a wipe of all data stored on the device would have the effect of deleting the IT policy data . As described above the IT policy data determines whether certain functions or data are available to a user of the device if the IT policy data is deleted then the next time the device is accessed by a user its operation may not be constrained by any rules set in the IT policy data at all. For example the IT policy may be configured to prevent a user from making outgoing voice calls e.g. AllowVoiceCalling False . This setting may only be in force so long as there is an IT policy stored at the client device . If all non application data were successfully wiped from the device then the IT policy data would be one of the sets of data deleted the user would then gain the ability to make outgoing voice calls. Thus a user may be able to circumvent the IT policy set for his or her device at least temporarily until the device is reconfigured by the server with a new IT policy. The ability to circumvent an IT policy may present a security risk however at other times deletion of the IT policy data may be desirable. As a further example an administrator or user may wish to only delete the PIM message data stored on the device without affecting other data or the operation of other systems on the device. Thus the embodiment described herein provides a system for allowing for selective deletion of data at the client device .

As noted above the wipe command is accompanied by or comprises an associated indicator of an authorization level. The indicator value is inserted into the command at the time the command is issued either at the client device or at the server and its value is determined by the authorization level associated with the issuer of the wipe command. The indicator value may be an alphanumeric value in accordance with one embodiment a value of 0 signifies the lowest authorization level and a value of 4 indicates the highest authorization level. The various authorization levels may be cumulative i.e. a person with an authorization level of 1 has authority to access the same functions and data at the server and or client device as a person with an authorization level of 0 plus access to additional functions and data alternatively the various authorization levels may be unrelated and have more or less overlap i.e. a person with an authorization level of 1 may have access to functions and data at the server only whereas a person with an authorization level of 0 only has access to functions and data at the client device . Thus when the wipe command is received at the client device the flag value is set at step with reference to the indicator value received with the command at step and authenticated at step and with reference to the IT policy stored at the client device . There may be more or fewer authorization levels for example these systems and methods may operate with only two authorization levels.

Returning to step while in a simple implementation the flag may consist of a single bit indicating whether a wipe is in progress in another embodiment the flag comprises a multi bit value corresponding to the authorization level indicated in the indicator accompanying the wipe command. The flag value may be determined using the existing IT policy for the device . For example if the existing IT policy contemplates only one rule relating to the authorization level required to enable a wipe of the IT policy itself then only a single rule such as ITPolicyWipeMinLevel 1 may be provided in the IT policy . This rule when executed by the device instructs the device to only wipe the IT policy from memory upon execution of a wipe command if the wipe command is accompanied by an indicator of an authorization level or a flag value corresponding to the IT policy of at least 1. In a more robust implementation such as that illustrated in the IT policy may comprise rules relating to the authorization level required to enable a wipe of the PIM message data PIMMessageDataWipeMinLevel user entered data UserDataWipeMinLevel IT policy ITPolicyWipeMinLevel third party applications ThirdPartyAppWipeMinLevel PIM message applications PIMMessageAppWipeMinLevel or key data KeyDataWipeMinLevel . In the example of an authorization level of 4 is required to wipe the IT policy but an authorization level of only 0 is required to wipe PIM message data. Thus for example if the authorization level indicated in the command is a 4 then according to the IT policy all data that requires an authorization level of 4 or less may be wiped which in the above example includes all data types listed above. If the authorization level indicated is zero then only that data capable of being wiped with that level of authorization here PIM message data and third party applications will be wiped. The types of data to be wiped are indicated in the flag.

An example of a flag is shown in . The flag comprises a number of subset values correlating to each of the data types stored at the client device . In the example of the two most significant bits correspond to a first data type here labelled as A01 with reference to it can be seen that these bits thus correspond to operating system data . The remaining pairs of bits from most to least significant thus correspond to key data PIM messaging applications third party applications PIM messaging data user entered data and IT policies .

In this embodiment a value of 11 for a pair of bits indicates that the corresponding data type is flagged for wiping. In the example of the bit pairs corresponding to third party applications PIM message data and user entered data have a value of 11. It will be appreciated that the flag does not require two bits for each type of data for example the flag may allocate only one bit per data type or may have whatever format is suitable for the implementation on the client device . If in a further embodiment the client device is configured to optionally take other steps upon receipt of a wipe command for example to encrypt data rather than delete it then two bits may be necessary in order for the flag to accurately indicate what action is to be taken on the data for example 00 may indicate that no action is to be taken 01 may indicate that the data is to be encrypted 11 may indicate that the data is to be deleted.

The execution of the wipe command at step will now be described in detail. In a first embodiment shown in the client device is configured to check each subset value contained within the flag in turn. The client device checks the next subset or pair of bits in the flag at step . The process may start either with the most significant values or the least significant values. If the device determines that it has reached the end of the flag at step then the flag is reset to a zero value at step indicating that the wipe command execution has been completed. If the end of the flag has not yet been reached then the device determines whether the subset value is set to the wipe value which in this example is 11 at step . If the subset value does not indicate that the corresponding data type is to be wiped the process returns to step . If the subset value indicates that the data type is to be wiped then at step the client device locates the data corresponding to the type represented by the subset or bit pair in the flag for example using the table of and deletes the data. The process then returns to step to check the next subset.

In a second embodiment of the execution of the wipe command shown in the wipe process is similar but the subset values in the flag are reset as the corresponding data is deleted. The client device checks the next subset or pair of bits in the flag at step . The process may start either with the most significant values or the least significant values. If the device determines that it has reached the end of the flag at step then the process ends. If the end of the flag has not yet been reached then the device determines whether the subset value is set to the wipe value which in this example is 11 at step . If the subset value does not indicate that the corresponding data type is to be wiped the process returns to step . If the subset value indicates that the data type is to be wiped then at step the client device locates the data corresponding to the type represented by the subset or bit pair in the flag for example using the table of and deletes the data. The subset value is then reset i.e. overwritten with a 00 value at step . The process then returns to step to check the next subset. It will be appreciated that in either of the foregoing embodiments the client device may encrypt rather than delete the data or may encrypt the data prior to deleting it. In any event the data identified by the flag is secured from unauthorized access by either deletion or encryption.

In an alternate embodiment the rules recorded in the IT policy comprise preconfigured sets of data types that may be wiped by users or administrators of each authorization level. Rather than assigning the ability to wipe a given data type to a minimum authorization level as described with reference to above the client device stores a set of directives that assign a particular set of data types to an authorization level. With reference to in the alternate embodiment the IT policy may comprise at least one rule such as DataWipeAuthLevel0 00000000000000. This rule assigns a flag value of 00000000000000 to an authorization level corresponding to 0 for example the authorization level of a typical user. This user is not authorized to issue a wipe command that wipes any data at the client device for example if this IT policy were implemented on the client device and a user with authorization level 0 were logged into the device then either the wipe command would be disabled on the device as long as that user was logged into the device or alternatively the wipe command may be enabled but would have no practical effect when executed. The flag values provided in the example provided in may be interpreted in the same manner as those provided in the example of described above that is to say beginning with the most significant pair the pairs of bits in the flag correspond to the operating system data key data PIM messaging applications third party applications PIM messaging data user entered data and IT policies . Again it will be appreciated that the flag values when implemented on the client device may have a different format and that the IT policy may comprise a set of directives for encrypting in addition to or in place of wiping the data as described above.

In the example of further rules are provided for the user administration authorization levels 1 2 and 4 DataWipeAuthLevel1 00000000111100 DataWipeAuthLevel2 00000011111100 and DataWipeAuthLevel4 00111111111111 respectively in this embodiment the client device is configured to implement the IT policy such that if a rule for a given authorization level is missing from the IT policy then the rule in effect for the next available lower authorization level is enforced for that missing authorization level. Thus in this example a wipe command issued by a user administrator with an authorization level of 3 would be governed by the DataWipeAuthLevel2 00000011111100 rule. It can be seen that in this particular example which is not intended to be limiting concerning the formatting of rules or flag values only those users administrators with an authorization level of 3 are capable of issuing a wipe command that will wipe the IT policy data and the key data . It will be appreciated that the execution of the wipe command will generally follow the same process as that described in respect of . When the user device sets the flag at step of it will locate the appropriate rule in the IT policy according to the authorization level indicator detected in the received wipe command then if the value provided in the rule is in the appropriate format the client device may utilize that value directly as the flag value in the subsequent execution of the wipe command in step .

It will be appreciated that this information need not be contained in a single IT policy file stored at the client device the wipe rules may be stored in a separate file or a different location in memory. In accordance with various embodiments the rules are incorporated into the IT policy that is updatable by an administrator or user at the server . Also the ability of an administrator or user to add or remove data types to each rule may be determined by the administrator s or user s authorization level. For example an administrator with an authorization level of 4 may be able to access server functions to designate which authorization levels up to and including level 4 may issue a command to wipe which data types. An administrator with an authorization level of 3 would thus lack sufficient permission to alter the wipe data types or wipe permissions that is the data types for which a person at a given authorization level is permitted issue a wipe command to a client device for a level 4 administrator but would be capable of altering the wipe permissions for an administrator of level 0 1 2 or 3.

However in order to ensure that a lower level administrator does not add the ability to wipe highly sensitive data such as encryption key data when the intention is to restrict that ability to only the highest of authorization levels the available data categories that are configurable by each administrator user level may be cascaded. Turning to an example of an administrative interface such as a dialog box that may be displayed at the server for configuring the various authorization wipe rules for the IT policy is shown. Each level of administrator user with the exception of the highest level of authorization is provided with access to modify only the wipe permissions for lower authorization levels but the ability to modify the wipe permissions for those lower authorization levels is determined by the permissions granted to the authorization level currently logged into the server . In for example an administrator of authorization level 3 is logged in because only an administrator of authorization level 4 is provided authority by the server functions to alter the authorization level 3 wipe permissions the checkboxes for selecting data types wipable by administrators of authorization levels 3 and 4 are not alterable as can be seen by the formatting of the headings 3 and 4 in the interface and the dashed lines in the checkboxes under those headings. The administrator currently logged into the server in this example is able to make certain changes to the wipe permissions of authorization levels 0 1 and 2 but only for those data types for which the administrator has permission to wipe in other words the currently logged in administrator cannot grant wipe permissions that he or she does not currently have. In the example of the currently logged in administrator has permission to wipe message data calendar data address book data user created data and third party applications but not PIM messaging applications encryption keys or IT policies and is therefore presented with a set of configuration options enabling the logged in administrator to configure security operations such as wiping and or encryption for users and administrators having a lower authorization level. Thus the selection boxes for PIM messaging applications encryption keys and IT policies are disabled as illustrated in with dashed lines for all levels of authorization.

In the example of an administrator with authorization level 4 is logged in therefore all selections are available to the currently logged in administrator as depicted by the solid line checkboxes and formatting of the example interface . In this embodiment the currently logged in administrator may alter the wipe permissions for its own level 4 without any effect on the permissions that this level of administrator may grant to other levels. In the example of this administrator has chosen to remove its own permission to wipe user created data on the client device as can be seen from the lack of a checkmark in the checkbox . However this administrator is still able to alter the wipe permissions for the same category of data for all other levels. Further in this example of the level 4 administrator has further disabled the level 4 administrator s wipe permission in relation to address book data as can be seen at the selection box but the level 2 and 3 administrators or users are still provided with permission to wipe that data category.

In this embodiment after input or alteration of wipe permissions for a user a new IT policy reflecting the newly configured wipe permissions is constructed at the server and transmitted to the client device . It will be appreciated that according to the implementation of the server functions at the server the IT policy thus constructed may be applied to each and every client device registered at the server or to only a subset of those devices.

By defining at the client device the authorization levels required to be able to wipe a given data type it is not necessary for a user or administrator at a server to choose the particular types of data that are to be deleted as a result of a wipe command at the time the wipe command is issued the actual determination and identification of the data to be deleted is carried out at the client device itself when the wipe command is executed. There is no need for the server to track the different types of data that are stored on the client device .

In the examples described above the user s or the administrator s authorization level indicated in the wipe command is associated with a predetermined set of data types to be wiped by the client device upon execution of the wipe command at step . In a still further embodiment the authorization level is still associated with a predetermined set of data types that may be the subject of a wipe command issued by that user or administrator but the user or administrator is also provided with the option of selecting a subset of the predetermined set of data types to be made the subject of a wipe command. Referring to an exemplary user interface at a server that may be presented to one category of user or administrator for example a help desk administrator is shown. The user interface comprises a listing of users whose accounts may be administered by the help desk administrator logged into the server . The administrator may select one user such as the user and select an option to Erase Data and Disable Handheld from a listing of options. The user interface may then comprise a pop up dialog box such as dialog box which provides the help desk administrator with a listing of available data types that may be erased including Message Data Calendar Data Address Book data Other user created data PIM messaging applications and Third party applications . However the further two options shown in the dialog box Encryption keys and IT Policy are not available to this help desk administrator as can be seen from the different formatting of these last two options because this administrator was not provided with sufficient privileges to delete these data types. Thus the help desk administrator may not select either Encryption keys or IT Policy to be deleted on a user s device . By contrast shows a further user interface when the server is operated by a security administrator with greater privileges than the help desk administrator. In this embodiment the administrator logged into the server is authorized to issue a wipe command that includes wiping the encryption keys and IT policy these options in dialog box are therefore available to be selected as can be seen from the formatting in the dialog box . In this further embodiment the wipe command issued from the server may comprise at least one indicator of the type or types of data to be wiped by the client device in executing the wipe command. The wipe command may further comprise the authorization level of the party issuing the authorization level so that the client device may also verify that the issuer possesses sufficient authority to issue the command to wipe the data types indicated at the authentication step . It will be appreciated that this embodiment may be implemented at the client device as well.

The foregoing systems and methods thus provide a means for selectively wiping data at a client device depending on the authorization level of the issuer of the wipe command. The issuer of the wipe command may be a user or administrator using the client device and inputting the wipe command on the client device or a user or administrator at the server issuing the wipe command. At either the client device or the server the user and or administrator may be provided with one of a number of authorization levels which is determined by the device or the server as the case may be when the individual logs into the device or server. In one embodiment an IT policy stored at the client device defines the various types of data that may be selected for wiping.

By thus identifying the data to be wiped at the client device on a more granular level according to the wipe command issuer s authorization level it is possible to avoid the situation where a user deliberately circumvents an IT policy in order to gain access to functions that the user was not intended to use. For example a user of the device may be able to invoke a wipe command at the device by selecting a menu option at the device or by otherwise deliberately triggering a wipe using the device as shown in the example described above while message data calendar data and the like may be deleted as a result of this wipe command the IT policy itself is not deleted and remains in force on the device . However if an administrator with a higher level of authorization were to issue the command then the IT policy may be deleted.

The systems and methods disclosed herein are presented only by way of example and are not meant to limit the scope of the present disclosure. Other variations of the systems and methods described above will be apparent to those skilled in the art and as such are considered to be within the scope of the present disclosure. For example it should be understood that steps and the order of the steps in the processing described herein may be altered modified and or augmented and still achieve the desired outcome.

The systems and methods data may be stored in one or more data stores. The data stores can be of many different types of storage devices and programming constructs such as RAM ROM flash memory programming data structures programming variables etc. It is noted that data structures describe formats for use in organizing and storing data in databases programs memory or other computer readable media for use by a computer program.

Code adapted to provide the systems and methods described above may be provided on many different types of computer readable media including computer storage mechanisms e.g. CD ROM diskette RAM flash memory computer s hard drive etc. that contain instructions for use in execution by a processor to perform the methods operations and implement the systems described herein.

The computer components software modules functions and data structures described herein may be connected directly or indirectly to each other in order to allow the flow of data needed for their operations. It is also noted that a module or processor includes but is not limited to a unit of code that performs a software operation and can be implemented for example as a subroutine unit of code or as a software function unit of code or as an object as in an object oriented paradigm or as an applet or in a computer script language or as another type of computer code.

A portion of the disclosure of this patent document contains material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by any one of the patent document or patent disclosure as it appears in the Patent and Trademark Office patent file or records but otherwise reserves all copyrights whatsoever.

