---

title: Computing a unit rate of power consumed in a data center
abstract: A power distribution unit having a power supply inputs including mains, secondary, generator, and renewable can be configured to measure how much power is drawn from each of the power supply inputs over a time period and to provide data to a unit rate of power engine indicating the same. A cost information engine can be configured to provide cost information, applicable over the time period, for each of the power supply inputs to the unit rate of power engine. The unit rate of power engine can be configured to compute the unit rate of power consumed in the data center over the time period based on the power drawn from each of the power supply inputs and the cost information.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09632553&OS=09632553&RS=09632553
owner: VMware, Inc.
number: 09632553
owner_city: Palo Alto
owner_country: US
publication_date: 20150508
---
Benefit is claimed under 35 U.S.C. 119 a d to Foreign application Serial No. 1215 CHE 2015 filed in India entitled COMPUTING A UNIT RATE OF POWER CONSUMED IN A DATA CENTER on Mar. 12 2015 by VMware Inc. which is herein incorporated in its entirety by reference for all purposes.

A data center is a facility that houses servers data storage devices and or other associated components such as backup power supplies redundant data communications connections environmental controls such as air conditioning and or fire suppression and or various security systems. A data center may be maintained by an information technology IT service provider. An enterprise may purchase data storage and or data processing services from the provider in order to run applications that handle the enterprises core business and operational data. The applications may be proprietary and used exclusively by the enterprise or made available through a network for anyone to access and use.

Data centers may use large amounts of electrical power. For example a rack of servers may use a few kilowatts of electrical power while numerous racks of servers housed in a large data center may use on the order of hundreds of megawatts of power over the same time period. Additional devices and support resources in the data center may use additional power. A large data center may use more than 100 times the amount of power used by an office building. The amount of power used for computing in a data center may scale up with faster and or bigger servers. Power costs for a data center may account for more than 10 of the total operating cost of the data center. More power demand may equate with more operational costs and more environmental stress.

In a data center e.g. a software defined data center cost from various drivers such as infrastructure power labor licenses etc. may be allocated to customers. For example such costs may be allocated to virtual computing instances VCIs provisioned by the data center for the purpose of a monthly showback report to the customers. The term VCI covers a range of computing functionality such as virtual machines virtual workloads data compute nodes clusters and containers among others. The term virtual machine VM refers generally to an isolated user space instance which can be executed within a virtualized environment. Other technologies aside from hardware virtualization can provide isolated user space instances also referred to as data compute nodes. Data compute nodes may include non virtualized physical hosts VMs containers that run on top of a host operating system without a hypervisor or separate operating system and or hypervisor kernel network interface modules among others. Hypervisor kernel network interface modules are non VM data compute nodes that include a network stack with a hypervisor kernel network interface and receive transmit threads. The term VCI covers these examples and combinations of different types of data compute nodes among others.

VCIs have been introduced to lower data center capital investment in facilities and operational expenses and reduce energy consumption. A VCI is a software implementation of a computer that executes application software analogously to a physical computer. VCIs have the advantage of not being bound to physical resources which allows VCIs to be moved around and scaled to meet changing demands of an enterprise without affecting the use of the enterprise s applications.

VMs in some embodiments operate with their own guest operating systems on a host using resources of the host virtualized by virtualization software e.g. a hypervisor virtual machine monitor etc. . The tenant i.e. the owner of the VM can choose which applications to operate on top of the guest operating system. Some containers on the other hand are constructs that run on top of a host operating system without the need for a hypervisor or separate guest operating system. The host operating system can use name spaces to isolate the containers from each other and therefore can provide operating system level segregation of the different groups of applications that operate within different containers. This segregation is akin to the VM segregation that may be offered in hypervisor virtualized environments that virtualize system hardware and thus can be viewed as a form of virtualization that isolates different groups of applications that operate in different containers. Such containers may be more lightweight than VMs.

Efficient power cost estimation allocation and optimization in the data center can include computing a unit rate of power consumed in the data center. The problem may be complex because a power distribution unit in a data center may have multiple power sources such as a mains power supply a secondary power supply a generator power supply and or a renewable power supply.

As the amount of power used by data centers increases IT service providers may be motivated to draw less of the power used by the data center from the grid e.g. mains power supply and or secondary power supply and to draw more of the power used by the data center from renewable sources of power e.g. renewable power supply . The power distribution unit can accurately meter the amount of power coming from each source but the cost should be computed with care. For example it may be desirable to amortize the cost of generator power supply and renewable power supply and spread the cost evenly over a time period whereas mains power supply and secondary power supply may be treated on actuals which can vary over time. A server can have a live power meter to monitor the amount of power consumed by the server e.g. in real time . In some embodiments the amount of power consumed can be monitored on a per VCI basis. According to a number of embodiments of the present disclosure the unit rate of power consumed by the data center can include capital expenditure for infrastructure and or operating expenditures for each power supply used by the data center. Different policies can be used to compute the unit cost of power among the different power supplies for the data center.

The present disclosure is not limited to particular devices or methods which may vary. The terminology used herein is for the purpose of describing particular embodiments and is not intended to be limiting. As used herein the singular forms a an and the include singular and plural referents unless the content clearly dictates otherwise. Furthermore the words can and may are used throughout this application in a permissive sense i.e. having the potential to being able to not in a mandatory sense i.e. must . The term include and derivations thereof mean including but not limited to. 

The figures herein follow a numbering convention in which the first digit or digits correspond to the drawing figure number and the remaining digits identify an element or component in the drawing. Similar elements or components between different figures may be identified by the use of similar digits. For example may reference element in and a similar element may be referenced as in . As will be appreciated elements shown in the various embodiments herein can be added exchanged and or eliminated so as to provide a number of additional embodiments of the present disclosure. In addition as will be appreciated the proportion and the relative scale of the elements provided in the figures are intended to illustrate certain embodiments of the present invention and should not be taken in a limiting sense.

The power distribution unit can be coupled to and or part of a data center . The power distribution unit can distribute electrical power from any of the power supply inputs to the data center . The power distribution unit can measure how much power is drawn from each of the power supply inputs by the data center over a time period. The power distribution unit can filter the power supply inputs to improve power quality provide intelligent load balancing and allow for remote and or local monitoring and control of the flow of power into the data center . The power distribution unit can provide data to the unit rate of power engine in the subsystem indicating the power drawn from each of the power supply inputs over the time period. In some embodiments the power distribution unit can be configured to provide the data to the unit rate of power engine instantaneously over the time period.

Each power supply comes with its own cost. The mains power supply and the secondary power supply include relatively little capital expenditure investment while the generator power supply and the renewable power supply include relatively more capital expenditure investment e.g. buying and installing a generator and or renewable power source such as solar panels wind turbines etc. . All of the power supply inputs have some regular operating expense investment. Some examples of costs other than the cost of the power itself that impact various power supply inputs include infrastructure maintenance labor facilities and other costs. In some instances costs may be offset by rebates or discounts.

Infrastructure costs include capital expense costs on the power supply infrastructure. For example capital expenditure costs for the mains power supply and or the secondary power supply may be negligible while capital expenditure costs for the generator power supply and or the renewable power supply may be more significant. Depreciation can be applied to the costs using a combination of double declining balance and standard line depreciation over n number of years e.g. three to five years to come to a total cost over a time period e.g. monthly due to capital expenditures which is denoted as Cherein. Depreciation can be computed as Yearly depreciation max Double declining balance Straight line depreciation where Straight line depreciation is Yearly depreciation original cost accumulated depreciation number of depreciation years and where Double declining balance is Depreciation rate 2 number of depreciation years Yearly depreciation original cost accumulated depreciation depreciation rate and in the last year of depreciation Yearly depreciation original cost accumulated depreciation.

Maintenance costs include costs for repairs and regular maintenance expenses toward power equipment and may be declared as a percentage of total power infrastructure cost over the time period. Maintenance cost is denoted as Cherein.

Labor costs include the expenses of labor that are paid toward maintaining power infrastructure. This can be applied as the total labor cost over the time period. Labor cost is denoted as Cherein.

Facilities costs include expenses paid toward rent etc. This can be specified as rent over the time period as real estate cost per rack unit in the data center etc. The facilities cost is denoted as Cherein.

Other costs represent any cost paid for power management of the data center that does not fit into one of the previously defined cost categories. The other costs are denoted as Cherein.

Some power supplies such as renewable energy sources may include tax rebates from the government. Such rebates can be specified as a percentage of expenditure on these sources over the time period or as a total rebate amount over the time period. A rebate is denoted as Cherein.

The subsystem can be either directly connected to the power distribution unit and or the data center or remotely connected e.g. via network as illustrated in . The subsystem can include a unit rate of power engine and a cost information engine coupled to the unit rate of power engine as described in more detail with respect to . As the subsystem is coupled to the power distribution unit and or the data center the unit rate of power engine and or the cost information engine are coupled to the power distribution unit and or the data center . In some embodiments the subsystem can be a server such as a web server.

According to some embodiments of the present disclosure different policies can be used to compute power consumed in the data center . For example a computation can be based on an average unit rate where customers of the data center can be charged at a same average rate over the time period. As another example a computation can be based on an instantaneous unit rate where customers of the data center can be charged differently at different times over the time period. An example of this is peak versus off peak pricing for power. In some embodiments costs for different power supplies can be computed differently. For example the cost of power supplied by backup power supplies may be computed on an average basis rather than instantaneously due to the irregular usage pattern of backup power supplies. The cost of the irregular usage of backup power supplies can be averaged over customers of the data center that ran workloads over the time period. As another example costs for power supplies such as a mains power supply and a secondary power supply may be computed instantaneously where utilities provides an instantaneous rate for such power supplies. As yet another example power supplies having relatively high capital expenditure costs may be charged on an average basis to help balance the relatively high capital expenditure costs. According to the present disclosure an administrator of the subsystem can set an operating parameter to choose which policy to use to compute the unit rate of power consumed in the data center e.g. via an input illustrated in .

An average unit rate of power consumed in the data center can be computed using both instantaneous unit rates for those power supplies for which an instantaneous rate is applicable and an average unit rate for other power supplies. The instantaneous unit rate for a particular power supply is U t the instantaneous amount of power consumed from the primary power supply is P t and the instantaneous power consumed from other power supplies is P t where t indicates an instantaneous time. The total amount of power consumed in the data center over a month can be computed as 1 The total operating expense costs for the data center can be computed as 2 The total power consumed from the particular power supply can be computed as 3 The average unit rate for the particular power supply can be computed as 4 Thus the average unit rate can be computed for each power supply that has an instantaneous unit rate.

For a particular power supply that has a capital expenditure cost the capital expenditure cost can be denoted as Cand the instantaneous power consumed from the power supply can be denoted as P t . The total power consumed from the particular power supply can be computed as 5 The total cost for the power supply can be computed as depreciated amount 6 The average unit rate can be computed as 7 

The average unit rate for all of the power supplies in the data center can be computed as circumflex over 8 Thus the average unit rate for the entire data center can be computed according to a first policy.

Some power supplies may have an instantaneous unit rate U t . The instantaneous operating expense rate can be computed as 9 where T is the time period e.g. a month . Instantaneous operating expense rate can be proportioned to the power drawn from a particular power supply as 10 The instantaneous unit rate for the particular power supply can be computed as 11 For backup power supplies such as the secondary power supply that may have an instantaneous unit rate the average unit rate t can be computed according to Equation 4. For regular power supplies such as the renewable power supply that has a capital expenditure cost associated therewith the instantaneous unit rate Ur t can be computed as 12 

The instantaneous unit rate for the resources in the data center can be computed as the sum of the instantaneous unit rates for the regular power supplies and the sum of the average unit rates for the backup power supplies as 13 Thus the average unit rate for the entire data center can be computed according to a second policy e.g. as a function of time . This metric can then be used to compute power cost to VCIs of a shorter time period e.g. instantaneously hourly daily etc. and then be integrated or summed over a longer time period e.g. a month to come up with accurate power cost allocation per data center entity.

The data center can include a number of hosts . . . M referred to generally as host each with processing resources e.g. a number of processors memory resources and or a network interface . The host can be included for example in a software defined data center. A software defined data center can extend virtualization concepts such as abstraction pooling and automation to data center resources and services to provide information technology as a service ITaaS . The term abstraction does not mean an abstract idea. Rather abstractions are a logical level of functionality provided by tangible physical interfaces that are implemented using physical computer hardware such as processing resources memory resources and network resources. In a software defined data center infrastructure such as networking processing and security can be virtualized and delivered as a service. A software defined data center can include software defined networking and or software defined storage. In some embodiments components of a software defined data center can be provisioned operated and or managed through an application programming interface API .

The host can incorporate a hypervisor that can execute a number of VCIs . . . N referred to generally herein as VCIs . The VCIs can be provisioned with processing resources and or memory resources and can communicate via the network interface . The processing resources and the memory resources provisioned to the VCIs can be local and or remote to the host . For example in a software defined data center the VCIs can be provisioned with resources that are generally available to the software defined data center and not tied to any particular hardware device. By way of example the memory resources can include volatile and or non volatile memory available to the VCIs . The VCIs can be moved to different hosts not specifically illustrated such that a different hypervisor manages the VCIs .

The hosts can draw power from the power distribution unit for example to execute the number of VCIs . However the data center can include other items that draw power from the power distribution unit . For example the data center can include a number of non virtualized servers heating ventilation and cooling HVAC equipment lighting various databases e.g. to support the hosts the non virtualized servers and or other computing equipment as well as other miscellaneous items that draw power.

The number of engines can include a combination of hardware and program instructions that is configured to perform a number of functions described herein. The program instructions e.g. software firmware etc. can be stored in a memory resource e.g. machine readable medium as well as hard wired program e.g. logic . Hard wired program instructions e.g. logic can be considered as both program instructions and hardware.

In some embodiments the cost information engine can include a combination of hardware and program instructions that is configured to provide cost information applicable over a time period for each of the power supply inputs to the unit rate of power engine . In some embodiments cost information can be acquired from the database which can be external to the subsystem . For example in some instances a utility may make cost information available e.g. on an instantaneous basis on a trailing basis and or on an average basis and the cost information engine can collect that information from the database associated with the utility. In some embodiments the database can be controlled by an entity controlling the data center e.g. data center illustrated in and the database can be populated with cost information known to the entity for a number of power supply inputs.

In some embodiments the unit rate of power engine can include a combination of hardware and program instructions that is configured to compute the unit rate of power consumed in the data center over the time period based on the power drawn from each of the power supply inputs and the cost information provided by the unit rate of power engine . As described herein different policies can be used to compute the unit rate of power consumed in the data center. The unit rate of power engine can compute the unit rate of power according to various policies for example as set by an operating parameter that can be selected via input . A first operating parameter can be selected via input to cause the unit rate of power engine to compute the unit rate of power according to a first policy and or a second operating parameter can be selected via input to cause the unit rate of power engine to compute the unit rate of power according to a second policy. However embodiments are not limited to a particular number of policies.

The cost information engine can be configured to provide the cost information including an operating expenditure cost and or a capital expenditure cost for the power supply inputs. For example the cost information engine can be configured to provide the cost information including a capital expenditure cost for the generator power supply and the renewable power supply. The unit rate of power engine can be configured to include the operating expenditure cost and or the capital expenditure cost in the computation of the unit rate of power. In some embodiments the cost information engine can be configured for at least one of the power supply inputs to provide instantaneous cost information over the time period and the unit rate of power engine can be configured to compute the unit rate of power as an instantaneous rate of power over the time period e.g. inclusive of both the instantaneous cost information for the at least one power supply input and cost information for a different one of the power supply inputs that is averaged over the time period .

In some embodiments the unit rate of power engine can be configured to allocate a cost of powering the data center to VCIs provisioned by the data center according to the unit rate of power consumed in the data center. That is the unit rate of power engine can use the computed unit rate of power consumed in the data center to charge customers of the data center for the VCIs provisioned for the customers. Such embodiments may help to identify cost saving opportunities for the customers and or for the entity controlling the data center e.g. when to run workloads and at what time to run workloads in order to reduce the total power cost .

Memory resources can be non transitory and can include volatile and or non volatile memory. Volatile memory can include memory that depends upon power to store information such as various types of dynamic random access memory DRAM among others. Non volatile memory can include memory that does not depend upon power to store information. Examples of non volatile memory can include solid state media such as flash memory electrically erasable programmable read only memory EEPROM phase change random access memory PCRAM magnetic memory optical memory and or a solid state drive SSD etc. as well as other types of machine readable media.

The processing resources can be coupled to the memory resources via a communication path . The communication path can be local or remote to the machine . Examples of a local communication path can include an electronic bus internal to a machine where the memory resources are in communication with the processing resources via the electronic bus. Examples of such electronic buses can include Industry Standard Architecture ISA Peripheral Component Interconnect PCI Advanced Technology Attachment ATA Small Computer System Interface SCSI Universal Serial Bus USB among other types of electronic buses and variants thereof. The communication path can be such that the memory resources are remote from the processing resources such as in a network connection between the memory resources and the processing resources . That is the communication path can be a network connection. Examples of such a network connection can include a local area network LAN wide area network WAN personal area network PAN and the Internet among others.

As shown in the MRI stored in the memory resources can be segmented into a number of modules that when executed by the processing resources can perform a number of functions. As used herein a module includes a set of instructions included to perform a particular task or action. The number of modules can be sub modules of other modules. For example the cost information module can be a sub module of the unit rate of power module . Furthermore the number of modules can comprise individual modules separate and distinct from one another. Examples are not limited to the specific modules illustrated in .

Each of the number of modules can include program instructions and or a combination of hardware and program instructions that when executed by a processing resource can function as a corresponding engine as described with respect to . For example the unit rate of power module can include program instructions and or a combination of hardware and program instructions that when executed by a processing resource can function as the unit rate of power engine and or the cost information module can include program instructions and or a combination of hardware and program instructions that when executed by a processing resource can function as the cost information engine .

The machine can include unit rate of power module which can include instructions to determine how much power is drawn from each of the power supply inputs to a data center over a time period based on information received from a power distribution unit coupled to the power supply inputs. The cost information module can include instructions to determine an operating expense for each power supply input over the time period. The cost information module can include instructions to determine a capital expense for at least one of the power supply inputs over the time period.

The unit rate of power module can include instructions to compute a unit rate of power consumed by the data center as a function of time based on the power drawn the operating expense and the capital expense according to a first policy in response to a first operating parameter being selected. The instructions to determine the capital expense for at least one of the power supply inputs can include instructions to depreciate the capital expense before the unit rate of power consumption is computed. For example the instructions to compute the unit rate of power according to the first policy can include instructions to compute an average unit rate of power consumed by the data center over a time period for all of the power supply inputs.

The unit rate of power module can include instructions to compute a unit rate of power consumed by the data center as a function of time based on the power drawn the operating expense and the capital expense according to a second policy in response to a second operating parameter being selected. For example the instructions to compute the unit rate of power according to the second policy can include instructions to compute an average unit rate of power consumed by the data center over a time period for a first subset of the power supply inputs and to compute an instantaneous unit rate of power consumed by the data center over the time period for a second subset of the power supply inputs. The second set of power supply inputs can include those power supply inputs that have a peak rate and an off peak rate e.g. a mains power supply input and a secondary power supply input . The first subset of power supply inputs can include a generator power supply input and a renewable power supply input.

The unit rate of power module can include instructions to allocate a cost of powering the data center to customers of the data center according to the unit rate of power consumed by the data center e.g. regardless of by which policy the unit rate of power is computed . For example the instructions to allocate the cost of powering the data center can include instructions to allocate the cost to the customers at an average unit rate of power.

In some embodiments the method can include provisioning VCIs in each of the software defined data centers. In such embodiments monitoring the relative usage of the pool of physical computing resources by each of the software defined data centers can include monitoring the relative usage per VCI e.g. monitoring a relative proportion of processor resources used by each of the VCIs . Allocating the unit rate of power consumed can include allocating the unit rate of power consumed to the software defined data centers on a per VCI basis.

In some embodiments the method can include receiving the cost information for the power supply inputs. For example an input of a first plurality of instantaneous rates applicable over the time period can be received for a mains power supply a second plurality of instantaneous unit rates applicable over the time period can be received for a secondary power supply an input of a first unit rate for a generator power supply can be received and an input of a second unit rate for a renewable power supply can be received. As another example an input of a first average unit rate applicable over the time period can be received for a mains power supply a second average unit rate applicable over the time period can be received for a secondary power supply a first unit rate for a generator power supply can be received and a second unit rate for a renewable power supply can be received.

Although specific embodiments have been described above these embodiments are not intended to limit the scope of the present disclosure even where only a single embodiment is described with respect to a particular feature. Examples of features provided in the disclosure are intended to be illustrative rather than restrictive unless stated otherwise. The above description is intended to cover such alternatives modifications and equivalents as would be apparent to a person skilled in the art having the benefit of this disclosure.

The scope of the present disclosure includes any feature or combination of features disclosed herein either explicitly or implicitly or any generalization thereof whether or not it mitigates any or all of the problems addressed herein. Various advantages of the present disclosure have been described herein but embodiments may provide some all or none of such advantages or may provide other advantages.

In the foregoing Detailed Description some features are grouped together in a single embodiment for the purpose of streamlining the disclosure. This method of disclosure is not to be interpreted as reflecting an intention that the disclosed embodiments of the present disclosure have to use more features than are expressly recited in each claim. Rather as the following claims reflect inventive subject matter lies in less than all features of a single disclosed embodiment. Thus the following claims are hereby incorporated into the Detailed Description with each claim standing on its own as a separate embodiment.

