---

title: Portable terminal device that selects lowest amount of power consumed by a sensor and sensor's driver
abstract: A portable terminal device includes: a memory to store power data; and a processor to execute a process, the process including: receiving an instruction to execute sensing; specifying one or more sensors for executing the sensing or one or more drivers controlling the sensors so that devices including the specified sensor and driver are specified; calculating a power consumed for the sensing by the specified devices based on the power data; and selecting a combination of the driver and the sensor, having a minimum power consumed for the sensing by the specified devices.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09571613&OS=09571613&RS=09571613
owner: FUJITSU LIMITED
number: 09571613
owner_city: Kawasaki
owner_country: JP
publication_date: 20150603
---
This application is based upon and claims the benefit of priority from the prior Japanese Patent Application No. 2014 137212 filed on Jul. 2 2014 the entire contents of which are incorporated herein by reference.

An application program using various sensors is installed in a portable terminal device represented by a smart phone. As the portable terminal device is multi functionalized a plurality of sensors of the same type may be equipped in the portable terminal device.

Related techniques are disclosed in for example International Publication Pamphlet No. WO 2010 107107 and Japanese Laid Open Patent Publication No. 2003 157155.

According to an aspect of the invention a portable terminal device includes a memory to store power data and a processor to execute a process the process including receiving an instruction to execute sensing specifying one or more sensors for executing the sensing or one or more drivers controlling the sensors so that devices including the specified sensor and driver are specified calculating a power consumed for the sensing by the specified devices based on the power data and selecting a combination of the driver and the sensor having a minimum power consumed for the sensing by the specified devices.

The object and advantages of the invention will be realized and attained by means of the elements and combinations particularly pointed out in the claims.

It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory and are not restrictive of the invention as claimed.

In the related art the power consumption of a sensor used in an application being executed is not always smaller than the power consumption of a sensor in an application not being executed. Accordingly there is a case where the power consumption of the sensor may cause a problem.

Hereinafter descriptions will be made on a portable terminal device equipped with a plurality of sensors according to the present disclosure with reference to the accompanying drawings. In the meantime the present disclosure is not limited to the embodiments. Also respective embodiments may be appropriately combined with each other within a scope in which inconsistency between processing contents are not caused.

Hereinafter the term sensing is used to indicate measuring and determining a physical quantity such as sound light temperature using a sensor. First descriptions will be made on a functional configuration of a portable terminal device according to the present embodiment. is a block diagram illustrating a functional configuration of a portable terminal device according to First Embodiment. The portable terminal device illustrated in executes a sensing control in which a sensing request made by an application program running on the portable terminal device is executed using a sensor under the control of the portable terminal device .

As a part of the sensing control the portable terminal device selects a sensor which consumes a less power than a case where sensing is executed using other sensors among the sensors under the control of the portable terminal device when various types of sensors capable of achieving the same sensing exist. Therefore the portable terminal device suppresses for example the power consumption for sensing.

In one embodiment a sensing control program which provides the sensing control described above to for example the application program running on the portable terminal device as an API Application Programming Interface may be installed in various computers as middleware to be equipped in the portable terminal device . The sensing control program may be provided as either a packaged software or an online software. For example the sensing control program may be installed in a mobile communication terminal such as a smart phone a mobile phone or a PHS Personal Handyphone System and in a portable terminal device including for example a tablet terminal or a slate terminal. Therefore the sensing control described above may be executed by the portable terminal device .

In the meantime here the following descriptions will be made on the portable terminal device by way of an example of an apparatus in which the sensing control program is installed but the sensing control program needs not necessarily be installed in the portable terminal device . For example the sensing control program may be installed in the whole of the information processing apparatus including a stationary terminal device and a personal computer.

As illustrated in the portable terminal device includes a BLE Bluetooth registered trademark Low Energy chip a walk sensor a BLE chip and a walk sensor as examples of sensors.

Both the BLE chip and the BLE chip are chips to perform a communication over the BLE with other apparatuses. Each of the BLE chip and BLE chip is capable of sensing a BLE compliant device. In the meantime the BLE is exemplified here as a short range wireless communication but the short range wireless communication may be performed in accordance with other wireless communication standards than the BLE.

Among the BLE chips the difference between the BLE chip and the BLE chip is that the BLE chip is utilized by a driver executed by a control unit without requiring an intervention of other device while a sensor microcomputer is intervened between the BLE chip and a driver executed by the control unit .

A microcomputer not illustrated is installed in the BLE chip and the BLE chip . The microcomputer executes a notification to the control unit by being narrowed to a case where the notification may be made to the control unit when a predetermined notification condition such as for example a threshold value is satisfied. Accordingly when a BLE sensing is executed the control unit may be in a sleep state until the notification condition is satisfied.

Both the walk sensor and the walk sensor are sensors to acquire walk data. Among these sensors the difference between the walk sensor and the walk sensor is that the walk sensor is utilized by a driver executed by the control unit without requiring an intervention of other device while a sensor microcomputer is intervened between the BLE chip and a driver executed by the control unit .

In one embodiment the walk sensor and the walk sensor may employ a motion sensor such as a triaxial acceleration sensor. For example the walk sensors are capable of sensing for example a walk or a quick walk using a triaxial acceleration data acquired by the motion sensor as an example of walk data. Further the walk sensors are also capable of sensing more accurate walk data using a posture component obtained from a sensor such as a geomagnetic sensor or a gyro sensor together with the sensed walk or quick walk.

Further the portable terminal device includes the sensor microcomputer as an example of a sensing processor as illustrated in .

The sensor microcomputer is so called a microcomputer that is a microprocessor which controls the sensing operation performed by the BLE chip and the walk sensor

In one embodiment the sensor microcomputer may combine sensor outputs from the BLE chip and the walk sensor to determine a composite notification condition. Also the sensor microcomputer executes a notification to the control unit by narrowing the situation to a case where the notification may be made to the control unit when the predetermined notification condition is satisfied. Accordingly when a sensor under the control of the sensor microcomputer executes a sensing operation the control unit may be in a sleep state until the notification condition is satisfied.

Further the portable terminal device includes a storage unit as a main storage device and the control unit as a central processing unit as illustrated in .

The storage unit is a storage device which stores data used for various programs such as an OS Operating System a middleware and an application program executed in the control unit .

In one embodiment the storage unit is installed as the main storage device in the portable terminal device . For example various semiconductor memory devices such as for example a RAM Random Access Memory a ROM Read Only Memory or a flash memory may be employed in the storage unit . Further the storage unit may be installed as an auxiliary storage device. In this case a device such as an SSD Solid State Drive may be employed in addition to a removable medium such as a USB Universal Serial Bus memory or an SD Secure Digital card.

The control unit includes an internal memory which stores various programs or control data and executes various processings using the programs or data.

In one embodiment the control unit is installed as a central processing unit so called a CPU. In the following descriptions may be made by describing the control unit as a CPU in an assumption that the control unit is installed as the CPU. In the meantime the control unit needs not necessarily be installed as the central processing unit and may be installed as an MPU Micro Processing Unit . Further the control unit may be implemented by a hard wired logic such as an ASIC Application Specific Integrated Circuit or FPGA Field Programmable Gate Array .

The control unit executes various programs to virtually implement processing units to be described below. For example the control unit includes a driver execution unit a driver execution unit a sensor microcomputer driver execution unit an application execution unit and a middleware execution unit as illustrated in .

The driver execution unit the driver execution unit and the sensor microcomputer driver execution unit are processing units which execute software such as so called a driver which controls a sensor under the control of the portable terminal device .

Among these execution units the driver execution unit executes a driver corresponding to the BLE chip and the driver execution unit executes a driver corresponding to the walk sensor . Further the sensor microcomputer driver execution unit executes a driver corresponding to the sensor microcomputer

In one embodiment the application execution unit may execute an arbitrary application program. The application program may also be pre installed in the portable terminal device downloaded from an external apparatus or acquired from a removable medium connected either by wired or wirelessly. For example when an instruction to activate an application program is issued by manipulation of a user the application execution unit activates the application program. Further the application execution unit may operate the application in a background. In this case the application program operates within a range of authority given by the user of the portable terminal device according to a condition determined by a manufacturer of the portable terminal device or an issuance source of the application program. In the meantime a plurality of application programs may be executed in parallel by a multitasking.

Here the application program may place a sensing request to the middleware executed in the middleware execution unit . For example when the application program relative to an SNS Social Networking Service or a game is executed StreetPass Communication by short range wireless communication may be established with another terminal. In this case an instruction to perform the BLE sensing is issued to the middleware from the application program. Further when an application program about a health management that is an application program which calculates for example calorie consumption is executed the number of steps of walk or quick walk may be used in calculating the calorie consumption. In this case an instruction to perform a walk sensing is issued to the middleware from the application program.

The middleware execution unit is a processing unit that executes a sensing control program provided as a middleware.

The reception unit is a processing unit that receives various instructions from the application program.

In one embodiment the reception unit receives a sensing request from the application program executed by the application execution unit according to an API provided by the sensing control program. The sensing request may include for example a sensing type and other information such as a sensing period of time. In this manner when a sensing request is received the reception unit notifies the specification unit of the sensing request.

The specification unit is a processing unit which specifies a device to be operated during execution of the sensing for each combination of sensors or drivers that implement a single or a plurality of sensing for which a request is received from the application program.

In one embodiment when the sensing request is received from the application program being executed by the application execution unit the specification unit derives a combination of drivers which implement the sensing for the request. For example the specification unit inquires the respective driver execution units and being executed in the control unit of whether the sensing for which the request is received by the reception unit is capable of being executed to derive the combination of drivers. Further the specification unit may retrieve the combination of drivers being corresponded to the type of sensing for which the request is received to derive the combination of drivers by referencing a correspondence relationship table in which a type of sensing and a combination of drivers are defined. As described above the specification unit may derive the combination of drivers by either the inquiry or the retrieval. In this case when various combinations of drivers that implement the sensing for which the request is received exist the specification unit derives all combinations of drivers. In the meantime here as an example a combination of drivers is extracted but a combination of sensors may be derived.

Thereafter the specification unit selects one combination of drivers among the combinations of drivers. Subsequently the specification unit specifies a device to be operated during the execution of the sensing from the combination of drivers selected at previous time. That is the specification unit specifies whether only a sensor which is an end hardware is required to be operated a CPU capable of executing a determination using a sensor output is also necessarily required to be operated or a sensing processor such as the sensor microcomputer is required to be operated instead of the CPU in executing the sensing. With this configuration the device described above may include a processor along with a sensor. In the following the device to be operated during execution of the sensing may be described as an operating device . In this case in a case of the inquiry described above when the sensing operation can be executed the operating device may also be included in a reply along with whether the sensing is allowed or not. Further in a case of the retrieval described above the operating device may also be added in the correspondence relationship table to be corresponded as an item of the relationship table.

The calculation unit is a processing unit that calculates a power consumed for the sensing by the operating device for each combination.

In one embodiment the calculation unit references the operating power data stored in the storage unit to calculate a power consumed for the sensing by each operating device each time when the operating device is specified by the specification unit . For example data in which items such as a device and an operating power are corresponded to each other may be employed in the operating power data . is a diagram illustrating an example of the operating power data . In the operating power of the respective devices of the BLE chip the walk sensor the BLE chip the walk sensor the sensor microcomputer and the CPU are exemplified. For example the example of indicates that even though the BLE chip and the BLE chip are the same type of BLE sensor the BLE chip consumes only 2 mA for operation while the BLE chip consumes 3 mA for operation. Further an operating power of the CPU is 20 mA which is the maximum value of the operating power in and also indicates that more than double the operating powers of other devices is consumed for operation by the CPU . With the operating powers the calculation unit retrieves the operating power corresponding to each device to be operated during execution of the sensing. Thereafter the calculation unit calculates the power consumption for a case where each device executes a sensing by combining a total operating power of each device.

The selection unit is a processing unit that selects the combination having the minimum power consumption during an execution of the sensing.

In one embodiment each time when the power consumption is calculated by the calculation unit the selection unit references an internal memory in which the minimum value of power consumption among the power consumption calculated up until now is stored to compare the calculated power consumption with the minimum value of the power consumption in magnitude. In this case when the power consumption calculated by the calculation unit is smaller than the minimum value stored in the internal memory the selection unit overwrites the minimum value with the power consumption calculated by the calculation unit to store the calculated power consumption in the internal memory that is the minimum value in the internal memory is updated. In the meantime when the power consumption calculated by the calculation unit is equal to or greater than the minimum value stored in the internal memory. The selection unit does not execute a storing operation of the calculated power consumption in the internal memory through overwriting. Further when the minimum value is not stored in the internal memory the power consumption calculated by the calculation unit is stored in the internal memory as the minimum value. Thereafter the selection unit selects a combination of drivers for which the minimum value is stored in the internal memory was calculated as the power consumption during execution of the sensing after the power consumption is calculated for all combinations.

In one embodiment the instruction unit instructs the driver included in the combination selected by the selection unit to control an operating device to execute the sensing. As a result the sensing corresponding to a sensing request is executed in the portable terminal device . As described above the application program may request the sensing according to the API such that a source code may be prepared even though a use sequence of the sensors equipped in the portable terminal device is not programmed.

In the meantime the portable terminal device may also be equipped with various functional units that are well known and included in a computer in addition to the functional units illustrated in . For example when the portable terminal device is installed as a tablet terminal or a slate terminal the portable terminal device may also be further equipped with an input device a display device a device capable of displaying and being inputted thereto. Further when the portable terminal device is installed as a mobile communication terminal the portable terminal device may further include functional units such as an antenna a wireless communication unit connecting to wireless communication network and a GPS Global Positioning System receiver.

Next a specific example of a sensing control according to the present embodiment will be described with reference to to . and are diagrams illustrating examples of a configuration of a correspondence relationship table. and are diagrams illustrating examples of a calculation result of power consumption. Among to a case where a BLE sensing is requested is illustrated in and while a case where the BLE sensing and a walk sensing are requested is illustrated in and . In the meantime here as an example descriptions will be made on differences between a sensing control used in the related art and a sensing control according to the present embodiment while contrasting the sensing controls of the present embodiment.

For example it is assumed that a request for the BLE sensing made from the application program is received by a reception unit . In this case for example the correspondence relationship table illustrated in is retrieved by the specification unit . As a result a BLE driver A which controls a BLE chip and a sensor microcomputer driver CD which controls a BLE chip are retrieved as the drivers which manage the sensors capable of executing the BLE sensing. In the present example since only the BLE sensing is requested the BLE driver A and the sensor microcomputer driver CD are derived as one of two combinations of drivers respectively.

Among the two combinations of drivers as for the combination of the BLE driver A the BLE chip is specified from the correspondence relationship table illustrated in as the operating device during the execution of the BLE sensing. Next 3 mA is acquired as the operating power corresponded to the BLE chip by referencing the operating power data illustrated in . Here in the case of the combination of the BLE driver A another operating device does not exist except for the BLE chip . As a result in a case of the combination of the BLE driver A the power consumption during execution of the BLE sensing is calculated as 3 mA as illustrated in .

In the meantime as for the combination of the sensor microcomputer driver CD the BLE chip and the sensor microcomputer are specified from the correspondence relationship table illustrated in as the operating devices during the execution of the BLE sensing as illustrated in . Next 2 mA is acquired as the operating power corresponded to the BLE chip and 4 mA is acquired as the operating power corresponded to the sensor microcomputer by referencing the operating power data illustrated in . Accordingly in a case of the combination of the sensor microcomputer driver CD the power consumption during execution of the BLE sensing is calculated as 6 mA 2 mA 4 mA as illustrated in .

As described above the power consumption of 3 mA is obtained for the combination of the BLE driver A and the power consumption of 6 mA is obtained for the combination of the sensor microcomputer driver CD. In this case the combination of the BLE driver A having the smaller power consumption is selected. As a result the instruction unit issues an instruction to control the BLE chip and execute the BLE sensing to the BLE driver A.

Accordingly when the BLE sensing was requested it is possible to suppress the instruction to execute the sensing from being issued to the combination of the sensor microcomputer driver CD having the power consumption greater than that of the combination of the BLE driver A by the sensing control according to the present embodiment.

Next it is assumed that a request for BLE sensing and walk sensing made from the application program is received by a reception unit . In this case for example the correspondence relationship table illustrated in is retrieved by the specification unit . As a result the BLE driver A which controls the BLE chip and the sensor microcomputer driver CD which controls the BLE chip are retrieved as the drivers which manage the sensors capable of executing the BLE sensing. This is similar to 1 BLE Sensing described above. Further the walk sensor driver B which controls the walk sensor and the sensor microcomputer driver CD which controls the walk sensor are retrieved as the drivers which manage the sensors capable of executing the walk sensing.

From the retrieved drivers as for the combinations of the drivers that implement the BLE sensing and the walk sensing the following A B C and D combinations of drivers may be derived.

Among the combinations of A to D as for the A combination of the drivers the BLE chip is specified from the correspondence relationship table illustrated in as the operating device during the execution of the BLE sensing and the walk sensor and the CPU are specified from the correspondence relationship table illustrated in as the operating devices during the execution of the walk sensing. Next 3 mA is acquired as the operating power of the BLE chip and 1 mA is acquired as the operating power of the walk sensor by referencing the operating power data illustrated in . Accordingly in a case of A combination of the drivers the power consumption during the execution of the BLE sensing and the walk sensing is calculated as 24 mA 1 mA 3 mA 20 mA as illustrated in .

Further as for the B combination of the drivers the BLE chip and the sensor microcomputer are specified from the correspondence relationship table illustrated in as the operating devices during the execution of the BLE sensing and the walk sensor and the CPU are specified from the correspondence relationship table illustrated in as the operating devices during execution of the walk sensing. Next 2 mA is acquired as the operating power of the BLE chip 4 mA is acquired as the operating power of the sensor microcomputer and 1 mA is acquired as the operating power of the walk sensor and 20 mA is acquired as the operating power of the CPU by referencing the operating power data illustrated in . Accordingly in a case of the B combination of the drivers the power consumption during execution of the BLE sensing and the walk sensing is calculated as 27 mA 2 mA 4 mA 1 mA 20 mA as illustrated in .

Further as for the C combination of the drivers the BLE chip is specified from the correspondence relationship table illustrated in as the operating device during the execution of the BLE sensing and the walk sensor and the sensor microcomputer are specified from the correspondence relationship table illustrated in as the operating devices during execution of the walk sensing. Next 3 mA is acquired as the operating power of the BLE chip 1 mA is acquired as the operating power of the walk sensor and 4 mA is acquired as the operating power of the sensor microcomputer by referencing the operating power data illustrated in . Accordingly in a case of the C combination of the drivers the power consumption during execution of the BLE sensing and the walk sensing is calculated as 8 mA 3 mA 1 mA 4 mA as illustrated in .

Further as for the D combination of the drivers the BLE chip and the sensor microcomputer are specified from the correspondence relationship table illustrated in as the operating devices during the execution of the BLE sensing and the walk sensor and the sensor microcomputer are specified from the correspondence relationship table illustrated in as the operating devices during execution of the walk sensing. Here in a case of the D combination of the drivers the sensor microcomputer is redundantly specified as the operating device during the execution of both the BLE sensing and the walk sensing. As described above when the operating device is redundantly specified the operating device is specified by deleting one of the BLE sensing and the walk sensing. Next 2 mA is acquired as the operating power of the BLE chip 1 mA is acquired as the operating power of the walk sensor and 4 mA is acquired as the operating power of the sensor microcomputer by referencing the operating power data illustrated in . Accordingly in a case of the D combination of the drivers the power consumption during the execution of the BLE sensing and the walk sensing is calculated as 7 mA 2 mA 1 mA 4 mA as illustrated in .

As described above the power consumption of 24 mA is obtained for the A combination of the drivers the power consumption of 27 mA is obtained for the B combination of the drivers the power consumption of 8 mA is obtained for the C combination of the drivers and the power consumption of 7 mA is obtained for the D combination of the drivers. In this case the D combination of the drivers having the minimum power consumption is selected. As a result the instruction unit issues an instruction to control the BLE chip the walk sensor and the sensor microcomputer and execute the BLE sensing and the walk sensing to the sensor microcomputer driver CD.

Accordingly by the sensing control according to the present embodiment even when the BLE sensing and the walk sensing are requested it is possible to suppress the instruction to execute the sensing from being issued to the A B and C combinations of the drivers each of which has the power consumption greater than that of the D combination of the drivers.

In the meantime as an example of the related art it is assumed that a platform performs various manipulations on a media file or stream. In the platform for example in a case where a plurality of modules to decode the media file exists a module to be used for decoding is selected according to a priority which is set for each module.

Here in a case where the related art is applied to the selection of the operating device for example regarding the BLE sensing a priority for execution is set for the BLE chip and the BLE chip so as to determine which one of the BLE chip and the BLE chip is to be selected for a preferential use. In this manner when the priority for execution to select one of the devices for the preferential use is set a power saving may not be achieved depending on the content of the sensing requested from the application program.

For example when it is assumed that the BLE chip is prioritized to be selected for the preferential use the A combination of the drivers or the C combination of the drivers is selected in a case where the BLE sensing and the walk sensing are requested. Accordingly the D combination of drivers which may be selected in the sensing control according to the present embodiment is not able to be selected in the sensing control according to the related art and thus the power saving is not achieved. In the meantime even when it is assumed that the BLE chip is prioritized to be selected for the preferential use the combination of the sensor microcomputer driver CD which controls the BLE chip is selected in a case where only the BLE sensing is requested. Accordingly the combination of the BLE driver A which may be selected in the sensing control according to the present embodiment is not able to be selected in the sensing control according to the related art and the power saving is not achieved.

In the meantime even when the sensing requested from the application program is either only the BLE sensing or both the BLE sensing and walk sensing the power saving for the sensing may be achieved. As described above by the sensing control according to the present embodiment since the power saving for the sensing may be achieved without depending on the content of the sensing requested from the application program an effect of power saving by the sensing control according to the present embodiment is greater than that by the sensing control according to the related art.

Next descriptions will be made on a flow of a process executed by the portable terminal device according to the present embodiment. is a flowchart illustrating a procedural sequence of sensing control according to First Embodiment. The process of the sensing control executed by the portable terminal device is executed when an instruction to execute a sensing is received from the application program.

As illustrated in the specification unit derives the combinations of drivers that implement the sensing for which a sensing request is received from the application program Operation S .

Next the specification unit selects one combination of drivers among the combinations of drivers derived at Operation S Operation S . Also the specification unit specifies a device to be operated during the execution of the sensing from the combination of drivers selected at Operation S Operation S .

Thereafter the calculation unit calculates a power consumed for the sensing by each device specified at Operation S by referencing the operating power data stored in the storage unit Operation S .

Here the selection unit compares the power consumption calculated at Operation S with the minimum value of the power consumption stored in the internal memory Operation S . In this case when the power consumption calculated at Operation S is smaller than the minimum value of the power consumption stored in the internal memory YES at Operation S the selection unit overwrites the minimum value in the internal memory with the power consumption calculated at Operation S to store the calculated power consumption in the internal memory Operation S . In the meantime when the power consumption calculated at Operation S is equal to or greater than the minimum value stored in the internal memory NO at Operation S storing the calculated power consumption in the internal memory through overwriting is not executed and the process proceeds to Operation S.

Also the processings of Operation S to Operation S are repeatedly executed until the comparisons of the power consumption with the minimum value for all combinations of the drivers are executed NO at Operation S .

Thereafter when the comparisons of the power consumption with the minimum value for all combinations of drivers are executed YES at Operation S the combination of drivers for which the minimum value stored in the internal memory is calculated as the power consumption during execution of the sensing is selected Operation S . Thereafter the instruction unit issues an instruction to control the operating device and execute the sensing to the driver included in the combination drivers selected at Operation S Operation S and ends the process.

In the meantime even though the processings of Operation S to Operation S are repeatedly executed in the flowchart illustrated in the processings of Operation S to Operation S may be executed in parallel and then the combination of drivers having the smallest power consumption may be selected.

As having been described above the portable terminal device according to the present embodiment calculates the power consumption of the device to be operated during the execution of the sensing for each of various combinations of sensors capable of implementing the same sensing and selects the combination in which the minimum power is consumed by the device. Accordingly it is possible to suppress the power consumption for the sensing by the portable terminal device according to the present embodiment.

In the meantime a case where the sensing request is received from a single application program is exemplified in First Embodiment but the sensing request may be received from a plurality of application programs.

Accordingly in the present embodiment a case where the sensing requests are received from a plurality of application programs will be described by way of an example.

The application execution unit and the application execution unit are the processing units that execute various application programs similarly to the application execution unit illustrated in . A plurality of application programs are executed in parallel by a multitasking in each of the application execution unit and the application execution unit . Hereinafter the application execution unit and the application execution unit may be collectively referred to as an application execution unit . In the meantime even though two application execution units are exemplified in three or more application programs may be executed in parallel and the number of application execution units is increased or decreased depending on the number of application programs.

The reception unit receives various instructions from the application program such that an instruction to stop the sensing is also received in addition to an instruction to execute the sensing in First Embodiment similarly to the reception unit illustrated in .

In one embodiment when the instruction to stop the sensing or the instruction to execute the sensing is received from the application program executed by the application execution unit the reception unit updates a request data stored in the storage unit . A table in which the sensing being requested by the application operated in the portable terminal device are listed may be employed in the request data . For example when the instruction to execute a sensing is received the reception unit adds the sensing for which the instruction to execute is received to the request data to be registered. Further when the instruction to stop the sensing is received the reception unit deletes the sensing for which the instruction to stop is received from the request data

The specification unit specifies the operating device similarly to the specification unit illustrated in but different from the specification unit in that an operating device for each combination of drivers is specified according to the request data each time when the request data stored in the storage unit is updated.

Next a specific example of the sensing control according to the present embodiment will be described with reference to . is a diagram illustrating an example of a transition of the request data . The request data at time t0 time t1 and time t2 are illustrated in . In the meantime it is assumed that the relationship between t0 t1 and t2 is t0

As illustrated in a state where a walk sensing is requested from an application program X at time t0 transits to a state where a BLE sensing is requested from an application program Y at time t1. In this case a sensing control is executed to select a combination of drivers in which the minimum power is consumed by the operating device among the combinations of drivers that implement the BLE sensing and the walk sensing. The process and the result of the sensing control become the same as those of a specific example 2 of First Embodiment. That is the D combination of drivers having the minimum power consumption is selected after the A to D combinations of drivers are derived.

Thereafter the state transits to a state where the instruction to stop the walk sensing is received from the application program X at time t2. In this case a sensing control is executed to select a combination of drivers in which the minimum power is consumed by the operating device among the combinations of the drivers that implement the BLE sensing. The process and the result of the sensing control become the same as those of a specific example 1 of First Embodiment. That is a combination of the BLE driver A having the minimum power consumption is selected after the combination of the BLE driver A and the combination of the sensor microcomputer driver CD are derived. Consequently the sensing control requests the sensor microcomputer driver CD to stop sensing and requests the BLE driver A to start sensing.

As described above the sensing control according to the present embodiment reselects the combination of the drivers in accordance with the change in the contents of the sensing requested from the application program. That is when the instructions to execute the sensing are being issued by a plurality of application programs even when the instruction to execute the sensing is being issued by a single application program or even when the instructions to execute the sensing are being issued by some of the application programs the combination of drivers having the minimum power consumption may be selected. As a result in the sensing control according to the present embodiment for example the power consumption may be suppressed even in a case where a plurality of application programs runs on the portable terminal device .

Next descriptions will be made on a flow of a process of the portable terminal device according to the present embodiment. Here descriptions on 1 a first sensing control executed by the portable terminal device will be made first and then descriptions on 2 a second sensing control will be made.

As illustrated in when the instruction to execute a sensing is received from the application program Operation S the reception unit adds the sensing for which the instruction to execute is received at Operation S to the request data to be registered Operation S .

Next the specification unit derives the combinations of drivers according to the request data in which the instruction to execute has been added and registered at Operation S Operation S .

Next the specification unit selects one combination of drivers among the combinations of drivers derived at Operation S Operation S . Also the specification unit specifies a device to be operated during the execution of the sensing from the combination of drivers selected at Operation S Operation S .

Thereafter the calculation unit calculates a power consumed for the sensing by each device specified at Operation S by referencing the operating power data stored in the storage unit Operation S .

Here the selection unit compares the power consumption calculated at Operation S with the minimum value of the power consumption stored in the internal memory Operation S . In this case when the power consumption calculated at Operation S is smaller than the minimum value of the power consumption stored in the internal memory YES at Operation S the selection unit overwrites the minimum value in the internal memory with the power consumption calculated at Operation S to store the calculated power consumption in the internal memory Operation S . In the meantime when the power consumption calculated at Operation S is equal to or greater than the minimum value stored in the internal memory NO at Operation S storing the calculated power consumption in the internal memory through overwriting is not executed and the process proceeds to Operation S.

Also the processings of Operation S to Operation S are repeatedly executed until the comparisons of the power consumption with the minimum value for all combinations of the drivers are executed NO at Operation S .

Thereafter when the comparisons of the power consumption with the minimum value for all combinations of the drivers are executed YES at Operation S the selection unit selects the combination of drivers for which the minimum value stored in the internal memory was calculated as the power consumption during execution of the sensing Operation S . Thereafter the instruction unit issues an instruction to control the operating device and execute the sensing to the driver included in the combination of drivers selected at Operation S Operation S and ends the process.

As illustrated in when the instruction to stop the sensing is received from the application program Operation S the reception unit deletes the sensing for which the instruction to stop is received at Operation S from the request data Operation S .

Next the specification unit derives the combinations of drivers according to the request data in which the instruction to stop has been deleted at Operation S Operation S .

Next the specification unit selects one combination of drivers among the combinations of drivers derived at Operation S Operation S . Also the specification unit specifies a device to be operated during the execution of the sensing from the combination of drivers selected at Operation S Operation S .

Thereafter the calculation unit calculates a power consumed for the sensing by each device specified at Operation S by referencing the operating power data stored in the storage unit Operation S .

Here the selection unit compares the power consumption calculated at Operation S with the minimum value of the power consumption stored in the internal memory Operation S . In this case when the power consumption calculated at Operation S is smaller than the minimum value of the power consumption stored in the internal memory YES at Operation S the selection unit overwrites the minimum value in the internal memory with the power consumption calculated at Operation S to store the calculated power consumption in the internal memory Operation S . In the meantime when the power consumption calculated at Operation S is equal to or greater than the minimum value stored in the internal memory NO at Operation S storing the calculated power consumption in the internal memory through overwriting is not executed and the process proceeds to Operation S.

Also the processings of Operation S to Operation S are repeatedly executed until the comparisons of the power consumption with the minimum value for all combinations of drivers are executed NO at Operation S .

Thereafter when the comparisons of the power consumption with the minimum value for all combinations of drivers are executed YES at Operation S the selection unit selects the combination of drivers for which the minimum value stored in the internal memory was calculated as the power consumption during the execution of the sensing Operation S .

Thereafter the instruction unit issues an instruction to control the operating device and execute the sensing to the driver included in the combination of drivers selected at Operation S Operation S and an instruction to control the operating device and stop the sensing to the driver not included in the combination of drivers selected at Operation S Operation S and ends the process.

In the meantime even though it is exemplified in the flowchart illustrated in that the processing of Operation S is executed after the processing of Operation S is executed Operation S and Operation S may be executed by changing the processing sequence between each other or in parallel.

As having been described above the portable terminal device according to the present embodiment calculates the power consumption of the device to be operated during the execution of the sensing for each of various combinations of sensors capable of implementing the same sensing and selects the combination in which the minimum power is consumed by the operating device similarly to the portable terminal device according to First Embodiment. Accordingly it is possible to suppress the power consumption for the sensing by the portable terminal device according to the present embodiment.

Further the portable terminal device according to the present embodiment reselects the combination of drivers in accordance with the change in the contents of sensing requested from the application program. Therefore in the portable terminal device according to the present embodiment for example the power consumed for the sensing may be suppressed even in a case where a plurality of application programs runs on the portable terminal device .

In the meantime in First Embodiment a case exemplified where the combination of drivers is reselected each time when the request data is updated but the combination of drivers needs not necessarily be re selected. Accordingly in the present embodiment descriptions will be made on a case where the combination of drivers is selected by adding the combination of drivers for the sensing which is requested when a request for sensing is added as an example.

The specification unit is a processing unit that specifies the operating device similarly to the specification unit illustrated in but the processing contents to be executed by the specification unit when a sensing request corresponding to the instruction to execute issued from the application program is added to the request data stored in the storage unit are different from the specification unit

In one embodiment when the request for the sensing is added to the request data the specification unit specifies the request added before and after the request data is updated. In the following the request added before and after the request data is updated may be described as an added request and the sensing which is additionally executed according to the added request may be described as an added sensing . Thereafter the specification unit derives the combination of drivers implementing the sensing for the added request. In the following the combination of drivers that implements the sensing for the added request may be described as added combination of drivers from the viewpoint of differentiating from the combinations of drivers that implement the sensing for all the requests. Thereafter the specification unit selects one of the added combinations of drivers. Next the specification unit specifies a device to be operated during the execution of an added sensing request from the added combinations of drivers selected previously. In the following the device to be operated during the execution of the added sensing request may be described as an added operating device . In the meantime deriving of the added combination of drivers or specifying of the operating device may also be executed in the same manner as in the inquiry and retrieval described above.

The calculation unit calculates the power consumed for sensing by the operating device for each combination similarly to the calculation unit illustrated in but the calculation unit is different from the calculation unit in that only an increment portion in the power consumed by the added operating device is calculated in the calculation unit instead of calculating the power consumption of all the operating devices as in the calculation unit

In one embodiment the calculation unit calculates the increment portion of the power consumption by the added operating devices by obtaining a total of the operating powers of all the added operating devices but an operating power of an operating device which has been being operated before the added request is received is not added to or deleted from the total of the operating powers. For example the calculation unit subtracts the operating power associated with the same operating device as the added operating device among the operating devices included in operation state data stored in the storage unit from the total of the operating powers of all the added operating devices. Data in which a device under the control of the portable terminal device is in association with an operation state indicating whether the device is being operated or not may be employed in the operation state data as an example. Accordingly the power consumption increment by each operating device is calculated for each added combination of drivers.

The selection unit selects the combination in which the minimum power is consumed during the execution of the sensing similarly to the selection unit illustrated in but the selection unit is different from the selection unit in that only a combination having the minimum power consumption increment during the execution of the added sensing is selected by the selection unit

In one embodiment each time when an increment in power consumption is calculated by the calculation unit the selection unit references the internal memory in which the minimum increment value of power consumption among the power consumption increments calculated up until now is stored to compare the calculated power consumption increment with the minimum increment value of power consumption in magnitude. In this case when the power consumption increment calculated by the calculation unit is smaller than the minimum increment value stored in the internal memory the selection unit overwrites the minimum increment value with the power consumption increment calculated by the calculation unit to store the calculated power consumption increment in the internal memory. In the meantime when the power consumption increment calculated by the calculation unit is equal to or greater than the minimum increment value stored in the internal memory storing the calculated power consumption increment in the internal memory through overwriting is not executed. Further when the minimum increment value is not stored in the internal memory the power consumption increment calculated by the calculation unit is stored in the internal memory as the minimum increment value as it is. Thereafter after the power consumption increment is calculated for all combinations the selection unit selects an added combination of drivers for which the minimum increment value stored in the internal memory was calculated as the power consumption increment during the execution of the sensing.

Next a specific example of a sensing control according to the present embodiment will be described with reference to to . and are diagrams illustrating an example of transitions of the operation state data . and are diagrams illustrating another example of calculation results of the power consumption increments. Among to an example of a case where a BLE sensing is additionally requested while a walk sensing is being requested is illustrated in and and an example of a case where the walk sensing is additionally requested while the BLE sensing is being requested is illustrated in and .

For example it is assumed that a request added at time t0 is the BLE sensing. In this case the combination of the BLE driver A and the combination of the sensor microcomputer driver CD are derived according to the correspondence relationship table illustrated in as the added combinations of drivers similarly to the specific example 1 of First Embodiment.

Among the combinations of the BLE driver A and the sensor microcomputer driver CD the BLE chip is specified according to the correspondence relationship table illustrated in as an added operating device for the combination of the BLE driver A. Next 3 mA is acquired as the operating power associated with the BLE chip by referencing the operating power data illustrated in . Here a reference symbol x is set for the BLE chip corresponding to the added operating device as an operation state among the operation state data at time t0 illustrated in . Therefore since the BLE chip does not overlap with the operating device before the BLE chip is added the operating power of the BLE chip is not cancelled and summed as the power consumption increment by the added operating device as it is. As a result in a case of the combination of the BLE driver A the power consumption increment during the execution of the added sensing is calculated as 3 mA as illustrated in .

Further the BLE chip and the sensor microcomputer are specified according to the correspondence relationship table illustrated in as the added operating devices for the combination of the sensor microcomputer driver CD. Next 2 mA is acquired as the operating power of the BLE chip and 4 mA is acquired as the operating power of the sensor microcomputer by referencing the operating power data illustrated in . Here the BLE chip and the sensor microcomputer corresponding to the added operating devices are retrieved from the operation state data at time t0 illustrated in . Among the operating states of the retrieved operating devices x is set for the operation state of the BLE chip but o is set for the operation state of the sensor microcomputer due to the walk sensing being requested. Therefore the operating power of the sensor microcomputer is subtracted from the total of the operating powers of the BLE chip and the sensor microcomputer . As a result in a case of the combination of the sensor microcomputer driver CD the power consumption increment during the execution of the added sensing is calculated as 2 mA 2 mA 4 mA 4 mA .

As described above the power consumption increment of 3 mA is obtained for the combination of the BLE driver A and the power consumption increment of 2 mA is obtained for the combination of the sensor microcomputer driver CD. In this case the combination of the sensor microcomputer driver CD having the smaller power consumption increment is selected. As a result the instruction unit issues an instruction to control the BLE chip and the sensor microcomputer and execute the BLE sensing to the sensor microcomputer driver CD. Accordingly the operating states of the BLE chip and the sensor microcomputer are updated with the reference symbol of o similarly as in the operation state data at time t1 illustrated in .

For example it is assumed that a request added at time t0 is the BLE sensing. In this case the combination of the walk sensor driver B and the combination of the sensor microcomputer driver CD are derived according to the correspondence relationship table illustrated in as the added combinations of the drivers similarly to the specific example 2 of First Embodiment.

Among the combinations of the walk sensor driver B and the sensor microcomputer driver CD the walk sensor and the CPU are specified according to the correspondence relationship table illustrated in as the added operating devices for the combination of the walk sensor driver B. Next 1 mA is acquired as the operating power of the walk sensor and 20 mA is acquired as the operating power of the CPU by referencing the operating power data illustrated in . Here the reference symbol of x is set for the walk sensor and the CPU corresponding to the added operating devices as the operation state among the operation state data at time t0 illustrated in . Therefore since the walk sensor and the CPU do not overlap with the operating devices before the walk sensor and the CPU are added the total of the operating powers of the walk sensor and the CPU are not cancelled and summed as the power consumption increments by the added operating devices as they are. As a result in a case of the combination of the walk sensor driver B the power consumption increment during the execution of the added sensing is calculated as 21 mA as illustrated in .

Further the walk sensor and the sensor microcomputer are specified according to the correspondence relationship table illustrated in as the added operating devices for the combination of the sensor microcomputer driver CD. Next 1 mA is acquired as the operating power of the walk sensor and 4 mA is acquired as the operating power of the sensor microcomputer by referencing the operating power data illustrated in . Here the walk sensor and the sensor microcomputer corresponding to the added operating devices are retrieved from the operation state data at time t0 illustrated in . In the meantime the reference symbol of x is set for both the walk sensor and the sensor microcomputer as the operation state. Therefore since the walk sensor and the sensor microcomputer do not overlap with the operating devices before the walk sensor and the sensor microcomputer are added the total of the operating powers of the walk sensor and the sensor microcomputer are not cancelled and summed as the power consumption increments by the added operating devices as they are. As a result in a case of the combination of the sensor microcomputer driver CD the power consumption increment during the execution of the added sensing is calculated as 5 mA as illustrated in .

As described above the power consumption increment of 21 mA is obtained for the combination of the walk sensor driver B and the power consumption increment of 5 mA is obtained for the combination of the sensor microcomputer driver CD. In this case the combination of the sensor microcomputer driver CD having the smaller power consumption increment is selected. As a result the instruction unit issues an instruction to control the walk sensor and the sensor microcomputer and execute the walk sensing to the sensor microcomputer driver CD. Accordingly the operating states of the walk sensor and the sensor microcomputer are updated with the reference symbol of o similarly as in the operation state data at time t1 illustrated in .

In the sensing control according to the present embodiment as in the specific examples 1 and 2 the combination of added drivers having the minimum power consumption increment among the added combinations of the drivers is selected while allowing the device continuously being operated at the time of receiving the added request. Therefore by the sensing control according to the present embodiment for example it is possible to suppress the operation of the portable terminal device from being unstabilized due to a frequent change of the operating device caused by reception of the added request.

As illustrated in when the instruction to execute sensing is received from the application program Operation S the reception unit adds the sensing for which the instruction to execute is received at Operation S to the request data to be registered Operation S .

Next the specification unit specifies the request added before and after an update of the request data at Operation S Operation S . Thereafter the specification unit derives the added combinations of drivers that implement the sensing operation for the added request specified at Operation S Operation S .

Thereafter the calculation unit reads the operation state data stored in the storage unit Operation S and the specification unit selects one added combination of the drivers among the added combinations of the drivers derived at Operation S Operation S . Next the specification unit specifies a device to be operated during the execution of the sensing for the added request from the combination of the drivers selected at Operation S Operation S .

Also the calculation unit calculates the power consumption increment by the added operating device by referencing the operation state data read at Operation S Operation S .

Here the selection unit compares the power consumption increment calculated at Operation S with the minimum increment value of the power consumption stored in the internal memory Operation S . In this case when the power consumption increment calculated at Operation S is smaller than the minimum increment value of the power consumption stored in the internal memory YES at Operation S the selection unit overwrites the minimum increment value in the internal memory with the power consumption increment calculated at Operation S to store the calculated power consumption increment in the internal memory Operation S . In the meantime when the power consumption increment calculated at Operation S is equal to or greater than the minimum increment value stored in the internal memory NO at Operation S storing the calculated power consumption increment in the internal memory through overwriting is not executed and the process proceeds to Operation S.

Also the processings of Operation S to Operation S are repeatedly executed until the comparing operations of the power consumption increment with the minimum increment value for all combinations of the drivers are executed NO at Operation S .

Thereafter when the comparing operations of the power consumption increment with the minimum increment value for all combinations of the drivers are executed YES at Operation S the selection unit selects the added combination of the drivers for which the minimum increment value stored in the internal memory was calculated as the power consumption increment during the execution of the added sensing Operation S . Also the selection unit updates the operation state of the added operating device corresponding to the added combination of the drivers selected at Operation S among the operation state data during the operation Operation S .

Further the instruction unit issues an instruction to control the operating device and execute the sensing to the added driver included in the added combination of drivers selected at Operation S Operation S and ends the process.

As having been described above the portable terminal device according to the present embodiment calculates the power consumption of the device to be operated during the execution of the sensing for each of various combinations of sensors capable of implementing the same sensing and selects the combination of devices in which the minimum power is consumed by the operating device similarly to the portable terminal device according to First Embodiment. Accordingly it is possible to suppress the power consumption of the sensing operation conducted by the portable terminal device according to the present embodiment.

Further the portable terminal device according to the present embodiment selects the combination of drivers having the minimum power consumption increment among the added combinations of drivers while allowing the device continuously being operated at the time of receiving the added request. Therefore for example the portable terminal device according to the present embodiment is able to suppress the operation of the portable terminal device from being unstabilized due to a frequent change of the operating device caused by the reception of added requests.

In the meantime embodiments of the apparatus according to the present disclosure has been described but the present disclosure may be implemented by various embodiments other than the embodiments described above. Accordingly in the following other embodiments included in the present disclosure will be described.

In First Embodiment to Third Embodiment described above the cases have been described where the portable terminal devices and use the sensor having been installed therein at the time of the product shipment but a sensor installed in an external apparatus for sensing may equally be used as well. For example a wearable gadget such as a smart watch equipped with a pedometer or a blood pressure meter or a ring gadget equipped with an acceleration sensor may be connected with the portable terminal devices and via wired or wirelessly such that the wearable gadget may be controlled by the portable terminal devices and . In this case when the portable terminal device is allowed to perform the same processes as those of and each time when connection or disconnection of a wearable device such as the wearable gadget is detected the portable terminal device may be allowed to perform the same process as that of .

In First Embodiment to Third Embodiment described above a case where the combination of the drivers is selected based on the power consumption but other item for example an operation time may also be added to a criteria for selection. For example it is assumed that a battery of a main body of the portable terminal device and a battery of a gadget connected with the portable terminal device exist. In this case the portable terminal device calculates a total power consumption of the device operated by a battery for each battery using a power source data in which a device and the battery used as a power source of the device are associated with each other. Also the portable terminal device calculates an operation time from the total of the power consumption of each battery for each combination of the drivers using the data of the battery remaining power in which the remaining power of the battery is associated with each battery. Next the portable terminal device calculates an evaluation value from the power consumption and the operation time for each combination of the drivers. Thereafter the portable terminal device selects the combination of the drivers having the best evaluation value. In the meantime the portable terminal device may select the combination of drivers having the minimum power consumption among the combinations of drivers of which an operation time is equal to or greater than a predetermined period of time without having to calculate the evaluation value. In the meantime the portable terminal device may ignore the power consumption and select the combination of drivers having the longest operation time.

Further various processes described in the embodiments may be implemented by executing a prepared program by a computer such as a personal computer or a workstation. Accordingly in the following descriptions will be made on an example of the computer which executes the sensing control program equipped with the same function as the embodiments described above with reference to .

In the HDD as illustrated in a sensing control program which implements the same functions as the middleware execution units described in First Embodiment to Third Embodiment is stored in advance. In the sensing control program respective functions may be appropriately integrated or separated similarly to respective constitutional elements of respective functional units illustrated in or . That is all of the data to be stored in the HDD need not necessarily be stored in the HDD and only the data used for the process needs to be stored in the HDD .

Also the CPU reads the sensing control program from the HDD to be deployed in the RAM . Accordingly the sensing control program functions as a sensing control process as illustrated in . The sensing control process deploys various data read from the HDD in an area allocated for the sensing control process on the RAM and executes various processes based on the deployed various data. In the meantime the sensing control process includes the processings executed in the functional units illustrated in or for example the processes illustrated in or . Further all the processing units virtually implemented in the CPU need not necessarily be operated on the CPU and only the processing unit used for the process needs to be virtually implemented.

In the meantime the sensing control program needs not necessarily be stored in the HDD or the ROM from the beginning. For example each program may be stored in a portable physical medium such as for example a flexible disk what is called FD a CD ROM a DVD disk an opto magnetic disk or an IC card to be inserted in the computer . Also the computer may acquire each program from the portable physical medium to be executed. Further each program is stored in other computer or a server apparatus connected to the computer through for example a public network the Internet the LAN the WAN and then the computer may acquire each program from the other computer or the server apparatus to be executed.

All examples and conditional language recited herein are intended for pedagogical purposes to aid the reader in understanding the invention and the concepts contributed by the inventor to furthering the art and are to be construed as being without limitation to such specifically recited examples and conditions nor does the organization of such examples in the specification relate to a illustrating of the superiority and inferiority of the invention. Although the embodiments of the present invention have been described in detail it should be understood that the various changes substitutions and alterations could be made hereto without departing from the spirit and scope of the invention.

