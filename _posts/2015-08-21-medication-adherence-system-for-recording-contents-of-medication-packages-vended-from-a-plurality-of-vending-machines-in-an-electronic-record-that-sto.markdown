---

title: Medication adherence system for recording contents of medication packages vended from a plurality of vending machines in an electronic record that stores records for a plurality of patients associated with respective vending machines
abstract: A medication adherence system is provided for recording contents of medication packages vended from a plurality of vending machines in electronic records, such as an electronic medication administration record (eMAR), that store records for a plurality of patients who are associated with respective vending machines. A vending event causes the electronic record to be populated.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09477817&OS=09477817&RS=09477817
owner: Medherent, LLC
number: 09477817
owner_city: Annapolis
owner_country: US
publication_date: 20150821
---
This application is a continuation of U.S. application Ser. No. 13 847 710 filed Mar. 20 2013 which is incorporated by reference herein.

This application claims the benefit of U.S. Provisional Patent Application No. 61 613 648 filed Mar. 21 2012 and U.S. Provisional Patent Application No. 61 794 777 filed Mar. 15 2013 the entire disclosures of which are both incorporated by reference herein.

Portions of the documentation in this patent document contain material that is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document or the patent disclosure as it appears in the Patent and Trademark Office file or records but otherwise reserves all copyright rights whatsoever.

Current medication dispensing devices such as the devices described in U.S. Pat. No. 7 963 201 Willoughby et al. address many of the issues associated with medication adherence or medication compliance which refers to the act of taking medications in a prescribed dosage during a prescribed window of time at prescribed intervals. However current devices still do not address many needs of the industry particularly with respect to patient privacy issues. The present invention addresses this need.

An automated method is provided for recording contents of medication packages vended from a plurality of vending machines in electronic records such as an electronic medication administration record eMAR that store records for a plurality of patients who are associated with respective vending machines. A vending event causes the electronic record to be populated. The contents of the medication packages vended from the vending machines are recorded in electronic records without communicating patient names or vended medications in the electronic message sent from the vending machines.

Certain terminology is used herein for convenience only and is not to be taken as a limitation on the present invention. For the purposes of explaining the present invention specific embodiments will be described. These embodiments are exemplary only and are not intended to limit the scope of the invention.

This patent application includes an Appendix having a file named appendix688372 1U3.txt created on Aug. 7 2015 and having a size of 17 879 bytes. The Appendix is incorporated by reference into the present patent application. One preferred embodiment of the present invention is implemented via the source code in the Appendix. The Appendix is subject to the Copyright Notice and Authorization stated above.

The present invention may be used to track the ingestion administering vending of single medicine packages or Multi Unit Dose Packages or Multi Unit Drug Packages MUDPs . An MUDP contains one dosage of medicines that are prescribed for a specific treatment regimen. That is there are a plurality of different medicines in an MUDP and there may be one or pills of each medicine to obtain the desired dosage. All of the different medications in an MUDP packet are meant to be taken at the same time. MUDPs are typically created using specialized robotic machinery. However the scope of the present invention includes MUDPs that are manually packaged in simple plastic packets or the like.

An MUDP typically includes a label that describes its contents or it may include human or machine readable indicia e.g. an ID number that functions as a pointer in a database memory that stores its contents. The label may also include patient identifying information. The machine readable indicia may be a bar code or QR code that identifies the patient date and medication. The examples described below relate to MUDPs but the scope of the present invention includes single medicines or packages that include only one medicine type per package.

1. A network of portable medication vending devices PMVDs for use by individual patients in a home environment designated as through . In a typical scenario there is one PMVD per patient and thus there will typically be one PMVD per home. The PMVDs may also be used in other environments such as nursing homes or hospitals wherein each resident or patient may have its own PMVD in his or her respective housing unit or hospital room. The word patient is used herein to designate the individual whose medications are present in the PMVD . The word user is used herein to designate an individual who physically interacts with the PMVD . In most instances the patient will be the user but a caregiver may also be a user especially if the patient is unable to operate the PMVD . Each PMVD has a unique IP address. It is well known in the art to assign unique IP addresses to physical devices such as conventional vending machines and any suitable assignment scheme may be used.

2. A host site that includes one or more databases an electronic translation engine and an electronic medication administration record e MAR or eMAR . The one or more databases includes a table that associates the IP address of a PMVD to a specific patient so that any data received from the PMVD will be associated with the correct patient and so that any data that needs to be sent to the patient will be routed to the correct PMVD .

The electronic translation engine has the overall function of receiving vending machine data in a conventional vending machine data format such as DEX data or MDB data described in more detail below and converting the data to a format that can be directly input into the eMAR . The IP address patient identity information in the database is used to identify which patient the eMAR data belongs to so that the appropriate patient record within the eMAR can be updated. More specifically the electronic translation engine includes a first electronic translator and a second electronic translator . The first electronic translator performs a conversion of the DEX data or MDB data into HL7 data. HL7 is an abbreviation of Health Level Seven which is a standard for exchanging information between medical applications. HL7 defines a format for the transmission of health related information. The second electronic translator converts the HL7 data into eMAR data. There is no standard eMAR format and it varies from system to system. However a typical eMAR will include patient ID information e.g. name medical record number and medication details drug name dosage strength frequency to be taken date time that each medication was taken .

In an alternative embodiment there is only one electronic translator which directly converts the DEX data or MDB data into eMAR data. However the two step conversion process has enhanced versatility because the HL7 data may be used for many other purposes such as for communications with other healthcare systems that may need to know about patient medication events. Also electronic translators for converting HL7 data into eMAR data are well known in the prior art. Thus the software for the overall conversion process may be simplified by performing the MDB DEX to HL7 conversion by the first electronic translator and then adding a conventional second electronic translator to the output of the first electronic translator .

In one preferred embodiment the eMAR includes data fields for patient ID date schedule of prompts and vended medications. The date field is shown in simplified form in . The actual eMAR includes more granular date information. The schedule of prompts field stores dates times that a prompting signal should be sent to the patient s PMVD to prompt the patient that it is time to take medication. The vended medications field stores dates times that a signal is received from a PMVD indicating that a vending event occurred. The vended medications field is also shown in simplified form in . The actual eMAR includes more granular vended medications data including exactly which medications were taken at the date time that a signal is received from a PMVD indicating that a vending event occurred as will be discussed in more detail below.

The patient ID field preferably includes the patient s medical record number either as the entire field or part of the field. If the patient s medical record number is not contained within the patient ID field another database table will need to be maintained by the host site so that the eMAR can be properly populated.

A conventional paper based medication administration record MAR functions as a recording of the medications taken by a patient typically during the patient s stay in a health care facility. A health care professional typically signs or initials the MAR upon witnessing or administering the medication. In an eMAR the signature or initials are electronically recorded but the concept is the same as a paper based MAR. These types of MARs have a field for recording dispensed medications. 

In the present invention a dispensed medications field is optional. However the eMAR needs to include a vended medications field. As discussed in more detail below there are two steps involved in the medication lifecycle. The first step in the lifecycle is a dispensing step which occurs when a pharmacist or similarly qualified individual fills the PMVD with prescribed medications. This step is conventionally referred to as medication dispensing wherein specific medication s are delivered to a patient in fulfillment of a prescription. Typically the medications are physically handed to the patient but in the present invention the medications are loaded into the PMVD thereby completing the dispensing step. The second step in the lifecycle is a vending step wherein the PMVD releases the previously dispensed medications to the patient. In a conventional vending machine the release of a product from a vending machine is typically referred to as a dispensing event but in the context of the present invention it is referred to as a vending event because the dispensing event occurred when the PMVD was loaded with the medications.

Referring again to a conventional eMAR the step of administering medications to a patient is typically considered to be the dispensing event and is the only event recorded in a conventional eMAR. That is a conventional eMAR typically does not capture the event that occurs when a hospital pharmacy or the like releases patient medications to the health care professional for subsequent delivery to and ingestion by the patient. Of course the pharmacy may capture this event for its own inventory records and for patient billing purposes. Consider for example a typical hospital scenario wherein a hospital based pill dispensing cart is filled at a hospital pharmacy and is then moved from room to room to dispense the medications to the patients the conventional eMAR being populated with data as the patients receive their medications.

The vended medications field in the eMAR thus defines a different paradigm than the conventional field of an eMAR that records dispensed medications. However the dispensed medications field of a conventional eMAR and the vended medications field of eMAR relate to the same patient medication ingestion event i.e. when the patient is presumed to have ingested the medications and what medications are presumed to have been ingested . Accordingly when the first electronic translator receives a signal from a PMVD that a vending event has occurred the outputted HL7 signal corresponds with a medication ingesting event so that the vended medications field of the eMAR can be properly populated.

The eMAR may optionally include a dispensed medications field for recording when a pharmacy dispensed the medications and what medications were dispensed. For example a pharmacy computer may send data HL7 data to the second electronic translator when a prescription is filled or the pharmacy computer may send the data directly to the eMAR in a form that the eMAR can accept. Furthermore the schedule of prompts stored in the eMAR may be set by the pharmacy computer based on the prescription.

The eMAR also includes a field not shown that contains contact information for entities who should be contacted if a medication dose is missed such as a physician caregiver or family member.

The host site also includes a host server host computer for facilitating communications into and out of the host site .

While only one eMAR is shown in there may be a plurality of eMARs each eMAR storing records for different patients. Thus the host server may need to determine which eMAR the incoming vending event data needs to be routed to. Alternatively there may be a single eMAR which in turn populates a replicated set of patient data at a plurality of different remotely located eMARs that store records for different patients.

In an alternative embodiment the eMAR is substituted by an electronic record that provides similar functionality as an eMAR such as an electronic medication chart or electronic drug chart which may be separate from or part of an electronic medical record and which can directly or indirectly via an additional electronic translator accept eMAR data. The eMAR is thus one specific type of the electronic record. If the eMAR is substituted by an electronic record there may be a plurality of such electronic records each electronic record storing records for different patients in the same manner as described above with respect to the multiple eMAR embodiment.

3. An electronic network such as the Internet allows for communications between the PMVDs and the host server .

4. A plurality of caregiver computers designated as through that allow patient caregivers to query the e MAR and receive alerts if any medications are not vended in accordance with the schedule. The caregiver computer may be any conventional computer with a browser based user interface. The user interface is preferably accessed via a cloud based software as a service SAS model so that no special software needs to be present in the caregiver computer to allow for its use. A userid and password is associated with each patient so that the caregiver is given access only to the patient records in the eMAR that match the appropriate patient. The caregiver may be a patient s medical care provider or the caregiver may be a family or friend. Thus as used herein the caregiver includes persons who are monitoring the patient regardless of whether they are actually rendering formal medical care to the patient.

5. A plurality of pharmacy computers designated as through that allow pharmacists to communicate the contents of PMVDs that they fill dispense with medications to the database in the first electronic translator of the host site . The pharmacy computer may be any conventional computer with a browser based user interface. The user interface is preferably accessed via a cloud based software as a service SAS model so that no special software needs to be present in the pharmacy computer to allow for its use.

The PMVD may have a vending mechanism that is similar to snack food type vending machines except in a much smaller form factor. In one well known type of vending machine the goods to be vended are placed in slots or compartments formed from turns of helical coils. The goods rest on a shelf disposed parallel to the helical coil. Each of the helical coils is connected to a motor that upon operation of the push button panel that selects the goods causes rotation of the helical coil about a longitudinal extension axis. This causes the goods to move forward in the turns while resting on the shelf. As the goods reach the final end of the helical coil they are pushed beyond an end edge of the shelf and drop into a lower portion of the machine such as a hopper where the goods can be retrieved. One example of this type of vending machine is shown in U.S. Pat. No. 8 052 010 Borra which is incorporated by reference herein. The helical coils can also be arranged vertically so no shelf would be necessary. In the present invention the goods are MUDPs which are loaded into the PMVD . FIGS. 10 and 11 of U.S. Pat. No. 7 963 201 Willoughby et al. shows a similar idea for dispensing MUDPs using vertically arranged helical coils. U.S. Pat. No. 7 963 201 is incorporated herein in its entirety.

In one example the PMVD may have three vending column or slots one for vending a morning MUDP one for vending a noon MUDP and one for vending an evening MUDP. The PMVD is preferably loaded at a pharmacist who records in a database record for the patient which MUDPs were placed in each of the compartments defined by the vending columns or slots.

The individual slots or compartments formed from turns of helical coils are not to be confused with the vending columns which are also referred to in the vending industry as slots. To avoid confusion the individual slots or compartments are referred to hereafter as compartments. 

The compartments may be physical as in the example of or they may be virtual wherein the compartments are defined by predetermined locations within a column or tray.

Slot 1 COL 1 31 MUDPs each MUDP including 1 pill of medicine A 1 pill of medicine B and 2 pills of medicine C.

Slot 3 COL 3 31 MUDPs each MUDP including 1 pill of medicine A 1 pill of medicine B and 2 pills of medicine C.

When a vending event occurs such as the vending of an MUDP from slot 1 column 1 of the PMVD having IP address ABCDEF the vending event is received by the first electronic translator which accesses database tables and and can determine which patient the vending event relates to and which medicines were vended. In this example if the vending event occurred in the morning the medicines will be 1 pill of medicine A 1 pill of medicine B and 2 pills of medicine C dispensed to patient 1234. This data may then be converted into an HL7 format and subsequently converted into eMAR data for populating the vended medications field of eMAR for patient 1234. In this manner one vending event may result in the recordation of multiple medications having been vended. Thus multiple records may be populated in the eMAR one record for each medicine .

Vending machine data is preferably communicated using a conventional vending machine data format such as DEX data or MDB data. DEX Data Exchange is a format for collecting audit and event data from vending machines. MDB multidrop bus is an internal communication protocol to allow subparts of a vending machine to properly interface with a vending machine controller VMC . FIGS. 9A 9C of U.S. Pat. No. 6 505 095 Kolls illustrate the use of a VMC with MDB and DEX and the corresponding description of these figures explains many of the details for formatting vending machine data for external communication and use. U.S. Pat. No. 6 505 095 Kolls is incorporated herein by reference in its entirety. Furthermore DEX and MDB each have published standards that describe in detail how they function.

For example Chapter 4.7 of a document entitled Data Transfer Standard EVA DTS 6.1 published by the European Vending Association in April 2008 which is part of the DEX standard provides a DEX Data Transfer Example on page 13 that includes at least the following information 

2. All vending activity that occurred since the last interval data reset by column there are five columns in this example designated COL1 through COL 5 

This example shows a typical DEX data transfer between a Data Carrier and Vending Machine Device. The Data Carrier is a device for collecting data from the Vending Machine Device and transmitting the data remotely.

The current standards for MDB is Version 4.0 published April 2009 by National Automatic Merchandising Association NAMA .

Regardless of which machine data format is used the outgoing messages will include at least 1 the IP address of the PMVD the slot column of the vending event and 3 the time of vending.

As discussed above HL7 defines a format for the transmission of health related information. HL7 has published standards and HL7 3 is the current standard. Additional information regarding HL7 is available at http www.hl7.org .

HL7 communicates via HL7 messages which are made up of a sequence of messages having segments fields and message types.

Admissions Message Segments include a Patient Identification Segment PID . The PID includes one or more forms of patient ID numbers and a patient medical record number.

Pharmacy order segments include complete information regarding medication types dosages and dispensing schedules. While these messages are conventionally meant to be used in conjunction with pharmacy orders not for representing vended medications HL7 messages may be created that contain pharmacy orders but which are used in the present system to represent vended medications.

By using HL7 messages having Admissions Message Segments and Pharmacy order segments and the data in databases and the first electronic translator may create HL7 messages that fully describe which patient received vended medications and which medications were vended.

As shown in the PMVD preferably includes at least one electronic display screen to display text and or graphics at least one speaker for delivering audio and at least one button keypad or swipe card device that enables the patient to activate the PMVD so as to initiate a vending event. The text and or graphics and speaker are used to prompt the patient to initiate a vending event in accordance with the schedule of prompts stored in the eMAR . In the example described above medication must be taken three times per day such as at 8 00 am 12 noon and 6 00 pm.

The PMVD has an internal clock and at least one reliable power source and preferably has a backup power source which can sustain functionality of the PMVD for extended periods of time so as to ensure the continuity of care. For example the PMVD may receive power from a standard electrical outlet and may include an automatically rechargeable backup battery that automatically takes over power functions upon disruption of electrical power and automatically reverts to standby mode upon resumption of power. Caregivers pharmacies and physicians may also be provided with the ability to remotely turn off all power to the PMVD .

As discussed above the PMVD may communicate with the host server via an electronic network such as the Internet. The communication may be wired or wireless. The wireless communication may be any conventional form of such communication including short range wireless signals such as Bluetooth signals.

The PMVD may have a conventional full keypad that may be used to enter security code e.g. a Personal Identification Numbers PIN for initiating a vending event or there may be a simple dedicated key such as the or key that must be pressed for initiating the vending event. The keypad may also be used to input information such as patient blood pressure readings blood glucose levels and the like. In this manner the PMVD may also be used to prompt a patient to take and record their blood pressure blood glucose levels and other similar vital signs. This can allow a physician or other healthcare professional to diagnose conditions remotely and in real time. The PMVD can also be programmed to have different prompts depending on the vital sign measurement. For example if a patient enters a glucose reading above a certain level the PMVD may announce Take your diabetes medicine now or Call your physician immediately. If the medicine is insulin the PMVD may also be programmed to announce Your insulin is in refrigerator. 

The PMVD may have the ability to read identification ID cards or other similar devices belonging to patients and caregivers. When a patient and possibly the caregiver enters a PIN or swipes their user ID card the PMVD may ask Do you want the 8 00 AM meds Also different user IDs ID devices and security settings may allow for different levels of functionality. For example a caregiver s security setting may allow the user to vend missed doses. However the patient s security setting may not allow the user to vend missed doses.

After the PMVD receives a prompt and communicates the prompt visually and or audibly the PMVD may also periodically communicate reminders visually and or audibly until the patient initiates a vending event. The reminders will continue for whatever preprogrammed period of time is set by the pharmacist or other authorized entity. The reminders will stop when it is determined that the patient should no longer take the missed dose. After the reminders are stopped the patient will be locked out of initiating a vending event until the next scheduled vending event occurs. When the next vending event occurs the patient will receive the next vended MUDP from a different vending slot in the example discussed above. The PMVD may also be programmed to allow a physician to override the lockout so that the patient may take a missed dose past the lock out time if the physician deems that it is safe to do so.

As discussed above a caregiver may log into the eMAR and view the vending medications noting any missed medications. The PMVD and or the eMAR may also electronically send medication alerts to the patient caregiver via email SMS text messages or automated phone messages.

The vending example discussed above provides a PMVD that can accept 31 MUDPs to be loaded into three vending slots to allow for three vending events per day. However the PMVD may have any suitable number of vending slots to accommodate more or less than three vending events per day. To increase the versatility of the PMVD it may have five vending slots and anywhere from one to all five of the slots may be filled for a particular patient s needs. The PMVD may also be filled with a 32 day supply of medication. The extra day s would be a safeguard if a patient spills of drops their medications.

If all of the MUDPs contain the same medication there may be more flexibility in the vending process. For example the MUDP can be vended from any available slot that is not empty since there would be no need to associate different vending slots with different time periods.

In an alternative embodiment the PMVD has a waste bin that received missed doses. Thus after the predetermined period of time in which the reminder message is stopped the missed dose is vended into the waste bin instead of being left in the vending region such as the slots of the helical coils.

The PMVD may optionally include a scanner that can read a bar code or QR code printed on an MUDP as the MUDP is vended. This information may act as a backup to the process described above wherein the databases and are used to correlate a vending event to the appropriate information that is needed to populate the eMAR . Such a scanner may be required to comply with some health care regulations.

Medications such as Tylenol which are taken only when needed i.e. PRN meds and not taken on a regular schedule are kept outside of PMVD . PRN meds may be packaged in blister packs so they can be easily counted tracked and billed. Although PRN meds may be kept outside of the PMVD the PMVD can still play an instructing role by prompting a patient when to take a non packaged medication. For example the PMVD can have an audio prompt such as If you are experiencing pain you should take your Tylenol now. The pharmacy can input information into the PMVD which shows that a PRN med can be taken every six hours. Then the PMVD will prompt the patient e.g. by announcement or text message every 6 hours.

There is preferably a double lock system for Controlled Dangerous Substances CDS . For example when it is time for a patient to take a CDS the PMVD will dispense an empty package labeled You need to take Ritalin . The Ritalin a CDS is kept in a safe place outside of PMVD so that no one is tempted to tamper with the PMVD to gain access to a CDS.

Insurance companies do not normally pay for remote monitoring devices. For example pharmacies are not reimbursed for blood glucose monitors which have the ability to report back to a central database. However if the PMVD is tied to an eMAR it can be a very effective tool to assist doctors in inexpensively improving patient health and safety and insurance companies may pay for this functionality. Consider the following examples 

A physician can see their patient s blood glucose readings when the patient took insulin and how much insulin was taken.

A psychotic patient gets arrested and misses his medications for two days. The patient s physician and caregivers are notified of the missed medications immediately after each missed dose.

In one preferred embodiment an automated method is provided for recording contents of medication packages vended from a plurality of vending machines in an electronic record such as an eMAR that stores records for a plurality of patients who are associated with respective vending machines. The electronic record includes i a patient ID field ii a vended medications field and iii time of medication vending the vending machine including i an IP address ii a vending machine controller VMC iii one or more vending slots or columns each slot or column holding a medication package to be vended and iv a vending machine data format interface connected to an electronic network for communicating vending machine data the vending machine s IP address and the time of vending events. The vending machine data includes the vending slot or column that medications were vended from. In use the method operates as follows 

In one preferred embodiment there are a plurality of different slots or columns in the vending machine and each slot or column contains medication packages with different medication contents.

In one preferred embodiment the medications are vended in multi unit dose packages MUDPs the contents of each MUDP being stored in the second database. A single vending event thereby causes the electronic record to record that a plurality of medications were vended.

In one preferred embodiment the vending machine slots or columns are filled by a pharmacy during a medication dispensing process and the pharmacy electronically populates the second database with the contents of the medication packages in each of the slots or columns of the respective vending machines.

In one preferred embodiment the vending machine data format interface is a data exchange DEX interface and the vending machine data is DEX data. In another preferred embodiment the vending machine data format interface is a multi drop bus MDB interface and the vending machine data is MDB data.

This implementation is described in the context of an integration of products services from a plurality of different entities vendors companies . This implementation is not limited to this particular combination of entities. Furthermore this implementation may alternatively be performed using products services from the same entity. The entities are identified below 

Medherent a medication adherence system also referred to herein as a medication administration computer. 

CarasSolva Inc. CaraSolva CaraSolva located in Boulder Colo. licenses web based software designed to automate and simplify the daily tasks performed by nurses and professional caregivers.

MedSupport MedSupport is CaraSolva s software module for scheduling of medications and the administration of medication. MedSupport provides a compliant eMAR. In addition this module along with a pharmacy interface allows prescriptions to automatically schedule into MedSupport .

Med Pass outcome Medpass event This is a data element used in MedSupport. Med Pass outcomes are electronically recorded on the MedSupport eMAR.

 The web service and accompanying web application use the System database for basic functions record web service application specific errors authentication and resource access as well as logging and transaction services.

Referring to which shows a vending machine which is suitable for up to a 3 times per day configuration and which has its front panel door open Tray 1 is the topmost pair of helical coils labeled MORNING AM Tray 2 is the middle pair of helical coils labeled AFTERNOON and Tray 3 is the bottommost pair of helical coils labeled EVENING PM. Selection 1 and Selection 2 refer to respective ones of the pair of helical coils.

Using the row column explanation discussed below with respect to step the row represents the tray and the column in the row represents the Selection 1 or 2 such that in the vending machine of there is a matrix of three rows and two columns when viewed in GVC terminology 

IMPLEMENTATION 1 refers to a vending slot or column that medications are vended from. Each vending slot or column in IMPLEMENTATION 1 is equivalent to a Tray Selection or a row column of a matrix in IMPLEMENTATION 2.

The dosing algorithm is fairly straightforward. Doses have a dose time and a date. When the current time and date falls within the dosing window as defined by the dose date and time plus a vending window beyond the dose time currently 2 hours then the dose is considered pending. When a dose is pending the Dispense My Meds button is displayed along with a multi tonal audio sound. If no dose is in a pending state then the doses are listed with their current status dispensed queued or . Where signifies that the dosing window has closed and the dose was not dispensed.

If the consumer taps the Dispense My Meds button the vending of the medication packet begins. The dose motor pairing in the vending machine is determined with the intermediate web services when the schedule POST is sent from the eMAR web service. When it s time to vend a particular dose the vending service algorithm retrieves the dose actuator s paired with the particular dose and reviews the current inventory level for 1 to ensure that there is an inventory item to vend and is online and 2 if there is more than one actuator paired that it vends from the particular actuator that has the largest inventory level greater than zero and is online. This provides 2 benefits 1 that upon the failure of a motor in a multiple pairing situation that the other can act as a failover until the vending machine can be serviced and repaired. Once the particular actuator address is resolved the vending instruction is then communicated to the Global Vending Controller GVC board over serial communication using a USB cable. This instruction in general is SEL LF where SEL represents the 3 digit selection number pertaining to the actuator address that is recognized by the GVC board.

Translating the HL7 formatted schedule information begins with parsing the message segments to extract the data and determine the consumer and their respective schedule. The schedule information is contained in a tuple field with dose times delimited by commas.

The HL7 transaction amounts to a RESTful web service POST where the body entity contains the HL7 formatted message 

The message segments of particular interest are the PID segment field 3 and the TQ1 segment field 4. Field 4 of the TQ1 segment as stated earlier is a tuple field so the data must be split into its component parts resulting in an array of dose times. The dose times are then counted omitting any empty tuple items. There are 6 pre determined configurations that map the dose times into actuator relationships. So determining which configuration to use is a matter of determining the number of doses per day then applying the configuration map.

Once the map is created the data is saved in the database for retrieval. If a schedule already exists for the consumer the existing schedule is marked discontinued and the new schedule takes over.

A patient requires a combination of medications three times per day. The medications are packaged such that there are morning afternoon and evening dose packets with the correct medications respectively packaged together for each dose time. This is equivalent to configuration c. in the listing of supported configurations above.

Upon installation of the Medherent vending machine into the consumer s home the vending controller tablet is started. Once the vending controller software has booted the user will be required to configure the vending machine software so it knows where to look on the internet to communicate with the Medherent web service and when to prompt for vending of medication packets. The user will tap the configuration button enter the default PIN and proceed to input the vending machine location address verify the web service host address and login credentials and finally add administrator and consumer accounts.

The communication between the Medherent vending machine and the Medherent web services is performed over HTTP 1.1 SSL transport protocols using REST Representational State Transfer and XML entities. The web service resource expects login id and respective password headers to authenticate with the body entity containing the xml to process.

After the user enters the location information and verifies the Medherent web service information they will proceed to register the device with the Medherent web service. A successful registration will return the devices network Id which will be stored locally. Once the device is registered with the Medherent web service user accounts will need to be created.

The user will then create an Administrator account for the caregiver which may also be the consumer. Regardless at least one administrator account must exist. The user will then create a consumer account. Both of these accounts must be verified against the Medsupport web service which maintains the patient eMAR. The Administrator account is verified by passing the MedSupport UserID to the Medsupport system. This is entered by the user setting up the vending controller. It is not stored locally but sent up to the Medherent web service to be converted to HL7 and then passed to the MedSupport web service using an HL7 transaction 

The MedSupport web service will then POST a request containing the user Id of the MedSupport system. This information will be stored with the Medherent web service only. It will not flow to the vending machine. Rather the Medherent web service will always communicate with the MedSupport web service and each vending machine using their respective local Ids.

The vending controller is then configured with the consumer s patient s dosing schedule by inputting patient information once to link the vending machine to the patient s eMAR. The personally identifying information input at registration is not stored in the vending machine anywhere. Only numbers are used to identify the patient after the registration process is over reducing the possibility of leaking patient data. Once linked the dosing schedule is retrieved using the HL7 specification and an intermediate web service to translate the HL7 transaction into the vending controller s native structure 

The Medherent web service will then respond with the translated dosing schedule into Medherent xml entities which are saved into the local Medherent vending machine database.

The pharmacy technician will then proceed to load the medication packets into the vending machine with respect to the configuration. In this example the pharmacy technician fills the morning dose in tray 1 selections 1 2 the afternoon dose in tray 2 selections 1 2 and the evening dose in tray 3 selections 1 2. shows a vending machine with tray 2 in a tray loading position. Once the door on the vending machine is closed the technician must attest that they followed protocol when filling the vending machine and that the doses are in the correct tray selections. The vending machine will then go into dose mode.

Using the obtained dosing schedule the vending machine queues the doses. When the time comes for a dose packet to be vended the patient is alerted through visual and auditory prompts. The patient can vend the dose by tapping the dispense button and if required entering their PIN personal identification number . A short animation demonstrating how to open the packet is played during vending actuation.

When the patient vends a dose the vending controller uses the configuration to determine the coil selection to actuate then instructs the vending service to execute the vending operation. The vending service issues the following serial command over the USB cord tethered to the GVC board 

When a dose packet is vended the vending machine logs the event in the local database and transmits the dose vend event to the Medherent web service where it is translated into an HL7 transaction calls MedSupport web service updating the patient s eMAR.

Referring again to the Example above the following additional details are provided to further explain how a vending event is used to populate the eMAR with data.

Upon detection of a vending event the vending machine communicates at least the following information to Medherent web services 

Medherent web services maintains a Patient Medication Table table that contains the data fields shown in . Upon receipt of the information above a check is made to identify whether there is a Patient ID and scheduled dose time that matches the incoming information. If so the appropriate entry is made in the table indicating that the medications for that patient were vended and thus presumed to have been taken. The actual time of vending may be used for more granular compliance monitoring.

In IMPLEMENTATION 2 no prompts are sent to the vending machines from the Medherent web services since the vending machine has already been pre programmed to generate its own prompts in accordance with the dose schedule. However the table knows the time of prompts and uses this information as described above to identify a vending event for the patients being monitored in the eMAR.

Furthermore in IMPLEMENTATION 2 no patient personalized information or medication details are communicated to Medherent web services. Thus if the communicated information was intercepted by an unauthorized entity the information could not be used to readily identify the patient or any of the medications that the patient has taken. Even if the unauthorized entity was able to determine the actual patient name from the Patient ID by gaining access to medical records other than the eMAR the unauthorized entity would still not be able to determine what medications the patient has taken.

In an alternative embodiment the vending machine communicates only the Patient ID to Medherent web services without the scheduled dose time. In this embodiment if the eMAR locates a record for the Patient ID then it infers from the actual time what the scheduled dose time should be and uses that information to complete the same process described above. For example if the vending event is detected at 8 02 am and there is a scheduled dose time at 8 00 am and no other scheduled dose time near 8 00 am then it can be inferred that the scheduled dose time is 8 00 am.

In another alternative embodiment a machine number of the vending machine or a static IP address of the tablet is sent in place of the Patient ID and a translation table equivalent to database table of is used to identify the Patient ID. The process then proceeds as described in either of the embodiments above i.e. with or without the scheduled dose time .

In addition any unique identifier of the patient can be used in place of the patient ID used by the Medherent system. Again a translation table would be required in this embodiment to obtain the Patient ID needed for the eMAR from the unique identifier.

The following specifications can be used for one preferred embodiment of hardware software components. Any of the components can be substituted for different hardware software having equivalent functionality.

The present invention may be implemented with any combination of hardware and software. If implemented as a computer implemented apparatus the present invention is implemented using means for performing all of the steps and functions described above.

When implemented in software the software code can be executed on any suitable processor or collection of processors whether provided in a single computer or distributed among multiple computers.

The present invention can also be included in an article of manufacture e.g. one or more computer program products having for instance computer readable storage media. The storage media has computer readable program code stored therein that is encoded with instructions for execution by a processor for providing and facilitating the mechanisms of the present invention. The article of manufacture can be included as part of a computer system or sold separately.

The storage media can be any known media such as computer memory one or more floppy discs compact discs optical discs magnetic tapes flash memories circuit configurations in Field Programmable Gate Arrays or other semiconductor devices or other tangible computer storage medium. The storage media can be transportable such that the program or programs stored thereon can be loaded onto one or more different computers or other processors to implement various aspects of the present invention as discussed above.

The computer s used herein may be embodied in any of a number of forms such as a rack mounted computer a desktop computer a laptop computer or a tablet computer. Additionally a computer may be embedded in a device not generally regarded as a computer but with suitable processing capabilities including a Personal Digital Assistant PDA a smart phone or any other suitable portable mobile or fixed electronic device.

The computer s may have one or more input and output devices. These devices can be used among other things to present a user interface. Examples of output devices that can be used to provide a user interface include printers or display screens for visual presentation of output and speakers or other sound generating devices for audible presentation of output.

Examples of input devices that can be used for a user interface include keyboards and pointing devices such as mice touch pads and digitizing tablets. As another example a computer may receive input information through speech recognition or in other audible format.

Such computers may be interconnected by one or more networks in any suitable form including as a local area network or a wide area network such as an enterprise network or the Internet. Such networks may be based on any suitable technology and may operate according to any suitable protocol and may include wireless networks wired networks or fiber optic networks.

The various methods or processes outlined herein may be coded as software that is executable on one or more processors that employ any one of a variety of operating systems e.g. Microsoft Windows or Android or platforms. Additionally such software may be written using any of a number of suitable programming languages and or programming or scripting tools and also may be compiled as executable machine language code or intermediate code that is executed on a framework or virtual machine.

The terms program or software are used herein in a generic sense to refer to any type of computer code or set of computer executable instructions that can be employed to program a computer or other processor to implement various aspects of the present invention as discussed above. The computer program need not reside on a single computer or processor but may be distributed in a modular fashion amongst a number of different computers or processors to implement various aspects of the present invention.

Computer executable instructions may be in many forms such as program modules executed by one or more computers or other devices. Generally program modules include routines programs objects components data structures and the like that perform particular tasks or implement particular abstract data types. The functionality of the program modules may be combined or distributed as desired in various embodiments.

Data structures may be stored in computer readable media in any suitable form. For simplicity of illustration data structures may be shown to have fields that are related through location in the data structure. Such relationships may likewise be achieved by assigning storage for the fields with locations in a computer readable medium that conveys relationship between the fields. However any suitable mechanism may be used to establish a relationship between information in fields of a data structure including through the use of pointers tags or other mechanisms that establish relationship between data elements.

Preferred embodiments of the present invention may be implemented as methods of which examples have been provided. The acts performed as part of the methods may be ordered in any suitable way. Accordingly embodiments may be constructed in which acts are performed in an order different than illustrated which may include performing some acts simultaneously even though such acts are shown as being sequentially performed in illustrative embodiments.

It will be appreciated by those skilled in the art that changes could be made to the embodiments described above without departing from the broad inventive concept thereof. It is understood therefore that this invention is not limited to the particular embodiments disclosed but it is intended to cover modifications within the spirit and scope of the present invention.

