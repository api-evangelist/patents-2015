---

title: Location tagging
abstract: A method and system for verifying an indoor position using Wireless Local Area Networks (WLAN), access points (AP), and Assisted Global Positioning System (A-GPS). The goal of this method is to determine if a user is in the place where he claims to be by using a mobile device. When a user wants his location to be verified he activates a scanning process on his mobile device that reads all the requested signals (WLAN, A-GPS). When the recording process is complete the information is sent to a server where it is processed and the user location is either confirmed to be true or false.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09420430&OS=09420430&RS=09420430
owner: Walkbase Oy
number: 09420430
owner_city: Turku
owner_country: FI
publication_date: 20150424
---
This application is a continuation of claims priority to and the benefit of U.S. patent application Ser. No. 13 289 003 filed on 4 Nov. 2011 the disclosure of which is incorporated herein by reference in its entirety 

The aspects of the disclosed embodiments generally relate to positioning and locations systems and in particular to verifying consumer location or presence in a certain place and associating names and tags to certain places.

One big trend in mobile marketing is the check in feature. In a check in service consumers use for example a mobile device to inform a service that they are in a certain location such as for example a shop or restaurant. Check in generally refers to a user confirming to the check in service provider that he is actually in a specific place such as a shop or restaurant using the mobile device. There is a need for higher accuracy for these kinds of check ins as they are increasingly being connected with actual value services that give cash rewards for customer loyalty. There is a need for verification of the check in to confirm that the user is really in the specific place he claims to be.

Indoor location technologies are generally known. In one example a mobile terminal MT or other mobile device scans a Wireless Local Area Network WLAN environment and uses for example the Time Difference on Arrival TDOA to estimate the distance of the mobile terminal from a transmitting antenna. As the TDOA is measured from several base stations the location can be estimated.

Another method of indoor location is the so called fingerprinting method using a Received Signal Strength Indicator RSSI . Location fingerprinting is used to determine the location of the mobile device based upon matching the information from multiple receivers or transmitters with earlier measurements.

One problem with earlier location methods is that they require detailed maps of the indoor environments to be available. Additionally they require updating the database if the setup of the WLAN network is changed. Adding further to the problem is the fact that traditional means of determining a location i.e. Global Positioning System GPS are often not possible to use inside buildings.

The methods of TDOA and matching RSSI fingerprints to detailed maps also typically require a significant amount of signal processing capability on the mobile terminal.

WO2011019125A1 describes a method of determining an indoor position in which a wireless terminal is located by using a signal fingerprint of a WLAN received signal strength indicator RSSI in combination with a place label inputted by a user to a place server. One problem with this prior art location method is that it requires the user to provide a place label.

Accordingly it would be desirable to provide a system that addresses at least some of the problems identified above.

As described herein the exemplary embodiments overcome one or more of the above or other disadvantages known in the art.

One aspect of the exemplary embodiments relates to a method and system for verifying user location in a space.

At least some embodiments of the disclosure provide a method for verifying an indoor position using Wireless Local Area Networks WLAN access points AP and Assisted Global Positioning System A GPS . The aspects of the disclosed embodiments advantageously determine if a user is in the place where he claims to be by using a mobile device. When a user wants his location to be verified he may activate a scanning process on his mobile device or the scanning process may be activated automatically by for example an application executed in the mobile device that reads all the requested signals WLAN A GPS . When the scanning or recording process is complete the information is sent to a server where it is processed and the user location is either confirmed to be true or false. In one embodiment the user location may be sent to a merchant for use for example in invoicing or advertising.

In one aspect the disclosed embodiments are directed to an apparatus configured to verify a desired location of a mobile terminal. In one embodiment a positioning device is coupled to the mobile terminal the positioning device configured to obtain coarse location information corresponding to a current position of the mobile terminal. A controller is coupled to the mobile terminal the controller having a memory in communication with a processor the memory including program instructions for execution by the processor to collect the coarse positioning data corresponding to the current location of the mobile terminal verify that the coarse location information approximately corresponds to relative position of the desired location collect precise location data corresponding to the current location of the mobile terminal if the coarse location information corresponds to the relative position of the desired location and verify that the precise location data corresponds to the desired location.

In another aspect the disclosed embodiments are directed to a system for verifying a location of a mobile terminal. In one embodiment the system includes a verification server and a verification database coupled to the server wherein the verification server comprises a memory in communication with a processor the memory including program instructions for execution by the processor to detect a location verification request for a desired location of the mobile terminal receive coarse location data corresponding to a current location of the mobile terminal determine if the coarse location data corresponds to a general area of the desired location receive precise location data corresponding to the current position of the mobile terminal and

determine that current location is the desired location if the precise location data corresponds to the desired location.

In a further aspect the disclosed embodiments are directed to a method. IN one embodiment the method includes receiving a location identification verification request the request including a location identification parameter comparing the identification parameter with one or more pre stored identification parameters if a match exists sending a corresponding location identifier to verify the location or if no match exists requesting additional location identification information.

These and other aspects and advantages of the exemplary embodiments will become apparent from the following detailed description considered in conjunction with the accompanying drawings. It is to be understood however that the drawings are designed solely for purposes of illustration and not as a definition of the limits of the invention for which reference should be made to the appended claims. Moreover the drawings are not necessarily drawn to scale and unless otherwise indicated they are merely intended to conceptually illustrate the structures and procedures described herein. In addition any suitable size shape or type of elements or materials could be used.

The aspects of the disclosed embodiments are generally concerned with improving reliability of the check in of a customer or user to a certain place. Reliability is improved with a verification method or service. The following description is merely used to describe certain aspects of the disclosed embodiments and it is not to be limiting in any way.

According to the embodiments of mobile terminals MT and MT have a check in application installed on the terminal. A check in application refers to an application which is used by a user or consumer to indicate to for example a store owner or other merchant that the consumer is in or at the store location. Mobile terminals MT and MT are capable of sending and receiving wireless signals and can also have for example GPS enabled as an alternate positioning method. The mobile terminals can have WLAN capabilities. As used herein the term mobile terminal or device generally refers to terminals like cellular telephones smart phones mobile phones handsets Personal Digital Assistants PDA pads laptops or other similar communication and computing devices.

As described earlier one big trend in mobile marketing is the check in feature. schematically illustrates a currently used check in process. A mobile device or mobile terminal MT includes a check in application. The mobile terminal is used to inform a check in service provider that he is in the specific location or area of the merchant which can be for example a shop restaurant or other location. Currently a major player in check in service providers is Foursquare http foursquare.com . Foursquare provides a user with an application executed on the phone or mobile terminal . The Foursquare application can be downloaded to the mobile terminal in a suitable fashion. The aspects of the disclosed embodiments are not however limited to the Foursquare . The application can be any application downloaded in the terminal. It can also be a native application and or part of the operating system or other lower level functionality. Check in service can be the only functionality of the application or it can be part of the functionality of another application.

In the process of in step S the application executed on mobile terminal sends location data based on A GPS to service system . Service system analyzes the received location data at step S. The service system provides back to the user a list of locations or merchant locations nearby where he may check in S . In one embodiment location or merchant location generally refers to a merchant services location and can include for example a store building service center reception area kiosk or other suitable facility or location where a user may check in to avail themselves of the services or goods provided by the merchant s . The user can check in in to one of the locations using the application in the mobile terminal as in Step S. Service provider can provide a report to merchant about a successful check in as in step S.

As the user is checked in to the location he might receive for example discount coupons or other benefits related to the store or merchant location where he is checked in. Typically the merchant or store owner pays the service provider for the check in service allowing a user to check in at their location. Since it is critical for a business to know if the consumer is physically located in the store or not when they check in a secure verification method is needed.

Referring to a method of verifying a user s location according to one embodiment is shown. The mobile terminal is ready S. to begin verification. The user initiates a verification request S. . The mobile terminal scans for coarse location information S. using for example the A GPS chip. In alternate embodiments any suitable location or positioning device or system can be used to obtain the coarse location information. The mobile terminal scans S. the available WLAN access points and records their signal output data. The mobile terminal collects S. all necessary data. The mobile terminal sends S. the recorded data to the verification service over a 3G or WLAN connection for example. In alternate embodiments the data can be sent over any suitable communication connection. The mobile terminal waits S. for the verification service to respond. The mobile terminal analyzes S. the results returned by the service. The mobile terminal gives a response S. to the user. The verification process is then complete S..

Referring now to in one embodiment the user of mobile terminal MT initiates S. a check in service application claiming to be inside of or within an area of shop A. A GPS information is used S. to check if the user is in proximity of the location i.e. mobile terminal MT could be close to shops A B C or D . Since mobile terminal MT is close to shop A mobile terminal MT sends S. information about the radio environment as received by MT WLAN chip to the Verification Service database and server using wireless connection . In this example it is assumed that mobile terminal MT can receive some signal information from access points AP and AP. This information is analyzed by the Verification Service database and or server . The Verification service compares previously recorded information of what the radio environment should be inside of shop A to determine if mobile terminal MT is in the shop or not. This method is referred to in the disclosed embodiments as RSSI fingerprint matching and involves comparing the previously recorded data to the newly acquired and detecting similarities.

One embodiment of a check in using the verification method of the disclosed embodiments is illustrated in . When a check in application with verification functionality is used by the user mobile terminal sends S. an approximate location to check in service . Check in service provider analyzes S. and provides S. a list of possible places where the user may check in. According to one embodiment the user decides to check in in S.. The mobile terminal sends S. check in information to service provider and sends S. information relating to the radio network or radio environment to verification service server and database . Mobile terminal may send additional A GPS information and place identification information to Verification Service simultaneously with the radio environment information. In alternate embodiments mobile terminal may send the additional A GPS information and place identification information earlier for example at the same time as it is sent to service provider i.e. during S.. Alternatively this information may be sent to service provider which then routes the information to Verification Service . In this embodiment the terminal needs to connect with only one server system at a time. Verification Service analyses S. the received information and compares it with known fingerprints of the claimed location.

If the check in location of mobile terminal MT matches the fingerprints in the database confirmation is sent S. to check in service . Check in service then sends S. the verified information about the checked in user to merchant . The verified location information can be used for example for advertising purposes by merchant or invoicing purposes by service provider . In an alternate embodiment verification service can send verification information directly to merchant as in step S. without first going through the service provider . Mobile terminal MT user might be informed about successful or unsuccessful verification of check in S. .

Different mobile terminals might receive WLAN access point signal strengths differently due to their WLAN chip type and physical construction. This presents a problem for the fingerprinting process since it relies on matching substantially identical signal strengths with a specific location. According to one embodiment this is solved by using an assumption as it is in most cases that RSSI is measured on a scale of 10 to 110 dBM. This means that even though there is a slight difference with each mobile terminal they still follow the same linear scale. Thus one embodiment of the method measures the signal difference between the strongest and the rest of the received signals. illustrates an example of this process. It is assumed for the example that there are two mobile terminals making a scan of a WLAN environment. Both terminals are in location x for example location of MT in shop A as in . It is further assumed that mobile terminals have measured RSSI of access points AP AP AP AP AP and AP at the location x which is in shop A. In the example it is assumed that radio signals can propagate through one or more walls .

In tables and of results of two scans are shown. Location x row values in and refer to measured RSSI from each of the access points. According to embodiments of the disclosure an algorithm is used to compare two different measurements. In the first step measured values of AP AP are ordered by the strength giving number 1 for the strongest signal in the example AP which is closest to mobile terminal MT is given number 1 and 6 on the weakest signal as shown in row Order by strength . It is apparent for one of skill in the art that there might be more or less access points in the system than six. Even though both Scan X and Scan Y in have measured different values the linear scaling allows us to extract a fingerprint that is comparable between the two. Scaling is done by allocating value 0 for the strongest signal AP in the example and calculating the difference between other measured signals in comparison to the strongest. Scan X in location x gave different values for RSSI than Scan Y in the same location x. The above described scaling however enables the creation of identical fingerprints for the measurements.

This fingerprint is in some embodiments sent to verification service or to check in service as indication of the place of the mobile terminal and the user. It should be noted that other scaling mechanisms could be used as well for example by selecting the second strongest signal as the reference or the third strongest signal as the reference etc. It should be noted as well that algorithms in verification service can compare for example sent fingerprint to stored fingerprints in the database. Such a comparison might include methods like a one to one comparison or looking at probabilities of fingerprint match the location identification.

Every check in can have two distinct purposes the primary purpose can be the location verification and the secondary can be the gathering of access point data that adds to the accuracy of the verification.

Referring again to another aspect of the disclosed embodiments can be illustrated by an example where mobile terminal MT is making a check in claiming to be in shop A. Again the process involves measuring coarse information from A GPS S. to determine possible locations where mobile terminal MT could be i.e. in Shop A B C D E or F to determine if shop A is in the list of shops available for check in. Next the WLAN Access Point radio signals S. are scanned and the A GPS and AP data is sent S. to the verification service . The verification service analyzes the received data for example info about AP AP and AP . First the user s position is determined using the A GPS data if it is considered close enough to the check in location it proceeds with comparing the measured WLAN AP signals with those that have been pre recorded i.e. fingerprint matching. The data is analyzed and if a fingerprint match is found the check in is verified as true. In the above example the fingerprint of the location of MT does not correlate sufficiently with the fingerprint of the store A since mobile terminal MT is located outside of the building. Thus verification service will inform check in service that the user is not in store A.

The aspects of the disclosed embodiments advantageously enables the identification of which store or part of the store the customer is in. There is no need to know the location of any of the base stations since the interest is to match the fingerprint of the radio network to certain areas.

Aspects of the verification service according to the disclosed embodiments might require that the user is using a mobile phone capable of scanning a WLAN network and communicate over the network or a wireless network such as 3rd generation cellular network 3G connection . There is also a need for a GPS chip that allows for coarse estimation of a user s position. However the disclosed embodiments are not limited to terminals with WLAN and or GPS only. According to some embodiments scanning of other local area radios or short range networks such as Bluetooth can be used. In some embodiments coarse estimation of a user s position can be done for example via cellular network cell identification or other positioning technologies using cellular networks.

In one embodiment the verification process is initiated by the user requesting to have their location verified. When a user selects to have their location verified the software or application running on the mobile terminal is initiated and starts gathering a coarse A GPS location. If this location is remotely close to the area where the verification request is targeted the next step is automatically initiated. This step scans the WLAN networks available and sends the collected data to a verification service running the positioning engine. The data is then analyzed on the server and once a result has been determined a true or false response is returned to the mobile terminal and displayed to the user.

The positioning engine looks for familiar RSSI fingerprints and uses these to calculate the probability that the user is in the location where he claims to be.

Every time a user requests that his location be verified and performs the subsequent scans he is also contributing to the database of available WLAN data. This database is continuously analyzed and the collected information is compared with previous results. The comparison process will group similar scans together and discard irrelevant or outlying scans. Once the groups have been created the most visible group will be selected as the most likely source of reliable WLAN data. The routers in this group will be given a weight that marks their importance in the positioning process the higher the weight the more important a router is. The location identification ID related database is created automatically.

According to another embodiment if there is no data in the verification service database related to the fingerprint of a particular location the verification cannot be done immediately. However according to the disclosed embodiments the database can store received fingerprints and user claimed identifications check in ID in the database. There can be an algorithm in the verification system which will accept a fingerprint as valid finger print in case a sufficient amount of users have sent the same fingerprint to the verification server. Additionally there can be validated users such as store owners that can send official fingerprints to database.

Additionally from time to time WLAN configurations might change. For example shop B might decide to change access point AP to another type of access point or turn it off reconfigure it or move it. This can lead to situation that at least a few persons will have non verified message when they are in location x since AP is not existing. According to one embodiment the verification server can change the associated fingerprint in the database according to a rule set. An example of a rule set can be for example that after 5 users have claimed the check in with the new fingerprint with no AP this is assumed as new verified fingerprint of the location x.

The server system component for associating hashtags to locations returns one or more hashtags which are associated with the location in step S.. The hashtags can be in the Walkbase server system or those can come from other sources such as 3party servers hosting information. Hashtags are commonly used identification in communication related to Twitter . Hashtag words are typically marked with symbol in the front of the word i.e. London Patent TPS. The hashtags can be used in the Twitter environment to group and sort discussions.

Additional examples of the exemplary application can be messaging applications such as email applications short message service SMS messages multimedia message service MMS messages games mapping social network applications such as Facebook and search applications for making Google searches for example.

The verification service can run in a server capable of load balancing and a database for storing the recorded data. The server can be part of a cloud computing grid that allows for easy scaling when necessary. shows example embodiment of verification server set up. Inputs from mobile devices are received as JSON Input via REST Representational state transfer interface. Location verification algorithms can use information from A GPS Wi Fi scans and acoustic scanner if available in a layered manner each information bringing more confidence on the location verification process. Information is analysed and appropriate weighting of the results are done in server system. Updated location related parameters are stored in the database . Location detection modules can use information from the database to detect the location of the terminal. There can be an interface to 3party point of interest POI data from server system or it can be integrated as part of the server system. POI data can be used to provide location context related information to mobile terminals and also mobile terminals can update POI data. An example of POI data can be association of Twitter communications to a location.

In some embodiments fingerprint matching to certain locations places can be done in the mobile terminal without need for on line connection to servers. In this embodiment the mobile terminal can include a database for storing a set of fingerprints and related place identification codes or place names.

In some embodiments verification services related database and check in services might be implemented by a single party in the same server logical or physical so the functionality of check in and verification can be distributed or handled by the same party.

The aspects of the disclosed embodiments will also include processing devices such as processors microprocessors computer program products and computer readable media that are configured to execute program code and computer readable instructions to carry out the methods and processes described herein. In one embodiment the computer readable media includes non transitory memory devices.

In other embodiments verification is operated by a third party other than the check in service in order to enable multiple different check in service providers to verify or access verified place information.

Thus while there have been shown described and pointed out fundamental novel features of the invention as applied to the exemplary embodiments thereof it will be understood that various omissions and substitutions and changes in the form and details of devices illustrated and in their operation may be made by those skilled in the art without departing from the spirit of the invention. Moreover it is expressly intended that all combinations of those elements and or method steps which perform substantially the same function in substantially the same way to achieve the same results are within the scope of the invention. Moreover it should be recognized that structures and or elements and or method steps shown and or described in connection with any disclosed form or embodiment of the invention may be incorporated in any other disclosed or described or suggested form or embodiment as a general matter of design choice. It is the intention therefore to be limited only as indicated by the scope of the claims appended hereto.

