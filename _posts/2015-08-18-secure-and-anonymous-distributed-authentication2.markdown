---

title: Secure and anonymous distributed authentication
abstract: A method performed at a central entity includes (a) sharing a secret with a remote tenant server of one of a plurality of tenant organizations, the tenant server being configured to provide authentication services for accessing storage of the central entity, (b) receiving a storage request from a remote client device, (c) extracting an identification of the tenant organization from a core portion of the request, (d) selecting the shared secret of the identified tenant organization, (e) cryptographically combining the core portion and the shared secret to generate a preliminary signature, (f) performing a computation using the preliminary signature and a body portion of the request to generate a test signature, the body portion including the core portion and an object identifier, (g) comparing the test signature with a signature from the request, and (h) permitting the client device to access an identified object only when the comparison is positive.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09565019&OS=09565019&RS=09565019
owner: EMC IP Holding Company LLC
number: 09565019
owner_city: Hopkinton
owner_country: US
publication_date: 20150818
---
This Application is a Divisional of U.S. patent application Ser. No. 13 630 335 which was filed on Sep. 28 2012.

Storage providers maintain large amounts of data storage for a multitude of users. These storage providers typically utilize authentication protocols in order to ensure that only authorized users can access the storage and that the authorized users only access portions of the storage that they are permitted to access. In order to access storage a user may send a storage request to the storage provider signed with a signature created using a secret shared between the storage provider and that user. In order to authenticate a user for any given access attempt the service provider verifies the identity of the user by making sure that the request is signed with the proper shared secret. The storage provider then allows access based upon an access policy for that user.

In some systems a storage provider may rent storage space to tenant storage providers. These tenant storage providers are each responsible for initially registering each user with the storage provider. Then a user is able to access the storage as described above.

The above described approach may not be optimal. For example in the conventional approach tenants are required to register user information with the storage provider. This may be undesirable if the tenant wishes to maintain the privacy of its users. In addition the above described registration approach may be undesirable if the tenant wants to be able to quickly add and remove users without needing to engage in a registration process with the storage provider every time a change is needed.

Thus techniques are presented for authenticating users of tenant organizations based upon signed leases provided to the users by each tenant organization without registration with the storage provider being required for each user. Each user is able to sign its own storage requests with a temporary secret code provided by its respective tenant as part of a lease provided by the tenant to the user.

One embodiment is directed to a method of accessing remote storage of a tenant organization at a central entity that provides remote storage for a plurality of tenant organizations. The method includes i receiving by a client device a lease from a tenant server of a tenant organization of the plurality of tenant organizations A the tenant server providing authentication services for accessing the remote storage at the central entity the central entity being distinct from the tenant server B the lease including 1 a core portion including lease terms and an identification of the tenant organization and 2 a first signature that cryptographically combines the core portion and a secret code associated with the tenant organization the secret code being unknown to the client device ii sending a storage request from the client device to the central entity for access to the remote storage of the tenant organization the storage request including a a body portion including the core portion and an object identifier which identifies an object stored in the remote storage and b a second signature that cryptographically combines the body portion and the first signature and iii receiving by the client device a storage response from the central entity the storage response including the object stored in the remote storage when I a computation performed at the direction of the central entity of a test value based on the secret code the core portion and the body portion matches the second signature sent in the storage request and II the storage request complies with the lease terms.

Another embodiment is directed to a method of providing access to storage of a central entity. The method includes a at a computing device of the central entity sharing a secret with a tenant server of a tenant organization of a plurality of tenant organizations the tenant server being configured to provide authentication services for accessing the storage at the central entity the central entity being remote from the tenant server b at the computing device of the central entity receiving a storage request from a client device the client device being remote from the central entity c at the computing device of the central entity extracting an identification of the tenant organization from a core portion of the storage request d at the computing device of the central entity selecting the shared secret of the tenant organization identified by the extracted identification of the tenant organization e at the computing device of the central entity cryptographically combining the core portion and the selected shared secret to generate a preliminary test signature f at the computing device of the central entity performing a computation using the preliminary test signature and a body portion of the storage request to generate a final test signature the body portion including the core portion and an object identifier g at the computing device of the central entity comparing the final test signature with a signature from the storage request and h at the computing device of the central entity permitting the client device to access an object identified by the object identifier only when the comparison is positive.

Other embodiments are directed to a computerized apparatus and computer program product. Some embodiments involve activity that is performed at a single location while other embodiments involve activity that is distributed over a computerized environment e.g. over a network .

Embodiments of the invention are directed to techniques for authenticating users of tenant organizations based upon signed leases provided to the users by each tenant organization without registration with the storage provider being required for each user. Each user is able to sign its own storage requests with a temporary secret code provided by its respective tenant as part of a lease provided by the tenant to the user.

A plurality of tenant organizations depicted as first tenant organization second tenant organization . . . n th tenant organization lease storage space from the central entity which they each are able to sub lease to their respective clients . Each tenant organization includes a tenant server depicted as tenant servers . . . which is responsible for providing leases to clients of its respective tenant organization so that the clients are able to access the storage via storage requests when authorized.

Each tenant server stores a shared secret depicted as SS SS . . . SSn that is shared between that tenant server and the central entity . The dotted lines between the tenant organizations and the central entity indicate a logical relationship the tenant organizations lease storage space of the storage from central entity and each shares a respective secret with the central entity.

In some embodiments central entity is a large data center having dozens or hundreds of banks of individual storage systems e.g. Symmetrix or VNX series storage systems produced by the EMC Corporation of Hopkinton Mass. storing petabytes or exabytes of data making up storage attached to one or more computing devices configured to control access to storage . Tenant organizations may be individual websites or cloud storage providers that provide access or cloud based storage to users running clients . Thus for example a user of client may have a cloud storage account with Clouds Are Us a hypothetical cloud based storage provider taking the place of first tenant organization . However Clouds Are Us does not actually provide any of its cloud based storage itself rather it outsources the storage to the data center of central entity and it operates a tenant server to provide leases to its users. Thus an individual who is a user of Clouds Are Us is able to access his cloud based storage by using his client device to obtain a lease from tenant server typically over the Internet not depicted which it is then able to use to construct a storage request which it then sends to central entity for processing typically over the Internet not depicted .

In some embodiments the central entity may allow data access over an HTTP REST based protocol with a cryptographically generated signature used to guarantee the authenticity of the data request and to authorize the data access. In such embodiments the client would send a properly formatted HTTP packet to the central entity . The HTTP packet would include lease information a cryptographically generated signature data access request information and any other necessary information required by the central entity . The individual elements may be distinguished by an appropriate use of HTTP headers an XML document in the HTTP request body a JSON document in the http request body or any other such mechanism that the central entity may be configured to accept. The invention is not restricted to HTTP REST based protocols and it should be clear to one of normal skill in the art that this same information may be communicated between the client and the central entity over a variety of network transport protocols.

In some embodiments an enhanced system is used as depicted in . In example enhanced system instead of tenant organizations directly sub leasing space to their clients depicted as clients . . . tenant organizations of which only one the second tenant organization is shown sub lease to sub tenant organizations depicted as sub tenant organizations A . . . B which in turn sub sub lease space to clients . The dotted lines between the tenant organizations and the central entity indicate a logical relationship the tenant organizations lease storage space of the storage from central entity and each shares a respective secret with the central entity while the dotted lines between the second tenant organization and the sub tenant organizations also indicate a logical relationship the sub tenant organizations sub lease storage space of the storage that second tenant organization leases from central entity and each sub tenant organizations receives a respective lease or upper lease from second tenant organization . Each sub tenant organization is then able to provide a sub lease also referred to as a lease to its respective clients .

For example in system central entity may be a large data center having dozens or hundreds of banks of individual storage systems e.g. Symmetrix or VNX series storage systems produced by the EMC Corp. storing petabytes or exabytes of data making up storage attached to one or more storage access control devices of central entity configured to control access to storage . Second tenant organization may be for example a large international law firm which provides cloud based storage to its employees running clients . However the large international law firm does not actually provide any of its cloud based storage itself rather it outsources the storage to the data center of central entity . However since the large international law firm may have tens of thousands of employees in hundreds of branch offices around the world each of which is managed separately the large international law firm may sub lease its cloud storage space to each of its local branch offices each of which is a separate sub tenant organization . Each local branch office runs a respective sub tenant server and is thus able to manage the cloud access of each of its own employees. Thus the Boston office of the large international law firm may be sub tenant organization A running sub tenant server A while the Hong Kong office of the large international law firm may be sub tenant organization B running sub tenant server B . The sub tenant server A of the Boston office obtains a lease A from the tenant server of the large international law firm signed with shared secret SS . The Boston office is then able to provide leases to its local Boston employees running client devices using its own lease A for signature purposes. Meanwhile the sub tenant server B of the Hong Kong office obtains a lease B from the tenant server of the large international law firm signed with shared secret SS . The Hong Kong office is then able to provide a lease to one of its local Hong Kong employees running client device using its own lease B for signature purposes.

Advantageously because tenant organizations and sub tenant organizations are able to provide their own leases central entity does not need to store and maintain information for all users and clients which are permitted to access storage . Rather the individual storage requests provide enough information gleaned from leases to allow the central entity to decide whether the individual storage requests should be allowed or denied.

Computing device includes a network interface . Each computing device is able to communicate with various other computing devices as relevant for the needs of that particular computing device using network interface . In some embodiments particularly in the case of clients but also in certain embodiments the other devices computing device also contains a user interface UI which allows computing device to communicate with a user via UI devices not depicted . UI may be for example one or more of the following a graphics adapter a serial port a parallel port a Universal Serial Bus adapter etc. UI devices may include input devices as well as output devices. Example UI devices include a display monitor and a keyboard. Other example UI devices could include a printer a touch screen a mouse etc.

Computing device also contains a processor and memory . Processor may be any kind of processor or set of processors configured to perform operations such as for example a microprocessor a multi core microprocessor a digital signal processor a collection of electronic circuits or any combination of the above. Memory may be any kind of digital memory such as for example random access memory read only memory static memory volatile memory non volatile memory system memory solid state storage disk based storage or some combination of the above. Memory stores programs executing on processor as well as data used by those programs. Memory stores an operating system and a configuration program computer program both of which run on processor . Memory typically includes both a system memory portion for storing programs and data in active use by the processor as well as a persistent storage portion e.g. solid state storage and or disk based storage for storing programs and data even while the computing device is powered off. OS and computer program are typically stored both in system memory and in persistent storage so that they may be loaded into system memory from persistent storage upon a system restart. The computer program when stored in non transient form in system memory forms a computer program product. Memory also stores data which is used by computer program in operation. The processor running the computer program thus forms a specialized circuit constructed and arranged to carry out the various processes described herein.

On a client computer program may be a storage access program. On a storage access control computing device of central entity computer program may be a storage access control program. On a tenant server or sub tenant server computer program may be a lease provisioning program configured to provide a lease to a client in accordance with access permissions associated with a user of such client .

The contents of program data may vary depending on what kind of computer program is running on the computing device . When the computer program is a storage access control program of central entity then program data may include a database associating each tenant organization with a particular unique shared secret . The program data may also include one or more received storage requests for processing.

When the computer program is a lease provisioning program of a tenant server or sub tenant server then program data may include a database associating the clients or users of those clients with specific access policies for those clients or users. This database may also include information which allows each client or user to be properly identified by the computer program e.g. a username and password an IP address etc. . The program data may also include one or more leases to be sent to the clients . In the case of a tenant server the program data also includes shared secret while in the case of a sub tenant server the program data may also include an upper lease received from a tenant server .

When the computer program is a storage access program of a client then program data may include a lease received from a tenant server or sub tenant server as well as one or more storage requests to be sent to client entity .

Further details with respect to the shared secret leases upper lease and storage requests of program data are depicted in .

Once the core portion of the lease has been calculated lease provisioning program of tenant server creates the first signature Sig by cryptographically combining the core portion with the shared secret of that tenant server e.g. using a cryptographic hashing algorithm such as an MD5 hash . The dotted arrows pointing at first signature Sig indicate that the first signature Sig is formed by hashing or otherwise cryptographically combining the core portion and the shared secret .

Once the storage access program of client has received the lease it is able to generate a storage request to send to central entity . Storage access program creates a body portion by combining the core portion of the received lease with request parameters . The request parameters may include for example an identifier of the client as well as details of what portion of storage client wishes to access and how it wishes to access it e.g. to read it or to write certain data to it . If the storage uses an object based storage system then the request parameters may include an object identifier which identifies a spot in an object hierarchy. If the storage uses a file based storage system then the request parameters may include a file name and or path which identifies a particular file at a particular logical location. If the storage uses a block based storage system then the request parameters may include a range of block addresses which identify the blocks that the client wishes to access.

Storage access program is then able to cryptographically combine the body portion with the first signature Sig from the received lease e.g. using a cryptographic hashing algorithm such as an MD5 hash in order to create second signature Sig which is also included as part of the storage request . The dotted arrows pointing at second signature Sig indicate that the second signature Sig is formed by hashing or otherwise cryptographically combining the body portion and the first signature Sig .

Upper lease includes an inner core portion ICore and a preliminary signature PSig . Lease provisioning program of tenant server creates inner core portion ICore by including a tenant ID which uniquely identifies tenant server or tenant organization as well as lease terms . Lease terms define the boundaries of the lease provided to the sub tenant organization e.g. sub tenant organization A . For example lease terms may include an area of storage that the sub tenant organization A is permitted to sub lease to clients e.g. an address range or a hierarchy of files or objects that the client is permitted to access a time period for the upper lease e.g. after time X and before time Y and an identifier of the client . These lease terms may be calculated with reference to the database associating each client or user of that client with specific access policies for that client .

Once the inner core portion ICore of the upper lease has been calculated lease provisioning program of tenant server creates the preliminary signature PSig by cryptographically combining the inner core portion ICore with the shared secret of that tenant server e.g. using a cryptographic hashing algorithm such as an MD5 hash . The dotted arrows pointing at preliminary signature PSig indicate that the preliminary signature PSig is formed by hashing or otherwise cryptographically combining the inner core portion ICore and the shared secret .

Once sub tenant server A has received the upper lease from the tenant server lease provisioning program of sub tenant server A creates a lease for a client e.g. client . Lease includes a core portion and a first signature Sig . Lease provisioning program of sub tenant server A creates core portion by combining the inner core portion ICore of the received upper lease with a tenant ID which uniquely identifies sub tenant server A or sub tenant organization A as well as lease terms . Lease terms define the boundaries of the lease provided to the client . For example lease terms may include an area of storage that the client is permitted to access e.g. an address range or a hierarchy of files or objects that the client is permitted to access a time period for the lease e.g. after time X and before time Y and an identifier of the client . These lease terms may be calculated with reference to the database associating each client or user of that client with specific access policies for that client .

Once the core portion of the lease has been calculated lease provisioning program of sub tenant server A creates the first signature Sig by cryptographically combining the core portion with the preliminary signature PSig received from tenant server e.g. using a cryptographic hashing algorithm such as an MD5 hash . The dotted arrows pointing at first signature Sig indicate that the first signature Sig is formed by hashing or otherwise cryptographically combining the core portion and the preliminary signature PSig .

Once the storage access program of client has received the lease it is able to generate a storage request to send to central entity . Storage access program creates a body portion by combining the core portion of the received lease with request parameters . The request parameters may include for example an identifier of the client as well as details of what portion of storage client wishes to access and how it wishes to access it e.g. to read it or to write certain data to it . If the storage uses an object based storage system then the request parameters may include an object identifier which identifies a spot in an object hierarchy. If the storage uses a file based storage system then the request parameters may include a file name and or path which identifies a particular file at a particular logical location. If the storage uses a block based storage system then the request parameters may include a range of block addresses which identify the blocks that the client wishes to access.

Storage access program is then able to cryptographically combine the body portion with the first signature Sig from the received lease e.g. using a cryptographic hashing algorithm such as an MD5 hash in order to create second signature Sig which is also included as part of the storage request . The dotted arrows pointing at second signature Sig indicate that the second signature Sig is formed by hashing or otherwise cryptographically combining the body portion and the first signature Sig .

In step storage access program of client receives a lease from a tenant server e.g. a tenant server or a sub tenant server of a tenant organization e.g. a tenant organization or a sub tenant organization via network interface . The lease includes a core portion and a first signature Sig . The core portion includes lease terms and a tenant ID . The first signature Sig is a cryptographic hash of the core portion and a secret code associated with the tenant organization and unknown to the client . In the case in which the lease is received from a tenant server the secret code is a shared secret uniquely shared between the central entity and the tenant organization . In the case in which the lease is received from a sub tenant server the secret code is the preliminary signature PSig stored within the upper lease that the sub tenant server has received from a tenant server . In the case in which the lease is received from a sub tenant server the core portion also includes an inner core ICore also stored within the upper lease that the sub tenant server has received from a tenant server .

In step storage access program of client creates and sends a storage request to the central entity for access to the remote storage provisioned by the tenant organization or sub tenant organization . The storage access program of client creates the storage request by forming a body portion from the core portion from the received lease and combining the body portion with request parameters discussed above in connection with . The storage access program of client continues to create the storage request by forming a second signature Sig by cryptographically hashing the newly formed body portion with the first signature Sig from the received lease . Once the storage request has been created the storage access program of client sends it to the central entity via network interface .

After storage access program of client has performed steps and the central entity performs a method to determine whether the storage request is to be accepted or denied see e.g. steps of method described below in connection with .

In step storage access program of client receives a storage response from the central entity . The storage response includes the requested object from storage or in the case of a write operation a confirmation that the requested data has been written to the address or area indicated by the request parameters when the central entity or more precisely when a storage access control computing device of central entity running a storage access control program has I confirmed that the second signature Sig in the storage request is consistent with the body portion and core portion within the storage request given that the central entity is aware of the shared secret used in performing such calculations and II confirmed that the request parameters comply with the lease terms and in embodiments in which a sub tenant organization is involved that the request parameters comply with the lease terms of the inner core . In some embodiments rather than the central entity performing these confirmation calculations directly central entity may direct another device to perform these calculations on its behalf.

In step storage access control program of central entity shares a secret with a remote tenant server of a tenant organization of the plurality of tenant organizations . That tenant server is configured to provide authentication services for accessing the storage of the central entity . In some embodiments that tenant server is only authorized to allow access to a portion of the remote storage smaller than the whole of the remote storage . Thus for example the various different tenant servers may each be authorized to access distinct and in some cases non overlapping portions of the remote storage .

Step is performed only once a client device has created and sent a storage request to the central entity e.g. after performing method described above in connection with . In step storage access control program of central entity receives the storage request from remote client device via network interface .

In step storage access control program of central entity extracts a tenant identifier from a core portion of the storage request . In the case of a storage request the tenant ID of the core is extracted. In the case of a storage request the tenant ID of the inner core ICore is extracted. Either way the tenant organization is identified and not a sub tenant organization .

In step storage access control program of central entity selects the shared secret of the tenant organization identified by the extracted tenant ID .

In step storage access control program of central entity cryptographically combines the core portion either core portion or ICore and the selected shared secret to generate a preliminary test signature. In the case of a storage request the core portion is cryptographically combined with the selected shared secret to yield a test version of Sig hereinafter referred to as Sig . In the case of a storage request the ICore is cryptographically combined with the selected shared secret to yield a test version of PSig hereinafter referred to as PSig . In step storage access control program of central entity performs a computation using the preliminary test signature Sig PSig and a body portion of the storage request to generate a final test signature hereinafter referred to as Sig . In the case of a storage request this computation is done by cryptographically combining the body portion with Sig to yield a test version of the second signature Sig which we call Sig . In the case of a storage request this computation is done by first cryptographically combining the core portion with PSig to generate a an intermediate test signature Sig a test version of the first signature Sig . Then the computation continues by cryptographically combining the body portion with intermediate signature Sig to yield a test version of the second signature Sig which we call Sig .

In step storage access control program of central entity compares the calculated final test signature Sig with the second signature Sig from the storage request .

In step storage access control program of central entity permits the client to access the storage only when the comparison of step was positive Sig Sig . A successful comparison indicates that the client was truly in possession of the lease and in the case of storage request that the sub tenant server was truly in possession of the upper lease and that the lease was generated by an authorized tenant server or sub tenant server and that the storage request has not been tampered with since leaving the client . Otherwise access is denied.

In addition storage access control program of central entity may also conduct additional tests in deciding whether to allow access. Thus in some embodiments storage access control program of central entity checks to make sure that the lease terms e.g. area of storage are within proper parameters current time is within time period of the lease terms are satisfied. Otherwise access is denied. In some embodiments in the case of a storage request storage access control program of central entity also checks to make sure that the lease terms of the upper lease e.g. area of storage are within proper parameters current time is within time period of the lease terms are satisfied. Otherwise access is denied.

Thus techniques have been described for authenticating users of tenant organizations based upon signed leases provided to the users by each tenant organization without registration with the storage provider being required for each user . Each user is able to sign its own storage requests with a temporary secret code provided by its respective tenant as part of a lease provided by the tenant to the user .

While various embodiments of the present disclosure have been particularly shown and described it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the spirit and scope of the present disclosure as defined by the appended claims.

For example it should be understood that although embodiments have been described in which a a tenant server sends lease to client and b a sub tenant server sends lease to client after having received an upper lease from a tenant server further nesting is possible. Thus embodiments are conceived in which a sub tenant of a sub tenant server is also a form of tenant server that may grant a lease to a client and other embodiments having even more layers. Similar techniques may be applied as in the case in which a sub tenant server sends lease to client after having received an upper lease from a tenant server as will be perceived by the person having ordinary skill in the art upon reading this Disclosure.

As an additional example although various embodiments have been described as being methods software embodying these methods is also included. Thus one embodiment includes a tangible non transient computer readable medium such as for example a hard disk a floppy disk an optical disk computer memory flash memory etc. programmed with instructions which when performed by a computer or a set of computers cause one or more of the methods described in various embodiments to be performed. Another embodiment includes a computer which is programmed to perform one or more of the methods described in various embodiments.

Furthermore it should be understood that all embodiments which have been described may be combined in all possible combinations with each other except to the extent that such combinations have been explicitly excluded.

Finally nothing in this Specification shall be construed as an admission of any sort. Even if a technique method apparatus or other concept is specifically labeled as prior art or as conventional Applicants make no admission that such technique method apparatus or other concept is actually prior art under 35 U.S.C. 102 such determination being a legal determination that depends upon many factors not all of which are known to Applicants at this time.

