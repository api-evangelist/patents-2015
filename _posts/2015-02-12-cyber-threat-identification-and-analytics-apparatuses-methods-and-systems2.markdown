---

title: Cyber threat identification and analytics apparatuses, methods and systems
abstract: The cyber threat identification and analytics (“CTIA”) apparatuses, methods and systems, for example, identify a list of relevant malware indicators of compromise (IOCs) during a cyber security incident. The CTIA system automatically groups relevant malware IOCs from all known samples of a particular threat, given either a threat or a specific IOC without knowing the threat. In this way, an incident responder can use the group of relevant malware IOCs to have the highest probability of locating infections of variations of malware of the particular threat.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09584541&OS=09584541&RS=09584541
owner: Lookingglass Cyber Solutions, Inc.
number: 09584541
owner_city: Baltimore
owner_country: US
publication_date: 20150212
---
This application may contain material that is subject to copyright mask work and or other intellectual property protection. The respective owners of such intellectual property have no objection to the facsimile reproduction of the disclosure by anyone as it appears in published Patent Office file records but otherwise reserve all rights.

Some embodiments generally relate to apparatuses methods and systems for cyber security management and more particularly relate to cyber threat identification and analytics CTIA apparatuses methods and systems.

Computer malware is a type of software that disrupts the normal operation of a computer and introduces security risk to a network of computers and any asset connected to the computer network. A malware instance can for example send malicious code programs to a computer so as to burden the processing capacity of the computer gain access to secured data without authorization or modify critical system settings. Anti malware programs are designed to detect potential threats of malware. When a computer is attacked by malware a computer user can experience abnormal symptoms on the computer. Different malware attacks can cause different abnormal symptoms to the computer for example hardware troubles slow performance missing files and or the like.

The cyber threat identification and analytics CTIA apparatuses methods and systems for example identify a list of relevant malware IOCs during a cyber security incident. In one embodiment the CTIA apparatus comprises a processor and a memory operatively coupled to the processor. The memory stores processor readable instructions executable by the processor to receive an input message including an indicator of compromise and to identify a type of a threat based on the indicator of compromise when the threat is unidentified by the indicator of compromise. When the threat is identified by the indicator of compromise the CTIA apparatus can identify all samples of malware that have been detected as that threat and compile a first group of previously stored indicators of compromise associated with the identified samples of malware. The CTIA apparatus can compile a second group of previously stored indicators of compromise that are statistically relevant to the threat based on the first list of previously stored indicators. The second group of previously stored indicators including indicators of compromise is from the first group of previously stored indicators and reaches a relevance level to the threat. The CTIA apparatus can generate an output message including the second group of previously stored indicators of compromise in response to the input message.

In one embodiment a processor implemented method performed by the CTIA apparatus is disclosed. The CTIA apparatus identifies presence of an indicator of compromise at a source and then determines a characteristic named observation associated with the first indicator of compromise. The CTIA apparatus forms a query on a set of previously identified samples of malware based on the characteristic named observation to identify a sample of malware that is associated with the characteristic named observation. The query thereby identifies a threat that is associated with the sample of malware. The CTIA apparatus then identifies a set of samples of malware that are associated with the identified threat based on the set of previously identified samples of malware based on which the CTIA apparatus determines a set of indicators of compromise. Each indicator of compromise from the set of indicators of compromise is associated with at least one sample of malware from the set of samples of malware. The CTIA apparatus can then generate an output group of statistically relevant indicators of compromise from the determined set of indicators of compromise which reaches a relevance level to the threat.

In one embodiment a system is disclosed. The system includes an indicator of compromise analyzer configured to receive an indicator of compromise and search a data store of indicators of comprise for the indicator of compromise to identify a sample of malware that contains the indicator of compromise to identify a threat. The system further includes a threat analyzer operatively coupled to the indicator of compromise analyzer. The threat analyzer is configured to search a data store of malware information based on the identified sample of malware to identify a set of samples of malware detected as the threat. The threat analyzer is further configured to compile a first group of previously stored indicators of compromise associated with the set of the samples of malware detected as the threat. The system further comprises a cluster analyzer operatively coupled to the threat analyzer. The cluster analyzer is configured to generate an output group of statistically clustered indicators of compromise from the first group of previously stored indicators of compromise the statistically clustered indicators of compromise reaching a relevance level to the threat.

Incident responders e.g. information technology administrators cyber threat analyst and or automatic cyber threat monitoring systems etc. can be in a situation in which they have come across an IOC but do not know what type of threat it is related to. The incident responders normally can check for IOCs related to the threat but the number of variants of malware or the number of IOCs related to the same threat could be significantly high e.g. an average of 160 000 new malware can be generated every day etc. and thus makes it extremely difficult or even impossible to inspect manually or with non trivial human involvement every malware.

Some embodiments of the cyber threat identification and analytics CTIA apparatuses methods and systems described herein for example can identify a list of relevant malware indicators of compromise IOCs during a cyber security incident. Such a cyber security incident can be for example a cyber attack that can disrupt the normal operation of a computer including different types of cyber threats such as but not limited to Trojans countermeasure unpatched software phishing attacks etc. The CTIA system can for example automatically group relevant malware IOCs from all known samples of a particular threat given either an identified threat or a specific IOC without specific knowledge of an identified threat. In this way an incident responder can use the group of relevant malware IOCs to have the highest probability of locating infections of variations of malware of the particular threat.

The CTIA system can determine statistically relevant malware IOCs for example by analyzing behavioral malware analysis data to automatically identify e.g. without human intervention the most relevant malware IOCs related to a threat. Such behavioral malware analysis data can be for example data that indicates or presents changes made to a computer when the computer is attacked by malware such as but not limited to network activities registry key changes files added modified removed in a file system on the computer etc. Given a large data set of behavioral malware analysis results from the execution of malware at mass scale the CTIA system allows incident responders to be provided a list of actionable IOCs so that the incident responders can identify the same malware or threat based on previously stored IOCs during incident response thereby greatly improving the chance of successful remediation of cyber risk. The CTIA system can group IOCs from all samples of malware of the same threat type to determine the most relevant IOCs without brute force examination of mass amounts of behavioral malware analysis data to determine which IOCs to use during incident response. In this way the incident responders can identify a threat in response to an IOC having the highest probability of locating infections of variations of malware of the particular threat based on the previously stored relevant IOCs. As a consequence incident responders need not inspect a large volume of variants of malware. Thus response times to threats are reduced and the likelihood of a remediation of threats is increased before damage to the computer at attack occurs or the performance of that computer deteriorates which in turn saves resources to maintain cyber security.

The user computer can send identifying information of the detected virus e.g. a hash to the data cloud too which can comprise an IOC data store a malware data store and or the like. Alternatively the identifying information of the detected virus can be any other form of a characteristic named observation e.g. registry keys file names and paths mutexes imported libraries and functions unique strings or network entity identifiers including domains and IP addresses . The data cloud too can be part of or maintained by the CTIA system or alternatively be maintained by a third party data service vendor. The CTIA system may generate a list of statistically relevant IOCs based on the identified IOC in response to the hash obtained from the initial virus IOC so that the user computer can analyze the threat based on the relevant IOCs. Further discussion and examples of generating statistically relevant IOCs are provided in .

Communication network can be any communication network such as the Internet configurable to allow the one or more UEs the one or more CTIA servers or components and the CTIA data sources to communicate with communication network and or to each other through communication network . Communication network can be any network or combination of networks capable of transmitting information e.g. data and or signals and can include for example a telephone network an Ethernet network a fiber optic network a wireless network and or a cellular network.

In some instances communication network can include multiple networks operatively coupled to one another by for example network bridges routers switches and or gateways. For example the UEs can be operatively coupled to a cellular network and the data source s can be operatively coupled to a fiber optic network. The cellular network and fiber optic network can each be operatively coupled to one another via one or more network bridges routers switches and or gateways such that the cellular network the Ethernet network and the fiber optic network are operatively coupled to form a communication network. Alternatively the cellular network and fiber optic network can each be operatively coupled to one another via one or more additional networks. For example the cellular network and the fiber optic network can each be operatively coupled to the Internet such that the cellular network the fiber optic network and the Internet are operatively coupled to form a communication network.

As illustrated in UEs are operatively coupled to communication network via network connection s CTIA server s and or CTIA cloud server are operatively coupled to communication network via network connection s or respectively and CTIA data source s are operatively coupled to communication network via network connection s . Network connections and can be any appropriate network connection to operatively couple UEs the CTIA server s and the data source s . In an alternative implementation the CTIA server s can have a direct connection with the UEs via a communication connection .

A network connection can be a wireless network connection such as for example a wireless fidelity Wi Fi or Wireless Local Area Network WLAN connection a Wireless Wide Area Network WWAN connection and or a cellular connection. A network connection can be a wired connection such as for example an Ethernet connection a Digital Subscription Line DSL connection a broadband coaxial connection and or a fiber optic connection.

As mentioned above in some instances a communication network system can include more than one UE more than one CTIA server more than one CTIA cloud server and more than one data source ill. A UE and or a CTIA server each can be operatively coupled to the communication network for example by heterogeneous network connections. For example a first UE can be operatively coupled to the communication network by a WWAN network connection another UE can be operatively coupled to the communication network by a DSL network connection and a CTIA server can be operatively coupled to the communication network by a fiber optic network connection.

The CTIA server s each can be for example a web server configured to provide search and or data analytics capabilities to electronic devices such as UEs . The UE can be in communication with the CTIA server s log via the communication network while the communication is managed at least in part by the CTIA client component . In one implementation the CTIA server s can be a remote server housed separately from the UE where the CTIA client component can include an application e.g. a browser application a mobile application etc. instantiated on a user device e.g. a Smartphone a computer a workstation a personal digital assistant etc. . For example the CTIA client component can send a signal representing a control command e.g. including a hash of a virus found on the UE etc. to the CTIA server s for relevant IOCs where the results of malware identification e.g. a list of relevant IOCs may be sent to UE and presented to a user via an output device of the UE . In another implementation the CTIA server s may be integrated with the UE including the CTIA client component . For example the CTIA server and UE can collectively act as an integrated computing device operated by a user e.g. via an input output device of the UE and communicate with various entities such as a data source CTIA cloud server and or the like. A detailed discussion of functional module s and data store s of the CTIA server is provided in . The CTIA component and the CITA cloud server can be integrated with the CTIA server and have a similar structure as shown in .

The UEs can be any of a variety of electronic devices that can be operatively coupled to communication network . A UE can be for example a personal computer a tablet computer a personal digital assistant PDA a cellular telephone a portable mobile internet device television kiosk display display screens in vehicles projection devices laser display devices digital display watches digital display glasses and or some other electronic communication device with audio and or visual capabilities. A UE can also be for example a television set a streaming device a set top box or any other electronic device equipped with a display unit a UI and an interface to a network connection that enables UE to run applications with real time contents received via the network connection on an operating system. The UEs each can include a web browser configured to access a webpage or website for example the CTIA client component which can be accessible over communication network . The UEs can be configured to support for example Hyper Text Markup Language HTML using JavaScript. For example the UEs each can include a web browser such as Firefox Safari Dolphin Opera Internet Explorer IE Chrome and or similar browsers. An Internet page or website can be accessed by a user of a web browser at a UE by providing the web browser with a reference such as a uniform resource locator URL for example of a webpage. In some instances UEs each can include specialized software other than a browser for accessing a web server such as for example a CTIA server . Specialized software can be for example a specialized network enabled application or program. In some instances portions of a website accessible via a web server can be located in a local or remote memory space data store accessible to the web server. A UE can also include a display monitor or user interface UI a keyboard various ports e.g. a USB port and other user interface features such as for example touch screen controls audio components and or video components each not shown .

Data source s can be distributed sources of data throughout the communication network system . A data source can be one or more of a database a data warehouse a file etc. The data source s can communicate with the CTIA cloud server via a network connection or be integrated with or housed with the CTIA cloud server and act as part of a data cloud of malware data. The CTIA server and or the CTIA component can communicate with the data source s to obtain cyber threat data via connections and through the communication network . Or alternatively the CTIA server or the CTIA component can access the CTIA cloud server via the communication network to load cyber threat data.

In various instances the CTIA server and its components can be located anywhere within a communication network system such as that shown in including but not limited to within the UEs or in separate locations within the communication network system of . The CTIA server can also be provided as on premise deployment via private computation clouds or be embedded into other software or bundled into devices by Original Equipment Manufacturers OEMs .

As used herein a module can be for example any assembly and or set of operatively coupled electrical components and can include for example a memory a processor electrical traces optical connectors software executing or to be executed in hardware or stored in memory and or the like. Furthermore a module can be capable of performing one or more specific functions associated with the module as discussed further below.

In some instances the CTIA server receives an input signal representing an IOC e.g. found or identified on a user computer under attack etc. at the IOC monitor module . The IOC monitor module processes the IOC and sends it to the hash identification module to identify a hash and or other characteristic named observation of the IOC including but not limited to a hash as a unique key the hash including for example any of MD5 SHA1 SHA256 or SHA512 from the IOC. Information of the IOC e.g. an identified hash a timestamp a description etc. can be stored at the IOC data store

The IOC analyzer module may search for IOC e.g. at and or matching malware IOC at the IOC data store . Elements within the IOC data store are related to elements within the malware data store . For example each sample of malware in the malware data store can have for example the SHA256 hash as the unique key and also stores the associated malware as automatically determined by the malware analyzer . Each IOC in the IOC data store can be related to a SHA256 key.

Upon the searches and the IOC analyzer module can obtain and send a found IOC of the threat e.g. a malware sample to the malware analyzer which in turn can retrieve all malware for the threat and a list of all IOCs associated with the found threat at . The found IOCs can be then sent to an IOC cluster analyzer module to generate statistically clustered IOCs from the list of found IOCs . Further discussion on generating statistically clustered IOCs is provided in .

In some instances the threat malware analyzer module can identify a type of the threat based on the hash provided by the hash identification module . For identified threats the IOC analyzer module can search for all IOCs and or malware that are associated with the hash identified by the hash identification module . The IOC analyzer module can search for all IOCs and or malware in the IOC data store and malware data store via the data connection . The IOC cluster analyzer module can then refine the searched IOCs and determine a group of statistically relevant IOCs as the output .

If the IOC cannot be identified at e.g. the received IOC does not contain a previously identified hash or other information the IOC can be directed to special handling e.g. a cyber analyst and or incident responder can review the IOC and determine a next step to process the IOC etc. at . If the IOC is identified at for the one or more input IOCs at the CTIA system can determine whether the threat can be specified by the known IOCs at e.g. whether a sample of malware for the threat is directly identifiable e.g. from the name of the IOC a network address of the source of the IOC etc. .

For unknown threats threat unspecified at the CTIA system can search an IOC data store e.g. see in for existence of IOCs based on a type of the threat the type is identified at step at . The CTIA system can find samples of malware e.g. by hash key SHA256 that contains the IOC at and identify the type of threat associated with these samples of malware in the malware data store e.g. in as determined by the malware analyzer e.g. in .

Continuing on with for the group of identified or known threats the CTIA system can identify a group of all samples of malware each represented by for example a SHA256 hash which have been detected as specified threat at . For example the CTIA system can count a total number of hashes representing all samples of malware for later IOC grouping. The CTIA system can then compile a collective and deduplicated group of all IOCs from each sample of malware represented by a hash SHA256 at and compile a group of IOCs that reaches a relevance threshold to the threat e.g. IOCs from the collective and deduplicated group that are seen in at least a threshold percentage e.g. 50 70 80 90 etc. of the samples of malware related to the threat at and send an output message including the group of relevant IOCs at .

The CTIA system can then determine a characteristic named observation e.g. hashes registry keys file names and paths mutexes imported libraries and functions unique strings or network entity identifiers including domains and IP addresses associated with the found IOC at and then determine or identify the threat that this characteristic named observation has been detected as part of the identified threat in this example it is Win32 Zbot at . The CTIA system can determine all characteristic named observations e.g. hashes etc. of malware that have been detected with the same threat as the identified threat Win32 Zbot at .

Once all characteristic named observations of malware associated with the identified threat Win32 Zbot are determined all IOCs from each characteristic named observation of malware are compiled and processed at e.g. as a first group of IOCs. Continuing on with the group of all IOCs for all Zbot hashes are shown at . The CTIA system then determines statistically relevant IOCs by identifying IOCs from the first group of IOCs that are found within more than a predetermined threshold e.g. 50 70 90 etc. of the samples of malware and these IOCs are put onto a group of IOCs that are statistically relevant e.g. as discussed at in . As shown in the above example the group of statistically relevant IOCs is provided by the CTIA system as an output to be used by incident responders or threat analysts. Incident responders can have a higher probability of identifying and removing infections of virus with the knowledge of relevant IOCs in response to a received IOC e.g. at in .

It is intended that the systems and methods described herein can be performed by software executed on hardware hardware or a combination thereof. Hardware modules can include for example a general purpose processor a field programmable gates array FPGA and or an application specific integrated circuit ASIC . Software modules executed on hardware can be expressed in a variety of software languages e.g. computer code including Clojure C C Java Ruby Python JavaScript Perl PHP Visual Basic and other object oriented procedural functional or other programming language and development tools. Examples of computer code include but are not limited to micro code or micro instructions machine instructions such as produced by a compiler code used to produce a web service and files containing higher level instructions that are executed by a computer using an interpreter. Additional examples of computer code include but are not limited to control signals encrypted code and compressed code.

Some embodiments described herein relate to a computer storage product with a non transitory computer readable medium also can be referred to as a non transitory processor readable medium having instructions or computer code thereon for performing various computer implemented operations. The computer readable medium or processor readable medium is non transitory in the sense that it does not include transitory propagating signals per se e.g. a propagating electromagnetic wave carrying information on a transmission medium such as space or a cable . The media and computer code also can be referred to as code may be those designed and constructed for the specific purpose or purposes. Examples of non transitory computer readable media include but are not limited to magnetic storage media such as hard disks floppy disks and magnetic tape optical storage media such as Compact Disc Digital Video Discs CD DVDs Compact Disc Read Only Memories CD ROMs and holographic devices magneto optical storage media such as optical disks carrier wave signal processing modules and hardware devices that are specially configured to store and execute program code such as Application Specific Integrated Circuits ASICs Programmable Logic Devices PLDs Read Only Memory ROM and Random Access Memory RAM devices.

While various embodiments have been described above it should be understood that they have been presented by way of example only and not limitation. Where methods and steps described above indicate certain events occurring in certain order the ordering of certain steps may be modified. Additionally certain of the steps may be performed concurrently in a parallel process when possible as well as performed sequentially as described above. Although various embodiments have been described as having particular features and or combinations of components other embodiments are possible having any combination or sub combination of any features and or components from any of the embodiments described herein.

