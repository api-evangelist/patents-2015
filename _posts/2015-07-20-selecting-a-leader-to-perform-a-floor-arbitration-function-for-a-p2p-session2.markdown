---

title: Selecting a leader to perform a floor arbitration function for a P2P session
abstract: In an embodiment, a P2P device discovers other P2P devices that belong to a P2P group. The P2P device calculates a reachability vector that indicates each discovered P2P device within a threshold number of P2P hops. The P2P device receives reachability vector(s) for each proximate P2P device in a set of proximate P2P devices discovered via the P2P discovery procedure. The P2P device ranks the P2P device and each proximate P2P device in the set of proximate P2P devices based on the calculated and received reachability vectors. The P2P device identifies a leader (e.g., the P2P device itself and/or one or more of the other P2P devices) that is responsible for performing a floor arbitration function for a P2P session from the ranked P2P devices based on the rankings, and participates in the P2P session by exchanging media in accordance with the floor arbitration function performed by the leader.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09614908&OS=09614908&RS=09614908
owner: QUALCOMM Incorporated
number: 09614908
owner_city: San Diego
owner_country: US
publication_date: 20150720
---
The present application for patent claims priority to Provisional Application No. 62 063 251 entitled SELECTING A LEADER TO PERFORM A FLOOR ARBITRATION FUNCTION FOR A P2P SESSION filed Oct. 13 2014 by the same inventors as the subject application assigned to the assignee hereof and hereby expressly incorporated by reference herein in its entirety.

Embodiments of the invention relate to selecting a leader to perform a floor arbitration function for a peer to peer P2P session.

Wireless communication systems have developed through various generations including a first generation analog wireless phone service 1G a second generation 2G digital wireless phone service including interim 2.5G and 2.75G networks and third generation 3G and fourth generation 4G high speed data Internet capable wireless services. There are presently many different types of wireless communication systems in use including Cellular and Personal Communications Service PCS systems. Examples of known cellular systems include the cellular Analog Advanced Mobile Phone System AMPS and digital cellular systems based on Code Division Multiple Access CDMA Frequency Division Multiple Access FDMA Time Division Multiple Access TDMA the Global System for Mobile access GSM variation of TDMA and newer hybrid digital communication systems using both TDMA and CDMA technologies.

More recently Long Term Evolution LTE has been developed as a wireless communications protocol for wireless communication of high speed data for mobile phones and other data terminals. LTE is based on GSM and includes contributions from various GSM related protocols such as Enhanced Data rates for GSM Evolution EDGE and Universal Mobile Telecommunications System UMTS protocols such as High Speed Packet Access HSPA .

LTE Direct LTE D is a proposed 3GPP Release 12 device to device D2D solution for proximate discovery. LTE D dispenses with location tracking and network calls by directly monitoring for services on other LTE D devices within a large range 500 m line of sight . LTE D operates as a synchronous system that is battery efficient and can concurrently detect thousands of services in proximity.

In an embodiment a P2P device discovers other P2P devices that belong to a P2P group. The P2P device calculates a reachability vector that indicates each discovered P2P device within a threshold number of P2P hops. The P2P device receives reachability vector s for each proximate P2P device in a set of proximate P2P devices discovered via the P2P discovery procedure. The P2P device ranks the P2P device and each proximate P2P device in the set of proximate P2P devices based on the calculated and received reachability vectors. The P2P device identifies a leader e.g. the P2P device itself and or one or more of the other P2P devices that is responsible for performing a floor arbitration function for a P2P session from the ranked P2P devices based on the rankings and participates in the P2P session by exchanging media in accordance with the floor arbitration function performed by the leader.

Aspects of the invention are disclosed in the following description and related drawings directed to specific embodiments of the invention. Alternate embodiments may be devised without departing from the scope of the invention. Additionally well known elements of the invention will not be described in detail or will be omitted so as not to obscure the relevant details of the invention.

The words exemplary and or example are used herein to mean serving as an example instance or illustration. Any embodiment described herein as exemplary and or example is not necessarily to be construed as preferred or advantageous over other embodiments. Likewise the term embodiments of the invention does not require that all embodiments of the invention include the discussed feature advantage or mode of operation.

Further many embodiments are described in terms of sequences of actions to be performed by for example elements of a computing device. It will be recognized that various actions described herein can be performed by specific circuits e.g. application specific integrated circuits ASICs by program instructions being executed by one or more processors or by a combination of both. Additionally these sequence of actions described herein can be considered to be embodied entirely within any form of computer readable storage medium having stored therein a corresponding set of computer instructions that upon execution would cause an associated processor to perform the functionality described herein. Thus the various aspects of the invention may be embodied in a number of different forms all of which have been contemplated to be within the scope of the claimed subject matter. In addition for each of the embodiments described herein the corresponding form of any such embodiments may be described herein as for example logic configured to perform the described action.

A client device referred to herein as a user equipment UE may be mobile or stationary and may communicate with a radio access network RAN . As used herein the term UE may be referred to interchangeably as an access terminal or AT a wireless device a subscriber device a subscriber terminal a subscriber station a user terminal or UT a mobile terminal a mobile station and variations thereof. Generally UEs can communicate with a core network via the RAN and through the core network the UEs can be connected with external networks such as the Internet. Of course other mechanisms of connecting to the core network and or the Internet are also possible for the UEs such as over wired access networks WiFi networks e.g. based on IEEE 802.11 etc. and so on. UEs can be embodied by any of a number of types of devices including but not limited to PC cards compact flash devices external or internal modems wireless or wireline phones and so on. A communication link through which UEs can send signals to the RAN is called an uplink channel e.g. a reverse traffic channel a reverse control channel an access channel etc. . A communication link through which the RAN can send signals to UEs is called a downlink or forward link channel e.g. a paging channel a control channel a broadcast channel a forward traffic channel etc. . As used herein the term traffic channel TCH can refer to either an uplink reverse or downlink forward traffic channel.

Referring to UEs . . . N are configured to communicate with an access network e.g. the RAN an access point etc. over a physical communications interface or layer shown in as air interfaces and or a direct wired connection. The air interfaces and can comply with a given cellular communications protocol e.g. CDMA EVDO eHRPD GSM EDGE W CDMA LTE etc. while the air interface can comply with a wireless IP protocol e.g. IEEE 802.11 . The RAN includes a plurality of access points that serve UEs over air interfaces such as the air interfaces and . The access points in the RAN can be referred to as access nodes or ANs access points or APs base stations or BSs Node Bs eNode Bs and so on. These access points can be terrestrial access points or ground stations or satellite access points. The RAN is configured to connect to a core network that can perform a variety of functions including bridging circuit switched CS calls between UEs served by the RAN and other UEs served by the RAN or a different RAN altogether and can also mediate an exchange of packet switched PS data with external networks such as Internet . The Internet includes a number of routing agents and processing agents not shown in for the sake of convenience . In UE N is shown as connecting to the Internet directly i.e. separate from the core network such as over an Ethernet connection of WiFi or 802.11 based network . The Internet can thereby function to bridge packet switched data communications between UE N and UEs . . . N via the core network . Also shown in is the access point that is separate from the RAN . The access point may be connected to the Internet independent of the core network e.g. via an optical communication system such as FiOS a cable modem etc. . The air interface may serve UE or UE over a local wireless connection such as IEEE 802.11 in an example. UE N is shown as a desktop computer with a wired connection to the Internet such as a direct connection to a modem or router which can correspond to the access point itself in an example e.g. for a WiFi router with both wired and wireless connectivity .

Referring to an application server is shown as connected to the Internet the core network or both. The application server can be implemented as a plurality of structurally separate servers or alternately may correspond to a single server. As will be described below in more detail the application server is configured to support one or more communication services e.g. Voice over Internet Protocol VoIP sessions Push to Talk PTT sessions group communication sessions social networking services etc. for UEs that can connect to the application server via the core network and or the Internet .

Examples of protocol specific implementations for the RAN and the core network are provided below with respect to to help explain the wireless communications system in more detail. In particular the components of the RAN and the core network corresponds to components associated with supporting packet switched PS communications whereby legacy circuit switched CS components may also be present in these networks but any legacy CS specific components are not shown explicitly in .

In the core network includes the above noted SGSN B and potentially a number of other SGSNs as well and a GGSN B. Generally GPRS is a protocol used in GSM for routing IP packets. The GPRS core network e.g. the GGSN B and one or more SGSNs B is the centralized part of the GPRS system and also provides support for W CDMA based 3G access networks. The GPRS core network is an integrated part of the GSM core network i.e. the core network that provides mobility management session management and transport for IP packet services in GSM and W CDMA networks.

The GPRS Tunneling Protocol GTP is the defining IP protocol of the GPRS core network. The GTP is the protocol which allows end users e.g. UEs of a GSM or W CDMA network to move from place to place while continuing to connect to the Internet as if from one location at the GGSN B. This is achieved by transferring the respective UE s data from the UE s current SGSN B to the GGSN B which is handling the respective UE s session.

Three forms of GTP are used by the GPRS core network namely i GTP U ii GTP C and iii GTP GTP Prime . GTP U is used for transfer of user data in separated tunnels for each packet data protocol PDP context. GTP C is used for control signaling e.g. setup and deletion of PDP contexts verification of GSN reach ability updates or modifications such as when a subscriber moves from one SGSN to another etc. . GTP is used for transfer of charging data from GSNs to a charging function.

Referring to the GGSN B acts as an interface between a GPRS backbone network not shown and the Internet . The GGSN B extracts packet data with associated a packet data protocol PDP format e.g. IP or PPP from GPRS packets coming from the SGSN B and sends the packets out on a corresponding packet data network. In the other direction the incoming data packets are directed by the GGSN connected UE to the SGSN B which manages and controls the Radio Access Bearer RAB of a target UE served by the RAN . Thereby the GGSN B stores the current SGSN address of the target UE and its associated profile in a location register e.g. within a PDP context . The GGSN B is responsible for IP address assignment and is the default router for a connected UE. The GGSN B also performs authentication and charging functions.

The SGSN B is representative of one of many SGSNs within the core network in an example. Each SGSN is responsible for the delivery of data packets from and to the UEs within an associated geographical service area. The tasks of the SGSN B includes packet routing and transfer mobility management e.g. attach detach and location management logical link management and authentication and charging functions. The location register of the SGSN B stores location information e.g. current cell current VLR and user profiles e.g. IMSI PDP address es used in the packet data network of all GPRS users registered with the SGSN B for example within one or more PDP contexts for each user or UE. Thus SGSNs B are responsible for i de tunneling downlink GTP packets from the GGSN B ii uplink tunnel IP packets toward the GGSN B iii carrying out mobility management as UEs move between SGSN service areas and iv billing mobile subscribers. As will be appreciated by one of ordinary skill in the art aside from i iv SGSNs configured for GSM EDGE networks have slightly different functionality as compared to SGSNs configured for W CDMA networks.

The RAN e.g. or UTRAN in UMTS system architecture communicates with the SGSN B via a Radio Access Network Application Part RANAP protocol. RANAP operates over a Iu interface Iu ps with a transmission protocol such as Frame Relay or IP. The SGSN B communicates with the GGSN B via a Gn interface which is an IP based interface between SGSN B and other SGSNs not shown and internal GGSNs not shown and uses the GTP protocol defined above e.g. GTP U GTP C GTP etc. . In the embodiment of the Gn between the SGSN B and the GGSN B carries both the GTP C and the GTP U. While not shown in the Gn interface is also used by the Domain Name System DNS . The GGSN B is connected to a Public Data Network PDN not shown and in turn to the Internet via a Gi interface with IP protocols either directly or through a Wireless Application Protocol WAP gateway.

In the core network includes a plurality of Mobility Management Entities MMEs D and D a Home Subscriber Server HSS D a Serving Gateway S GW D a Packet Data Network Gateway P GW D and a Policy and Charging Rules Function PCRF D. Network interfaces between these components the RAN and the Internet are illustrated in and are defined in Table 1 below as follows 

A high level description of the components shown in the RAN and core network of will now be described. However these components are each well known in the art from various 3GPP TS standards and the description contained herein is not intended to be an exhaustive description of all functionalities performed by these components.

Referring to the MMEs D and D are configured to manage the control plane signaling for the EPS bearers. MME functions include Non Access Stratum NAS signaling NAS signaling security Mobility management for inter and intra technology handovers P GW and S GW selection and MME selection for handovers with MME change.

Referring to the S GW D is the gateway that terminates the interface toward the RAN . For each UE associated with the core network for an EPS based system at a given point of time there is a single S GW. The functions of the S GW D for both the GTP based and the Proxy Mobile IPv6 PMIP based S5 S8 include Mobility anchor point Packet routing and forwarding and setting the DiffSery Code Point DSCP based on a QoS Class Identifier QCI of the associated EPS bearer.

Referring to the P GW D is the gateway that terminates the SGi interface toward the Packet Data Network PDN e.g. the Internet . If a UE is accessing multiple PDNs there may be more than one P GW for that UE however a mix of S5 S8 connectivity and Gn Gp connectivity is not typically supported for that UE simultaneously. P GW functions include for both the GTP based S5 S8 Packet filtering by deep packet inspection UE IP address allocation setting the DSCP based on the QCI of the associated EPS bearer accounting for inter operator charging uplink UL and downlink DL bearer binding as defined in 3GPP TS 23.203 UL bearer binding verification as defined in 3GPP TS 23.203. The P GW D provides PDN connectivity to both GSM EDGE Radio Access Network GERAN UTRAN only UEs and E UTRAN capable UEs using any of E UTRAN GERAN or UTRAN. The P GW D provides PDN connectivity to E UTRAN capable UEs using E UTRAN only over the S5 S8 interface.

Referring to the PCRF D is the policy and charging control element of the EPS based core network . In a non roaming scenario there is a single PCRF in the HPLMN associated with a UE s Internet Protocol Connectivity Access Network IP CAN session. The PCRF terminates the Rx interface and the Gx interface. In a roaming scenario with local breakout of traffic there may be two PCRFs associated with a UE s IP CAN session A Home PCRF H PCRF is a PCRF that resides within a HPLMN and a Visited PCRF V PCRF is a PCRF that resides within a visited VPLMN. PCRF is described in more detail in 3GPP TS 23.203 and as such will not be described further for the sake of brevity. In the application server e.g. which can be referred to as the AF in 3GPP terminology is shown as connected to the core network via the Internet or alternatively to the PCRF D directly via an Rx interface. Generally the application server or AF is an element offering applications that use IP bearer resources with the core network e.g. UMTS PS domain GPRS domain resources LTE PS data services . One example of an application function is the Proxy Call Session Control Function P CSCF of the IP Multimedia Subsystem IMS Core Network sub system. The AF uses the Rx reference point to provide session information to the PCRF D. Any other application server offering IP data services over cellular network can also be connected to the PCRF D via the Rx reference point.

In the eHRPD RAN includes a plurality of base transceiver stations BTSs E E and E which are connected to an enhanced BSC eBSC and enhanced PCF ePCF E. The eBSC ePCF E can connect to one of the MMEs D or D within the EPS core network A over an S101 interface and to an HRPD serving gateway HSGW E over A10 and or A11 interfaces for interfacing with other entities in the EPS core network A e.g. the S GW D over an S103 interface the P GW D over an S2a interface the PCRF D over a Gxa interface a 3GPP AAA server not shown explicitly in over an STa interface etc. . The HSGW E is defined in 3GPP2 to provide the interworking between HRPD networks and EPS LTE networks. As will be appreciated the eHRPD RAN and the HSGW E are configured with interface functionality to EPC LTE networks that is not available in legacy HRPD networks.

Turning back to the eHRPD RAN in addition to interfacing with the EPS LTE network A the eHRPD RAN can also interface with legacy HRPD networks such as HRPD network B. As will be appreciated the HRPD network B is an example implementation of a legacy HRPD network such as the EV DO network from . For example the eBSC ePCF E can interface with an authentication authorization and accounting AAA server E via an A12 interface or to a PDSN FA E via an A10 or A11 interface. The PDSN FA E in turn connects to HA E through which the Internet can be accessed. In certain interfaces e.g. A13 A16 H1 H2 etc. are not described explicitly but are shown for completeness and would be understood by one of ordinary skill in the art familiar with HRPD or eHRPD.

Referring to it will be appreciated that LTE core networks e.g. and HRPD core networks that interface with eHRPD RANs and HSGWs e.g. can support network initiated Quality of Service QoS e.g. by the P GW GGSN SGSN etc. in certain cases.

While internal components of UEs such as the UEs A and B can be embodied with different hardware configurations a basic high level UE configuration for internal hardware components is shown as platform in . The platform can receive and execute software applications data and or commands transmitted from the RAN that may ultimately come from the core network the Internet and or other remote servers and networks e.g. application server web URLs etc. . The platform can also independently execute locally stored applications without RAN interaction. The platform can include a transceiver operably coupled to an application specific integrated circuit ASIC or other processor microprocessor logic circuit or other data processing device. The ASIC or other processor executes the application programming interface API layer that interfaces with any resident programs in the memory of the wireless device. The memory can be comprised of read only or random access memory RAM and ROM EEPROM flash cards or any memory common to computer platforms. The platform also can include a local database that can store applications not actively used in memory as well as other data. The local database is typically a flash memory cell but can be any secondary storage device as known in the art such as magnetic media EEPROM optical media tape soft or hard disk or the like.

Accordingly an embodiment of the invention can include a UE e.g. UE A B etc. including the ability to perform the functions described herein. As will be appreciated by those skilled in the art the various logic elements can be embodied in discrete elements software modules executed on a processor or any combination of software and hardware to achieve the functionality disclosed herein. For example ASIC memory API and local database may all be used cooperatively to load store and execute the various functions disclosed herein and thus the logic to perform these functions may be distributed over various elements. Alternatively the functionality could be incorporated into one discrete component. Therefore the features of the UEs A and B in are to be considered merely illustrative and the invention is not limited to the illustrated features or arrangement.

The wireless communication between the UEs A and or B and the RAN can be based on different technologies such as CDMA W CDMA time division multiple access TDMA frequency division multiple access FDMA Orthogonal Frequency Division Multiplexing OFDM GSM or other protocols that may be used in a wireless communications network or a data communications network. As discussed in the foregoing and known in the art voice transmission and or data can be transmitted to the UEs from the RAN using a variety of networks and configurations. Accordingly the illustrations provided herein are not intended to limit the embodiments of the invention and are merely to aid in the description of aspects of embodiments of the invention.

Referring to the communication device includes logic configured to receive and or transmit information . In an example if the communication device corresponds to a wireless communications device e.g. UE A or B one of BSs A through A one of Node Bs B through B one of eNodeBs D through D etc. the logic configured to receive and or transmit information can include a wireless communications interface e.g. Bluetooth WiFi 2G CDMA W CDMA 3G 4G LTE etc. such as a wireless transceiver and associated hardware e.g. an RF antenna a MODEM a modulator and or demodulator etc. . In another example the logic configured to receive and or transmit information can correspond to a wired communications interface e.g. a serial connection a USB or Firewire connection an Ethernet connection through which the Internet can be accessed etc. . Thus if the communication device corresponds to some type of network based server e.g. PDSN SGSN GGSN S GW P GW MME HSS PCRF the application etc. the logic configured to receive and or transmit information can correspond to an Ethernet card in an example that connects the network based server to other communication entities via an Ethernet protocol. In a further example the logic configured to receive and or transmit information can include sensory or measurement hardware by which the communication device can monitor its local environment e.g. an accelerometer a temperature sensor a light sensor an antenna for monitoring local RF signals etc. . The logic configured to receive and or transmit information can also include software that when executed permits the associated hardware of the logic configured to receive and or transmit information to perform its reception and or transmission function s . However the logic configured to receive and or transmit information does not correspond to software alone and the logic configured to receive and or transmit information relies at least in part upon hardware to achieve its functionality.

Referring to the communication device further includes logic configured to process information . In an example the logic configured to process information can include at least a processor. Example implementations of the type of processing that can be performed by the logic configured to process information includes but is not limited to performing determinations establishing connections making selections between different information options performing evaluations related to data interacting with sensors coupled to the communication device to perform measurement operations converting information from one format to another e.g. between different protocols such as .wmv to .avi etc. and so on. For example the processor included in the logic configured to process information can correspond to a general purpose processor a digital signal processor DSP an ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but in the alternative the processor may be any conventional processor controller microcontroller or state machine. A processor may also be implemented as a combination of computing devices e.g. a combination of a DSP and a microprocessor a plurality of microprocessors one or more microprocessors in conjunction with a DSP core or any other such configuration. The logic configured to process information can also include software that when executed permits the associated hardware of the logic configured to process information to perform its processing function s . However the logic configured to process information does not correspond to software alone and the logic configured to process information relies at least in part upon hardware to achieve its functionality.

Referring to the communication device further includes logic configured to store information . In an example the logic configured to store information can include at least a non transitory memory and associated hardware e.g. a memory controller etc. . For example the non transitory memory included in the logic configured to store information can correspond to RAM memory flash memory ROM memory EPROM memory EEPROM memory registers hard disk a removable disk a CD ROM or any other form of storage medium known in the art. The logic configured to store information can also include software that when executed permits the associated hardware of the logic configured to store information to perform its storage function s . However the logic configured to store information does not correspond to software alone and the logic configured to store information relies at least in part upon hardware to achieve its functionality.

Referring to the communication device further optionally includes logic configured to present information . In an example the logic configured to present information can include at least an output device and associated hardware. For example the output device can include a video output device e.g. a display screen a port that can carry video information such as USB HDMI etc. an audio output device e.g. speakers a port that can carry audio information such as a microphone jack USB HDMI etc. a vibration device and or any other device by which information can be formatted for output or actually outputted by a user or operator of the communication device . For example if the communication device corresponds to UE A or UE B as shown in the logic configured to present information can include the display A of UE A or the touchscreen display B of UE B. In a further example the logic configured to present information can be omitted for certain communication devices such as network communication devices that do not have a local user e.g. network switches or routers remote servers etc. . The logic configured to present information can also include software that when executed permits the associated hardware of the logic configured to present information to perform its presentation function s . However the logic configured to present information does not correspond to software alone and the logic configured to present information relies at least in part upon hardware to achieve its functionality.

Referring to the communication device further optionally includes logic configured to receive local user input . In an example the logic configured to receive local user input can include at least a user input device and associated hardware. For example the user input device can include buttons a touchscreen display a keyboard a camera an audio input device e.g. a microphone or a port that can carry audio information such as a microphone jack etc. and or any other device by which information can be received from a user or operator of the communication device . For example if the communication device corresponds to UE A or UE B as shown in the logic configured to receive local user input can include the keypad A any of the buttons A or B through B the touchscreen display B etc. In a further example the logic configured to receive local user input can be omitted for certain communication devices such as network communication devices that do not have a local user e.g. network switches or routers remote servers etc. . The logic configured to receive local user input can also include software that when executed permits the associated hardware of the logic configured to receive local user input to perform its input reception function s . However the logic configured to receive local user input does not correspond to software alone and the logic configured to receive local user input relies at least in part upon hardware to achieve its functionality.

Referring to while the configured logics of through are shown as separate or distinct blocks in it will be appreciated that the hardware and or software by which the respective configured logic performs its functionality can overlap in part. For example any software used to facilitate the functionality of the configured logics of through can be stored in the non transitory memory associated with the logic configured to store information such that the configured logics of through each performs their functionality i.e. in this case software execution based in part upon the operation of software stored by the logic configured to store information . Likewise hardware that is directly associated with one of the configured logics can be borrowed or used by other configured logics from time to time. For example the processor of the logic configured to process information can format data into an appropriate format before being transmitted by the logic configured to receive and or transmit information such that the logic configured to receive and or transmit information performs its functionality i.e. in this case transmission of data based in part upon the operation of hardware i.e. the processor associated with the logic configured to process information .

Generally unless stated otherwise explicitly the phrase logic configured to as used throughout this disclosure is intended to invoke an embodiment that is at least partially implemented with hardware and is not intended to map to software only implementations that are independent of hardware. Also it will be appreciated that the configured logic or logic configured to in the various blocks are not limited to specific logic gates or elements but generally refer to the ability to perform the functionality described herein either via hardware or a combination of hardware and software . Thus the configured logics or logic configured to as illustrated in the various blocks are not necessarily implemented as logic gates or logic elements despite sharing the word logic. Other interactions or cooperation between the logic in the various blocks will become clear to one of ordinary skill in the art from a review of the embodiments described below in more detail.

The various embodiments may be implemented on any of a variety of commercially available server devices such as server illustrated in . In an example the server may correspond to one example configuration of the application server described above. In the server includes a processor coupled to volatile memory and a large capacity nonvolatile memory such as a disk drive . The server may also include a floppy disc drive compact disc CD or DVD disc drive coupled to the processor . The server may also include network access ports coupled to the processor for establishing data connections with a network such as a local area network coupled to other broadcast system computers and servers or to the Internet. In context with it will be appreciated that the server of illustrates one example implementation of the communication device whereby the logic configured to transmit and or receive information corresponds to the network access ports used by the server to communicate with the network the logic configured to process information corresponds to the processor and the logic configuration to store information corresponds to any combination of the volatile memory the disk drive and or the disc drive . The optional logic configured to present information and the optional logic configured to receive local user input are not shown explicitly in and may or may not be included therein. Thus helps to demonstrate that the communication device may be implemented as a server in addition to a UE implementation as in A or B as in .

In accordance with various exemplary embodiments described herein one or more of UE UE UE UE UE and UE may support direct or D2D P2P communications whereby such UEs may support communicating with one another directly without having to communicate through another device or a network infrastructure element such as the first base station and the second base station and also support communications through the network infrastructure elements such as the first base station and or the second base station . In communications that involve network infrastructure signals may generally be transmitted and received through uplink and downlink connections between various UEs and the base stations such as link in the first cell and link in the second cell . Each of the base stations generally serve as the attachment point for the UEs in the corresponding cells and facilitate communications between the UEs served therein. In accordance with one aspect when two or more UEs such as UE and UE wish to communicate with one another and are located in sufficient proximity to each other then a direct P2P link can be established therebetween which may offload traffic from the base station serving the UEs allow UEs to communicate more efficiently or provide other advantages that will be apparent to those skilled in the art.

As shown in the UE can communicate with UE through intermediate base station via link and UEs may further communicate via a P2P link . Furthermore for inter cell communications where the participating UEs are in different nearby cells a direct P2P communications link is still a possibility which is illustrated in where UE and UE may communicate using direct P2P communications illustrated by dashed link .

LTE Direct LTE D is a proposed 3GPP Release 12 device to device D2D solution for proximate discovery. LTE D dispenses with location tracking and network calls by directly monitoring for services on other LTE D devices within a large range 500 m line of sight . LTE D operates as a synchronous system that is battery efficient and can concurrently detect thousands of services in proximity. LTE D has a wider range than other D2D P2P technologies such as WiFi Direct WFD or Bluetooth.

LTE D operates on licensed spectrum as a service to mobile applications. LTE D is a device to device D2D solution that enables service layer discovery and also D2D communication. Mobile applications on LTE D devices can instruct LTE D to monitor for mobile application services on other devices and announce their own services for detection by services on other LTE D devices at the physical layer. This allows the applications to be closed while LTE D does the work continuously and notify the client application when it detects a match to a monitor established by an associated application. For example the application can establish a monitor for tennis events and the LTE D discovery layer can wake up the application when a tennis related LTE D message is detected.

LTE D is thus an attractive alternative to mobile developers seeking to deploy proximate discovery solutions as extensions of their existing cloud services. LTE D is a distributed discovery solution versus the centralized discovery that exists today whereby mobile applications forego centralized database processing in identifying relevancy matches instead autonomously determining relevance at the device level by transmitting and monitoring for relevant attributes. LTE D offers certain benefits in terms of privacy as well as power consumption in that LTE D does not utilize perpetual location tracking to determine proximity. By keeping discovery on the device rather than in the cloud the user has more control of what information is shared with external devices.

LTE D relies upon Expressions for both discovery of proximate peers and facilitating communication between proximate peers. Expressions at the application or service layer are referred to as Expression Names e.g. ShirtSale Gap.com Jane Facebook.com etc. . Expression Names at the application layer are mapped to bit strings at the physical layer that are referred to as Expression Codes . In an example each Expression Code can have a length of 192 bits e.g. 11001111 . . . 1011 etc. . As will be appreciated any reference to a particular Expression can be used to refer to the Expression s associated Expression Name Expression Code or both depending upon the context. Expressions can be either Private or Public. Public Expressions are made public and can be identified by any application whereby Private Expressions are targeted for specific audiences. Expressions can be configured to identify and characterize LTE D groups or alternatively can be configured to identify and characterize individual LTE D devices.

Public Expressions can be externally provisioned by a server AES in which case the Public Expressions are referred to as public managed expressions which can be provisioned at the LTE D device via out of band signaling. Public Expressions can alternatively be managed locally by the client application on the LTE D device itself in which case the Public Expressions are referred to as unmanaged expressions.

Discovery in LTE D operates in a synchronous manner based on parameters that are configured by the LTE network itself. For example frequency division duplexing FDD and or time division duplexing TDD may be assigned by a serving eNode B via a Session Information Block SIB . The serving eNode B can also configure an interval at which LTE D devices to are announce themselves e.g. every 20 seconds etc. via transmission of a Service Discovery or P2P Discovery message. For example for a 10 MHz FDD system the eNode B can allocate 44 Physical Uplink Shared Channel PUSCH radio bearers RBs to be used for discovery in accordance with a discovery period that occurs every 20 seconds and includes 64 sub frames such that the number of direct discovery resources DRIDs is 44 64 2816.

For example assume that each LTE D device periodically transmits an individual P2P discovery message or I P2PDM at the 20 second interval. Each I P2PDM individually identifies the LTE D device that transmits the I P2PDM. For example in LTE D the I P2PDM can include the Private or Public Expression for the associated LTE D device. One or more LTE D devices that belong to a particular LTE D group may also be assigned the task of periodically transmitting a group P2P discovery message or G P2PDM on a periodic basis which may be the same or different from the interval at which the I P2PDMs are transmitted. In LTE D the G P2PDM can include the Private or Public Expression for the associated LTE D group itself as opposed to the I P2PDM which carried the Private or Public Expression for an individual LTE D device. In an example less than all of the LTE D group members may be asked to transmit the G P2PDM to reduce interference and improve battery life in scenarios where a high number of proximate LTE D group members are present.

For successful half duplex group communication in a P2P environment in direct mode e.g. LTE D WiFi Direct or any other direct mode without wireless local area network WLAN or wireless wide area network WWAN support for data transfer proper selection of a floor arbitrator for half duplex communication sessions is crucial for effective floor management. Conventional selection schemes for a floor arbitrator in direct mode in P2P environments generally do not account for mobility require a fully connected topology where each session participant is in direct communication range with each other session participant i.e. no hops can suffer from misallocation of floor resources e.g. one session participant is starved for floor access while another session participant hogs the floor there is a single point of failure e.g. the session may be fail if the floor arbitrator moves out of range of the other session participants or otherwise drops out of the session and in session latency performance may be reduced somewhat as a result of identifying the floor arbitrator during the session. Some of these issues related to conventional floor arbitration schemes are shown below with respect to .

In assume that the floor arbitrator selection scheme for the P2P group is that the floor arbitrator for the P2P session is set to the session originator. This is a simple way to select the floor arbitrator but has certain drawbacks e.g. the session may terminate automatically if the session originator drops out of the session the session originator may not be in an optimal position relative to the other session participants for performing the floor arbitration function etc. . Accordingly each of UEs and . . . N agree to join the P2P session initiated by UE with UE established as floor arbitrator for the P2P session by virtue of being the session originator . Also UE is established as the initial floorholder for the P2P session by virtue of being the session originator .

At this point UE begins to transmit media over the P2P interface to the UEs and . . . N . At some later point during the P2P session UE sends a floor request to UE e.g. via a unicast message over the P2P interface which can alternatively be referred to as a unicast channel of the P2P interface . The floor request is granted by UE and UE sends a floor grant message back to UE e.g. via a unicast message . UE also notifies UEs . . . N that UE is the new floorholder for the P2P session .

At this point UE begins to transmit media over the P2P interface to the UEs . . . N . At some later point during the P2P session assume that UE leaves the P2P session e.g. UE moves outside of direct communication range with one or more of UEs . . . N an operator of UE decides to end participation in the session etc. . After UE leaves the P2P session UE sends a floor request to UE e.g. via a unicast message . The floor request is granted by UE and UE sends a floor grant message back to UE e.g. via a unicast message . UE also notifies UEs and . . . N that UE is the new floorholder for the P2P session . At this point UE begins to transmit media over the P2P interface to the UEs and . . . N . At some later point during the P2P session assume that UE determines to end the P2P session . UE thereby messages the remaining session participants i.e. UEs . . . N to notify them of the session termination and .

Referring to assume that UEs . . . N belong to a P2P group are in direct communication range of each other and perform a P2P discovery procedure to detect each other s presence . The P2P discovery procedure can be conducted over a P2P interface in an example such as an LTE D discovery interface or a WiFi Direct discovery interface. At some later point in time while UEs . . . N are still in direct communication range with each other UE originates and initiates setup of a P2P session . Each of UEs and . . . N agree to join the P2P session initiated by UE with UE established as the initial floorholder for the P2P session and thereby also established as the initial floor arbitrator for the P2P session by virtue of being the floorholder and .

At this point UE begins to transmit media over the P2P interface to the UEs and . . . N . At some later point during the P2P session UE sends a floor request to UE e.g. via a unicast message . The floor request is granted by UE and UE sends a floor grant message back to UE e.g. via a unicast message . The P2P group is notified that UE is the new floorholder for the P2P session . Further because the floor arbitrator selection scheme for the P2P group in is that the floor arbitrator for the P2P session is set to a current floorholder UE also becomes the new floor arbitrator for the P2P session and the P2P group is notified of the floor arbitrator transition .

Referring to UE begins to transmit media over the P2P interface to the UEs . . . N . At some later point during the P2P session UE sends a floor request to UE e.g. via a unicast message . The floor request is granted by UE and UE sends a floor grant message back to UE e.g. via a unicast message . The P2P group is notified that UE is the new floorholder for the P2P session . Further because the floor arbitrator selection scheme for the P2P group in is that the floor arbitrator for the P2P session is set to a current floorholder UE also becomes the new floor arbitrator for the session and the P2P group is notified of the floor arbitrator transition . At this point UE begins to transmit media over the P2P interface to the UEs . . . N . At some later point during the P2P session assume that UE determines to end the communication session . UE thereby messages the remaining session participants i.e. UEs and . . . N to notify them of the session termination and .

As noted above describe half duplex group communication sessions that occur in a P2P environment that has a network topology suitable for direct communication between all session participants. An example of this type of P2P network topology is shown in via P2P network topology .

Referring to assume that UEs A . . . D are each part of the same P2P group and are equipped with P2P communication hardware e.g. an LTE D transceiver a WiFi Direct transceiver etc. that permits UEs A . . . D to directly communicate via a P2P interface with one or more other P2P devices within direct communication ranges A . . . D respectively. In each of UEs A . . . D is positioned within an overlapping direct communication range region of each other UE such that UEs A . . . D can each directly communicate with each other via the P2P interface without having to hop to any intermediate P2P nodes. For the P2P network topology shown in there is no single point of failure and there are multiple reasonable floor arbitration candidates because each P2P device is within direct communication range of each other P2P device.

While the P2P network topology of represents ideal conditions for P2P communication other P2P network topologies do not necessarily support direct communication between all P2P group members. For example illustrates a P2P network topology A which may be referred to as a star topology because at least one node i.e. UE B can reach all other P2P devices while other nodes i.e. UEs A and C cannot do so. In the P2P network topology A UEs A and B are positioned within each other s respective direct communication ranges A and B respectively and UEs B and C are also positioned within each other s respective direct communication ranges B and C respectively. However UEs A and C are not positioned within each other s respective direct communication ranges A and C respectively. Accordingly for UEs A and B to communicate with each other via the P2P interface any traffic needs to hop to UE B as a mediating P2P node. As will be appreciated the floor arbitrator selection schemes discussed above with respect to will not necessarily pick the most appropriate P2P device to be floor arbitrator for star network topologies which in is UE B.

In Table 2 above a 1 indicates two UEs that are in direct communication range of each other a 0 indicates two UEs that are not in direct communication range of each other and a dash or is used when the UE in the column matches the UE in the row. As will be appreciated the relatively complex network topology shown in is suggestive that the floor arbitrator selection schemes discussed above with respect to will not necessarily pick the most appropriate P2P device to be floor arbitrator for the P2P network topology B. Reachability matrices will be explained in more detail below with respect to .

In Table 3 above a 1 indicates two UEs that are in direct communication range of each other a 0 indicates two UEs that are not in direct communication range of each other and a dash or is used when the UE in the column matches the UE in the row. As will be appreciated the relatively complex network topology shown in is suggestive that the floor arbitrator selection schemes discussed above with respect to will not necessarily pick the most appropriate P2P device to be floor arbitrator for the P2P network topology C. Reachability matrices will be explained in more detail below with respect to .

Embodiments of the invention are directed to selecting a floor arbitration selection for a half duplex group communication session based upon reachability vectors that are shared between two or more proximate P2P devices registered to a P2P group as will be discussed below with respect to . Moreover as used herein half duplex group communication sessions encompass sessions where a single participant can access the floor at any given time or sessions where multiple participants but less than all participants can access the floor at any given time. Half duplex group communication sessions where multiple participants can transmit media e.g. speech to the P2P group while one or more other session participants can only receive media are sometimes referred to as hybrid duplex group communication sessions. While embodiments described below primarily focus on single floorholder half duplex group communication sessions it will be appreciated that these embodiments can alternatively be applied to a hybrid duplex implementation. In a hybrid duplex implementation the floor arbitrator may receive unicast media feeds from the multiple floorholders and then perform a mixing operation to provide a mixed output frame for delivery to the P2P group or alternatively the media feeds from the multiple floorholders can be multicasted to the P2P group for local mixing operations.

Still referring to the P2P discovery procedure of can be triggered in a variety of ways. For example the P2P device can be triggered when the P2P device detects the presence of one or more proximate P2P devices that also belong to the P2P group. For example the detection that triggers the P2P discovery procedure of can occur in response to the P2P device receiving an I P2PDM from another P2P device that is also registered to the P2P group e.g. based on the P2P device comparing an identifier from the I P2PDM with a list of registered P2P devices for the P2P group to make the group association or the P2P device receiving a G P2PDM that identifies the P2P group and so on. In a more specific LTE D example the P2P discovery procedure of can be triggered when a number of duplicate group Expressions exceeds a threshold.

In an alternative embodiment the P2P discovery procedure of can be triggered manually or user triggered by one or more members of the P2P group. In an alternative embodiment the P2P discovery procedure of can be triggered via external signaling e.g. some other proximate P2P device makes the determination to perform P2P discovery for any of the above noted reasons and the P2P device simply complies with the externally triggered P2P discovery procedure . The P2P discovery procedure of can be triggered based on rules that are either user specified or based on machine learning in other embodiments e.g. entry of the P2P device into proximity of a particular location or area of interest a measured environmental parameter such as time ambient temperature ambient brightness level ambient noise level and or ambient humidity level or any combination thereof such as at a particular shopping mall between 5 7 PM on Saturdays during the summer .

Referring to after performing the initial P2P discovery procedure of the P2P device calculates a reachability vector that indicates each discovered P2P device in the P2P group that is within a threshold number of hops to the P2P device via the P2P interface . In an example the threshold number of hops can be one such that the reachability vector is calculated for P2P devices that are in direct communication range of the P2P device. However the reachability vector could alternatively be multi hop oriented e.g. a vector of P2P devices that are within two 2 hops of the P2P device and so on . Using the P2P network topology C from as an example the reachability vectors for U is shown in Table 4 below 

The reachability vector shown in Table 4 above is a simplified version whereby a 1 indicates two UEs that are in direct communication range of each other a 0 indicates two UEs that are not in direct communication range of each other and a dash or is used when the UE in the column matches the UE in the row. However a more generic framework or template for reachability vectors with an example of eight 8 total P2P devices is as follows 

In Table 5 above the value W that represents the reachability value between a source UE and a target UE such that Wcorresponds to the reachability value between U and U and so forth. Using Table 5 the reachability vector for U can be expressed as follows 1 Equation 1

whereby Qis a resource parameter that indicates a degree to which resources can be allocated by User I for an incoming request from User J. The value of Q can depend on several factors such as device type e.g. smart phone rugged etc. connectivity type e.g. WiFi WAN etc. operating system OS e.g. Android iOS etc. battery life and so on. Generally lower values for Q denote low resource availability while higher values for Q denote high resource availability. For example Qcan be equal to a non binary numerical value that is the sum of parameters representative of phone type connectivity battery life mobility e.g. a high mobility characteristic may lower the value of Q because the given P2P device is expected to move away from the P2P group whereas a low mobility characteristic may increase the value of Q because the given P2P device is expected to stay within P2P range etc. whether a location of the given P2P device is in proximity to a particular area of interest e.g. if the given P2P device is near an area where the given P2P is typically plugged in for charging Qmay be weighted to increase the given P2P device s likelihood of becoming leader and vice versa if the given P2P device is operated by a supervisory user of a particular area such as a teacher at school Qmay be weighted to increase the given P2P device s likelihood of becoming leader if the given P2P device is operated by a subordinate user of a particular area such as a student at school Qij may be weighted to decrease the given P2P device s likelihood of becoming leader and so on expected time to live TTL in the environment e.g. an expected time a given P2P device is expected to stay connected to the P2P group via the P2P interface which can be based on the mobility of the given P2P device relay support e.g. a capacity to act as a relay for forwarding media and or signaling or any combination thereof and

whereby is a scaling factor whereby 1 denotes higher preference towards reachability whereas 0 denotes higher preference towards resource availability. Accordingly the reachability vector shown in Table 4 above can be calculated using Equations 1 2 in an example.

Referring to after the P2P device knows its own reachability vector but does not yet know the reachability vectors of the other proximate P2P devices and thereby has limited visibility regarding P2P devices that are more than the threshold number of hops away from the P2P device. The P2P device thereby receives a reachability vector for each proximate P2P device in a set of proximate P2P devices discovered via the P2P discovery procedure each received reachability vector indicating each P2P device in the P2P group that is within the threshold number of hops to the proximate P2P device via the P2P interface . The set of proximate P2P devices can correspond to the P2P devices in direct communication range with the P2P device e.g. single hop as shown in the example related to and Tables 9 10 below or can correspond to each proximate P2P device in the P2P group e.g. reachable via single hop or multi hop as shown in the example related to Table 8 below . In an example the reachability vector s that are received at can be received over the P2P interface of the P2P group. While not shown explicitly in the P2P device can also transmit its own calculated reachability vector that was calculated at to each proximate P2P device in the set of proximate P2P devices either via single hop or multi hop.

The P2P device ranks both itself and the proximate P2P devices from the set of proximate P2P devices based on a combination of the calculated reachability vector from and the received reachability vector s from . The P2P device can use the calculated reachability vector from and the received reachability vector s from to construct a reachability matrix that includes the respective reachability vectors along with a leader score for each vector whereby the leader scores are used to determine the rankings. Examples of how the P2P device can rank the respective P2P devices will now be discussed.

In a single hop network topology example of the ranking that occurs at a reachability matrix along with the associated leader scores for the P2P network topology of may be as follows with the assumption that 1 such that the resource parameter Q has no impact on Equation 1 

Because UEs A . . . D are each in direct communication or a single hop away from each other the leader scores for UEs A . . . D are the same when 1. Next consider the scenario where 0 and further assume that UEs C D have strong connectivity and high battery power whereas UEs A B are very weak on battery level. This means that it is more appropriate for UE C or UE D to be the leader in this scenario and the reachability matrix in this scenario can be expressed as follows 

From Table 7 above UEs A and B have very low leader scores and are not considered for leadership of the P2P group. However UEs C and D are tied for leadership. When this occurs a tie breaking procedure can be executed to select between UEs C and D to be the leader of the P2P group. In an example the tie breaking procedure can include UEs C or D generating a random number and sending the random number to the other UE which generates its own random number for comparison with the UE that generates the highest random number being the leader. After a leader is selected the rest of the P2P group is notified of the leader selection or identification . For example a leader confirmation message can be sent out to each proximate P2P member in the P2P group so that there is no leader confusion. Also the selected leader can further convey a list of backup leaders in case the selected leader loses its capacity to be leader e.g. moves out of range etc. . So using Table 7 as an example if UE C is the selected leader UE C can notify the P2P group that UE D is the back up leader. As will be appreciated the UE that performs the leader selection identifies the leader as soon as the selection is made at whereas the other UEs identify the leader at once they receive the leader confirmation message.

In a multi hop network topology example of the ranking that occurs at a reachability matrix along with the associated leader scores for the P2P network topology C of may be as follows with the assumption that 1 such that the resource parameter Q has no impact on Equation 1 

From Table 8 above UEs U and U have the highest leader scores. Accordingly a tie breaking procedure can be executed to select between UEs U and U to be the leader of the P2P group. In an example the tie breaking procedure can include UEs U or U generating a random number and sending the random number to the other UE which generates its own random number for comparison with the UE that generates the highest random number being the leader. In another example while not shown expressly in Table 8 the P2P device can also factor the number of exclusions i.e. the number of P2P devices that UEs with the highest leader score cannot directly communicate. In U has two exclusions i.e. U and U and U also has two exclusions i.e. U and U so the exclusion number would not be used as the tie breaker in this particular example because the two numbers are the same but in other embodiments the exclusion number can be used as part of the tie breaking procedure e.g. the selected leader is the leader with the lowest exclusion number from among the UEs with the highest leader scores .

In another multi hop network topology example of the ranking that occurs at the reachability matrices constructed by each P2P device only include the reachability vectors for the P2P devices that are in direct communication range. Using the example P2P network topology C of as an example the reachability matrices for would be as follows in this scenario where 1 

From Tables 9 10 above U lacks the reachability vectors for U and U whereas U lacks the reachability vectors for U and U. U has two exclusions from self U and U and U also has two exclusions from self U and U . So U would have two exclusions if selected as the leader and U would also have two exclusions if selected as the leader. Assume that U decides to try to be the leader and sends out a leader announcement 1 as shown in which illustrates the P2P network topology C from with additional messaging. U receives the leader confirmation but decides that it also wants to be the leader and thereby triggers the tie breaking procedure 2 e.g. generate and send a random number to U etc. . U then executes the tie breaking procedure e.g. by generating its own random number and comparing the random number to U s random number and picking the UE with the higher number as the leader etc. after which U sends a lead confirmation message 3 to the P2P group to announce the selected leader U or U . In this case whichever UE U or U is not selected as the leader may act as a relay point for P2P group communication. For example if U is selected as the leader U may transmit to U and U U with U re transmitting via multicast or unicast any of U s transmissions that are directed to U or U or alternatively U or U may transmit to U with U re transmitting via multicast or unicast any of U or U s transmissions directed to any of U U.

After a leader is selected the rest of the P2P group is notified of the leader selection or identification . For example a leader confirmation message can be sent out to each proximate P2P member in the P2P group so that there is no leader confusion. Also the selected leader can further convey a list of backup leaders in case the selected leader loses its capacity to be leader e.g. moves out of range etc. . So using Table 8 as an example if U is the selected leader U can notify the P2P group that U is the back up leader. As will be appreciated the UE that performs the leader selection identifies the leader as soon as the selection is made at whereas the other UEs identify the leader at once they receive the leader confirmation message.

The purpose of the leader selection of is specifically to identify the P2P device that will be responsible at least initially for performing a floor arbitration function for a half duplex group communication session via P2P. However the selected leader can also optionally act as a media relay to accommodate multi hop network topologies. Accordingly at some point after the leader is selected at which can be delayed somewhat as the floor arbitrator or leader can potentially be identified before any P2P device actually wants to originate a P2P session the P2P device participates in the P2P session by exchanging media with one or more other P2P devices from the set of proximate P2P devices in accordance with the floor arbitration function performed by the identified leader would could potentially be the P2P device itself or alternatively one of the other P2P devices . Optionally the floor arbitration function may be transferred from the selected leader to a different P2P device at some point during the P2P session . For example the process of may periodically repeat during the P2P session to ensure that the selected leader is still appropriate to handle the floor arbitration function. In another example the selected leader may move out of range and drop out of the P2P session altogether which necessitates a new leader to be selected. For example the selected leader may transmit a heartbeat i.e. a periodic keep alive message and the process of can be triggered to select a new leader whenever the heartbeat gets too weak or simply stops altogether. In an example the heartbeat can be transmitted exclusively by the current floor arbitrator or by a subset of nodes in the P2P group e.g. the floor arbitrator plus one or more proxy nodes such as floor arbitrator back ups .

Referring to assume that UEs . . . N belong to or are registered to a P2P group and that UEs . . . N engage in a P2P discovery procedure so as to identify proximate P2P group members of the P2P group e.g. similar to of . As discussed above with respect to the P2P discovery procedure of can be triggered in a variety of ways e.g. detection by at least one of UEs . . . N that a threshold number or quorum of P2P group members is present based upon receive of one or more I P2PDMs or G P2PGMs in response to user input to trigger the P2P discovery procedure in response to an event based trigger such as time and or location in response to environmental condition s in response to a signal from an external device etc. .

After performing the P2P discovery procedure of UEs . . . N each calculate a reachability vector e.g. as in of . UEs . . . N then share the calculated reachability vectors with each other e.g. as in of . As will be appreciated in a multi hop network topology some of the calculated reachability vectors will need to be relayed or forwarded by at least one intermediate UE to be shared with each of the UEs in the P2P group at . UEs and . . . N next rank the UEs from which reachability vectors are received based upon their own calculated reachability vectors from in combination with the received reachability vectors from the other UEs at and . Assume that UEs . . . N each determine that UEs and have the highest leader score after which UEs and engage in a tie breaker procedure with UE wins . UE thereby becomes the selected leader and the P2P group is notified that UE will be performing the floor arbitration function as the selected leader via a leader confirmation message e.g. as in of .

At some later point in time UE sends a unicast message to UE to request origination of a half duplex group communication session or P2P session with the P2P group . UE sets up the P2P session in response to the request which establishes UE as the initial floorholder for the P2P session . Once UE is established as the floorholder in UE begins to stream or multicast media to the P2P group . Based on the P2P network topology the media can be streamed at either in a direct manner from UE to the other P2P session participants or via a hopping relay whereby UE transmits the media to the current floor arbitrator i.e. UE which in turn re transmits UE s media to other UEs in the P2P session via multicast. At some later point during the P2P session UE sends a floor request message via unicast to UE and UE sends a floor grant message to UE via unicast . At this point UE is established as the new floorholder for the P2P session and the rest of the participating P2P devices are notified of the new floorholder . Once UE is established as the floorholder in UE begins to stream or multicast media to the P2P group e.g. via direct transmission or multi hop relay .

Referring to at some later point in the P2P session while media is being streamed or multicasted from UE to the rest of the P2P group e.g. via direct transmission or multi hop relay the current floor arbitrator i.e. UE drops out of the P2P session or moves out of range of the rest of the P2P group and can no longer perform the floor arbitration function for the P2P session . Of course in other examples a different trigger could occur to prompt a new floor arbitrator to be selected e.g. a manual selection by one or more priority users an environmental status change or location change a battery level of UE dropping too low a change to the P2P network topology etc. . UE dropping out of the P2P session functions to trigger UEs and . . . N to perform the P2P discovery procedure again e.g. similar to of . For example one or more of UEs and . . . N may detect that a threshold period of time has elapsed since the last heartbeat or periodic keep alive packet from UE has been received from which the one or more UEs infer that UE has dropped out of the P2P session for some reason.

UEs and . . . N recalculate their respective reachability vectors and e.g. similar to and of and then share their reachability vectors with each other e.g. similar to of . UEs and . . . N next rank themselves along with the UEs from which reachability vectors are received based on the received reachability vectors and e.g. similar to and of . Assume that UEs and . . . N each determine that UE has the highest leader score and after which UE is confirmed as the leader via a leader confirmation message e.g. similar to of .

At this point UE continues to stream or multicast media to the P2P group e.g. via direct transmission or multi hop relay in addition to taking over responsibility for performing the floor arbitration function. At some later point during the P2P session UE sends a floor request message via unicast to UE and UE sends a floor grant message to UE via unicast . At this point UE is established as the new floorholder for the P2P session and the rest of the participating P2P devices are notified of the new floorholder . Once UE is established as the floorholder in UE begins to stream or multicast media to the P2P group e.g. via direct transmission or multi hop relay .

While not shown explicitly in if UE is able to re establish its connection to the P2P session UE may resume its role as floor arbitrator for the P2P session e.g. either automatically if occurring within a threshold period of time from the dropout of or by virtue of re triggering the process of .

Referring to at some later point in the P2P session while media is being streamed or multicasted from UE to the rest of the P2P group e.g. via direct transmission or multi hop relay a new UE i.e. UE X joins the P2P session B. UE X joining the P2P session functions to trigger UEs . . . N and X to perform the P2P discovery procedure again B. UEs and . . . N recalculate their respective reachability vectors and UE X calculates its reachability vector B B B and B and then UEs . . . N and X share their reachability vectors with each other B. UEs . . . N and X next rank themselves along with the UEs from which reachability vectors are received based on the received reachability vectors along with their own calculated reachability vectors B B B and B. Assume that UEs . . . N and X each determine that UE X has the highest leader score B B B and B after which UE X is confirmed as the leader via a leader confirmation message B.

At this point UE continues to stream or multicast media to the P2P group e.g. via direct transmission or relay through UE X B while UE X takes over responsibility for performing the floor arbitration function. At some later point during the P2P session UE sends a floor request message via unicast to UE X B and UE X sends a floor grant message to UE via unicast B. At this point UE is established as the new floorholder for the P2P session and the rest of the participating P2P devices are notified of the new floorholder B. Once UE is established as the floorholder in B UE begins to stream or multicast media to the P2P group e.g. via direct transmission or multi hop relay B.

While not illustrated explicitly for multi hop network topologies it is possible that multiple leaders could be selected. Using the P2P network topology C from as an example both U and U could be selected as leaders that coordinate with each other to control the overall P2P group. In this case the floor arbitration function can be performed in parallel e.g. both U and U have the power to grant the floor revoke the floor etc. or alternatively there can be one master leader and one slave leader with the master leader performing the actual floor arbitration function and the slave leader performing a relay or forwarding function. For example if U is the master leader U may send a floor request to U under the assumption that U is the leader while U forwards the floor request to U instead of directly making any floor arbitration decisions itself. In this case for the sake of efficiency U would send its own floor request messages directly to U to avoid the necessity for U to forward U s signaling messages to U. The same type of rules could also be used for media forwarding in a master slave leader configuration. Also for larger multi hop network topologies with more hops there could be additional slave leaders and potentially additional master leaders as well.

P2P discovery occurs over a defined P2P discovery channel of the P2P interface after which signaling and media for P2P sessions occur via unicast or multicast. A unicast P2P message is sent from one P2P node to one target P2P node whereas a multicast P2P message can be received by multiple target P2P nodes. For example in the process of the P2P discovery procedure of occurs over the P2P discovery channel the media of or is shared over a multicast media channel or in part a unicast media channel e.g. media can be sent to a relay point via unicast and then multicasted from the relay while any signaling after the P2P discovery procedure e.g. and of occurs via unicast.

Referring to the P2P device determine a multicast address to be used for signaling related to floor arbitration of a P2P session with the P2P group . The multicast address can be determined in a variety of ways as will now be explained.

In a first example the multicast address can be pre assigned or pre provisioned at each P2P device registered to the P2P group. For example each P2P device can be required to registered to the P2P group with an external device e.g. an external server and the external server can provision the P2P devices with the pre assigned multicast address during registration. In another example the external server can send the multicast address to the P2P devices registered to the P2P group at some point after registration.

In a second example specific to LTE D the multicast address can be derived as an IPv6 address from an Expression associated with the P2P group. An example IPv6 multicast address format is as follows 

The IPv6 prefix shown in Table 11 above can be defined based on operator policy for link local addresses for P2P service. The Flags field shown in Table 11 and again in Table 12 in more detail can be set to indicate the Transient flag to show a dynamically assigned multicast address. The scope field shown in Table 11 above can be set to link local or organization local or site local depending on operator and service policy which can be predetermined e.g. known to each P2P device in the P2P group which permits independent derivation of the IPv6 multicast address . The remainder of the IPv6 multicast address can then incorporate bits from the Group ID B using a hash function as described below in more detail.

Referring back to the unique Group ID B for the P2P group is known to each P2P device registered to the P2P group and can thereby be used for independent derivation of the multicast address to be used for signaling in an example. In particular to construct the 112 bit Group ID field for the multicast address using IPv6 as shown in Table 11 above the Group ID B can be hashed along with an application specific string e.g. which can be provisioned with a client application that supports P2P sessions on each of the registered P2P devices such as a PTT specific string and so on to produce the 112 bit Group ID field for the IPv6 multicast address using any suitable hashing algorithm. In an example hashing algorithm for computing the IPv6 multicast address the 112 least significant bits LSBs from the output of the SHA 256 hashing function with input as Group ID B along with and application specific string can be combined so as to produce the IPv6 multicast address. However it will be appreciated that this is a mere example and any suitable hashing algorithm can be used to combine the Group ID B with the application specific string potentially based on other parameters as well if the other parameters are available at each P2P group member. As will be appreciated a defined multicast address derivation rule combined with information e.g. the Group ID B available to each registered P2P device permits the multicast address to be independently derived at each registered P2P device without any coordination or signaling during discovery or session setup although the capability of independent derivation does not imply that such coordination or signaling is actually prohibited during discovery and or session setup .

In a further example the multicast address determined at can either be determined during or after the P2P discovery procedure from or can alternatively occur at some earlier point in time and then stored locally at the P2P device. Thus the determination of can either be a mathematical derivation operation or alternatively an operation of loading a stored multicast address from memory at the P2P device.

Referring to the P2P device exchanges signaling with one or more of the discovered P2P devices over a multicast signaling control channel of the P2P interface using the multicast address determined at . In particular the multicast signaling control channel is defined based on the usage of the multicast address so the multicast channel could overlap with the discovery channel in terms of physical resources e.g. frequency allocation etc. while being distinguished from the discovery channel by virtue of the multicast address. As will be described in greater detail below the signaling exchanged at over the multicast signaling control channel can be exchanged before setup of a P2P session e.g. for leader or floor arbitrator selection heartbeats etc. or during the P2P session e.g. for in session signaling such as call announcements floor change notifications floor arbitrator change notifications call termination notifications etc. . Also the multicast signaling control channel is not necessarily the only control channel used for signaling with the P2P group as a unicast channel can also be used for signaling e.g. to exchange one to one signaling messages such as session origination messages floor request messages floor grant messages and so on . As used herein a unicast channel in is any P2P connection established between two P2P nodes any reference to the unicast channel simply implies that the two referenced P2P nodes are communicating via a point to point communication and not to imply any particular physical resource commonality to another unicast channel used between a different pair of P2P nodes. In a further example the multicast signaling control channel can be a dedicated multicast signaling control channel that only includes signaling messages no media . However in another example it is also possible that at least media be sent using the multicast channel. Generally speaking however media will be sent using a separate media channel so that the P2P devices can distinguish between signaling data using the multicast address.

In another example separate multicast addresses can be generated for delivering different types of data using the same approach or a similar approach as described above with respect to the Group ID hashing procedure using either a different application specific string thereby resulting in a different multicast address once combined with the hashed Group ID. For example each P2P device registered to the P2P group can be provisioned with multiple application specific strings that are each associated with a particular data type e.g. control signaling in call signaling call set up signaling media or any combination thereof . This permits independent derivation of multiple multicast addresses at the respective P2P devices. So the multicast signaling control channel can use several different multicast addresses e.g. two or more multicast addresses for control signaling in call signaling call set up signaling or any combination thereof or a single multicast address for any type of multicast signaling e.g. a single multicast addressed used by the P2P group for control signaling in call signaling and call set up signaling . As another example while not strictly necessary in all embodiments multicast media transmissions can also use a multicast address that is independently derived using an application specific string for media combined with a hash of the Group ID B.

After the P2P discovery procedure of the P2P device identifies a leader for the P2P group that is responsible for performing a floor arbitration function for any P2P session that originates with the P2P group . In an example the leader identification at can occur using the procedure described above with respect to of although this is merely one possible implementation for the identifying of as a modified version of the leader selection schemes described with respect to could also be used at . In a further example instead of relying upon an exchange of unicast messages to facilitate the leader identification at the multicast signaling control channel could be used at least in part for this purpose. For an example if the leader identification of is actually implemented as discussed above with respect to of the multicast signaling control channel could be used to exchange the reachability vectors at to exchange messages e.g. leader announcement message tie breaker messages etc. implemented with respect to and or to send the leader confirmation message at .

The purpose of the leader selection of is specifically to identify the P2P device that will be responsible at least initially for performing a floor arbitration function for a half duplex group communication session via P2P or P2P session . However the selected leader can also optionally act as a media relay to accommodate multi hop network topologies. Accordingly at some point after the leader is selected at which can be delayed somewhat as the floor arbitrator or leader can potentially be identified before any P2P device actually wants to originate a P2P session the P2P device participates in the P2P session by exchanging media with the P2P group in accordance with the floor arbitration function performed by the selected leader would could potentially be the P2P device itself or alternatively one of the other P2P devices . As will be appreciated exchanging media with the P2P group at implies that the P2P device is either transmitting media to the rest of the P2P group that joined the P2P session as the floorholder of the P2P session or is receiving media from the current floorholder of the P2P session. Optionally the floor arbitration function may be transferred from the selected leader to a different P2P device at some point during the P2P session . For example of may be repeated during the P2P session with a new P2P device being identified to perform the floor arbitration function to ensure that the selected leader is still appropriate to handle the floor arbitration function. In another example the selected leader may move out of range and drop out of the P2P session altogether which necessitates a new leader to be selected. For example the selected leader may transmit a heartbeat i.e. a periodic keep alive message using the multicast signaling control channel a new leader may be selected or identified whenever the heartbeat gets too weak or simply stops altogether. In an example the heartbeat can be transmitted on the multicast signaling control channel exclusively by the current floor arbitrator or by a subset of nodes e.g. the floor arbitrator plus any floor arbitrator back ups and or one or more other proxy nodes .

Referring to UEs . . . N conduct a P2P discovery procedure over the discovery channel over the multicast interface of the P2P interface e.g. as in of . At this point assume of are performed by each of UEs . . . N with UE ultimately being identified as the leader that is responsible for performing the floor arbitration function for any P2P sessions involving the P2P group . Any messaging associated with the establishment of the floor arbitrator at may be carried on the multicast signaling control channel although it is possible that at least some of the messaging is carried on one or more unicast channels.

At some later point in time UE determines to originate a half duplex group communication session or P2P session and sends a session origination message to UE via a unicast channel e.g. analogous to an uplink message delivered from a client device to a server in a server arbitrated system . UE receives the session origination message and announces the P2P session over the multicast signaling control channel . UE acknowledges the session announcement on the unicast channel and indicates acceptance willingness to join the P2P session UE sends a floor grant message to UE on the unicast channel and UE begins to stream media to UE on the unicast channel . While not shown explicitly assume that UEs . . . N also ACK the session announcement on the unicast channel in order to join the P2P session.

UE transmits call control information e.g. indicating that UE is the floorholder for the P2P session potentially including information to help identify and or tune to the multicast media channel etc. to the P2P group over the multicast signaling control channel . UE then begins to transmit UE s media to the P2P group over the multicast media channel which is separate from the multicast signaling control channel as noted above .

At some later point during the P2P session UE sends a floor request to UE on the unicast channel and UE sends a floor grant to UE on the unicast channel . UE stops sending media to UE at this point for transmission to the P2P group and UE begins to stream media to UE on the unicast channel . UE transmits call control information e.g. indicating that UE is the new floorholder for the P2P session etc. to the P2P group over the multicast signaling control channel . UE then begins to transmit UE s media to the P2P group over the multicast media channel . At some later point in time during the P2P session UE determines to end the P2P session . UE transmits call control information to end the P2P session to the P2P group over the multicast signaling control channel after which the P2P session is terminated.

Referring to UEs . . . N conduct a P2P discovery procedure over the discovery channel of the P2P interface e.g. as in of . At this point assume of are performed by each of UEs . . . N with UE ultimately being identified as the leader that is responsible for performing the floor arbitration function for any P2P sessions involving the P2P group . Any messaging associated with the establishment of the floor arbitrator at may be carried on the multicast signaling control channel although it is possible that at least some of the messaging is carried on one or more unicast channels.

At some later point in time UE determines to originate a half duplex group communication session or P2P session and sends a session origination message to UE to the P2P group via the multicast signaling control channel e.g. analogous to a downlink call announce message delivered from the server to a group of target UEs in a server arbitrated system . UE acknowledges the session announcement to the floor arbitrator i.e. UE on the unicast channel and indicates acceptance willingness to join the P2P session UE sends a floor grant message to UE on the unicast channel and UE transmits call control information e.g. indicating that UE is the floorholder for the P2P session potentially including information to help identify and or tune to the multicast media channel etc. to the P2P group over the multicast signaling control channel . UE then begins to transmit media to the P2P group over the multicast media channel . While not shown explicitly assume that UEs . . . N also ACK the session announcement on the unicast channel in order to join the P2P session.

At some later point during the P2P session UE sends a floor request to UE on the unicast channel and UE sends a floor grant to UE on the unicast channel . UE transmits call control information e.g. indicating that UE is the new floorholder for the P2P session etc. to the P2P group over the multicast signaling control channel . UE stops sending media at this point UE begins to stream media to the P2P group over the multicast media channel as the new floorholder . At some later point in time during the P2P session UE determines to end the P2P session . UE transmits call control information to end the P2P session to the P2P group over the multicast signaling control channel after which the P2P session is terminated. While show the unicast channel being used to carry floor grant messages it will be appreciated that the unicast channel could also be used to carry floor denial or rejection messages if the floor arbitrator determines not to grant a particular floor request.

While show the unicast channel being used to carry certain signaling that is primarily intended for one recipient e.g. floor request messages floor grant messages unicast media for relay etc. it will be appreciated that any or all of these data could alternatively be transmitted using the multicast signaling control channel in other embodiments of the invention. Accordingly the degree to which the multicast signaling control channel is used or not used can vary by implementation although the multicast signaling control channel would likely be used to carry signaling data that is targeted to multiple P2P targets although some P2P network topologies may reduce the benefit that is gained from the multicast signaling control channel over the unicast channel s .

Further for any of the embodiments discussed above with respect to mixed mode support can be used to extend the above described P2P sessions to one or more UEs that cannot support multicasting with the rest of the P2P group via the P2P interface. For example using the P2P network topology C from as an example U may move out of direct communication range of U and thereby lose its connection to the P2P group via the P2P interface. In this case U can attempt to connect to the RAN and be patched into the P2P session via another P2P device e.g. the leader or some other P2P device in the P2P group can also maintain a RAN connection for streaming media to or from any mixed mode participants etc. . If U re enters P2P range at some later point in time while the P2P session is still active U can transition from being a mixed mode participant back to being a P2P participant over the P2P interface for the P2P session. In another example U may remain in direct communication range with U but may simply not have the capacity to support multicast via P2P for media and or signaling e.g. the multicast address or multicast address derivation algorithm may not have been provisioned on U etc. . In this case any multicast messaging that cannot be decoded by U can be separately transmitted to U via unicast. Likewise any messaging originating from U that would normally be sent via multicast by other P2P group members can be re transmitted by U or some other P2P group member via multicast.

While the above described embodiments are described with respect to LTE D in part it will be appreciated by one of ordinary skill in the art that the above described embodiments can be implemented with respect to any D2D P2P technology or interface e.g. LTE D WFD Bluetooth near field communication NFC etc. .

Those of skill in the art will appreciate that information and signals may be represented using any of a variety of different technologies and techniques. For example data instructions commands information signals bits symbols and chips that may be referenced throughout the above description may be represented by voltages currents electromagnetic waves magnetic fields or particles optical fields or particles or any combination thereof.

Further those of skill in the art will appreciate that the various illustrative logical blocks modules circuits and algorithm steps described in connection with the embodiments disclosed herein may be implemented as electronic hardware computer software or combinations of both. To clearly illustrate this interchangeability of hardware and software various illustrative components blocks modules circuits and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system. Skilled artisans may implement the described functionality in varying ways for each particular application but such implementation decisions should not be interpreted as causing a departure from the scope of the present invention.

The various illustrative logical blocks modules and circuits described in connection with the embodiments disclosed herein may be implemented or performed with a general purpose processor a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but in the alternative the processor may be any conventional processor controller microcontroller or state machine. A processor may also be implemented as a combination of computing devices e.g. a combination of a DSP and a microprocessor a plurality of microprocessors one or more microprocessors in conjunction with a DSP core or any other such configuration.

The methods sequences and or algorithms described in connection with the embodiments disclosed herein may be embodied directly in hardware in a software module executed by a processor or in a combination of the two. A software module may reside in RAM memory flash memory ROM memory EPROM memory EEPROM memory registers hard disk a removable disk a CD ROM or any other form of storage medium known in the art. An exemplary storage medium is coupled to the processor such that the processor can read information from and write information to the storage medium. In the alternative the storage medium may be integral to the processor. The processor and the storage medium may reside in an ASIC. The ASIC may reside in a user terminal e.g. UE . In the alternative the processor and the storage medium may reside as discrete components in a user terminal.

In one or more exemplary embodiments the functions described may be implemented in hardware software firmware or any combination thereof. If implemented in software the functions may be stored on or transmitted over as one or more instructions or code on a computer readable medium. Computer readable media includes both computer storage media and communication media including any medium that facilitates transfer of a computer program from one place to another. A storage media may be any available media that can be accessed by a computer. By way of example and not limitation such computer readable media can comprise RAM ROM EEPROM CD ROM or other optical disk storage magnetic disk storage or other magnetic storage devices or any other medium that can be used to carry or store desired program code in the form of instructions or data structures and that can be accessed by a computer. Also any connection is properly termed a computer readable medium. For example if the software is transmitted from a website server or other remote source using a coaxial cable fiber optic cable twisted pair digital subscriber line DSL or wireless technologies such as infrared radio and microwave then the coaxial cable fiber optic cable twisted pair DSL or wireless technologies such as infrared radio and microwave are included in the definition of medium. Disk and disc as used herein includes compact disc CD laser disc optical disc digital versatile disc DVD floppy disk and blu ray disc where disks usually reproduce data magnetically while discs reproduce data optically with lasers. Combinations of the above should also be included within the scope of computer readable media.

While the foregoing disclosure shows illustrative embodiments of the invention it should be noted that various changes and modifications could be made herein without departing from the scope of the invention as defined by the appended claims. The functions steps and or actions of the method claims in accordance with the embodiments of the invention described herein need not be performed in any particular order. Furthermore although elements of the invention may be described or claimed in the singular the plural is contemplated unless limitation to the singular is explicitly stated.

